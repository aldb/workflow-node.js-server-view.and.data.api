/*
 zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License  zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License  Copyright (c) 2013 Autodesk Inc. */
var IS_CONCAT_BUILD=!0,BUILD_LMV_WORKER_URL="lmvworker.js",LMV_WORKER_URL=BUILD_LMV_WORKER_URL,ENABLE_DEBUG=!1,ENABLE_TRACE=!1,ENABLE_INLINE_WORKER=!0;AutodeskNamespace=function(a){var b=this;a=a.split(".");for(var c=0;c<a.length;++c)b[a[c]]=b[a[c]]||{},b=b[a[c]];return b};var _isIE11=!!navigator.userAgent.match(/Trident\/7\./);
"undefined"!==typeof window&&_isIE11&&function(){function a(a,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=document.createEvent("CustomEvent");d.initCustomEvent(a,c.bubbles,c.cancelable,c.detail);return d}a.prototype=window.CustomEvent.prototype;window.CustomEvent=a}();
ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){!b||b>this.byteLength?b=this.byteLength:0>b&&(b=this.byteLength+b,0>b&&(b=0));0>a&&(a=this.byteLength+a,0>a&&(a=0));if(b<=a)return new ArrayBuffer;for(var c=b-a,d=new Uint8Array(this,a,c),e=new Uint8Array(c),f=0;f<c;f++)e[f]=d[f];return e.buffer});"undefined"!==typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);
function launchFullscreen(a,b){a.requestFullscreen?a.requestFullscreen(b):a.mozRequestFullScreen?a.mozRequestFullScreen(b):a.webkitRequestFullscreen?a.webkitRequestFullscreen(b):a.msRequestFullscreen&&a.msRequestFullscreen(b)}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}
function inFullscreen(){return document.fullscreenEnabled||document.mozFullScreenElement||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1}function fullscreenElement(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function isFullscreenAvailable(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen}
function getAndroidVersion(a){a=a||navigator.userAgent;return(a=a.match(/Android\s([0-9\.]*)/))?a[1]:!1}function isTouchDevice(){return"ontouchstart"in window}function isIOSDevice(){return/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())}function isAndroidDevice(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")}function touchStartToClick(a){a.preventDefault();a.stopPropagation();a.target.click()}
(function(){var a="undefined"!==typeof window&&null!==window?window:self;a.performance||(a.performance=Date)})();LmvMatrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};
LmvMatrix4.prototype={constructor:LmvMatrix4,set:function(a,b,c,d,e,f,g,h,l,k,m,p,r,n,u,t){var q=this.elements;q[0]=a;q[4]=b;q[8]=c;q[12]=d;q[1]=e;q[5]=f;q[9]=g;q[13]=h;q[2]=l;q[6]=k;q[10]=m;q[14]=p;q[3]=r;q[7]=n;q[11]=u;q[15]=t;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,l=e+e;a=c*g;var k=c*h,c=c*l,m=
d*h,d=d*l,e=e*l,g=f*g,h=f*h,f=f*l;b[0]=1-(m+e);b[4]=k-f;b[8]=c+h;b[1]=k+f;b[5]=1-(a+e);b[9]=d-g;b[2]=c-h;b[6]=d+g;b[10]=1-(a+m);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},multiply:function(a){return this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],l=c[12],k=c[1],m=c[5],p=c[9],r=c[13],n=c[2],u=c[6],t=c[10],q=c[14],x=c[3],A=c[7],F=c[11],c=c[15],z=d[0],B=d[4],J=d[8],K=d[12],I=d[1],D=d[5],C=d[9],w=
d[13],E=d[2],G=d[6],H=d[10],y=d[14],v=d[3],M=d[7],N=d[11],d=d[15];e[0]=f*z+g*I+h*E+l*v;e[4]=f*B+g*D+h*G+l*M;e[8]=f*J+g*C+h*H+l*N;e[12]=f*K+g*w+h*y+l*d;e[1]=k*z+m*I+p*E+r*v;e[5]=k*B+m*D+p*G+r*M;e[9]=k*J+m*C+p*H+r*N;e[13]=k*K+m*w+p*y+r*d;e[2]=n*z+u*I+t*E+q*v;e[6]=n*B+u*D+t*G+q*M;e[10]=n*J+u*C+t*H+q*N;e[14]=n*K+u*w+t*y+q*d;e[3]=x*z+A*I+F*E+c*v;e[7]=x*B+A*D+F*G+c*M;e[11]=x*J+A*C+F*H+c*N;e[15]=x*K+A*w+F*y+c*d;return this},multiplyToArray:function(a,b,c){var d=this.elements;this.multiplyMatrices(a,b);c[0]=
d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],l=a[13],k=a[2],m=a[6],p=a[10],r=a[14];
return a[3]*(+e*h*m-d*l*m-e*g*p+c*l*p+d*g*r-c*h*r)+a[7]*(+b*h*r-b*l*p+e*f*p-d*f*r+d*l*k-e*h*k)+a[11]*(+b*l*m-b*g*r-e*f*m+c*f*r+e*g*k-c*l*k)+a[15]*(-d*g*k-b*h*m+b*g*p+d*f*m-c*f*p+c*h*k)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=
c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],g=d[8],h=d[12],l=d[1],k=d[5],m=d[9],p=d[13],r=d[2],n=d[6],u=d[10],t=d[14],q=d[3],x=d[7],A=d[11],d=d[15];c[0]=m*t*x-p*u*x+p*n*A-k*t*A-m*n*d+k*u*d;c[4]=h*u*x-g*t*x-h*n*A+f*t*A+g*n*d-f*u*
d;c[8]=g*p*x-h*m*x+h*k*A-f*p*A-g*k*d+f*m*d;c[12]=h*m*n-g*p*n-h*k*u+f*p*u+g*k*t-f*m*t;c[1]=p*u*q-m*t*q-p*r*A+l*t*A+m*r*d-l*u*d;c[5]=g*t*q-h*u*q+h*r*A-e*t*A-g*r*d+e*u*d;c[9]=h*m*q-g*p*q-h*l*A+e*p*A+g*l*d-e*m*d;c[13]=g*p*r-h*m*r+h*l*u-e*p*u-g*l*t+e*m*t;c[2]=k*t*q-p*n*q+p*r*x-l*t*x-k*r*d+l*n*d;c[6]=h*n*q-f*t*q-h*r*x+e*t*x+f*r*d-e*n*d;c[10]=f*p*q-h*k*q+h*l*x-e*p*x-f*l*d+e*k*d;c[14]=h*k*r-f*p*r-h*l*n+e*p*n+f*l*t-e*k*t;c[3]=m*n*q-k*u*q-m*r*x+l*u*x+k*r*A-l*n*A;c[7]=f*u*q-g*n*q+g*r*x-e*u*x-f*r*A+e*n*A;c[11]=
g*k*q-f*m*q-g*l*x+e*m*x+f*l*A-e*k*A;c[15]=f*m*r-g*k*r+g*l*n-e*m*n-f*l*u+e*k*u;c=e*c[0]+l*c[4]+r*c[8]+q*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},
makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,
g=a.y,h=a.z,l=e*f,k=e*g;this.set(l*f+c,l*g-d*h,l*h+d*g,0,l*g+d*h,k*g+c,k*h-d*f,0,l*h-d*g,k*h+d*f,e*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},transformPoint:function(a){var b=a.x,c=a.y,d=a.z,e=this.elements;a.x=e[0]*b+e[4]*c+e[8]*d+e[12];a.y=e[1]*b+e[5]*c+e[9]*d+e[13];a.z=e[2]*b+e[6]*c+e[10]*d+e[14];return a},transformDirection:function(a){var b=
a.x,c=a.y,d=a.z,e=this.elements;a.x=e[0]*b+e[4]*c+e[8]*d;a.y=e[1]*b+e[5]*c+e[9]*d;a.z=e[2]*b+e[6]*c+e[10]*d;b=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z);0<b&&(b=1/b,a.x*=b,a.y*=b,a.z*=b);return a},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){return(new LmvMatrix4).fromArray(this.elements)}};
(function(){function a(a){throw a;}function b(a,b){var c=a.split("."),d=m;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function c(a,b,c){var d="number"===typeof b?b:b=0,e="number"===typeof c?c:a.length;c=-1;for(d=e&7;d--;++b)c=c>>>8^t[(c^a[b])&255];for(d=e>>3;d--;b+=8)c=c>>>8^t[(c^a[b])&255],c=c>>>8^t[(c^a[b+1])&255],c=c>>>8^t[(c^a[b+2])&255],c=c>>>8^t[(c^a[b+3])&255],c=c>>>8^t[(c^a[b+4])&255],c=c>>>8^t[(c^a[b+
5])&255],c=c>>>8^t[(c^a[b+6])&255],c=c>>>8^t[(c^a[b+7])&255];return(c^4294967295)>>>0}function d(){}function e(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,g,f,v,h,k,l,q,m;for(q=0;q<b;++q)a[q]>c&&(c=a[q]),a[q]<d&&(d=a[q]);e=1<<c;g=new (p?Uint32Array:Array)(e);f=1;v=0;for(h=2;f<=c;){for(q=0;q<b;++q)if(a[q]===f){k=0;l=v;for(m=0;m<f;++m)k=k<<1|l&1,l>>=1;for(m=k;m<e;m+=h)g[m]=f<<16|q;++v}++f;v<<=1;h<<=1}return[g,c,d]}function f(b,c){this.i=[];this.j=32768;this.d=this.f=this.c=this.n=0;this.input=
p?new Uint8Array(b):b;this.o=!1;this.k=x;this.w=!1;if(c||!(c={}))c.index&&(this.c=c.index),c.bufferSize&&(this.j=c.bufferSize),c.bufferType&&(this.k=c.bufferType),c.resize&&(this.w=c.resize);switch(this.k){case q:this.a=32768;this.b=new (p?Uint8Array:Array)(32768+this.j+258);break;case x:this.a=0;this.b=new (p?Uint8Array:Array)(this.j);this.e=this.D;this.q=this.A;this.l=this.C;break;default:a(Error("invalid inflate mode"))}}function g(b,c){for(var d=b.f,e=b.d,g=b.input,f=b.c,y;e<c;)y=g[f++],void 0===
y&&a(Error("input buffer is broken")),d|=y<<e,e+=8;b.f=d>>>c;b.d=e-c;b.c=f;return d&(1<<c)-1}function h(a,b){for(var c=a.f,d=a.d,e=a.input,g=a.c,f=b[0],v=b[1],h;d<v;){h=e[g++];if(void 0===h)break;c|=h<<d;d+=8}e=f[c&(1<<v)-1];f=e>>>16;a.f=c>>f;a.d=d-f;a.c=g;return e&65535}function l(a){function b(a,c,d){var e,f,y,k;for(k=0;k<a;)switch(e=h(this,c),e){case 16:for(y=3+g(this,2);y--;)d[k++]=f;break;case 17:for(y=3+g(this,3);y--;)d[k++]=0;f=0;break;case 18:for(y=11+g(this,7);y--;)d[k++]=0;f=0;break;default:f=
d[k++]=e}return d}var c=g(a,5)+257,d=g(a,5)+1,f=g(a,4)+4,k=new (p?Uint8Array:Array)(A.length),y;for(y=0;y<f;++y)k[A[y]]=g(a,3);f=e(k);k=new (p?Uint8Array:Array)(c);y=new (p?Uint8Array:Array)(d);a.l(e(b.call(a,c,f,k)),e(b.call(a,d,f,y)))}function k(a){this.input=a;this.c=0;this.m=[];this.s=!1}var m=this,p="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;new (p?Uint8Array:Array)(256);var r;for(r=0;256>r;++r)for(var n=r,u=7,n=n>>>1;n;n>>>=1)--u;r=[0,
1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,
651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,
4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,
167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,
3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,
2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];var t=p?new Uint32Array(r):r;d.prototype.getName=function(){return this.name};d.prototype.getData=function(){return this.data};d.prototype.G=function(){return this.H};b("Zlib.GunzipMember",d);b("Zlib.GunzipMember.prototype.getName",d.prototype.getName);b("Zlib.GunzipMember.prototype.getData",
d.prototype.getData);b("Zlib.GunzipMember.prototype.getMtime",d.prototype.G);r=[];for(n=0;288>n;n++)switch(!0){case 143>=n:r.push([n+48,8]);break;case 255>=n:r.push([n-144+400,9]);break;case 279>=n:r.push([n-256+0,7]);break;case 287>=n:r.push([n-280+192,8]);break;default:a("invalid literal: "+n)}r=function(){function b(c){switch(!0){case 3===c:return[257,c-3,0];case 4===c:return[258,c-4,0];case 5===c:return[259,c-5,0];case 6===c:return[260,c-6,0];case 7===c:return[261,c-7,0];case 8===c:return[262,
c-8,0];case 9===c:return[263,c-9,0];case 10===c:return[264,c-10,0];case 12>=c:return[265,c-11,1];case 14>=c:return[266,c-13,1];case 16>=c:return[267,c-15,1];case 18>=c:return[268,c-17,1];case 22>=c:return[269,c-19,2];case 26>=c:return[270,c-23,2];case 30>=c:return[271,c-27,2];case 34>=c:return[272,c-31,2];case 42>=c:return[273,c-35,3];case 50>=c:return[274,c-43,3];case 58>=c:return[275,c-51,3];case 66>=c:return[276,c-59,3];case 82>=c:return[277,c-67,4];case 98>=c:return[278,c-83,4];case 114>=c:return[279,
c-99,4];case 130>=c:return[280,c-115,4];case 162>=c:return[281,c-131,5];case 194>=c:return[282,c-163,5];case 226>=c:return[283,c-195,5];case 257>=c:return[284,c-227,5];case 258===c:return[285,c-258,0];default:a("invalid length: "+c)}}var c=[],d,e;for(d=3;258>=d;d++)e=b(d),c[d]=e[2]<<24|e[1]<<16|e[0];return c}();p&&new Uint32Array(r);var q=0,x=1;f.prototype.g=function(){for(;!this.o;){var b=g(this,3);b&1&&(this.o=!0);b>>>=1;switch(b){case 0:var b=this.input,c=this.c,d=this.b,e=this.a,f=void 0,h=void 0,
y=void 0,v=d.length,f=void 0;this.d=this.f=0;f=b[c++];void 0===f&&a(Error("invalid uncompressed block header: LEN (first byte)"));h=f;f=b[c++];void 0===f&&a(Error("invalid uncompressed block header: LEN (second byte)"));h|=f<<8;f=b[c++];void 0===f&&a(Error("invalid uncompressed block header: NLEN (first byte)"));y=f;f=b[c++];void 0===f&&a(Error("invalid uncompressed block header: NLEN (second byte)"));y|=f<<8;h===~y&&a(Error("invalid uncompressed block header: length verify"));c+h>b.length&&a(Error("input buffer is broken"));
switch(this.k){case q:for(;e+h>d.length;){f=v-e;h-=f;if(p)d.set(b.subarray(c,c+f),e),e+=f,c+=f;else for(;f--;)d[e++]=b[c++];this.a=e;d=this.e();e=this.a}break;case x:for(;e+h>d.length;)d=this.e({t:2});break;default:a(Error("invalid inflate mode"))}if(p)d.set(b.subarray(c,c+h),e),e+=h,c+=h;else for(;h--;)d[e++]=b[c++];this.c=c;this.a=e;this.b=d;break;case 1:this.l(K,I);break;case 2:l(this);break;default:a(Error("unknown BTYPE: "+b))}}return this.q()};r=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,
15];var A=p?new Uint16Array(r):r;r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];var F=p?new Uint16Array(r):r;r=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var z=p?new Uint8Array(r):r;r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var B=p?new Uint16Array(r):r;r=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var J=p?new Uint8Array(r):r;r=
new (p?Uint8Array:Array)(288);n=0;for(u=r.length;n<u;++n)r[n]=143>=n?8:255>=n?9:279>=n?7:8;var K=e(r);r=new (p?Uint8Array:Array)(30);n=0;for(u=r.length;n<u;++n)r[n]=5;var I=e(r);f.prototype.l=function(a,b){var c=this.b,d=this.a;this.r=a;for(var e=c.length-258,f,y,v;256!==(f=h(this,a));)if(256>f)d>=e&&(this.a=d,c=this.e(),d=this.a),c[d++]=f;else for(f-=257,v=F[f],0<z[f]&&(v+=g(this,z[f])),f=h(this,b),y=B[f],0<J[f]&&(y+=g(this,J[f])),d>=e&&(this.a=d,c=this.e(),d=this.a);v--;)c[d]=c[d++-y];for(;8<=this.d;)this.d-=
8,this.c--;this.a=d};f.prototype.C=function(a,b){var c=this.b,d=this.a;this.r=a;for(var e=c.length,f,y,v;256!==(f=h(this,a));)if(256>f)d>=e&&(c=this.e(),e=c.length),c[d++]=f;else for(f-=257,v=F[f],0<z[f]&&(v+=g(this,z[f])),f=h(this,b),y=B[f],0<J[f]&&(y+=g(this,J[f])),d+v>e&&(c=this.e(),e=c.length);v--;)c[d]=c[d++-y];for(;8<=this.d;)this.d-=8,this.c--;this.a=d};f.prototype.e=function(){var a=new (p?Uint8Array:Array)(this.a-32768),b=this.a-32768,c,d,e=this.b;if(p)a.set(e.subarray(32768,a.length));else for(c=
0,d=a.length;c<d;++c)a[c]=e[c+32768];this.i.push(a);this.n+=a.length;if(p)e.set(e.subarray(b,b+32768));else for(c=0;32768>c;++c)e[c]=e[b+c];this.a=32768;return e};f.prototype.D=function(a){var b,c=this.input.length/this.c+1|0,d,e,f,g=this.input,h=this.b;a&&("number"===typeof a.t&&(c=a.t),"number"===typeof a.z&&(c+=a.z));2>c?(d=(g.length-this.c)/this.r[2],f=d/2*258|0,e=f<h.length?h.length+f:h.length<<1):e=h.length*c;p?(b=new Uint8Array(e),b.set(h)):b=h;return this.b=b};f.prototype.q=function(){var a=
0,b=this.b,c=this.i,d,e=new (p?Uint8Array:Array)(this.n+(this.a-32768)),f,g,h,k;if(0===c.length)return p?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);f=0;for(g=c.length;f<g;++f)for(d=c[f],h=0,k=d.length;h<k;++h)e[a++]=d[h];f=32768;for(g=this.a;f<g;++f)e[a++]=b[f];this.i=[];return this.buffer=e};f.prototype.A=function(){var a,b=this.a;p?this.w?(a=new Uint8Array(b),a.set(this.b.subarray(0,b))):a=this.b.subarray(0,b):(this.b.length>b&&(this.b.length=b),a=this.b);return this.buffer=a};k.prototype.F=
function(){this.s||this.g();return this.m.slice()};k.prototype.g=function(){for(var b=this.input.length;this.c<b;){var e=new d,g=void 0,h=void 0,k=void 0,q=g=k=void 0,y=void 0,g=g=void 0,v=this.input,h=this.c;e.u=v[h++];e.v=v[h++];31===e.u&&139===e.v||a(Error("invalid file signature:"+e.u+","+e.v));e.p=v[h++];switch(e.p){case 8:break;default:a(Error("unknown compression method: "+e.p))}e.h=v[h++];g=v[h++]|v[h++]<<8|v[h++]<<16|v[h++]<<24;e.H=new Date(1E3*g);e.N=v[h++];e.M=v[h++];0<(e.h&4)&&(e.I=v[h++]|
v[h++]<<8,h+=e.I);if(0<(e.h&8)){y=[];for(q=0;0<(g=v[h++]);)y[q++]=String.fromCharCode(g);e.name=y.join("")}if(0<(e.h&16)){y=[];for(q=0;0<(g=v[h++]);)y[q++]=String.fromCharCode(g);e.J=y.join("")}0<(e.h&2)&&(e.B=c(v,0,h)&65535,e.B!==(v[h++]|v[h++]<<8)&&a(Error("invalid header crc16")));g=v[v.length-4]|v[v.length-3]<<8|v[v.length-2]<<16|v[v.length-1]<<24;v.length-h-4-4<512*g&&(k=g);h=new f(v,{index:h,bufferSize:k});e.data=k=h.g();h=h.c;e.K=g=(v[h++]|v[h++]<<8|v[h++]<<16|v[h++]<<24)>>>0;c(k,void 0,void 0)!==
g&&a(Error("invalid CRC-32 checksum: 0x"+c(k,void 0,void 0).toString(16)+" / 0x"+g.toString(16)));e.L=g=(v[h++]|v[h++]<<8|v[h++]<<16|v[h++]<<24)>>>0;(k.length&4294967295)!==g&&a(Error("invalid input size: "+(k.length&4294967295)+" / "+g));this.m.push(e);this.c=h}this.s=!0;b=this.m;e=k=h=0;for(v=b.length;e<v;++e)k+=b[e].data.length;if(p)for(k=new Uint8Array(k),e=0;e<v;++e)k.set(b[e].data,h),h+=b[e].data.length;else{k=[];for(e=0;e<v;++e)k[e]=b[e].data;k=Array.prototype.concat.apply([],k)}return k};
b("Zlib.Gunzip",k);b("Zlib.Gunzip.prototype.decompress",k.prototype.g);b("Zlib.Gunzip.prototype.getMembers",k.prototype.F)}).call(this);
(function(){function a(a){throw a;}function b(a,b){var c=a.split("."),d=u;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d=d[e]?d[e]:d[e]={}:d[e]=b}function c(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,g,h,k,q,l,m,n;for(m=0;m<b;++m)a[m]>c&&(c=a[m]),a[m]<d&&(d=a[m]);e=1<<c;f=new (t?Uint32Array:Array)(e);g=1;h=0;for(k=2;g<=c;){for(m=0;m<b;++m)if(a[m]===g){q=0;l=h;for(n=0;n<g;++n)q=q<<1|l&1,l>>=1;for(n=q;n<e;n+=k)f[n]=g<<16|m;++h}++g;
h<<=1;k<<=1}return[f,c,d]}function d(b,c){this.l=[];this.m=32768;this.d=this.f=this.c=this.t=0;this.input=t?new Uint8Array(b):b;this.u=!1;this.n=z;this.K=!1;if(c||!(c={}))c.index&&(this.c=c.index),c.bufferSize&&(this.m=c.bufferSize),c.bufferType&&(this.n=c.bufferType),c.resize&&(this.K=c.resize);switch(this.n){case F:this.a=32768;this.b=new (t?Uint8Array:Array)(32768+this.m+258);break;case z:this.a=0;this.b=new (t?Uint8Array:Array)(this.m);this.e=this.W;this.B=this.R;this.q=this.V;break;default:a(Error("invalid inflate mode"))}}
function e(b,c){for(var d=b.f,e=b.d,f=b.input,g=b.c,h;e<c;)h=f[g++],void 0===h&&a(Error("input buffer is broken")),d|=h<<e,e+=8;b.f=d>>>c;b.d=e-c;b.c=g;return d&(1<<c)-1}function f(a,b){for(var c=a.f,d=a.d,e=a.input,f=a.c,g=b[0],h=b[1],k;d<h;){k=e[f++];if(void 0===k)break;c|=k<<d;d+=8}e=g[c&(1<<h)-1];g=e>>>16;a.f=c>>g;a.d=d-g;a.c=f;return e&65535}function g(a){function b(a,c,d){var g,h,k,q;for(q=0;q<a;)switch(g=f(this,c),g){case 16:for(k=3+e(this,2);k--;)d[q++]=h;break;case 17:for(k=3+e(this,3);k--;)d[q++]=
0;h=0;break;case 18:for(k=11+e(this,7);k--;)d[q++]=0;h=0;break;default:h=d[q++]=g}return d}var d=e(a,5)+257,g=e(a,5)+1,h=e(a,4)+4,k=new (t?Uint8Array:Array)(B.length),q;for(q=0;q<h;++q)k[B[q]]=e(a,3);h=c(k);k=new (t?Uint8Array:Array)(d);q=new (t?Uint8Array:Array)(g);a.q(c(b.call(a,d,h,k)),c(b.call(a,g,h,q)))}function h(a){a=a||{};this.files=[];this.v=a.comment}function l(a,b){b=b||{};this.input=t&&a instanceof Array?new Uint8Array(a):a;this.c=0;this.ba=b.verify||!1;this.j=b.password}function k(a,
b){this.input=a;this.offset=b}function m(a,b){this.input=a;this.offset=b}function p(b){var c=[],d={},e,f,g,h;if(!b.i){if(void 0===b.o){e=b.input;if(!b.D)a:{f=b.input;for(g=f.length-12;0<g;--g)if(f[g]===H[0]&&f[g+1]===H[1]&&f[g+2]===H[2]&&f[g+3]===H[3]){b.D=g;break a}a(Error("End of Central Directory Record not found"))}f=b.D;e[f++]===H[0]&&e[f++]===H[1]&&e[f++]===H[2]&&e[f++]===H[3]||a(Error("invalid signature"));b.ha=e[f++]|e[f++]<<8;b.ja=e[f++]|e[f++]<<8;b.ka=e[f++]|e[f++]<<8;b.aa=e[f++]|e[f++]<<
8;b.Q=(e[f++]|e[f++]<<8|e[f++]<<16|e[f++]<<24)>>>0;b.o=(e[f++]|e[f++]<<8|e[f++]<<16|e[f++]<<24)>>>0;b.w=e[f++]|e[f++]<<8;b.v=t?e.subarray(f,f+b.w):e.slice(f,f+b.w)}e=b.o;g=0;for(h=b.aa;g<h;++g)f=new k(b.input,e),f.parse(),e+=f.length,c[g]=f,d[f.filename]=g;b.Q<e-b.o&&a(Error("invalid file header size"));b.i=c;b.G=d}}function r(a,b,c){c^=a.s(b);a.k(b,c);return c}var n,u=this,t="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;new (t?Uint8Array:Array)(256);
for(n=0;256>n;++n)for(var q=n,x=7,q=q>>>1;q;q>>>=1)--x;n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,
3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,
314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,
3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,
1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,
1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];var A=t?new Uint32Array(n):n;n=[];for(q=0;288>q;q++)switch(!0){case 143>=q:n.push([q+48,8]);break;case 255>=q:n.push([q-144+400,9]);break;case 279>=q:n.push([q-256+0,7]);break;case 287>=q:n.push([q-280+192,8]);break;default:a("invalid literal: "+
q)}n=function(){function b(c){switch(!0){case 3===c:return[257,c-3,0];case 4===c:return[258,c-4,0];case 5===c:return[259,c-5,0];case 6===c:return[260,c-6,0];case 7===c:return[261,c-7,0];case 8===c:return[262,c-8,0];case 9===c:return[263,c-9,0];case 10===c:return[264,c-10,0];case 12>=c:return[265,c-11,1];case 14>=c:return[266,c-13,1];case 16>=c:return[267,c-15,1];case 18>=c:return[268,c-17,1];case 22>=c:return[269,c-19,2];case 26>=c:return[270,c-23,2];case 30>=c:return[271,c-27,2];case 34>=c:return[272,
c-31,2];case 42>=c:return[273,c-35,3];case 50>=c:return[274,c-43,3];case 58>=c:return[275,c-51,3];case 66>=c:return[276,c-59,3];case 82>=c:return[277,c-67,4];case 98>=c:return[278,c-83,4];case 114>=c:return[279,c-99,4];case 130>=c:return[280,c-115,4];case 162>=c:return[281,c-131,5];case 194>=c:return[282,c-163,5];case 226>=c:return[283,c-195,5];case 257>=c:return[284,c-227,5];case 258===c:return[285,c-258,0];default:a("invalid length: "+c)}}var c=[],d,e;for(d=3;258>=d;d++)e=b(d),c[d]=e[2]<<24|e[1]<<
16|e[0];return c}();t&&new Uint32Array(n);var F=0,z=1;d.prototype.r=function(){for(;!this.u;){var b=e(this,3);b&1&&(this.u=!0);b>>>=1;switch(b){case 0:var b=this.input,c=this.c,d=this.b,f=this.a,h=void 0,k=void 0,q=void 0,l=d.length,h=void 0;this.d=this.f=0;h=b[c++];void 0===h&&a(Error("invalid uncompressed block header: LEN (first byte)"));k=h;h=b[c++];void 0===h&&a(Error("invalid uncompressed block header: LEN (second byte)"));k|=h<<8;h=b[c++];void 0===h&&a(Error("invalid uncompressed block header: NLEN (first byte)"));
q=h;h=b[c++];void 0===h&&a(Error("invalid uncompressed block header: NLEN (second byte)"));q|=h<<8;k===~q&&a(Error("invalid uncompressed block header: length verify"));c+k>b.length&&a(Error("input buffer is broken"));switch(this.n){case F:for(;f+k>d.length;){h=l-f;k-=h;if(t)d.set(b.subarray(c,c+h),f),f+=h,c+=h;else for(;h--;)d[f++]=b[c++];this.a=f;d=this.e();f=this.a}break;case z:for(;f+k>d.length;)d=this.e({H:2});break;default:a(Error("invalid inflate mode"))}if(t)d.set(b.subarray(c,c+k),f),f+=k,
c+=k;else for(;k--;)d[f++]=b[c++];this.c=c;this.a=f;this.b=d;break;case 1:this.q(C,w);break;case 2:g(this);break;default:a(Error("unknown BTYPE: "+b))}}return this.B()};n=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var B=t?new Uint16Array(n):n;n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258];var J=t?new Uint16Array(n):n;n=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0];var K=t?new Uint8Array(n):n;n=[1,2,3,4,5,7,9,13,17,25,33,49,
65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var I=t?new Uint16Array(n):n;n=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var D=t?new Uint8Array(n):n;n=new (t?Uint8Array:Array)(288);q=0;for(x=n.length;q<x;++q)n[q]=143>=q?8:255>=q?9:279>=q?7:8;var C=c(n);n=new (t?Uint8Array:Array)(30);q=0;for(x=n.length;q<x;++q)n[q]=5;var w=c(n);n=d.prototype;n.q=function(a,b){var c=this.b,d=this.a;this.C=a;for(var g=c.length-258,h,k,q;256!==(h=f(this,
a));)if(256>h)d>=g&&(this.a=d,c=this.e(),d=this.a),c[d++]=h;else for(h-=257,q=J[h],0<K[h]&&(q+=e(this,K[h])),h=f(this,b),k=I[h],0<D[h]&&(k+=e(this,D[h])),d>=g&&(this.a=d,c=this.e(),d=this.a);q--;)c[d]=c[d++-k];for(;8<=this.d;)this.d-=8,this.c--;this.a=d};n.V=function(a,b){var c=this.b,d=this.a;this.C=a;for(var h=c.length,g,k,q;256!==(g=f(this,a));)if(256>g)d>=h&&(c=this.e(),h=c.length),c[d++]=g;else for(g-=257,q=J[g],0<K[g]&&(q+=e(this,K[g])),g=f(this,b),k=I[g],0<D[g]&&(k+=e(this,D[g])),d+q>h&&(c=
this.e(),h=c.length);q--;)c[d]=c[d++-k];for(;8<=this.d;)this.d-=8,this.c--;this.a=d};n.e=function(){var a=new (t?Uint8Array:Array)(this.a-32768),b=this.a-32768,c,d,e=this.b;if(t)a.set(e.subarray(32768,a.length));else for(c=0,d=a.length;c<d;++c)a[c]=e[c+32768];this.l.push(a);this.t+=a.length;if(t)e.set(e.subarray(b,b+32768));else for(c=0;32768>c;++c)e[c]=e[b+c];this.a=32768;return e};n.W=function(a){var b,c=this.input.length/this.c+1|0,d,e,f,g=this.input,h=this.b;a&&("number"===typeof a.H&&(c=a.H),
"number"===typeof a.P&&(c+=a.P));2>c?(d=(g.length-this.c)/this.C[2],f=d/2*258|0,e=f<h.length?h.length+f:h.length<<1):e=h.length*c;t?(b=new Uint8Array(e),b.set(h)):b=h;return this.b=b};n.B=function(){var a=0,b=this.b,c=this.l,d,e=new (t?Uint8Array:Array)(this.t+(this.a-32768)),f,h,g,k;if(0===c.length)return t?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);f=0;for(h=c.length;f<h;++f)for(d=c[f],g=0,k=d.length;g<k;++g)e[a++]=d[g];f=32768;for(h=this.a;f<h;++f)e[a++]=b[f];this.l=[];return this.buffer=
e};n.R=function(){var a,b=this.a;t?this.K?(a=new Uint8Array(b),a.set(this.b.subarray(0,b))):a=this.b.subarray(0,b):(this.b.length>b&&(this.b.length=b),a=this.b);return this.buffer=a};h.prototype.L=function(a){this.j=a};h.prototype.s=function(a){a=a[2]&65535|2;return a*(a^1)>>8&255};h.prototype.k=function(a,b){a[0]=(A[(a[0]^b)&255]^a[0]>>>8)>>>0;a[1]=(6681*(20173*(a[1]+(a[0]&255))>>>0)>>>0)+1>>>0;a[2]=(A[(a[2]^a[1]>>>24)&255]^a[2]>>>8)>>>0};h.prototype.T=function(a){var b=[305419896,591751049,878082192],
c,d;t&&(b=new Uint32Array(b));c=0;for(d=a.length;c<d;++c)this.k(b,a[c]&255);return b};var E=[80,75,1,2],G=[80,75,3,4],H=[80,75,5,6];k.prototype.parse=function(){var b=this.input,c=this.offset;b[c++]===E[0]&&b[c++]===E[1]&&b[c++]===E[2]&&b[c++]===E[3]||a(Error("invalid file header signature"));this.version=b[c++];this.ia=b[c++];this.Z=b[c++]|b[c++]<<8;this.I=b[c++]|b[c++]<<8;this.A=b[c++]|b[c++]<<8;this.time=b[c++]|b[c++]<<8;this.U=b[c++]|b[c++]<<8;this.p=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>
0;this.z=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.J=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.h=b[c++]|b[c++]<<8;this.g=b[c++]|b[c++]<<8;this.F=b[c++]|b[c++]<<8;this.ea=b[c++]|b[c++]<<8;this.ga=b[c++]|b[c++]<<8;this.fa=b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24;this.$=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.filename=String.fromCharCode.apply(null,t?b.subarray(c,c+=this.h):b.slice(c,c+=this.h));this.X=t?b.subarray(c,c+=this.g):b.slice(c,c+=this.g);this.v=t?b.subarray(c,c+this.F):
b.slice(c,c+this.F);this.length=c-this.offset};m.prototype.parse=function(){var b=this.input,c=this.offset;b[c++]===G[0]&&b[c++]===G[1]&&b[c++]===G[2]&&b[c++]===G[3]||a(Error("invalid local file header signature"));this.Z=b[c++]|b[c++]<<8;this.I=b[c++]|b[c++]<<8;this.A=b[c++]|b[c++]<<8;this.time=b[c++]|b[c++]<<8;this.U=b[c++]|b[c++]<<8;this.p=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.z=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.J=(b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24)>>>0;this.h=
b[c++]|b[c++]<<8;this.g=b[c++]|b[c++]<<8;this.filename=String.fromCharCode.apply(null,t?b.subarray(c,c+=this.h):b.slice(c,c+=this.h));this.X=t?b.subarray(c,c+=this.g):b.slice(c,c+=this.g);this.length=c-this.offset};n=l.prototype;n.Y=function(){var a=[],b,c,d;this.i||p(this);d=this.i;b=0;for(c=d.length;b<c;++b)a[b]=d[b].filename;return a};n.r=function(b,c){var e;this.G||p(this);e=this.G[b];void 0===e&&a(Error(b+" not found"));var f;f=c||{};var h=this.input,g=this.i,k,q,l,n;g||p(this);void 0===g[e]&&
a(Error("wrong index"));g=g[e].$;e=new m(this.input,g);e.parse();g+=e.length;k=e.z;if(0!==(e.I&1)){f.password||this.j||a(Error("please set password"));f=this.S(f.password||this.j);l=g;for(n=g+12;l<n;++l)r(this,f,h[l]);g+=12;k-=12;l=g;for(n=g+k;l<n;++l)h[l]=r(this,f,h[l])}switch(e.A){case 0:q=t?this.input.subarray(g,g+k):this.input.slice(g,g+k);break;case 8:q=(new d(this.input,{index:g,bufferSize:e.J})).r();break;default:a(Error("unknown compression type"))}if(this.ba){h=void 0;k="number"===typeof h?
h:h=0;f=q.length;g=-1;for(k=f&7;k--;++h)g=g>>>8^A[(g^q[h])&255];for(k=f>>3;k--;h+=8)g=g>>>8^A[(g^q[h])&255],g=g>>>8^A[(g^q[h+1])&255],g=g>>>8^A[(g^q[h+2])&255],g=g>>>8^A[(g^q[h+3])&255],g=g>>>8^A[(g^q[h+4])&255],g=g>>>8^A[(g^q[h+5])&255],g=g>>>8^A[(g^q[h+6])&255],g=g>>>8^A[(g^q[h+7])&255];h=(g^4294967295)>>>0;e.p!==h&&a(Error("wrong crc: file=0x"+e.p.toString(16)+", data=0x"+h.toString(16)))}return q};n.L=function(a){this.j=a};n.k=h.prototype.k;n.S=h.prototype.T;n.s=h.prototype.s;b("Zlib.Unzip",l);
b("Zlib.Unzip.prototype.decompress",l.prototype.r);b("Zlib.Unzip.prototype.getFilenames",l.prototype.Y);b("Zlib.Unzip.prototype.setPassword",l.prototype.L)}).call(this);
function InputStream(a){this.buffer=a;this.offset=0;this.byteLength=a.length;this.convBuf=new ArrayBuffer(8);this.convUint8=new Uint8Array(this.convBuf);this.convUint16=new Uint16Array(this.convBuf);this.convInt32=new Int32Array(this.convBuf);this.convUint32=new Uint32Array(this.convBuf);this.convFloat32=new Float32Array(this.convBuf);this.convFloat64=new Float64Array(this.convBuf)}InputStream.prototype.seek=function(a){this.offset=a};
InputStream.prototype.getBytes=function(a){var b=new Uint8Array(this.buffer.buffer,this.offset,a);this.offset+=a;return b};InputStream.prototype.getVarints=function(){var a,b=0,c=0;do a=this.buffer[this.offset++],b|=(a&127)<<c,c+=7;while(a&128);return b};InputStream.prototype.getUint8=function(){return this.buffer[this.offset++]};InputStream.prototype.getUint16=function(){this.convUint8[0]=this.buffer[this.offset++];this.convUint8[1]=this.buffer[this.offset++];return this.convUint16[0]};
InputStream.prototype.getInt16=function(){var a=this.getUint16();32767<a&&(a|=4294901760);return a};InputStream.prototype.getInt32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convInt32[0]};InputStream.prototype.getUint32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convUint32[0]};
InputStream.prototype.getFloat32=function(){var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convFloat32[0]};InputStream.prototype.getFloat64=function(){for(var a=this.buffer,b=this.convUint8,c=this.offset,d=0;8>d;d++)b[d]=a[c+d];this.offset+=8;return this.convFloat64[0]};InputStream.prototype.getString=function(a){for(var b=this.buffer,c="",d=this.offset,e=this.offset+a;d<e;d++)c+=String.fromCharCode(b[d]);this.offset+=a;return decodeURIComponent(escape(c))};
InputStream.prototype.reset=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length};
VBUtils={deduceUVRepetition:function(a){for(var b in a.vblayout)if(0==b.indexOf("uv"))for(var c=a.vbstride,d=a.vb,e=a.vb.length/c,f=0,g=a.vblayout[b].offset;f<e;f++,g+=c){var h=d[g],l=d[g+1];if(2<h||0>h||2<l||0>l){a.vblayout[b].isPattern=!0;break}}},computeBounds3D:function(a){var b=Infinity,c=Infinity,d=Infinity,e=-Infinity,f=-Infinity,g=-Infinity,h,l,k,m,p,r=a.vbstride,n=a.vblayout.position.offset,u=a.vb,t=a.vb.length/r;h=0;for(l=n;h<t;h++,l+=r)k=u[l],m=u[l+1],p=u[l+2],b>k&&(b=k),c>m&&(c=m),d>p&&
(d=p),e<k&&(e=k),f<m&&(f=m),g<p&&(g=p);a.boundingBox={min:{x:b,y:c,z:d},max:{x:e,y:f,z:g}};b=.5*(b+e);c=.5*(c+f);d=.5*(d+g);a=a.boundingSphere={};a.center={x:b,y:c,z:d};h=g=0;for(l=n;h<t;h++,l+=r)k=u[l],m=u[l+1],p=u[l+2],k-=b,m-=c,p-=d,p=k*k+m*m+p*p,p>g&&(g=p);a.radius=Math.sqrt(g)},bboxUnion:function(a,b){b.min.x<a.min.x&&(a.min.x=b.min.x);b.min.y<a.min.y&&(a.min.y=b.min.y);b.min.z<a.min.z&&(a.min.z=b.min.z);b.max.x>a.max.x&&(a.max.x=b.max.x);b.max.y>a.max.y&&(a.max.y=b.max.y);b.max.z>a.max.z&&(a.max.z=
b.max.z)}};var VBB_LINE_SEGMENT=16,VBB_ARC_CIRCULAR=32,VBB_ARC_ELLIPTICAL=48,VBB_TEX_QUAD=64,VBB_ONE_TRIANGLE=80,VBB_INSTANCED_FLAG=0,VBB_SEG_START_RIGHT=1,VBB_SEG_START_LEFT=2,VBB_SEG_END_RIGHT=3,VBB_SEG_END_LEFT=4,TAU=2*Math.PI,VBB_COLOR_OFFSET=6,VBB_DBID_OFFSET=7,VBB_FLAGS_OFFSET=8;
function VertexBufferBuilder(a){this.useInstancing=a;this.stride=9;this.vb=new ArrayBuffer(4*this.stride*(this.useInstancing?16384:65536));this.vbf=new Float32Array(this.vb);this.vbi=new Int32Array(this.vb);this.vcount=0;this.ib=this.useInstancing?null:new Uint16Array(65536);this.icount=0;this.minx=this.miny=Infinity;this.maxx=this.maxy=-Infinity;this.dbIds={};this.numTriangleGeoms=this.numCirculars=this.numEllipticals=0}
VertexBufferBuilder.prototype.expandStride=function(){var a=this.stride;if(!(12<=a)){for(var b=this.stride+3,c=new ArrayBuffer(this.vb.byteLength/a*b),d=new Uint8Array(this.vb),e=new Uint8Array(c),f=0,g=this.vcount;f<g;f++)for(var h=f*a*4,l=f*b*4,k=0;k<4*a;k++)e[l+k]=d[h+k];this.vb=c;this.vbf=new Float32Array(c);this.vbi=new Int32Array(c);this.stride=b}};
VertexBufferBuilder.prototype.addToBounds=function(a,b){a<this.minx&&(this.minx=a);a>this.maxx&&(this.maxx=a);b<this.miny&&(this.miny=b);b>this.maxy&&(this.maxy=b)};VertexBufferBuilder.prototype.setVertexFlag=function(a,b,c,d){this.vbi[a*this.stride+VBB_FLAGS_OFFSET]=d|c|b<<16};
VertexBufferBuilder.prototype.addVertexTriangleGeom=function(a,b,c,d,e,f,g,h){for(var l=this.vcount,k=this.useInstancing?1:4,m=0;m<k;m++){var p=(l+m)*this.stride,r=this.vbf;r[p]=a;r[p+1]=b;r[p+2]=c;r[p+3]=d;r[p+4]=e;r[p+5]=f;this.vbi[p+VBB_COLOR_OFFSET]=g;this.vbi[p+VBB_DBID_OFFSET]=h;this.vcount++;this.dbIds[h]=1}return l};
VertexBufferBuilder.prototype.addVertexLine=function(a,b,c,d,e,f,g){for(var h=this.vcount,l=this.useInstancing?1:4,k=0;k<l;k++){var m=(h+k)*this.stride,p=this.vbf;p[m]=a;p[m+1]=b;p[m+2]=c;p[m+3]=d;p[m+4]=e;p[m+5]=0;this.vbi[m+VBB_COLOR_OFFSET]=f;this.vbi[m+VBB_DBID_OFFSET]=g;this.dbIds[g]=1;this.vcount++}return h};
VertexBufferBuilder.prototype.addVertexArc=function(a,b,c,d,e,f,g,h,l,k){for(var m=this.vcount,p=this.useInstancing?1:4,r=0;r<p;r++){var n=(m+r)*this.stride,u=this.vbf;u[n]=a;u[n+1]=b;u[n+2]=c;u[n+3]=d;u[n+4]=h;u[n+5]=e;this.vbi[n+VBB_COLOR_OFFSET]=l;this.vbi[n+VBB_DBID_OFFSET]=k;e!=f&&(u[n+9]=f,u[n+10]=g);this.dbIds[k]=1;this.vcount++}return m};
VertexBufferBuilder.prototype.addVertex=function(a,b,c,d,e,f,g,h){if(!this.useInstancing){var l=this.vcount,k=l*this.stride,m=this.vbf;m[k]=a;m[k+1]=b;m[k+2]=c;m[k+3]=d;m[k+4]=e;m[k+5]=0;this.vbi[k+VBB_COLOR_OFFSET]=f;this.vbi[k+VBB_DBID_OFFSET]=g;this.setVertexFlag(l,h,0,0);this.vcount++;this.dbIds[g]=1;return l}};VertexBufferBuilder.prototype.addVertexPolytriangle=function(a,b,c,d,e,f,g,h){this.useInstancing||(this.addVertex(a,b,c,d,e,f,g,h),this.addToBounds(a,b))};
VertexBufferBuilder.prototype.setVertexColor=function(a,b){this.useInstancing||(this.vbi[a*this.stride+VBB_COLOR_OFFSET]=b)};VertexBufferBuilder.prototype.addTriangle=function(a,b,c){if(!this.useInstancing){var d=this.ib,e=this.icount;if(e+3>=d.length){for(var f=new Uint16Array(2*d.length),g=0;g<e;g++)f[g]=d[g];this.ib=d=f}d[e]=a;d[e+1]=b;d[e+2]=c;this.icount+=3}};
VertexBufferBuilder.prototype.finalizeQuad=function(a,b,c){this.useInstancing?this.setVertexFlag(a,c,VBB_INSTANCED_FLAG,b):(this.addTriangle(a,a+1,a+2),this.addTriangle(a,a+2,a+3),this.setVertexFlag(a,c,VBB_SEG_START_RIGHT,b),this.setVertexFlag(a+1,c,VBB_SEG_END_RIGHT,b),this.setVertexFlag(a+2,c,VBB_SEG_END_LEFT,b),this.setVertexFlag(a+3,c,VBB_SEG_START_LEFT,b))};
VertexBufferBuilder.prototype.addSegment=function(a,b,c,d,e,f,g,h){var l=c-a,k=d-b,m=0;if(l||k)m=Math.atan2(k,l);l=Math.sqrt(l*l+k*k);e=this.addVertexLine(a,b,m,l,.5*e,f,g);this.finalizeQuad(e,VBB_LINE_SEGMENT,h);this.addToBounds(a,b);this.addToBounds(c,d)};
VertexBufferBuilder.prototype.addTriangleGeom=function(a,b,c,d,e,f,g,h,l){this.numTriangleGeoms++;g=this.addVertexTriangleGeom(a,b,c,d,e,f,g,h,l);this.finalizeQuad(g,VBB_ONE_TRIANGLE,l);this.addToBounds(a,b);this.addToBounds(c,d);this.addToBounds(e,f)};
VertexBufferBuilder.prototype.addCircularArc=function(a,b,c,d,e,f,g,h,l){this.numCirculars++;var k=Math.abs(c-d);if(1E-4<k&&1E-4<Math.abs(k-TAU)){var k=a+e*Math.cos(c),m=b+e*Math.sin(c);this.addSegment(k,m,k,m,f,g,h,l);k=a+e*Math.cos(d);m=b+e*Math.sin(d);this.addSegment(k,m,k,m,f,g,h,l)}else this.addToBounds(a-e,b-e),this.addToBounds(a+e,b+e);a=this.addVertexArc(a,b,c,d,e,e,0,.5*f,g,h);this.finalizeQuad(a,VBB_ARC_CIRCULAR,l)};
VertexBufferBuilder.prototype.addEllipticalArc=function(a,b,c,d,e,f,g,h,l,k,m){this.expandStride();this.numEllipticals++;var p=Math.abs(c-d);if(1E-4<Math.abs(p-TAU)){var p=a+e*Math.cos(c),r=b+f*Math.sin(c);this.addSegment(p,r,p,r,h,l,k,m);p=a+e*Math.cos(d);r=b+f*Math.sin(d);this.addSegment(p,r,p,r,h,l,k,m)}else this.addToBounds(a-e,b-f),this.addToBounds(a+e,b+f);a=this.addVertexArc(a,b,c,d,e,f,g,.5*h,l,k);this.finalizeQuad(a,VBB_ARC_ELLIPTICAL,m)};
VertexBufferBuilder.prototype.addTexturedQuad=function(a,b,c,d,e,f){var g=.5*d;e=this.addVertexLine(a,b+g,0,c,g,4278255615,e);this.finalizeQuad(e,VBB_TEX_QUAD,f);this.addToBounds(a,b);this.addToBounds(a+c,b+d)};VertexBufferBuilder.prototype.isFull=function(a){a||(a=3);return this.useInstancing?32767<4*this.vcount+a:32767<this.vcount+a};
VertexBufferBuilder.prototype.toMesh=function(){var a={};a.vb=new Float32Array(this.vb.slice(0,this.vcount*this.stride*4));a.vbstride=this.stride;var b=this.useInstancing?1:0;a.vblayout={fields1:{offset:0,itemSize:3,bytesPerItem:4,divisor:b},fields2:{offset:3,itemSize:3,bytesPerItem:4,divisor:b},color4b:{offset:VBB_COLOR_OFFSET,itemSize:4,bytesPerItem:1,divisor:b,normalize:!0},dbId4b:{offset:VBB_DBID_OFFSET,itemSize:4,bytesPerItem:1,divisor:b,normalize:!0},flags4b:{offset:VBB_FLAGS_OFFSET,itemSize:4,
bytesPerItem:1,divisor:b,normalize:!1}};9<this.stride&&(a.vblayout.extraParams={offset:9,itemSize:3,bytesPerItem:4,divisor:b,normalize:!1});if(this.useInstancing){for(var c in a.vblayout)a.vblayout[c].divisor=1;a.numInstances=this.vcount;b=new Int32Array(4);b[0]=VBB_SEG_START_RIGHT;b[1]=VBB_SEG_END_RIGHT;b[2]=VBB_SEG_END_LEFT;b[3]=VBB_SEG_START_LEFT;a.vblayout.instFlags4b={offset:0,itemSize:4,bytesPerItem:1,normalize:!1,divisor:0};a.vblayout.instFlags4b.array=b.buffer;b=a.indices=new Uint16Array(6);
b[0]=0;b[1]=1;b[2]=2;b[3]=0;b[4]=2;b[5]=3}else a.indices=new Uint16Array(this.ib.buffer.slice(0,2*this.icount));a.dbIds=this.dbIds;b=this.maxx-this.minx;c=this.maxy-this.miny;var d=Math.max(b,c);a.boundingBox={min:{x:this.minx,y:this.miny,z:.001*-d},max:{x:this.maxx,y:this.maxy,z:.001*d}};d=a.boundingSphere={};d.center={x:.5*(this.minx+this.maxx),y:.5*(this.miny+this.maxy),z:0};d.radius=.5*Math.sqrt(b*b+c*c);return a};
function PackFileReader(a){31==a[0]&&139==a[1]&&(a=(new Zlib.Gunzip(a)).decompress());this.tempQuat={x:0,y:0,z:0,w:0};this.tempTrans={x:0,y:0,z:0};this.tempScale={x:1,y:1,z:1};this.tempMat=new LmvMatrix4;a=this.stream=new InputStream(a);var b=a.getInt32();this.type=a.getString(b);this.version=a.getInt32();this.types=null;this.entryOffsets=[];a.seek(a.byteLength-8);var c=a.getUint32();this.typesOffset=a.getUint32();a.seek(this.typesOffset);var d=this.readU32V();this.types=[];for(b=0;b<d;++b)this.types.push({entryClass:this.readString(),
entryType:this.readString(),version:this.readU32V()});a.seek(c);c=this.readU32V();d=this.entryOffsets;for(b=0;b<c;++b)d.push(a.getUint32());a.seek(0)}PackFileReader.prototype.readVarint=function(){var a,b=0,c=0;do a=this.stream.getUint8(),b|=(a&127)<<c,c+=7;while(a&128);return b};PackFileReader.prototype.readU32V=PackFileReader.prototype.readVarint;PackFileReader.prototype.readU16=function(){return this.stream.getUint16()};PackFileReader.prototype.readU8=function(){return this.stream.getUint8()};
PackFileReader.prototype.readString=function(){return this.stream.getString(this.readU32V())};PackFileReader.prototype.readVector3f=function(){var a=this.stream;return{x:a.getFloat32(),y:a.getFloat32(),z:a.getFloat32()}};
PackFileReader.prototype.readTransform=function(a,b,c){function d(a){a.x=g.getFloat32();a.y=g.getFloat32();a.z=g.getFloat32();a.w=g.getFloat32()}function e(a){a.x=g.getFloat64();a.y=g.getFloat64();a.z=g.getFloat64()}function f(){m.identity();for(var a=0;3>a;++a)for(var b=0;3>b;++b)m.elements[4*a+b]=g.getFloat32()}var g=this.stream,h=this.tempTrans,l=this.tempQuat,k=this.tempScale,m=this.tempMat;switch(g.getUint8()){case 4:m.identity();break;case 0:e(h);m.makeTranslation(h.x,h.y,h.z);break;case 1:d(l);
e(h);k.x=1;k.y=1;k.z=1;m.compose(h,l,k);break;case 2:var p=g.getFloat32();d(l);e(h);k.x=p;k.y=p;k.z=p;m.compose(h,l,k);break;case 3:f(),e(h),m.setPosition(h)}if(void 0!==a)for(a=m.elements,h=0;16>h;h++)b[c++]=a[h];else return(new LmvMatrix4).copy(m)};PackFileReader.prototype.getEntryCounts=function(){return this.entryOffsets.length};
PackFileReader.prototype.seekToEntry=function(a){var b=this.getEntryCounts();if(a>=b)return null;this.stream.seek(this.entryOffsets[a]);a=this.stream.getUint32();return a>=this.types.length?null:this.types[a]};
PackFileReader.prototype.readPathID=function(){var a=this.stream;if(2>this.version){var b=a.getUint16();if(!b)return null;a.getUint16();if(1==b)return"";for(var c=a.getUint16(),d=2;d<b;++d)c+="/"+a.getUint16()}else{b=this.readU32V();if(!b)return null;this.readU32V();if(1==b)return"";c=this.readU32V();for(d=2;d<b;++d)c+="/"+this.readU32V()}return c};
function readOpenCTM_RAW(a,b){var c=a.getString(4);if("INDX"!=c)return null;for(var d=b.vertexCount,e=b.triangleCount,f=b.indices=new Uint16Array(3*e),c=0,e=3*e;c<e;c++)f[c]=a.getInt32();c=a.getString(4);if("VERT"!=c)return null;for(var f=b.vbstride,e=b.vb,c=0,g=b.vblayout.position.offset;c<d;c++,g+=f)e[g]=a.getFloat32(),e[g+1]=a.getFloat32(),e[g+2]=a.getFloat32();if(b.flags&1){c=a.getString(4);if("NORM"!=c)return null;c=0;for(g=b.vblayout.normal.offset;c<d;c++,g+=f)e[g]=a.getFloat32(),e[g+1]=a.getFloat32(),
e[g+2]=a.getFloat32()}for(var h=0;h<b.texMapCount;h++){c=a.getString(4);if("TEXC"!=c)return null;c={name:a.getString(a.getInt32()),file:a.getString(a.getInt32())};b.uvs.push(c);g="uv";h&&(g+=(h+1).toString());c=0;for(g=b.vblayout[g].offset;c<d;c++,g+=f)e[g]=a.getFloat32(),e[g+1]=a.getFloat32()}for(h=0;h<b.attribMapCount;h++){c=a.getString(4);if("ATTR"!=c)return null;c={name:a.getString(a.getInt32())};if(-1!=c.name.indexOf("Color"))for(c=0,g=b.vblayout.color.offset;c<d;c++,g+=f)e[g]=a.getFloat32(),
e[g+1]=a.getFloat32(),e[g+2]=a.getFloat32(),a.getFloat32();else b.attrs.push(c),a.getBytes(16*d)}}
var readOpenCTM=function(a){if("OCTM"!=a.getString(4)||5!=a.getInt32())return null;var b=a.getString(3);a.getUint8();var c={stream:null,vertices:null,indices:null,normals:null,colors:null,uvs:[],attrs:[]};c.vertexCount=a.getInt32();c.triangleCount=a.getInt32();c.texMapCount=a.getInt32();c.attribMapCount=a.getInt32();c.flags=a.getInt32();c.comment=a.getString(a.getInt32());c.vbstride=3;c.flags&1&&(c.vbstride+=3);c.vbstride+=2*(c.texMapCount||0);0<c.attribMapCount&&(c.vbstride+=3);c.vblayout={};var d=
0;c.vblayout.position={offset:d,itemSize:3};d+=3;c.flags&1&&(c.vblayout.normal={offset:d,itemSize:3},d+=3);if(c.texMapCount)for(var e=0;e<c.texMapCount;e++){var f="uv";e&&(f+=(e+1).toString());c.vblayout[f]={offset:d,itemSize:2};d+=2}c.attribMapCount&&(c.vblayout.color={offset:d,itemSize:3});c.vb=new Float32Array(c.vertexCount*c.vbstride);return"RAW"==b?(readOpenCTM_RAW(a,c),VBUtils.deduceUVRepetition(c),VBUtils.computeBounds3D(c),c):"MG2"==b?(readOpenCTM_MG2(a,c),VBUtils.deduceUVRepetition(c),VBUtils.computeBounds3D(c),
c):null},readLines=function(a,b){var c={isLines:!0,vertices:null,indices:null,colors:null,normals:null,uvs:[],attrs:[]},d,e;1<b.version?(c.vertexCount=a.readU16(),d=a.readU16(),e=a.readU16()):(c.vertexCount=a.readU32V(),d=a.readU32V(),e=a.readU32V());var f=0!=a.stream.getUint8();c.vbstride=3;f&&(c.vbstride+=3);c.vblayout={};var g=0;c.vblayout.position={offset:g,itemSize:3};f&&(c.vblayout.color={offset:g+3,itemSize:3});c.vb=new Float32Array(c.vertexCount*c.vbstride);for(var h=c.vb,l=c.vbstride,k=a.stream,
m=0,g=c.vblayout.position.offset,p=c.vertexCount;m<p;m++,g+=l)h[g]=k.getFloat32(),h[g+1]=k.getFloat32(),h[g+2]=k.getFloat32();if(f)for(m=0,g=c.vblayout.color.offset,f=c.vertexCount;m<f;m++,g+=l)h[g]=k.getFloat32(),h[g+1]=k.getFloat32(),h[g+2]=k.getFloat32(),k.getFloat32();m=function(a){return a.buffer.slice(a.byteOffset,a.byteOffset+a.length)};1<b.version?(d=new Uint16Array(m(k.getBytes(2*d))),k=new Uint16Array(m(k.getBytes(2*e)))):(d=new Int32Array(m(k.getBytes(4*d))),k=new Int32Array(m(k.getBytes(4*
e))));c.indices=new Uint16Array(2*(k[e-1]-e+1));for(m=g=0;m+1<e;m++)for(h=k[m];h+1<k[m+1];h++)c.indices[g++]=d[h],c.indices[g++]=d[h+1];VBUtils.computeBounds3D(c);return c};function readGeometry(a,b,c){return(b=a.seekToEntry(b))?"Autodesk.CloudPlatform.OpenCTM"==b.entryType?readOpenCTM(a.stream):"Autodesk.CloudPlatform.Lines"==b.entryType?readLines(a,b):null:null}
function convertMaterials(a){var b=function(a,b){if(!a||!a.colors)return{r:1,g:0,b:0};var c=a.colors[b];if(!c)return{r:0,g:0,b:0};c=c.values;if(!c||!c.length)return{r:1,g:0,b:0};c=c[0];return{r:c.r,g:c.g,b:c.b}},c=function(a,b){if(!a||!a.scalars)return 0;var c=a.scalars[b];return c?c.values[0]:void 0},d=function(a,b){if(!a||!a.booleans)return 0;var c=a.booleans;return c?c[b]:void 0},e=a.materials.materials;a.simplemats={};for(var f in e){var g=e[f],h=g.materials,l=h[g.userassets[0]];if(l&&"SimplePhong"==
l.definition){var g=l.properties,k={};k.tag=l.tag;k.proteinType=l.proteinType;void 0===k.proteinType&&(k.proteinType=null);k.ambient=b(g,"generic_ambient");k.color=b(g,"generic_diffuse");k.specular=b(g,"generic_specular");k.emissive=b(g,"generic_emissive");var m=c(g,"generic_glossiness");m||(m=30);k.shininess=m;(m=c(g,"generic_transparency"))||(m=0);k.opacity=1-m;(m=c(g,"generic_reflectivity_at_0deg"))||(m=0);k.reflectivity=m;m=d(g,"generic_is_metal");void 0!==m&&(k.metal=m);m=d(g,"generic_backface_cull");
void 0!==m&&(k.doubleSided=!m);k.transparent=l.transparent;var l=l.textures,p;for(p in l){var m=h[l[p].connections[0]].properties,r=m.uris.unifiedbitmap_Bitmap.values[0],n=null;if(r)if("generic_diffuse"==p){if(n="map",!k.color||0==k.color.r&&0==k.color.g&&0==k.color.b)k.color={r:1,g:1,b:1}}else"generic_bump"==p?(n=d(g,"generic_bump_is_normal")?"normalMap":"bumpMap",k.bumpScale=c(g,"generic_bump_amount")):"generic_specular"==p?n="specularMap":"generic_reflection"!=p&&"generic_alpha"==p&&(n="alphaMap",
k.transparent=!0);n&&(k["uri_"+n]=r,(r=c(m,"texture_UScale"))&&(k["uscale_"+n]=r),(r=c(m,"texture_VScale"))&&(k["vscale_"+n]=r))}a.simplemats[f]=k}}}function readLightDefinition(a,b){var c=a.seekToEntry(b);if(!c||1<c.version)return null;c=a.stream;return{position:a.readVector3f(),dir:a.readVector3f(),r:c.getFloat32(),g:c.getFloat32(),b:c.getFloat32(),intensity:c.getFloat32(),spotAngle:c.getFloat32(),size:c.getFloat32(),type:c.getUint8()}}
function readCameraDefinition(a,b){var c=a.seekToEntry(b.definition);if(!c||2<c.version)return null;var d=a.stream,e={isPerspective:!d.getUint8(),position:a.readVector3f(),target:a.readVector3f(),up:a.readVector3f(),aspect:d.getFloat32(),fov:d.getFloat32()*(180/Math.PI)};2>c.version&&(d.getFloat32(),d.getFloat32());e.orthoScale=d.getFloat32();return e}
function FragList(){this.numLoaded=this.length=0;this.mesh2frag=this.fragId2dbId=this.entityIndexes=this.packIds=this.materials=this.transforms=this.boxes=null}
function readGeometryMetadata(a,b){var c=a.getEntryCounts(),d=a.stream;b.length=c;for(var e=b.fragTypes=new Uint8Array(c),f=b.primCounts=new Uint16Array(c),g=b.packIds=new Int32Array(c),h=b.entityIndexes=new Int32Array(c),l=0;l<c&&a.seekToEntry(l);l++)e[l]=d.getUint8(),d.seek(d.offset+24),f[l]=d.getUint16(),g[l]=parseInt(a.readString()),h[l]=a.readU32V()}
function readFragments(a,b){function c(a){a*=6;for(var b=0;6>b;b++)g[a++]=f.getFloat32()}function d(a,b,c){a*=6;for(var d=0;6>d;d++)g[a++]=f.getFloat32()+b[c+d%3]}var e=a.getEntryCounts(),f=a.stream;b.length=e;b.numLoaded=0;for(var g=b.boxes=new Float32Array(6*e),h=b.transforms=new Float32Array(16*e),l=b.materials=new Int32Array(e),k=b.packIds=new Int32Array(e),m=b.entityIndexes=new Int32Array(e),p=b.geomDataIndexes=new Int32Array(e),e=b.fragId2dbId=new Int32Array(e),r=0,n=b.length;r<n;r++){var u=
a.seekToEntry(r);if(!u)break;if(5<u.version)break;4<u.version&&a.readU8();l[r]=a.readU32V();2<u.version?p[r]=a.readU32V():(k[r]=parseInt(a.readString()),m[r]=a.readU32V());a.readTransform(r,h,16*r);3<u.version?d(r,h,16*r+12):c(r);1<u.version&&(e[r]=a.readU32V())}}
function filterFragments(a,b){a.length=b.length;a.numLoaded=0;for(var c=a.length,d=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity],e=new Float32Array(6*c),f=new Float32Array(16*c),g=new Int32Array(c),h=new Int32Array(c),c=new Int32Array(c),l={},k=0;k<b.length;++k){for(var m=b[k],p=6*m,r=6*k,n=0;6>n;++n)e[r++]=a.boxes[p++];p=16*m;r=16*k;for(n=0;16>n;++n)f[r++]=a.transforms[p++];g[k]=a.materials[m];h[k]=a.packIds[m];c[k]=a.entityIndexes[m];n=a.packIds[m]+":"+a.entityIndexes[m];m=l[n];void 0==
m?l[n]=k:Array.isArray(m)?m.push(k):l[n]=[m,k];m=6*k;for(n=0;3>n;++n)e[m+n]<d[n]&&(d[n]=e[m+n]);for(n=3;6>n;++n)e[m+n]>d[n]&&(d[n]=e[m+n])}a.boxes=e;a.transforms=f;a.materials=g;a.packIds=h;a.entityIndexes=c;a.mesh2frag=l;return d}function readInstance(a,b){var c=a.seekToEntry(b);if(!c||2<c.version)return null;1<c.version&&a.readU8();return{definition:a.stream.getUint32(),transform:a.readTransform(),instanceNodePath:a.readPathID()}}
function Package(a){this.unzip=new Zlib.Unzip(a);this.fragments=this.metadata=this.simplemats=this.materials=this.manifest=null;this.geompacks=[];this.instances=[];this.cameras=[];this.lights=[];this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[]};this.animations=this.bbox=null;this.pendingRequests=0}
Package.prototype.loadAsyncResource=function(a,b,c,d){function e(b){f.pendingRequests--;this.response&&(b=new Uint8Array(this.response),31==b[0]&&139==b[1]&&(b=(new Zlib.Gunzip(b)).decompress()),d(b));0==f.pendingRequests&&f.postLoad(a)}if(c)d(c);else{var f=this;this.pendingRequests++;(new Xhr(a.errorHandler,a.auth,a.viewing_url)).get(a.basePath+b,a.headers,"arraybuffer",e,"",a.queryParams)}};
Package.prototype.loadManifest=function(a){a=this.unzip.decompress("manifest.json");if(!a)return!1;var b=new InputStream(a);this.manifest=JSON.parse(b.getString(a.byteLength))};
Package.prototype.loadRemainingSvf=function(a){var b=this,c=this.unzip,d=this.manifest=a.manifest,e=c.decompress("metadata.json"),f=new InputStream(e);3<e.byteLength&&0!==e[3]&&(this.metadata=JSON.parse(f.getString(e.byteLength)).metadata)&&(e=this.metadata["world bounding box"],this.bbox={min:{x:e.minXYZ[0],y:e.minXYZ[1],z:e.minXYZ[2]},max:{x:e.maxXYZ[0],y:e.maxXYZ[1],z:e.maxXYZ[2]}},this.metadata.hasOwnProperty("double sided geometry")&&this.metadata["double sided geometry"].value&&(this.doubleSided=
!0));this.primitiveCount=this.packFileTotalSize=0;for(var g=d.typesets,e={},f=0;f<g.length;f++){var h=g[f];e[h.id]=h.types}d=d.assets;for(f=0;f<d.length;f++){h=d[f];g=h.type;0==g.indexOf("Autodesk.CloudPlatform.")&&(g=g.substr(23));var l=h.URI,k=h.typeset?e[h.typeset]:null;0!=l.indexOf("embed:/")&&("PackFile"==g?"Autodesk.CloudPlatform.Geometry"==(k?k[0]["class"]:null)&&(this.packFileTotalSize+=h.usize||0,this.geompacks.push({id:h.id,uri:l})):"PropertyAttributes"==g?this.propertydb.attrs.push(l):
"PropertyAVs"==g?this.propertydb.avs.push(l):"PropertyIDs"==g?this.propertydb.ids.push(l):"PropertyOffsets"==g?this.propertydb.offsets.push(l):"PropertyValues"==g&&this.propertydb.values.push(l));var h=h.URI,m;0==h.indexOf("embed:/")&&(h=h.substr(7),m=c.decompress(h));"ProteinMaterials"==g?-1==h.indexOf("Protein")?this.loadAsyncResource(a,h,m,function(a){var c=new InputStream(a);a=a.byteLength;0<a?(b.materials=JSON.parse(c.getString(a)),convertMaterials(b)):b.materials=null}):this.loadAsyncResource(a,
h,m,function(a){var c=new InputStream(a);a=a.byteLength;b.proteinMaterials=0<a?JSON.parse(c.getString(a)):null}):"FragmentList"==g?this.loadAsyncResource(a,h,m,function(a){a=new PackFileReader(a);var c=b.fragments=new FragList;readFragments(a,c)}):"GeometryMetadataList"==g?this.loadAsyncResource(a,h,m,function(a){a=new PackFileReader(a);b.geomMetadata={};readGeometryMetadata(a,b.geomMetadata)}):"PackFile"==g?-1!=h.indexOf("CameraDefinitions.bin")?this.loadAsyncResource(a,h,m,function(a){b.camDefPack=
new PackFileReader(a)}):-1!=h.indexOf("CameraList.bin")?this.loadAsyncResource(a,h,m,function(a){b.camInstPack=new PackFileReader(a)}):-1!=h.indexOf("LightDefinitions.bin")?this.loadAsyncResource(a,h,m,function(a){b.lightDefPack=new PackFileReader(a)}):-1!=h.indexOf("LightList.bin")&&this.loadAsyncResource(a,h,m,function(a){b.lightInstPack=new PackFileReader(a)}):"Animations"==g&&this.loadAsyncResource(a,h,m,function(a){var c=new InputStream(a);a=a.byteLength;b.animations=0<a?JSON.parse(c.getString(a)):
null})}0==this.pendingRequests&&this.postLoad(a);delete this.unzip};
Package.prototype.postLoad=function(a){if(this.camDefPack&&this.camInstPack){for(var b=0,c=this.camInstPack.getEntryCounts();b<c;b++){var d=readInstance(this.camInstPack,b),e=readCameraDefinition(this.camDefPack,d);d.transform&&(d.transform.transformPoint(e.position),d.transform.transformPoint(e.target),d.transform.transformDirection(e.up));this.cameras.push(e)}delete this.camDefPack;delete this.camInstPack}if(this.lightDefPack&&this.lightInstPack){b=0;for(c=this.lightInstPack.getEntryCounts();b<
c;b++)d=readInstance(this.lightInstPack,b),this.lights.push(readLightDefinition(this.lightDefPack,d.definition));delete this.lightInstPack;delete this.lightDefPack}d=this.fragments;if(this.geomMetadata){d.polygonCounts=d.geomDataIndexes;c=this.geomMetadata;b=0;for(e=d.length;b<e;b++){var f=d.geomDataIndexes[b];d.entityIndexes[b]=c.entityIndexes[f];d.packIds[b]=c.packIds[f];d.polygonCounts[b]=c.primCounts[f];this.primitiveCount+=c.primCounts[f]}this.geomMetadata=d.geomDataIndexes=null}for(var f=d.mesh2frag=
{},c=d.packIds,g=d.entityIndexes,b=0,e=d.length;b<e;b++){var h=c[b]+":"+g[b],l=f[h];void 0===l?f[h]=b:Array.isArray(l)?l.push(b):f[h]=[l,b]}if(!this.bbox){c=[Infinity,Infinity,Infinity,-Infinity,-Infinity,-Infinity];e=d.boxes;f=0;for(d=d.length;f<d;f++){g=6*f;for(b=0;3>b;b++)e[g+b]<c[b]&&(c[b]=e[g+b]);for(b=3;6>b;b++)e[g+b]>c[b]&&(c[b]=e[g+b])}this.bbox={min:{x:c[0],y:c[1],z:c[2]},max:{x:c[3],y:c[4],z:c[5]}}}f=a.objectIds;if(null!=f){c=[];d=[];for(b=0;b<f.length;++b)for(e=0;e<this.fragments.length;++e)this.fragments.fragId2dbId[e]==
f[b]&&(c.push(this.fragments.packIds[e]),d.push(e));e=1;f=c.length;for(b=1;b<f;){for(;b<f&&c[b]==c[b-1];)++b;if(f==b)break;c[e++]=c[b++]}c.splice(e-1,f-e);f=[];for(b=0;b<this.geompacks.length;++b)for(e=0;e<c.length;++e)parseInt(this.geompacks[b].id)==c[e]&&f.push(this.geompacks[b]);this.geompacks=f;b=filterFragments(this.fragments,d);this.bbox={min:{x:b[0],y:b[1],z:b[2]},max:{x:b[3],y:b[4],z:b[5]}}}a.loadDoneCB("svf");this.fragments.polygonCounts?(b=performance.now(),this.bvh=new BVHBuilder(this.fragments,
this.simplemats),this.bvh.build(a.bvhOptions),c=performance.now(),debug("BVH build time (worker thread):"+(c-b)),a.loadDoneCB("bvh")):a.loadDoneCB("done")};
function PropertyDatabase(a){function b(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);a=decodeURIComponent(escape(b));return JSON.parse(a)}function c(a,b){for(var c=b,d="";c<a.length-1;){var e=a[c];if(44==e&&(10==a[c+1]||13==a[c+1]))break;if(10==e||13==e)break;d+=String.fromCharCode(e);c++}c=decodeURIComponent(escape(d));return JSON.parse(c)}function d(a,b){for(var c=0,d=0,e=a.length;d<e;d++)44==a[d]&&c++;c++;for(var e=new Uint32Array(c+(b?1:0)),d=0,f=a.length;91!=a[d]&&d<f;)d++;
if(d==a.length)return null;d++;for(var g=!1,h=c=0;d<f;){var k=a[d];48<=k&&57>=k?(h=10*h+(k-48),g=!0):44==k||93==k?g&&(e[c++]=h,g=!1,h=0):(g=!1,h=0);d++}return e}function e(a){for(var b=0,c=a.length-1,d=0;d<c;d++)44!=a[d]||10!=a[d+1]&&13!=a[d+1]||b++;if(!b)return null;b++;for(var e=new Uint32Array(b),b=d=0;91!=a[d]&&d<c;)d++;d++;e[b++]=d;for(var f=!1;d<c;)10==a[d]||13==a[d]?f=!0:f&&(f=!1,e[b++]=d),d++;return e}var f,g,h,l,k,m,p,r,n,u,t,q,x,A;for(A in a.attrs){f=b(a.attrs[A]);for(var F=0;F<f.length;F++)switch(f[F][1]){case "__parent__":n=
F;break;case "__child__":r=F;break;case "__name__":u=F;break;case "__instanceof__":t=F;break;case "__viewable_in__":q=F;break;case "__externalref__":x=F}break}for(A in a.avs){h=d(a.avs[A],0);delete a.avs;break}for(A in a.offsets){g=d(a.offsets[A],1);g[g.length-1]=h.length/2;delete a.offsets;break}for(A in a.values){l=a.values[A];k=e(l);break}for(A in a.ids){m=a.ids[A];p=e(m);break}this.getObjectCount=function(){return g.length-1};this.getValueAt=function(a){return c(l,k[a])};this.getIntValueAt=function(a){var b=
0;a=k[a];for(34==l[a]&&a++;a<l.length-1;){var c=l[a];if(44==c&&(10==l[a+1]||13==l[a+1]))break;if(10==c||13==c||34==c)break;48<=c&&57>=c&&(b+=10*b+(c-48));a++}return b};this.getIdAt=function(a){return c(m,p[a])};this.getObjectProperties=function(a){var b={dbId:a,name:"",externalId:this.getIdAt(a),properties:[]},c=null,d=2*g[a+1];for(a=2*g[a];a<d;a+=2){var e=h[a];if(e==u)e=this.getValueAt(h[a+1]),b.name=e;else if(e==t)(e=this.getObjectProperties(this.getValueAt(h[a+1])))&&e.properties&&(c=e);else if(e!=
n&&e!=r&&e!=q&&e!=x){var e=f[e],k=e[6]?e[6]:0;b.properties.push({displayName:e[5]?e[5]:e[0],displayValue:this.getValueAt(h[a+1]),displayCategory:e[1],type:e[2],units:e[3],hidden:k&1})}}if(c){d={};e=b.properties;for(a=0;a<e.length;a++)d[e[a].displayName]=1;b.name||(b.name=c.name);c=c.properties;for(a=0;a<c.length;a++)d.hasOwnProperty(c[a].displayName)||e.push(c[a])}return b};this.findRootNodes=function(){for(var a=[],b=1,c=g.length;b<c;b++){for(var d=!1,e=!1,f=!1,k=2*g[b+1],q=2*g[b];q<k;q+=2){var l=
h[q];l==n?this.getIntValueAt(h[q+1])&&(e=!0):l==r?d=!0:l==u&&(f=!0)}d&&f&&!e&&a.push(b)}return a};this.getNodeNameAndChildren=function(a,b){for(var c=a.dbId,d=2*g[c+1],e,c=2*g[c];c<d;c+=2){var f=h[c];f!=n&&(f!=r||b?f==u?(f=this.getValueAt(h[c+1]),a.name=f):f==t&&(f={dbId:this.getValueAt(h[c+1]),name:null},this.getNodeNameAndChildren(f,!0),f&&f.name&&!a.name&&(a.name=f.name)):(f=this.getValueAt(h[c+1]),f={dbId:f,parent:a},e?e.push(f):e=[f]))}return e};this.buildObjectTree=function(a,b,c,d){c>d[0]&&
(d[0]=c);var e=this.getNodeNameAndChildren(a);if(e){for(var f=0;f<e.length;f++)this.buildObjectTree(e[f],b,c+1,d);for(f=0;f<e.length;f++)if(e[f].children||void 0!==e[f].fragIds)a.children?a.children.push(e[f]):a.children=[e[f]]}b=b[a.dbId];void 0!==b&&(a.fragIds=b)};this.bruteForceSearch=function(a){a=a.toLowerCase();for(var b=[],c=[],d=0,e=k.length;d<e;d++){var f=this.getValueAt(d);"string"==typeof f?-1!=f.toLowerCase().indexOf(a)&&c.push(d):-1!=f.toString().toLowerCase().indexOf(a)&&c.push(d)}a=
1;for(e=g.length;a<e;a++)for(f=2*g[a+1],d=2*g[a];d<f;d+=2)if(-1!=c.indexOf(h[d+1])){b.push(a);break}return b}}
function F2D(a,b,c,d){function e(a){a=a.children;if(void 0!==a){for(var b=0;b<a.length;++b)e(a[b]);a.sort(function(a,b){var c=a.isLayer,d=b.isLayer;return c&&!d?-1:!c&&d?1:a.name.localeCompare(b.name,void 0,{sensitivity:"base",numeric:!0})})}}function f(a){var b=0;if(a.isLayer)b=1;else{for(var c=a.children,d=0;d<c.length;++d)b+=f(c[d]);a.childCount=b}return b}this.metadata=a;this.scaleY=this.scaleX=1;this.bbox={min:{x:0,y:0,z:0},max:{x:0,y:0,z:0}};this.is2d=!0;this.layersMap={};this.layersRoot={name:"root",
id:"root",children:[],isLayer:!1,childCount:0};this.fontDefs={};this.fontId=this.fontCount=0;this.manifestAvailable=!1;this.objectMemberQueue=[];this.propertydb={attrs:[],avs:[],ids:[],values:[],offsets:[],rcv_offsets:[],rcvs:[],viewables:[]};if(a){var g=function(a,b,c){var d=l,e=a.length;if(1<e)for(var f=0;f<e-1;++f){var g=a[f],h;a:{h=d.children;for(var n=0;n<h.length;++n){var p=h[n];if(p.name===g){h=p;break a}}h=null}h||(h={name:g,id:"group-"+k++,children:[],isLayer:!1,childCount:0},d.children.push(h));
d=h}d.children.push({name:b,index:c,id:m++,isLayer:!0})},h=a.page_dimensions;this.paperWidth=h.page_width;this.paperHeight=h.page_height;this.scaleX=this.paperWidth/h.plot_width;this.scaleY=this.paperHeight/h.plot_height;this.hidePaper=h.hide_paper;this.bbox.max.x=this.paperWidth;this.bbox.max.y=this.paperHeight;var l=this.layersRoot,k=0,m=0,h=0;this.layersMap[0]=h++;for(var p in a.layers){var r=parseInt(p),n=a.layers[p];(n="string"===typeof n?n:n.name)||(n=p);g(n.split("|"),n,r);this.layersMap[r]=
h++}this.layerCount=h}this.hidePaper=this.hidePaper||d&&d.modelSpace;e(this.layersRoot);f(this.layersRoot);this.opCount=0;this.fontFaces=[];this.fontFamilies=[];this.clip=null;this.maxObjectNumber=this.imageNumber=this.objectNumber=0;this.objectStack=[];this.objectNameStack=[];this.parseObjState={polyTriangle:{},clip:{},raster:{},text:{},fontDef:{},uknown:{}};this.layer=0;this.bgColor=d.bgColor?d.bgColor:4294967295;this.contrastColor=this.color=this.fillColor=4278190080;this.currentVbb=new VertexBufferBuilder(!1);
this.meshes=[];this.numPolytriangles=this.numTriangles=this.numCircles=this.numEllipses=this.numPolylines=this.numLineSegs=0;this.error=!1;this.offsetY=this.offsetX=0;if(b){this.manifestAvailable=!0;this.imageId2URI={};a=b.assets;b=0;for(d=a.length;b<d;++b)g=a[b],-1!=g.mime.indexOf("image/")&&(p=g.id,p=p.substr(0,p.indexOf(".")),this.imageId2URI[p]=c+g.URI),"Autodesk.CloudPlatform.PropertyAttributes"==g.type&&this.propertydb.attrs.push(g.URI),"Autodesk.CloudPlatform.PropertyValues"==g.type&&this.propertydb.values.push(g.URI),
"Autodesk.CloudPlatform.PropertyIDs"==g.type&&this.propertydb.ids.push(g.URI),"Autodesk.CloudPlatform.PropertyViewables"==g.type&&this.propertydb.viewables.push(g.URI),"Autodesk.CloudPlatform.PropertyOffsets"==g.type&&(-1!=g.id.indexOf("rcv")?this.propertydb.rcv_offsets.push(g.URI):this.propertydb.offsets.push(g.URI)),"Autodesk.CloudPlatform.PropertyAVs"==g.type&&this.propertydb.avs.push(g.URI),"Autodesk.CloudPlatform.PropertyRCVs"==g.type&&this.propertydb.rcvs.push(g.URI);debug(JSON.stringify(this.propertydb))}}
F2D.prototype.load=function(a,b){31==b[0]&&139==b[1]&&(b=(new Zlib.Gunzip(b)).decompress());this.data=b;this.parse();a.loadDoneCB(!0)};F2D.prototype.loadFrames=function(a){a.data?this.data=new Uint8Array(a.data):a.finalFrame&&(this.data=null);this.parseFrames(a.finalFrame);a.loadDoneCB(!0)};
var F2dDataType={dt_object:0,dt_void:1,dt_byte:2,dt_int:3,dt_float:4,dt_double:5,dt_varint:6,dt_point_varint:7,dt_byte_array:32,dt_int_array:33,dt_float_array:34,dt_double_drray:35,dt_varint_array:36,dt_point_varint_array:37,dt_arc:38,dt_circle:39,dt_circular_arc:40,dt_string:63,dt_last_data_type:127},F2dSemanticType={st_object_member:0,st_fill:1,st_fill_off:2,st_clip_off:3,st_layer:4,st_link:5,st_line_weight:6,st_miter_angle:7,st_miter_length:8,st_line_pattern_ref:9,st_back_color:10,st_color:11,
st_markup:12,st_object_id:13,st_markup_id:14,st_reset_rel_offset:15,st_font_ref:16,st_begin_object:32,st_clip:33,st_line_caps:34,st_line_join:35,st_line_pattern_def:36,st_font_def:37,st_sheet:42,st_arc:43,st_polyline:44,st_raster:45,st_text:46,st_polytriangle:47,st_dot:48,st_end_object:63,st_last_semantic_type:127};
F2D.prototype.flushBuffer=function(a,b){if(this.currentVbb.vcount){var c;if(c=b||this.currentVbb.isFull(a))c=this.currentVbb.toMesh(),VBUtils.bboxUnion(this.bbox,c.boundingBox),this.meshes.push(c),c.material={skipEllipticals:!this.currentVbb.numEllipses,skipCircles:!this.currentVbb.numCirculars,skipTriangleGeoms:!this.currentVbb.numTriangleGeoms,useInstancing:this.currentVbb.useInstancing},this.currentImage&&(c.material.image=this.currentImage,c.material.image.name=this.imageNumber++,this.currentImage=
null),this.currentVbb=new VertexBufferBuilder}};F2D.prototype.tx=function(a){return this.sx(a)};F2D.prototype.ty=function(a){return this.sy(a)};F2D.prototype.sx=function(a){return a*this.scaleX};F2D.prototype.sy=function(a){return a*this.scaleY};F2D.prototype.invertColor=function(a){var b,c,d;b=255-(a>>16&255);c=255-(a>>8&255);d=255-(a&255);return(a>>24&255)<<24|b<<16|c<<8|d};F2D.prototype.mapColor=function(a){return a};F2D.prototype.restoreSignBitFromLSB=function(a){return a&1?-(a>>>1):a>>>1};
F2D.prototype.parsePointPositions=function(){var a=this.stream.getVarints(),b=this.stream.getVarints(),a=this.restoreSignBitFromLSB(a),b=this.restoreSignBitFromLSB(b),a=a+this.offsetX,b=b+this.offsetY;this.offsetX=a;this.offsetY=b;return[this.tx(a),this.ty(b)]};F2D.prototype.parserAssert=function(a,b,c){return a!=b?(debug("Expect "+b+"; actual type is "+a+"; in function "+c),this.error=!0):!1};F2D.prototype.unhandledTypeWarning=function(a,b){debug("Unhandled semantic type : "+b+" in function "+a)};
F2D.prototype.parseObject=function(){var a=this.stream.getVarints();this.objectStack.push(a);switch(a){case F2dSemanticType.st_sheet:this.objectNameStack.push("sheet");this.objectMemberQueue.unshift("paperColor");break;case F2dSemanticType.st_clip:this.objectNameStack.push("clip");this.objectMemberQueue.unshift("contourCounts","points");break;case F2dSemanticType.st_polytriangle:this.objectNameStack.push("polyTriangle");this.objectMemberQueue.unshift("points","indices","colors");break;case F2dSemanticType.st_raster:this.objectNameStack.push("raster");
this.objectMemberQueue.unshift("position","width","height","imageId");break;case F2dSemanticType.st_text:this.objectNameStack.push("text");this.objectMemberQueue.unshift("string","position","height","widthScale","rotation","oblique","charWidths");break;case F2dSemanticType.st_font_def:this.objectNameStack.push("fontDef");this.objectMemberQueue.unshift("name","fullName","flags","spacing","panose");break;case F2dSemanticType.st_end_object:this.objectStack.pop();if(this.objectStack.length){switch(this.objectStack.pop()){case F2dSemanticType.st_polytriangle:this.actOnPolyTriangle();
break;case F2dSemanticType.st_clip:this.actOnClip();break;case F2dSemanticType.st_raster:this.actOnRaster();break;case F2dSemanticType.st_text:this.actOnText();break;case F2dSemanticType.st_font_def:this.actOnFontDef()}var a=this.objectNameStack.pop(),a=this.parseObjState[a],b;for(b in a)a[b]=null}else this.parserAssert(0,1,"parseEndObject (Stack Empty)");this.objectMemberQueue.length=0;break;default:this.objectNameStack.push("unknown"),this.error=!0,this.unhandledTypeWarning("parseObject",a)}};
F2D.prototype.initSheet=function(a){this.bgColor=a;if(!this.hidePaper&&this.metadata){var b=this.paperWidth,c=this.paperHeight,d=this.currentVbb,e=.0075*b;this.addPolyTriangle([0,0,b,0,b,c,0,c,e,-e,b+e,-e,b+e,0,e,0,b,0,b+e,0,b+e,c-e,b,c-e],[a,a,a,a,4283782485,4283782485,4283782485,4283782485,4283782485,4283782485,4283782485,4283782485],[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11],4294967295,0,4294967295,!1);d.addSegment(0,0,b,0,1E-6,4278190080,4294967295,0);d.addSegment(b,0,b,c,1E-6,4278190080,4294967295,
0);d.addSegment(b,c,0,c,1E-6,4278190080,4294967295,0);d.addSegment(0,c,0,0,1E-6,4278190080,4294967295,0)}};F2D.prototype.setObjectMember=function(a){if(!this.objectMemberQueue.length)return debug("Unexpected object member. "+a),!1;var b=this.objectMemberQueue.shift(),c=this.objectNameStack[this.objectNameStack.length-1];return"sheet"==c&&"paperColor"==b?(this.initSheet(a),!0):c?(this.parseObjState[c][b]=a,!0):!1};
F2D.prototype.parseString=function(){var a=this.stream,b=a.getVarints(),c=a.getVarints(),a=a.getString(c);switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(a))return;break;default:debug("Unexpected opcode semantic type for string.")}return a};F2D.prototype.actOnFontDef=function(){var a=this.parseObjState.fontDef;this.fontDefs[++this.fontCount]=a;this.fontId=this.fontCount};
F2D.prototype.parsePoint=function(){var a=this.stream.getVarints(),b=this.parsePointPositions();switch(a){case F2dSemanticType.st_object_member:if(this.setObjectMember(b))return;break;default:debug("Unexpected opcode semantic type for point.")}return b};
F2D.prototype.parsePointsArray=function(){var a=this.stream,b=a.getVarints();if(a=a.getVarints()){for(var a=a/2,c=[],d,e=0;e<a;++e)d=this.parsePointPositions(),c.push(d[0]),c.push(d[1]);switch(b){case F2dSemanticType.st_polyline:this.actOnPolylinePointsArray(c);return;case F2dSemanticType.st_dot:this.actOnDot(c);return;case F2dSemanticType.st_object_member:if(this.setObjectMember(c))return;break;default:debug("Unexpected opcode semantic type for points array.")}return c}};
F2D.prototype.parseIntArray=function(){for(var a=this.stream,b=a.getVarints(),c=a.getVarints(),d=[],e=0;e<c;++e)d.push(a.getUint32());switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(d))return;break;default:this.unhandledTypeWarning("parseIntArray",b)}return d};
F2D.prototype.parseByteArray=function(){for(var a=this.stream,b=a.getVarints(),c=a.getVarints(),d=[],e=0;e<c;++e)d.push(a.getUint8());switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(d))return;break;default:this.unhandledTypeWarning("parseByteArray",b)}return d};
F2D.prototype.parseVarintArray=function(){for(var a=this.stream,b=a.getVarints(),c=[],d=a.getVarints(),e=0;e<d;++e)c.push(a.getVarints());switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(c))return;break;default:this.unhandledTypeWarning("parseVarIntArray",b)}return c};
F2D.prototype.parseInt=function(){var a=this.stream,b=a.getVarints(),a=a.getUint32();switch(b){case F2dSemanticType.st_color:this.color=a;break;case F2dSemanticType.st_fill:this.fill=!0;this.fillColor=a;break;case F2dSemanticType.st_object_member:if(this.setObjectMember(a))return;default:this.unhandledTypeWarning("parseInt",b)}return a};
F2D.prototype.parseVoid=function(){var a=this.stream.getVarints();switch(a){case F2dSemanticType.st_fill_off:this.fill=!1;break;default:this.unhandledTypeWarning("parseVoid",a)}};
F2D.prototype.parseVarint=function(){var a=this.stream,b=a.getVarints(),a=a.getVarints();switch(b){case F2dSemanticType.st_line_weight:this.lineWeight=this.tx(a);break;case F2dSemanticType.st_object_id:case F2dSemanticType.st_markup_id:this.objectNumber=a;this.maxObjectNumber=Math.max(this.maxObjectNumber,a);break;case F2dSemanticType.st_layer:this.layer=this.layersMap[a];break;case F2dSemanticType.st_font_ref:this.fontId=a;break;case F2dSemanticType.st_object_member:if(this.setObjectMember(a))return}return a};
F2D.prototype.parseFloat=function(){var a=this.stream,b=a.getVarints(),a=a.getFloat32();switch(b){case F2dSemanticType.st_object_member:if(this.setObjectMember(a))return}return a};F2D.prototype.parseCircularArc=function(){var a=this.stream,b=a.getVarints();if(!this.parserAssert(b,F2dSemanticType.st_arc,"parseCircularArc")){var b=this.parsePointPositions(),c=a.getVarints(),d=a.getFloat32(),a=a.getFloat32();this.actOnCircularArc(b[0],b[1],d,a,this.sx(c))}};
F2D.prototype.parseCircle=function(){var a=this.stream,b=a.getVarints();this.parserAssert(b,F2dSemanticType.st_arc,"parseCircle")||(b=this.parsePointPositions(),a=a.getVarints(),this.actOnCompleteCircle(b[0],b[1],this.sx(a)))};
F2D.prototype.parseArc=function(){var a=this.stream,b=a.getVarints();if(!this.parserAssert(b,F2dSemanticType.st_arc,"parseArc")){var b=this.parsePointPositions(),c=a.getVarints(),d=a.getVarints(),e=a.getFloat32(),f=a.getFloat32(),a=a.getFloat32();this.actOnArc(b[0],b[1],f,a,this.sx(c),this.sy(d),e)}};
F2D.prototype.parseDataType=function(){var a=this.stream.getVarints();switch(a){case F2dDataType.dt_void:this.parseVoid();break;case F2dDataType.dt_int:this.parseInt();break;case F2dDataType.dt_object:this.parseObject();break;case F2dDataType.dt_varint:this.parseVarint();break;case F2dDataType.dt_point_varint:this.parsePoint();break;case F2dDataType.dt_float:this.parseFloat();break;case F2dDataType.dt_point_varint_array:this.parsePointsArray();break;case F2dDataType.dt_circular_arc:this.parseCircularArc();
break;case F2dDataType.dt_circle:this.parseCircle();break;case F2dDataType.dt_arc:this.parseArc();break;case F2dDataType.dt_int_array:this.parseIntArray();break;case F2dDataType.dt_varint_array:this.parseVarintArray();break;case F2dDataType.dt_byte_array:this.parseByteArray();break;case F2dDataType.dt_string:this.parseString();break;default:this.error=!0,debug("Data type not supported yet: "+a)}};
F2D.prototype.parse=function(){var a=this.stream=new InputStream(this.data),b=a.getString(3);if("F2D"!=b)debug("Invalid F2D header : "+b);else if(b=a.getString(2),"01"!=b)debug("Only support f2d major version 1; actual version is : "+b);else if("."!=a.getString(1))debug("Invalid version delimiter.");else{for(a.getString(2);a.offset<a.byteLength;){this.parseDataType();if(this.error)break;this.opCount++}this.flushBuffer(0,!0);this.data=this.stream=this.currentVbb=null;debug("F2d parse: data types count : "+
this.opCount)}};F2D.prototype.parseFrames=function(a){if(this.data)for(var b=this.stream=new InputStream(this.data);b.offset<b.byteLength;){this.parseDataType();if(this.error)break;this.opCount++}else a||debug("Unexpected F2D parse state: If there is no data, we only expect a flush command, but flush was false.");a&&this.flushBuffer(0,!0);this.data=this.stream=null};
F2D.prototype.actOnPolylinePointsArray=function(a){this.flushBuffer();this.numPolylines++;for(var b=a.length/2,c=a[0],d=a[1],e=1;e<b;++e){var f=a[2*e],g=a[2*e+1];this.currentVbb.addSegment(c,d,f,g,this.lineWeight,this.color,this.objectNumber,this.layer);c=f;d=g}this.numLineSegs+=b-1};F2D.prototype.actOnDot=function(a){this.actOnCompleteCircle(a[0],a[1],this.sx(1))};
F2D.prototype.actOnCompleteCircle=function(a,b,c){this.flushBuffer();this.numCircles++;this.fill?this.currentVbb.addSegment(a,b,a,b,2*c,this.color,this.objectNumber,this.layer,!0,!1,!0):this.currentVbb.addCircularArc(a,b,0,2*Math.PI,c,this.lineWeight,this.color,this.objectNumber,this.layer)};F2D.prototype.actOnCircularArc=function(a,b,c,d,e){this.numCircles++;this.flushBuffer();this.currentVbb.addCircularArc(a,b,c,d,e,this.lineWeight,this.color,this.objectNumber,this.layer)};
F2D.prototype.actOnArc=function(a,b,c,d,e,f,g){this.numEllipses++;this.flushBuffer();this.currentVbb.addEllipticalArc(a,b,c,d,e,f,g,this.lineWeight,this.color,this.objectNumber,this.layer)};
F2D.prototype.actOnRaster=function(){if(this.manifestAvailable){this.flushBuffer(4,!0);var a=this.parseObjState.raster,b=a.position,c=a.height,d=a.imageId,e=b[0],b=b[1],a=this.sx(a.width),c=this.sy(c),d={dataURI:this.imageId2URI[d],width:a,height:c};this.currentVbb.addTexturedQuad(e,b-c,a,c,this.objectNumber,this.layer);this.currentImage=d;this.flushBuffer(0,!0)}};F2D.prototype.actOnClip=function(){};F2D.prototype.actOnText=function(){};
F2D.prototype.addPolyTriangle=function(a,b,c,d,e,f,g){function h(a,b){if(a>b){var c=a;a=b;b=c}if(p[a]){var c=p[a],d=c.lastIndexOf(b);-1==d?c.push(b):c[d]=-1}else p[a]=[b]}function l(){for(var c=0,g=p.length;c<g;c++){var h=p[c];if(h)for(var k=0;k<h.length;k++){var q=h[k];-1!=q&&(m.flushBuffer(4),m.currentVbb.addSegment(a[2*c],a[2*c+1],a[2*q],a[2*q+1],r,b?b[c]:d,f,e),b&&b[c]!=b[q]&&debug("Gouraud triangle encountered. Will have incorrect antialiasing."))}}}function k(c,g){if(c>g){var h=c;c=g;g=h}(h=
p[c])&&-1!=h.indexOf(g)&&(m.flushBuffer(4),m.currentVbb.addSegment(a[2*c],a[2*c+1],a[2*g],a[2*g+1],r,b?b[c]:d,f,e),b&&b[c]!=b[g]&&debug("Gouraud triangle encountered. Will have incorrect antialiasing."))}var m=this,p=null,r=-1;this.objectStack[this.objectStack.length-1]==F2dSemanticType.st_text&&(r=-.5);if(g)for(var p=Array(a.length/2),n=0,u=c.length;n<u;n+=3){var t=c[n],q=c[n+1],x=c[n+2];h(t,q);h(q,x);h(x,t)}if(this.currentVbb.useInstancing)for(u=c.length,n=0;n<u;n+=3)t=c[n],q=c[n+1],x=c[n+2],this.flushBuffer(4),
this.currentVbb.addTriangleGeom(a[2*t],a[2*t+1],a[2*q],a[2*q+1],a[2*x],a[2*x+1],b?b[t]:d,f,e),g&&(k(t,q),k(q,x),k(x,t));else{u=a.length/2;this.flushBuffer(u);t=this.currentVbb;q=t.vcount;for(n=0;n<u;++n)t.addVertexPolytriangle(a[2*n],a[2*n+1],0,0,0,b?b[n]:d,f,e);u=c.length;for(n=0;n<u;n+=3)t.addTriangle(q+c[n],q+c[n+1],q+c[n+2]);g&&l()}};
F2D.prototype.actOnPolyTriangle=function(){var a=this.parseObjState.polyTriangle;this.parseObjState.polyTriangle={};var b=a.points,c=a.indices,a=a.colors;b&&c?(this.numPolytriangles++,this.numTriangles+=c.length/3,this.addPolyTriangle(b,a,c,this.color,this.layer,this.objectNumber,!0)):debug("Malformed polytriangle.")};function F2DProbe(){this.data=null;this.frameEnd=this.frameStart=0;this.stream=null;this.opCount=0;this.marker={frameStart:this.frameStart,frameEnd:this.frameEnd}}
F2DProbe.prototype.load=function(a){this.data=a;this.frameStart=0;this.stream?(this.stream.reset(this.data),this.stream.seek(0),this.frameEnd=0):(this.stream=new CheckedInputStream(this.data),this.stream.seek(8),this.frameEnd=this.frameStart=8);this.probe();this.marker.frameStart=this.frameStart;this.marker.frameEnd=this.frameEnd;return this.marker};
var F2dProbeDataType={dt_object:0,dt_void:1,dt_byte:2,dt_int:3,dt_float:4,dt_double:5,dt_varint:6,dt_point_varint:7,dt_byte_array:32,dt_int_array:33,dt_float_array:34,dt_double_drray:35,dt_varint_array:36,dt_point_varint_array:37,dt_arc:38,dt_circle:39,dt_circular_arc:40,dt_string:63,dt_last_data_type:127},F2dProbeSemanticType={st_object_member:0,st_fill:1,st_fill_off:2,st_clip_off:3,st_layer:4,st_link:5,st_line_weight:6,st_miter_angle:7,st_miter_length:8,st_line_pattern_ref:9,st_back_color:10,st_color:11,
st_markup:12,st_object_id:13,st_markup_id:14,st_reset_rel_offset:15,st_font_ref:16,st_begin_object:32,st_clip:33,st_line_caps:34,st_line_join:35,st_line_pattern_def:36,st_font_def:37,st_sheet:42,st_arc:43,st_polyline:44,st_raster:45,st_text:46,st_polytriangle:47,st_dot:48,st_end_object:63,st_last_semantic_type:127};F2DProbe.prototype.readColor=function(){var a=this.stream;a.getVarints();a.getVarints();a.skipUint32()};F2DProbe.prototype.parsePointPositions=function(){this.stream.getVarints();this.stream.getVarints()};
F2DProbe.prototype.unhandledTypeWarning=function(a,b){debug("Unhandled semantic type when probing F2d : "+b+" in function "+a)};F2DProbe.prototype.parseObject=function(){this.stream.getVarints()};F2DProbe.prototype.parseString=function(){var a=this.stream;a.getVarints();var b=a.getVarints();a.skipBytes(b)};F2DProbe.prototype.parsePoint=function(){this.stream.getVarints();this.parsePointPositions()};
F2DProbe.prototype.parseVarintArray=function(){var a=this.stream;a.getVarints();for(var b=a.getVarints(),c=0;c<b;++c)a.getVarints()};F2DProbe.prototype.parseByteArray=function(){var a=this.stream;a.getVarints();var b=a.getVarints();a.skipBytes(b)};F2DProbe.prototype.parseEndOfObject=function(){var a=this.stream;a.getVarints();a.getVarints()};F2DProbe.prototype.parsePointsArray=function(a){a=this.stream;a.getVarints();if(a=a.getVarints()){a/=2;for(var b=0;b<a;++b)this.parsePointPositions()}};
F2DProbe.prototype.parsePoint=function(a){this.stream.getVarints();this.parsePointPositions()};F2DProbe.prototype.parseInt=function(){var a=this.stream,b=a.getVarints();switch(b){case F2dProbeSemanticType.st_color:a.skipUint32();break;case F2dProbeSemanticType.st_fill:a.skipUint32();break;default:a.skipUint32(),this.unhandledTypeWarning("parseInt",b)}};
F2DProbe.prototype.parseVoid=function(){var a=this.stream.getVarints();switch(a){case F2dProbeSemanticType.st_fill_off:break;default:this.unhandledTypeWarning("parseVoid",a)}};F2DProbe.prototype.parseVarint=function(){this.stream.getVarints();this.stream.getVarints()};F2DProbe.prototype.parseIntArray=function(){var a=this.stream;a.getVarints();for(var b=a.getVarints(),c=0;c<b;++c)a.skipUint32()};F2DProbe.prototype.parseFloat=function(){var a=this.stream;a.getVarints();a.getFloat32()};
F2DProbe.prototype.parseCircularArc=function(){var a=this.stream;a.getVarints();this.parsePointPositions();a.getVarints();a.getFloat32();a.getFloat32()};F2DProbe.prototype.parseCircle=function(){var a=this.stream;a.getVarints();this.parsePointPositions();a.getVarints()};F2DProbe.prototype.parseArc=function(){var a=this.stream;a.getVarints();this.parsePointPositions();a.getVarints();a.getVarints();a.getFloat32();a.getFloat32();a.getFloat32()};
F2DProbe.prototype.parseDataType=function(){var a=this.stream.getVarints();switch(a){case F2dProbeDataType.dt_void:this.parseVoid();break;case F2dProbeDataType.dt_int:this.parseInt();break;case F2dProbeDataType.dt_object:this.parseObject();break;case F2dProbeDataType.dt_varint:this.parseVarint();break;case F2dProbeDataType.dt_float:this.parseFloat();break;case F2dProbeDataType.dt_point_varint:this.parsePoint();break;case F2dProbeDataType.dt_point_varint_array:this.parsePointsArray();break;case F2dProbeDataType.dt_circular_arc:this.parseCircularArc();
break;case F2dProbeDataType.dt_circle:this.parseCircle();break;case F2dProbeDataType.dt_arc:this.parseArc();break;case F2dProbeDataType.dt_varint_array:this.parseVarintArray();break;case F2dProbeDataType.dt_int_array:this.parseIntArray();break;case F2dProbeDataType.dt_byte_array:this.parseByteArray();break;case F2dProbeDataType.dt_string:this.parseString();break;default:this.error=!0,debug("Bad op code encountered : "+a+" , bail out.")}this.error||(this.frameEnd=this.stream.offset)};
F2DProbe.prototype.probe=function(){var a=this.stream;try{for(;a.offset<a.byteLength;){this.parseDataType();if(this.error)break;this.opCount++}}catch(b){}};function CheckedInputStream(a){this.buffer=a;this.offset=0;this.byteLength=a.length;this.convBuf=new ArrayBuffer(8);this.convUint8=new Uint8Array(this.convBuf);this.convUint16=new Uint16Array(this.convBuf);this.convInt32=new Int32Array(this.convBuf);this.convUint32=new Uint32Array(this.convBuf)}
function OutOfBoundsBufferAccessException(a){this.offset=a;this.message="try to access an offset that is out of bounds: "+this.offset;this.toString=function(){return this.message}}CheckedInputStream.prototype.boundsCheck=function(a){if(a>=this.byteLength)throw new OutOfBoundsBufferAccessException(a);};CheckedInputStream.prototype.seek=function(a){this.boundsCheck(a);this.offset=a};
CheckedInputStream.prototype.getBytes=function(a){this.boundsCheck(this.offset+a);var b=new Uint8Array(this.buffer.buffer,this.offset,a);this.offset+=a;return b};CheckedInputStream.prototype.skipBytes=function(a){this.boundsCheck(this.offset+a);this.offset+=a};CheckedInputStream.prototype.getVarints=function(){var a,b=0,c=0;do this.boundsCheck(this.offset),a=this.buffer[this.offset++],b|=(a&127)<<c,c+=7;while(a&128);return b};
CheckedInputStream.prototype.getUint8=function(){this.boundsCheck(this.offset+1);return this.buffer[this.offset++]};CheckedInputStream.prototype.getUint16=function(){this.boundsCheck(this.offset+2);this.convUint8[0]=this.buffer[this.offset++];this.convUint8[1]=this.buffer[this.offset++];return this.convUint16[0]};CheckedInputStream.prototype.getInt16=function(){var a=this.getUint16();32767<a&&(a|=4294901760);return a};
CheckedInputStream.prototype.getInt32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convInt32[0]};CheckedInputStream.prototype.getUint32=function(){this.boundsCheck(this.offset+4);var a=this.buffer,b=this.convUint8,c=this.offset;b[0]=a[c];b[1]=a[c+1];b[2]=a[c+2];b[3]=a[c+3];this.offset+=4;return this.convUint32[0]};
CheckedInputStream.prototype.skipUint32=function(){this.boundsCheck(this.offset+4);this.offset+=4};CheckedInputStream.prototype.getFloat32=function(){this.boundsCheck(this.offset+4);this.offset+=4;return 0};CheckedInputStream.prototype.getFloat64=function(){this.boundsCheck(this.offset+8);this.offset+=8;return 0};CheckedInputStream.prototype.reset=function(a){this.buffer=a;this.offset=0;this.byteLength=a.length};
function NodeArray(a,b){this.bytes_per_node=b?32:36;var c,d;a instanceof ArrayBuffer?(c=a.byteLength/this.bytes_per_node,d=a,this.nodeCount=c):(c=a|0,d=new ArrayBuffer(this.bytes_per_node*c),this.nodeCount=0);this.nodeCapacity=c;this.nodesRaw=d;this.is_lean_node=b;this.node_stride=this.bytes_per_node/4;this.node_stride_short=this.bytes_per_node/2;this.nodesF=new Float32Array(this.nodesRaw);this.nodesI=new Int32Array(this.nodesRaw);this.nodesS=new Uint16Array(this.nodesRaw)}
NodeArray.prototype.setLeftChild=function(a,b){this.nodesI[a*this.node_stride+6]=b};NodeArray.prototype.getLeftChild=function(a){return this.nodesI[a*this.node_stride+6]};NodeArray.prototype.setPrimStart=function(a,b){this.is_lean_node?this.nodesI[a*this.node_stride+6]=b:this.nodesI[a*this.node_stride+8]=b};NodeArray.prototype.getPrimStart=function(a){return this.is_lean_node?this.nodesI[a*this.node_stride+6]:this.nodesI[a*this.node_stride+8]};
NodeArray.prototype.setPrimCount=function(a,b){this.nodesS[a*this.node_stride_short+14]=b};NodeArray.prototype.getPrimCount=function(a){return this.nodesS[a*this.node_stride_short+14]};NodeArray.prototype.setFlags=function(a,b,c,d){this.nodesS[a*this.node_stride_short+15]=d<<3|c<<2|b&3};NodeArray.prototype.getFlags=function(a){return this.nodesS[a*this.node_stride_short+15]};
NodeArray.prototype.setBox0=function(a,b){var c=a*this.node_stride,d=this.nodesF;d[c]=b[0];d[c+1]=b[1];d[c+2]=b[2];d[c+3]=b[3];d[c+4]=b[4];d[c+5]=b[5]};NodeArray.prototype.getBoxThree=function(a,b){var c=a*this.node_stride,d=this.nodesF;b.min.x=d[c];b.min.y=d[c+1];b.min.z=d[c+2];b.max.x=d[c+3];b.max.y=d[c+4];b.max.z=d[c+5]};NodeArray.prototype.setBoxThree=function(a,b){var c=a*this.node_stride,d=this.nodesF;d[c]=b.min.x;d[c+1]=b.min.y;d[c+2]=b.min.z;d[c+3]=b.max.x;d[c+4]=b.max.y;d[c+5]=b.max.z};
NodeArray.prototype.makeEmpty=function(a){a*=this.node_stride;var b=this.nodesI;b[a+6]=-1;b[a+7]=0;this.is_lean_node||(b[a+8]=-1)};NodeArray.prototype.realloc=function(a){if(this.nodeCount+a>this.nodeCapacity){var b=0|3*this.nodeCapacity/2;b<this.nodeCount+a&&(b=this.nodeCount+a);a=new ArrayBuffer(b*this.bytes_per_node);var c=new Int32Array(a);c.set(this.nodesI);this.nodeCapacity=b;this.nodesRaw=a;this.nodesF=new Float32Array(a);this.nodesI=c;this.nodesS=new Uint16Array(a)}};
NodeArray.prototype.nextNodes=function(a){this.realloc(a);var b=this.nodeCount;this.nodeCount+=a;for(var c=0;c<a;c++)this.makeEmpty(b+c);return b};NodeArray.prototype.getRawData=function(){return this.nodesRaw.slice(0,this.nodeCount*this.bytes_per_node)};
var BOX_STRIDE=6,POINT_STRIDE=3,BOX_EPSILON=1E-5,BOX_SCALE_EPSILON=1E-5,MAX_DEPTH=15,MAX_BINS=16,BVHModule=function(){function a(a,b,c){a[0]>b[c]&&(a[0]=b[c]);a[3]<b[c]&&(a[3]=b[c]);a[1]>b[c+1]&&(a[1]=b[c+1]);a[4]<b[c+1]&&(a[4]=b[c+1]);a[2]>b[c+2]&&(a[2]=b[c+2]);a[5]<b[c+2]&&(a[5]=b[c+2])}function b(a,b,c){a[0]>b[c]&&(a[0]=b[c]);a[1]>b[c+1]&&(a[1]=b[c+1]);a[2]>b[c+2]&&(a[2]=b[c+2]);a[3]<b[c+3]&&(a[3]=b[c+3]);a[4]<b[c+4]&&(a[4]=b[c+4]);a[5]<b[c+5]&&(a[5]=b[c+5])}function c(a,b){a[0]>b[0]&&(a[0]=b[0]);
a[1]>b[1]&&(a[1]=b[1]);a[2]>b[2]&&(a[2]=b[2]);a[3]<b[3]&&(a[3]=b[3]);a[4]<b[4]&&(a[4]=b[4]);a[5]<b[5]&&(a[5]=b[5])}function d(a,b,c,d){for(var e=0;3>e;e++)a[b+e]=c[d+3+e]-c[d+e]}function e(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5]}function f(a){a[0]=Infinity;a[1]=Infinity;a[2]=Infinity;a[3]=-Infinity;a[4]=-Infinity;a[5]=-Infinity}function g(a){var b=a[3]-a[0],c=a[4]-a[1];a=a[5]-a[2];return 0>b||0>c||0>a?0:2*(b*c+c*a+a*b)}function h(){this.vb_left=new Float32Array(6);this.vb_right=
new Float32Array(6);this.cb_left=new Float32Array(6);this.cb_right=new Float32Array(6);this.num_left=0;this.num_bins=this.best_cost=this.best_split=-1}function l(){this.box_bbox=new Float32Array(6);this.box_centroid=new Float32Array(6);this.num_prims=0}function k(){this.BL=new Float32Array(6);this.CL=new Float32Array(6);this.AL=this.NL=0}h.prototype.reset=function(){this.num_left=0;this.num_bins=this.best_cost=this.best_split=-1};l.prototype.reset=function(){this.num_prims=0;f(this.box_bbox);f(this.box_centroid)};
k.prototype.reset=function(){this.AL=this.NL=0;f(this.BL);f(this.CL)};for(var m=[],p=0;p<MAX_BINS;p++)m.push(new l);for(var r=[],p=0;p<MAX_BINS-1;p++)r.push(new k);var n=new Float32Array(6),u=new Float32Array(6),t=new Float32Array(3);return{bvh_subdivide:function(k,l,p,F,z,B,J,K){d(t,0,B,0);var I=k.nodes,D=J?k.frags_per_leaf_node_transparent:k.frags_per_leaf_node,C=J?k.frags_per_inner_node_transparent:k.frags_per_inner_node,w=k.max_polys_per_node,E=0;t[1]>t[0]&&(E=1);t[2]>t[E]&&(E=2);I.setBox0(l,
z);var G=0;z=0;if(k.polygonCounts)for(var H=p;H<=F&&!(G+=k.polygonCounts[k.primitives[H]],z++,G>w);H++);H=F-p+1;if(H<=D&&G<w||1===H||K>MAX_DEPTH||t[E]<k.scene_epsilon)I.setLeftChild(l,-1),I.setPrimStart(l,p),I.setPrimCount(l,F-p+1),I.setFlags(l,0,0,J?1:0);else{if(C){C=p;E=k.primitives;D=k.centroids;w=F-C+1;w>k.frags_per_inner_node&&(w=k.frags_per_inner_node);w>z&&(w=z);I.setPrimStart(l,C);I.setPrimCount(l,w);C+=w;f(B);for(z=C;z<=F;z++)a(B,D,3*E[z]);d(t,0,B,0);E=0;t[1]>t[0]&&(E=1);t[2]>t[E]&&(E=2);
p+=I.getPrimCount(l)}z=new h;var y=p,C=E;if(t[C]<k.scene_epsilon)z.best_cost=Infinity;else{D=MAX_BINS;D>F-y+1&&(D=F-y+1);for(w=0;w<D;w++)m[w].reset();for(w=0;w<D-1;w++)r[w].reset();var w=z.num_bins=D,G=k.centroids,H=k.primitives,v=k.boxes,M=w*(1-BOX_SCALE_EPSILON)/t[C];B=B[C];for(var N=k.sort_prims;y<=F;y++){var O=H[y]|0,L=M*(G[3*O+C]-B)|0;0>L?L=0:L>=w&&(L=w-1);N[y]=L;m[L].num_prims++;b(m[L].box_bbox,v,6*O);a(m[L].box_centroid,G,3*O)}e(r[0].BL,m[0].box_bbox);e(r[0].CL,m[0].box_centroid);r[0].AL=g(r[0].BL);
r[0].NL=m[0].num_prims;for(w=1;w<D-1;w++)B=m[w],C=r[w],e(C.BL,r[w-1].BL),c(C.BL,B.box_bbox),C.AL=g(C.BL),e(C.CL,r[w-1].CL),c(C.CL,B.box_centroid),C.NL=r[w-1].NL+B.num_prims;w=D-1;e(n,m[w].box_bbox);e(u,m[w].box_centroid);H=g(n);D=m[w].num_prims;C=w;G=H*D+r[w-1].AL*r[w-1].NL;e(z.vb_right,n);e(z.cb_right,m[w].box_centroid);e(z.vb_left,r[w-1].BL);e(z.cb_left,r[w-1].CL);z.num_left=r[w-1].NL;for(--w;1<=w;w--)B=m[w],c(n,B.box_bbox),c(u,B.box_centroid),H=g(n),D+=B.num_prims,B=H*D+r[w-1].AL*r[w-1].NL,B<=
G&&(G=B,C=w,e(z.vb_right,n),e(z.cb_right,u),e(z.vb_left,r[w-1].BL),e(z.cb_left,r[w-1].CL),z.num_left=r[w-1].NL);z.best_split=C;z.best_cost=G}if(0>z.num_bins)I.setPrimCount(l,I.getPrimCount(l)+F-p+1);else{B=k.primitives;D=k.sort_prims;C=0;w=p|0;H=z.best_split|0;for(G=p;G<=F;G++)v=B[G]|0,D[G]<H?B[w++]=v:D[C++]=v;for(G=0;G<C;G++)B[w+G]=D[G];B=I.nextNodes(2);I.setFlags(l,E,.5*(z.vb_left[3+E]+z.vb_left[E])<.5*(z.vb_right[3+E]+z.vb_right[E])?0:1,J?1:0);I.setLeftChild(l,B);k.recursion_stack.push([k,B+1,
p+z.num_left,F,z.vb_right,z.cb_right,J,K+1]);k.recursion_stack.push([k,B,p,p+z.num_left-1,z.vb_left,z.cb_left,J,K+1])}}},compute_boxes:function(c){var e=c.boxv_o,g=c.boxc_o,h=c.boxv_t,k=c.boxc_t;f(e);f(g);f(h);f(k);for(var l=c.centroids,m=c.boxes,n=0,p=c.prim_count;n<p;n++){var r=l,u=3*n,w=m,E=6*n;r[u]=.5*(w[E]+w[E+3]);r[u+1]=.5*(w[E+1]+w[E+4]);r[u+2]=.5*(w[E+2]+w[E+5]);n>=c.first_transparent?(a(k,l,3*n),b(h,m,6*n)):(a(g,l,3*n),b(e,m,6*n))}d(t,0,c.boxv_o,0);e=Math.max(t[0],t[1],t[2]);c.scene_epsilon=
BOX_EPSILON*e},box_area:function(a,b){var c=a[b+3]-a[b],d=a[b+4]-a[b+1],e=a[b+5]-a[b+2];return 0>c||0>d||0>e?0:2*(c*d+d*e+e*c)}}}();
function BVHBuilder(a,b){this.boxes=a.boxes;this.polygonCounts=a.polygonCounts;this.materials=a.materials;this.materialDefs=b;this.prim_count=a.length;this.frags_per_inner_node=this.frags_per_leaf_node=-1;this.nodes=null;this.work_buf=new ArrayBuffer(4*this.prim_count);this.sort_prims=new Int32Array(this.work_buf);this.primitives=new Int32Array(this.prim_count);this.centroids=new Float32Array(POINT_STRIDE*this.prim_count);this.boxv_o=new Float32Array(6);this.boxc_o=new Float32Array(6);this.boxv_t=
new Float32Array(6);this.boxc_t=new Float32Array(6);this.recursion_stack=[]}
BVHBuilder.prototype.sortPrimitives=function(){for(var a=new Float32Array(this.work_buf),b=this.materialDefs,c=this.materials,d=this.primitives,e=0,f=0,g=this.prim_count;f<g;f++){d[f]=f;var h=b[c[f]].transparent;h&&e++;l?(a[f]=BVHModule.box_area(this.boxes,BOX_STRIDE*f),h&&(a[f]=-a[f])):a[f]=h?-1:1}var l=!1;if(e&&e<this.prim_count){b=new Int32Array(e);f=h=c=0;for(g=this.prim_count;f<g;f++)0<=a[f]?d[c++]=d[f]:b[h++]=d[f];d.set(b,this.prim_count-e)}this.first_transparent=this.prim_count-e};
BVHBuilder.prototype.build=function(a){var b=a&&!!a.useSlimNodes;if(b)this.frags_per_leaf_node=1,this.frags_per_inner_node=0,this.frags_per_leaf_node_transparent=1,this.frags_per_inner_node_transparent=0,this.max_polys_per_node=Infinity;else{var c=a.isWeakDevice?.5:1;this.frags_per_leaf_node=0|32*c;this.frags_per_inner_node=0|this.frags_per_leaf_node;this.frags_per_leaf_node_transparent=this.frags_per_leaf_node;this.frags_per_inner_node_transparent=0;this.max_polys_per_node=0|1E4*c}if(this.nodes&&
this.nodes.is_lean_node==b)this.nodes.nodeCount=0;else{b=this.prim_count/this.frags_per_leaf_node;for(c=1;c<b;)c*=2;this.nodes=new NodeArray(c,a?a.useSlimNodes:!1)}this.sortPrimitives();BVHModule.compute_boxes(this);a=this.nodes.nextNodes(2);for(BVHModule.bvh_subdivide(this,a,0,this.first_transparent-1,this.boxv_o,this.boxc_o,!1,0);this.recursion_stack.length;)b=this.recursion_stack.pop(),BVHModule.bvh_subdivide(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);for(BVHModule.bvh_subdivide(this,a+1,this.first_transparent,
this.prim_count-1,this.boxv_t,this.boxc_t,!0,0);this.recursion_stack.length;)b=this.recursion_stack.pop(),BVHModule.bvh_subdivide(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7])};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.inWorkerThread="undefined"!==typeof self&&"undefined"===typeof window;Autodesk.Viewing.Private.RefreshTokenHandler=function(){};Autodesk.Viewing.Private.RefreshTokenHandler.prototype.shouldRefreshToken=function(a,b,c){return 401===a};
Autodesk.Viewing.Private.RefreshTokenHandler.prototype.refreshToken=function(a,b){};Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler=function(){Autodesk.Viewing.Private.RefreshTokenHandler.call(this)};Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype=Object.create(Autodesk.Viewing.Private.RefreshTokenHandler.prototype);Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype.constructor=Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler;
Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype.shouldRefreshToken=function(a,b,c){b=!1;401===a?(a="string"===typeof c&&""!==c?JSON.parse(c):c,b=""===c||a.hasOwnProperty("errorCode")&&"AUTH-006"===a.errorCode):b=403===a;return b};
Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype.refreshToken=function(a,b){var c=null;Autodesk.Viewing.Private.refreshToken&&(c=Autodesk.Viewing.Private.refreshToken());c?0===Autodesk.Viewing.Private.env.indexOf("Autodesk")?Autodesk.Viewing.Private.setApigeeTokenInCookie(c,a,b):Autodesk.Viewing.Private.setAuthTokenInCookie(c,a,b):b&&b(null)};Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler=function(){Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.call(this)};
Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler.prototype=Object.create(Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype);Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler.prototype.constructor=Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler;
Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler.prototype.refreshToken=function(a,b){Autodesk.Viewing.Private.inWorkerThread?(self.addEventListener("message",function(c){c.data&&c.data.tokenRefreshed?a(c):b(c)}),self.postMessage({refreshToken:!0})):Autodesk.Viewing.Private.ViewingServiceRefreshTokenHandler.prototype.refreshToken.call(this,a,b)};Autodesk.Viewing.Private.Xhr=function(a,b){this.request=new XMLHttpRequest;this.withCredentials=a;this.refreshTokenHandler=b};
Autodesk.Viewing.Private.Xhr.prototype.generateUrl=function(a,b){var c=this.getDefaultQueryParameters();b&&(c+="&"+b);c&&(a=a+"?"+c);return a};Autodesk.Viewing.Private.Xhr.prototype.getDefaultHeaders=function(){return{}};Autodesk.Viewing.Private.Xhr.prototype.getDefaultQueryParameters=function(){return""};Autodesk.Viewing.Private.Xhr.prototype.addHeaders=function(a){var b=this.getDefaultHeaders();if(a)for(var c in a)b[c]=a[c];for(var d in b)this.request.setRequestHeader(d,b[d])};
Autodesk.Viewing.Private.Xhr.prototype.get=function(a,b,c,d){var e=this;d=d?d:{};a=e.generateUrl(a,d?d.queryParams:null);try{var f=function(a){200===e.request.status?b(e.request.response?e.request.response:e.request.responseText):g(a)},g=function(f){(d.hasOwnProperty("retryOnAuthenticationFail")?d.retryOnAuthenticationFail:1)&&e.refreshTokenHandler&&e.refreshTokenHandler.shouldRefreshToken(e.request.status,e.request.statusText,"text"===e.request.responseType||""===e.request.responseType?e.request.responseText:
"")?e.refreshTokenHandler.refreshToken(function(f){e.request=new XMLHttpRequest;d.retryOnAuthenticationFail=!1;e.get(a,b,c,d)},function(b){c(e.request.status,e.request.statusText,{url:a})}):c(e.request.status,e.request.statusText,{url:a})},h=d.hasOwnProperty("asynchronous")?d.asynchronous:!0;e.request.open("GET",a,h);d.hasOwnProperty("responseType")&&(e.request.responseType=d.responseType);e.request.withCredentials=e.withCredentials;e.addHeaders(d.hasOwnProperty("headers")?d.headers:[]);h&&(e.request.onload=
f,e.request.onerror=g,e.request.ontimeout=g);e.request.send();h||f(null)}catch(l){c(e.request.status,e.request.statusText,{url:a,exception:l})}};
Autodesk.Viewing.Private.ViewingServiceXhr=function(a,b,c){var d=c&&c.hasOwnProperty("refreshTokenHandler")?c.refreshTokenHandler:new Autodesk.Viewing.Private.WorkerViewingServiceRefreshTokenHandler;this.withCredentials=!0;c&&c.hasOwnProperty("withCredentials")&&(this.withCredentials=c.withCredentials);Autodesk.Viewing.Private.Xhr.call(this,this.withCredentials,d);this.api=b;this.baseUrl=a;this.options=c};Autodesk.Viewing.Private.ViewingServiceXhr.prototype=Object.create(Autodesk.Viewing.Private.Xhr.prototype);
Autodesk.Viewing.Private.ViewingServiceXhr.prototype.constructor=Autodesk.Viewing.Private.ViewingServiceXhr;
Autodesk.Viewing.Private.ViewingServiceXhr.prototype.generateUrl=function(a,b){if(0===a.indexOf("urn:")){"items"!==this.api&&(a=a.substr(4));var c=this.options&&this.options.hasOwnProperty("encodeUrn")?this.options.encodeUrn:!0;a="bubbles"===this.api&&0==Autodesk.Viewing.Private.env.indexOf("Autodesk")?this.baseUrl+"/"+(c?encodeURIComponent(a):a):this.baseUrl+"/"+this.api+"/"+(c?encodeURIComponent(a):a)}return Autodesk.Viewing.Private.Xhr.prototype.generateUrl.call(this,a,b)};
var Xhr=function(){var a=function(a,c,d){this.xhr=new XMLHttpRequest;this.errorHandler=a;this.success=!1;this.viewing_url=d;this.auth=c};a.prototype.generateUrl=function(a,c,d){var e=a.indexOf("urn:");0===e&&this.viewing_url&&((d=d&&d.feature?d.feature:null)?"render"==d?(a=a.substr(4),a=this.viewing_url+"/"+d+"/"+encodeURIComponent(a)):"bubbles"==d?(a=a.substr(4),a=this.viewing_url+"/"+d+"/"+encodeURIComponent(a)):"comments"==d?(a=a.substr(4),a=this.viewing_url+"/"+d+"/file/"+encodeURIComponent(a)):
a=this.viewing_url+"/"+d+"/"+encodeURIComponent(a.substr(e)):a=this.viewing_url+"/items/"+encodeURIComponent(a.substr(e)));c&&(a=a+"?"+c);return a};a.prototype.addHeaders=function(a){for(var c in a)this.xhr.setRequestHeader(c,a[c])};a.prototype.get=function(a,c,d,e,f,g){a=this.generateUrl(a,g,{feature:f});try{this.xhr.open("GET",a,!!e),this.xhr.responseType=d,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),e&&(this.xhr.onload=e),this.addHeaders(c),this.xhr.send()}catch(h){return this.errorHandler&&
this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,200);return this.xhr.response};a.prototype.post=function(a,c,d,e,f,g){a=this.generateUrl(a,null,{feature:g});c["Content-Type"]||(c["Content-Type"]="application/json");try{this.xhr.open("POST",a,!!f),this.xhr.responseType=e,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),f&&(this.xhr.onload=f),this.addHeaders(c),this.xhr.send(d)}catch(h){return this.errorHandler&&this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,200,201);
return this.xhr.response};a.prototype.getRange=function(a,c,d,e,f,g){a=this.generateUrl(path);c.Range="bytes="+e+"-"+f;try{this.xhr.open("GET",a,!!g),this.xhr.responseType=d,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),g&&(this.xhr.onload=g),this.addHeaders(c),this.xhr.send()}catch(h){return this.errorHandler&&this.errorHandler.networkFailure(a,h),null}this.errorCheck(a,206);return this.xhr.response};a.prototype.head=function(a){a=this.generateUrl(path);try{this.xhr.open("GET",a,!1),this.success=
!1,this.auth&&(this.xhr.withCredentials=!0),this.addHeaders([]),this.xhr.send()}catch(c){return this.errorHandler&&this.errorHandler.networkFailure(a,c),null}this.errorCheck(a,200);a=[];a["Accept-Ranges"]=this.xhr.getResponseHeader("Accept-Ranges");a["Content-Length"]=this.xhr.getResponseHeader("Content-Length");return a};a.prototype.errorCheck=function(a,c){if(4===this.xhr.readyState&&this.xhr.status){var d;for(d=1;d<arguments.length&&this.xhr.status!==arguments[d];d++);d===arguments.length&&this.errorHandler?
this.errorHandler.unsuccessfulResponse(a,this.xhr.status,this.xhr.statusText):this.success=!0}else this.success=!0};return a}(),XhrErrorHandler=function(){var a=function(a){this.host=a;this.ignoreFileNotFound=!1};a.prototype.networkFailure=function(a,c){this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:a,exception:c.toString(),stack:c.stack})};a.prototype.unsuccessfulResponse=function(a,c,d){403==c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED,
"Access denied to remote resource",{url:a,httpStatus:c,httpStatusText:d}):404==c?this.ignoreFileNotFound||this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:a,httpStatus:c,httpStatusText:d}):500<=c&&600>c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:a,httpStatus:c,httpStatusText:d}):this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",
{url:a,httpStatus:c,httpStatusText:d})};return a}();
function doGeomLoad(a,b){(new Autodesk.Viewing.Private.ViewingServiceXhr(b.viewing_url,"items",{withCredentials:!!b.auth})).get(b.url,function(c){a.postMessage({url:b.url,workerId:b.workerId,progress:.5});try{var d=new PackFileReader(new Uint8Array(c))}catch(e){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while reading pack file",{url:b.url,exception:e.toString(),stack:e.stack});a.postMessage(null);return}for(var f=c=!1,g={packId:b.packId,meshIndex:0,mesh:null,workerId:b.workerId,
progress:0},h=0,l=d.getEntryCounts();h<l;h++){try{var k=readGeometry(d,h,null)}catch(m){f||(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while reading geometry",{url:b.url,exception:m.toString(),stack:m.stack}),c=f=!0,debug(m.stack)),k=null}g.meshIndex=h;g.mesh=k;g.progress=.5+(h+1)/l*.5;if(k){var p=[];p.push(k.vb.buffer);a.postMessage(g,p)}else c||(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unable to load geometry",{url:b.url}),c=!0),a.postMessage(g)}},b.onFailureCallback,
{responseType:"arraybuffer",asynchronous:!1,headers:b.headers,queryParams:b.queryParams})}function guardFunction(a,b,c){try{c()}catch(d){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Unhandled exception while loading SVF",{url:b.url,exception:d.toString(),stack:d.stack}),a.postMessage(null)}}
function doLoadSvfContinued(a,b){guardFunction(a,b,function(){var c=a.svf;b.loadDoneCB=function(d){"svf"==d?a.postMessage({svf:c,progress:.75}):"bvh"==d?(d={nodes:c.bvh.nodes.getRawData(),primitives:c.bvh.primitives,useLeanNodes:32==c.bvh.nodes.bytes_per_node},a.postMessage({bvh:d,basePath:c.basePath,progress:1},[d.nodes,d.primitives.buffer])):"done"==d?a.postMessage({progress:1}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Failure while loading SVF",{url:b.url}),a.postMessage(null))};a.svf.loadRemainingSvf(b)})}
function doLoadSvf(a,b){(new Autodesk.Viewing.Private.ViewingServiceXhr(b.viewing_url,"items",{withCredentials:!!b.auth})).get(b.url,function(c){a.postMessage({progress:.5});guardFunction(a,b,function(){a.svf=new Package(new Uint8Array(c));a.svf.loadManifest(b);b.interceptManifest?a.postMessage({manifest:svf.manifest}):(b.manifest=a.svf.manifest,doLoadSvfContinued(a,b))})},b.onFailureCallback,{responseType:"arraybuffer",asynchronous:!1,headers:b.headers,queryParams:b.queryParams})}
var propdb=null,propdbFailed=!1,propdbURL="";
function loadPropertyPacks(a,b,c){function d(b){if(!b){if(g){propdbFailed=!0;c(null);return}g=!0;b=[];b.push({filename:"objects_attrs.json",storage:e.attrs});b.push({filename:"objects_vals.json",storage:e.values});b.push({filename:"objects_avs.json",storage:e.avs});b.push({filename:"objects_offs.json",storage:e.offsets});b.push({filename:"objects_ids.json",storage:e.ids});f=b}0===f.length?(propdb=new PropertyDatabase(e),c(propdb),propdbFailed=!1,propdbURL=a.url):(b=f.shift(),requestFile(b.filename,
a,d,b.storage))}if(propdb&&a.url===propdbURL)c(propdb);else if(propdbFailed)c(null);else if(b=a.propertydb){var e={ids:{},attrs:{},offsets:{},values:{},avs:{}},f=[];f.push({filename:b.attrs.length?b.attrs[0]:"objects_attrs.json.gz",storage:e.attrs});f.push({filename:b.values.length?b.values[0]:"objects_vals.json.gz",storage:e.values});f.push({filename:b.avs.length?b.avs[0]:"objects_avs.json.gz",storage:e.avs});f.push({filename:b.offsets.length?b.offsets[0]:"objects_offs.json.gz",storage:e.offsets});
f.push({filename:b.ids.length?b.ids[0]:"objects_ids.json.gz",storage:e.ids});for(b=0;b<f.length;b++)f[b].filename=f[b].filename.replace(/\\/g,"/");var g=!1;b=f.shift();requestFile(b.filename,a,d,b.storage)}else propdbFailed=!0,c(null)}function doPropertyGet(a,b){var c=b.dbId;loadPropertyPacks(b,c,function(b){b&&(b=b.getObjectProperties(c),a.postMessage({result:b,dbId:c}))})}
function computeTreeBBoxes(a,b,c){var d=6*a.dbId;b[d]=b[d+1]=b[d+2]=Infinity;b[d+3]=b[d+4]=b[d+5]=-Infinity;var e=a.children;if(e)for(var f=0,g=e.length;f<g;f++){computeTreeBBoxes(e[f],b,c);for(var h=6*(e[f].dbId|0),l=0;3>l;l++)b[d+l]>b[h+l]&&(b[d+l]=b[h+l]),b[d+l+3]<b[h+l+3]&&(b[d+l+3]=b[h+l+3])}if(void 0!==a.fragIds)if(!Array.isArray(a.fragIds))for(e=6*(a.fragIds|0),l=0;3>l;l++)b[d+l]>c[e+l]&&(b[d+l]=c[e+l]),b[d+l+3]<c[e+l+3]&&(b[d+l+3]=c[e+l+3]);else if(a.fragIds.length)for(f=0;f<a.fragIds.length;f++)for(e=
6*(a.fragIds[f]|0),l=0;3>l;l++)b[d+l]>c[e+l]&&(b[d+l]=c[e+l]),b[d+l+3]<c[e+l+3]&&(b[d+l+3]=c[e+l+3])}function buildDbIdToFragMap(a){for(var b={},c=0,d=a.length;c<d;c++){var e=a[c],f=b[e];void 0===f?b[e]=c:Array.isArray(f)?f.push(c):b[e]=[f,c]}return b}
function doObjectTreeParse(a,b){loadPropertyPacks(b,null,function(c){if(c){var d;b.fragToDbId&&(d=buildDbIdToFragMap(b.fragToDbId));var e=c.findRootNodes(),f,g=[0],h=c.getObjectCount();if(e&&e.length)if(1==e.length)f={dbId:e[0]},c.buildObjectTree(f,d,0,g);else{f={dbId:0,children:[]};for(var l=0;l<e.length;l++){var k={dbId:e[l]};f.children.push(k);c.buildObjectTree(k,d,0,g)}}a.postMessage({instanceTree:f,maxTreeDepth:g[0],objectCount:h});b.fragBoxes&&(c=new Float32Array(6*c.getObjectCount()),computeTreeBBoxes(f,
c,b.fragBoxes),a.postMessage({instanceBoxes:c}))}else a.postMessage({instanceTree:null,maxTreeDepth:0})})}
function requestFile(a,b,c,d){var e=b.url+a,f=null,f=-1!==e.indexOf(".gz",e.length-3)?function(b){try{var f=new Uint8Array(b);31==f[0]&&139==f[1]&&(f=(new Zlib.Gunzip(f)).decompress());d[a]=f;c(f)}catch(l){self.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:e,exception:l.toString(),stack:l.stack}),c(null)}}:function(b){d[a]=rawbuf;c(new Uint8Array(b))};(new Autodesk.Viewing.Private.ViewingServiceXhr(b.viewing_url,"items",{withCredentials:!!b.auth})).get(e,
f,function(a,d,e){if(404!==a)b.onFailureCallback(a,d,e);c(null)},{responseType:"arraybuffer",asynchronous:!1,headers:b.headers,queryParams:b.queryParams})}function doPropertySearch(a,b){loadPropertyPacks(b,null,function(c){c&&(c=c.bruteForceSearch(b.searchText),a.postMessage(c))})}
function doParseF2D(a,b){if(b.data){a.postMessage({progress:.5});var c=new F2D(b.metadata,b.manifest,b.basePath,b.f2dLoadOptions);b.loadDoneCB=function(b){b?a.postMessage({f2d:c}):(a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"",{}),a.postMessage(null))};try{c.load(b,new Uint8Array(b.data))}catch(d){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"",{exception:d.toString(),stack:d.stack}),a.postMessage(null)}}else a.postMessage(null)}
function doParseF2DFrame(a,b){f2d||(a.postMessage({progress:.5}),f2d=new F2D(b.metadata,b.manifest,b.basePath,b.f2dLoadOptions),f2d.F2D_MESH_COUNT_OLD=0,a.postMessage({f2dframe:f2d}));b.loadDoneCB=function(c){if(c){if(f2d.meshes.length){c={f2dframe:!0,meshes:f2d.meshes,baseIndex:f2d.F2D_MESH_COUNT_OLD,maxObjectNumber:f2d.maxObjectNumber,bbox:f2d.bbox};b.finalFrame&&(c.finalFrame=!0);for(var e=[],f=0,g=f2d.meshes.length;f<g;++f)e.push(f2d.meshes[f].vb.buffer),e.push(f2d.meshes[f].indices.buffer);a.postMessage(c,
e);f2d.F2D_MESH_COUNT_OLD+=f2d.meshes.length;f2d.meshes=[]}}else a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"",{}),a.postMessage(null)};try{f2d.loadFrames(b)}catch(c){a.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"",{exception:c.toString(),stack:c.stack}),a.postMessage(null)}}var ENABLE_F2D_STREAMING_MODE=!0;
function requestFileF2D(a,b){b.errorHandler.ignoreFileNotFound=!0;var c=new Xhr(b.errorHandler,b.auth,b.viewing_url);if(-1!==a.indexOf(".gz",a.length-3)){var d=c.get(a,b.headers,"arraybuffer",null,null,b.queryParams);if(c.success)try{var e=new Uint8Array(d);31==e[0]&&139==e[1]&&(e=(new Zlib.Gunzip(e)).decompress());return e}catch(f){return self.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malformed data received when requesting file",{url:a,exception:f.toString(),stack:f.stack}),null}else return null}else return d=
c.get(a,b.headers,"arraybuffer"),c.success?new Uint8Array(d):null}
function doStreamF2D(a,b){function c(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);a=decodeURIComponent(escape(b));return JSON.parse(a)}function d(a,b){for(var c=a.length-b,d=new ArrayBuffer(c),e=new Uint8Array(d,0),f=0,g=b;f<c;f++,g++)e[f]=a.charCodeAt(g)&255;return d}var e=b.url;b.queryParams&&(e+="?"+b.queryParams);var f=requestFileF2D(b.basePath+"metadata.json.gz",b),g=requestFileF2D(b.basePath+"manifest.json.gz",b);try{f&&(f=c(f)),g&&(g=c(g))}catch(h){g=f=null}if(f){var l;if(g&&
g.assets)for(var k=g.assets,m=0;m<k.length;m++)if(-1!=e.indexOf(k[m].URI)){l=k[m].usize||0;break}var p=new XMLHttpRequest;p.withCredentials=!!b.auth;var r=new F2DProbe,n=0,u=0,t=!1;p.onreadystatechange=function(){try{if(4==p.readyState){if(ENABLE_F2D_STREAMING_MODE&&0<u){var c=p.responseText,e={type:"F2DSTREAM",finalFrame:!0,finished:!0,progress:1},h=[];t||(e.manifest=g,e.metadata=f,e.basePath=b.basePath,t=!0);if(c.length>u){var k=d(c,u),m=new Uint8Array(k),q=r.load(m),x=k.slice(q.frameStart,q.frameEnd);
q.frameEnd>q.frameStart&&(h.push(x),e.frames=x)}debug("Total text bytes count : "+p.responseText.length);a.postMessage(e,h);return}c=p.responseText;k=d(c,0);e={type:"F2DBLOB",metadata:f,manifest:g,basePath:b.basePath,progress:1,buffer:k};h=[];h.push(k);a.postMessage(e,h)}if(2<p.readyState&&ENABLE_F2D_STREAMING_MODE&&(c=p.responseText,!(u+65536>c.length))){k=d(c,u);if(!n){++n;var D=new Uint8Array(k);if(31==D[0]&&139==D[1]){ENABLE_F2D_STREAMING_MODE=!1;return}}m=new Uint8Array(k);q=r.load(m);q.frameEnd>
q.frameStart&&(x=k.slice(q.frameStart,q.frameEnd),u+=q.frameEnd,h=[],h.push(x),e={type:"F2DSTREAM",frames:x,finalFrame:!1},l&&(e.progress=u/l),t||(e.manifest=g,e.metadata=f,e.basePath=b.basePath,t=!0),a.postMessage(e,h))}}catch(C){debug(C.message)}};try{p.open("GET",e,!0);if(b.headers)for(var q in b.headers)p.setRequestHeader(q,b.headers[q]);p.overrideMimeType("text/plain; charset=x-user-defined");p.send()}catch(x){debug(x.message)}}else self.raiseError(Autodesk.Viewing.ErrorCodes.BAD_DATA,"")}
var defaultCloudRenderConfig={ConsumerServiceKey:"Viewing",ProductVersion:"2014",UserInfo:{UserID:"",EmailFlag:"true"},Scenes:[{SceneInfo:{SourceFileInfo:{Type:"S3",AccessLevel:"Private"},FileUri:"",SceneId:"FireflyJSDefaultSceneId"},Renderings:[{ImageInfo:{Actions:["Render","ToneMap"],ProductionVersion:"SparkViewer",ImageParams:{RenderResolutionY:1500,RenderResolutionX:2E3,RenderImageFormat:"PNG"},Render:{RenderQuality:"standard",RenderCameraName:"",RenderingType:"image",ExposureType:"Customized"},
ToneMap:{BaseExposure:-9.5,OffsetExposure:0,ExposureValue:14,Shadows:.2,Midtones:1,Highlights:.25,WhitePoint:6500,Saturation:1,Type:"Cameraresponse"},EnvironmentOverridePreset:"studio_01",CameraOverride:{Units:"MILLIMETER",FocalDistance:0,Aperture:0,View:{Eye:[-4026.55,2722.32,-527.835],At:[.834734,-.454954,-.310218],Up:[.233914,-.0868021,.968375]},Projection:{isOrthographic:!1,Extent:1,ImageShift:[0,0],NativeAspect:1}}}}]}]};
function doCloudRendering(a,b){var c=new Xhr(b.errorHandler,b.auth,b.viewing_url),d=defaultCloudRenderConfig,e=b.camera,f=b.canvas,g=b.imageNo,h=b.exposureBias,l=b.currentLightPreset,k=new THREE.Vector3;k.x=e.target.x-e.position.x;k.y=e.target.y-e.position.y;k.z=e.target.z-e.position.z;k.normalize();var m=new THREE.Vector3;m.crossVectors(k,e.up);m.normalize();debug("Transform: "+m.x+" "+m.y+" "+m.z+" 0 "+e.up.x+" "+e.up.y+" "+e.up.z+" 0 "+k.x+" "+k.y+" "+k.z+" 0 "+e.position.x+" "+e.position.y+" "+
e.position.z+" 1");var p;1===b.upVector[0]?(m=[e.position.z,e.position.y,e.position.x],k=[k.z,k.y,k.x],p=[e.up.z,e.up.y,e.up.x]):1===b.upVector[1]?(m=[e.position.x,-e.position.z,e.position.y],k=[k.x,-k.z,k.y],p=[e.up.x,-e.up.z,e.up.y]):-1===b.upVector[0]?(m=[e.position.z,-e.position.y,-e.position.x],k=[k.z,-k.y,-k.x],p=[e.up.z,-e.up.y,-e.up.x]):-1===b.upVector[1]?(m=[-e.position.x,-e.position.z,-e.position.y],k=[-k.x,-k.z,-k.y],p=[-e.up.x,-e.up.z,-e.up.y]):-1===b.upVector[2]?(m=[-e.position.x,e.position.y,
-e.position.z],k=[-k.x,k.y,-k.z],p=[-e.up.x,e.up.y,-e.up.z]):(m=[e.position.x,e.position.y,e.position.z],k=[k.x,k.y,k.z],p=[e.up.x,e.up.y,e.up.z]);d.Scenes[0].Renderings[0].ImageInfo.CameraOverride.View.Eye=m;d.Scenes[0].Renderings[0].ImageInfo.CameraOverride.View.At=k;d.Scenes[0].Renderings[0].ImageInfo.CameraOverride.View.Up=p;d.Scenes[0].Renderings[0].ImageInfo.ImageParams.RenderResolutionX=f.width;d.Scenes[0].Renderings[0].ImageInfo.ImageParams.RenderResolutionY=f.height;d.Scenes[0].Renderings[0].ImageInfo.ToneMap.BaseExposure=
h;debug("currentLightPreset = "+l);var r;1===l?r="studio_01":3===l?r="grey_room":4===l?r="photobooth":8===l?r="riverbank":10===l?r="mi360_Plaza":11===l?r="field":12===l?r="crossroads":13===l?r="seaport":14===l?r="mi360_Snow":15===l&&(r="boardwalk");d.Scenes[0].Renderings[0].ImageInfo.EnvironmentOverridePreset=r;debug("Render config is : "+JSON.stringify(d));e=THREE.Math.degToRad(e.fov);0>=e&&(e=1E-4);d.Scenes[0].Renderings[0].ImageInfo.CameraOverride.Projection.Extent=e;debug("fov in radius = "+e);
debug("CameraOverrides: "+JSON.stringify(d.Scenes[0].Renderings[0].ImageInfo.CameraOverride));b.headers["x-ads-mode"]="verbatim";d=c.post(b.url,b.headers,JSON.stringify(d),"text",null,"render");debug(d);var n=JSON.parse(d)[0].JobId;debug("rendering job kicked off with render job id: "+n);a.postMessage({progress:"progress"});var u=setInterval(function(){var d=c.get(b.url,b.headers,"text",null,"render",b.queryParams?b.queryParams+"&jobid="+n:"jobid="+n);debug("from rendering worker : "+d);var d=JSON.parse(d).renderings[0],
e=d.JobInfo.JobStatus;"Complete"==e?(debug("rendering job :"+n+" finished."),d={renderings:{thumbnail:d.Storage.Output.Thumbnail,preview:d.Storage.Output.Preview,image:d.Storage.Output.Image,renderResolutionX:d.ImageParams.RenderResolutionX,renderResolutionY:d.ImageParams.RenderResolutionY,imageNo:g}},a.postMessage(d),clearInterval(u)):"Error"==e&&(d={error:{imageNo:g}},a.postMessage(d),clearInterval(u))},1E4)}
function doSvfToSpd(a,b){var c=new Xhr(b.errorHandler,b.auth,b.viewing_url),d={urn:"dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbmAvQVZFTlRBRE9SIExQNzAwLmYzZA",registerType:{rendering:{}}};d.urn=b.svfUrn;debug("svf to spd config : "+JSON.stringify(d));var e=c.post(b.url,b.headers,JSON.stringify(d),"text",null,"bubbles");debug(e);a.postMessage({translationProgress:"progress"});var f,g=setInterval(function(){var e=c.get(b.url+d.urn,b.headers,"text",null,"bubbles",
null);debug("from Svf to Spd worker : "+e);var e=JSON.parse(e),e=getValues(e,"urn"),l;for(l in e)if(-1!=e[l].indexOf(".spd")){f=e[l];break}void 0!=f&&(a.postMessage({translation:{spdUrn:f,camera:b.camera,imageNo:b.imageNo}}),clearInterval(g))},1E3);setTimeout(function(){void 0===f&&(a.postMessage({translationError:{imageNo:b.imageNo}}),clearInterval(g))},3E4)}
function getValues(a,b){var c=[],d;for(d in a)a.hasOwnProperty(d)&&("object"==typeof a[d]?c=c.concat(getValues(a[d],b)):d==b&&c.push(a[d]));return c}AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ESCAPE_EVENT="escape";Autodesk.Viewing.PROGRESS_UPDATE_EVENT="progress";Autodesk.Viewing.FULLSCREEN_MODE_EVENT="fullScreenMode";Autodesk.Viewing.NAVIGATION_MODE_CHANGED_EVENT="navmode";Autodesk.Viewing.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored";Autodesk.Viewing.VIEWER_RESIZE_EVENT="viewerResize";
Autodesk.Viewing.TOOLBAR_CREATED_EVENT="toolbarCreated";Autodesk.Viewing.VIEWER_UNINITIALIZED="viewerUninitialized";
Autodesk.Viewing.Viewer=function(a,b){this.clientContainer=a;this.container=document.createElement("div");this.container.className="adsk-viewing-viewer";this.container.style.height="100%";this.container.style.width="100%";this.container.style.overflow="hidden";this.container.classList.add(isTouchDevice()?"touch":"notouch");this.clientContainer.appendChild(this.container);this.listeners={};this.dockingPanels=[];this.config=b;this.contextMenu=null;this.contextMenuCallbacks={};this.__firefoxLMBfix=!1;
this.screenModeDelegateClass=this.screenModeDelegate=null;this.setScreenModeDelegate(b?b.screenModeDelegate:void 0);this.loadedExtensions={};this.started=!1};Autodesk.Viewing.Viewer.prototype={load:function(a,b){throw"bool load(urn, function(void)) must be implemented.  For more details, read the Viewer class documentation.";}};
Autodesk.Viewing.Viewer.prototype.start=function(){if(this.started)return 0;var a=this.initialize();if(0===a&&(this.started=!0,this.config&&this.config.hasOwnProperty("extensions")))for(var b=this.config.extensions,c=0;c<b.length;++c)this.loadExtension(b[c],this.config);return a};
Autodesk.Viewing.Viewer.prototype.initialize=function(){var a=this;this.onResizeCallback=function(b){a.resize()};window.addEventListener("resize",this.onResizeCallback,!1);if(!this.config||(this.config.hasOwnProperty("disableBrowserContextMenu")?this.config.disableBrowserContextMenu:1))this.onDefaultContextMenu=function(a){a.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1);this.initContextMenu();this.localize()};
Autodesk.Viewing.Viewer.prototype.uninitialize=function(){this.onDefaultContextMenu&&this.container.removeEventListener("contextmenu",this.onDefaultContextMenu,!1);this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container);this.container=null;this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null);this.config=this.clientContainer=null;this.listeners={};this.dockingPanels=[];this.contextMenuCallbacks=this.contextMenu=null;
window.removeEventListener("resize",this.onResizeCallback,!1);this.fireEvent({type:Autodesk.Viewing.VIEWER_UNINITIALIZED})};Autodesk.Viewing.Viewer.prototype.finish=function(){for(var a in this.loadedExtensions)this.unloadExtension(a);this.uninitialize()};Autodesk.Viewing.Viewer.prototype.setUp=function(a){if((this.config=a)&&this.config.hasOwnProperty("extensions")){a=this.config.extensions;for(var b=0;b<a.length;++b)this.loadExtension(a[b],this.config)}};
Autodesk.Viewing.Viewer.prototype.tearDown=function(){for(var a in this.loadedExtensions)this.unloadExtension(a)};Autodesk.Viewing.Viewer.prototype.loadExtension=function(a,b){var c=!1;if(this.isExtensionLoaded(a))stderr("Extension already loaded: "+a);else{var d=Autodesk.Viewing.theExtensionManager.getExtension(a);if(d){if(d=new d(this,b),c=d.load())this.loadedExtensions[a]=d,stderr("Extension loaded: "+a)}else stderr("Extension not found: "+a)}return c};
Autodesk.Viewing.Viewer.prototype.isExtensionLoaded=function(a){return a in this.loadedExtensions};Autodesk.Viewing.Viewer.prototype.getExtension=function(a){return a in this.loadedExtensions?this.loadedExtensions[a]:null};Autodesk.Viewing.Viewer.prototype.unloadExtension=function(a){var b=!1;this.isExtensionLoaded(a)?(b=this.loadedExtensions[a].unload(),stderr("Extension unloaded: "+a),delete this.loadedExtensions[a]):stderr("Extension not found: "+a);return b};
Autodesk.Viewing.Viewer.prototype.localize=function(){Autodesk.Viewing.i18n.localize()};Autodesk.Viewing.Viewer.prototype.addEventListener=function(a,b){"undefined"==typeof this.listeners[a]&&(this.listeners[a]=[]);this.listeners[a].push(b)};Autodesk.Viewing.Viewer.prototype.hasEventListener=function(a,b){if(void 0===this.listeners)return!1;var c=this.listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1};
Autodesk.Viewing.Viewer.prototype.removeEventListener=function(a,b){if(this.listeners[a]instanceof Array)for(var c=this.listeners[a],d=0,e=c.length;d<e;d++)if(c[d]===b){c.splice(d,1);break}};Autodesk.Viewing.Viewer.prototype.fireEvent=function(a){"string"==typeof a&&(a={type:a});a.target||(a.target=this);if(!a.type)throw Error("event type unknown.");if(this.listeners[a.type]instanceof Array)for(var b=this.listeners[a.type].slice(),c=0;c<b.length;c++)b[c].call(this,a)};
Autodesk.Viewing.Viewer.prototype.getDimensions=function(){if(this.container){var a={};this.getScreenMode()===Autodesk.Viewing.Viewer.ScreenMode.kFullScreen?(a.width=screen.width,a.height=screen.height):a=this.container.getBoundingClientRect();return{width:a.width,height:a.height}}return null};Autodesk.Viewing.Viewer.prototype.getState=function(a){throw"Implement getState() in derived class";};
Autodesk.Viewing.Viewer.prototype.restoreState=function(a,b,c){throw"Implement restoreState() in derived class";};Autodesk.Viewing.Viewer.prototype.setViewFromArray=function(a,b){};Autodesk.Viewing.Viewer.prototype.setViewFromViewBox=function(a,b){};Autodesk.Viewing.Viewer.prototype.setViewFromFile=function(){};Autodesk.Viewing.Viewer.prototype.resize=function(){this.resizePanels()};
Autodesk.Viewing.Viewer.prototype.addPanel=function(a){return-1===this.dockingPanels.indexOf(a)?(this.dockingPanels.push(a),!0):!1};Autodesk.Viewing.Viewer.prototype.removePanel=function(a){a=this.dockingPanels.indexOf(a);return-1<a?(this.dockingPanels.splice(a,1),!0):!1};
Autodesk.Viewing.Viewer.prototype.resizePanels=function(a){var b=a?a.viewer:null;b||(b=this);var c=a?a.dockingPanels:null;c||(c=b.dockingPanels);var d=b.container.getBoundingClientRect(),b=d.top,e=d.bottom,f=d.left,g=d.right,h;a&&a.dimensions?(h=a.dimensions.width,e=d=a.dimensions.height):(h=d.width,d=d.height);for(a=0;a<c.length;++a){var l=c[a].container,k=l.getBoundingClientRect(),m=k.top,m=k.bottom,p=k.left,p=k.right,r=k.width,k=k.height;if(r&&k){h<r&&(r=Math.round(h),l.style.width=r+"px");d<k&&
(k=Math.round(d),l.style.height=k+"px");if(g<p||l.dockRight)p=Math.round(g-r-f),l.style.left=p+"px";if(e<m||l.dockBottom)m=Math.round(e-k-b),0>m&&(m=0),l.style.top=m+"px";l.style.maxWidth=Math.round(h)+"px";l.style.maxHeight=Math.round(d)+"px"}}};Autodesk.Viewing.Viewer.prototype.search=function(a,b,c){};Autodesk.Viewing.Viewer.prototype.setContextMenu=function(a){this.contextMenu&&this.contextMenu.hide();this.contextMenu=a};
Autodesk.Viewing.Viewer.prototype.triggerContextMenu=function(a){if(this.config&&this.config.onTriggerContextMenuCallback)this.config.onTriggerContextMenuCallback();return this.contextMenu&&this.preContextMenuShow(a)?(this.contextMenu.show(a),!0):!1};
Autodesk.Viewing.Viewer.prototype.initContextMenu=function(){function a(a){var c=a.button;"buttons"in a&&(!b.__firefoxLMBfix||a.buttons&1?2===c&&a.buttons&1&&(c=0,b.__firefoxLMBfix=!0):(b.__firefoxLMBfix=!1,c=0));a=b.navigation&&b.navigation.getUseLeftHandedInput()?0:2;return c===a?!0:!1}var b=this,c=this.canvas||this.container;c.addEventListener("mousedown",function(c){a(c)&&(b.startX=c.clientX,b.startY=c.clientY)});c.addEventListener("mouseup",function(c){a(c)&&c.clientX===b.startX&&c.clientY===
b.startY&&b.triggerContextMenu(c);return!0},!1)};Autodesk.Viewing.Viewer.prototype.preContextMenuShow=function(a){return!0};Autodesk.Viewing.Viewer.prototype.registerContextMenuCallback=function(a,b){this.contextMenuCallbacks[a]=b};Autodesk.Viewing.Viewer.prototype.unregisterContextMenuCallback=function(a){return a in this.contextMenuCallbacks?(delete this.contextMenuCallbacks[a],!0):!1};
Autodesk.Viewing.Viewer.prototype.runContextMenuCallbacks=function(a,b){for(var c in this.contextMenuCallbacks)if(this.contextMenuCallbacks.hasOwnProperty(c))this.contextMenuCallbacks[c](a,b)};Autodesk.Viewing.Viewer.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2};Autodesk.Viewing.Viewer.prototype.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2};
Autodesk.Viewing.Viewer.prototype.setScreenModeDelegate=function(a){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null);this.screenModeDelegateClass=a?a:null===a?Autodesk.Viewing.NullScreenModeDelegate:Autodesk.Viewing.ApplicationScreenModeDelegate};Autodesk.Viewing.Viewer.prototype.getScreenModeDelegate=function(){this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this));return this.screenModeDelegate};
Autodesk.Viewing.Viewer.prototype.isScreenModeSupported=function(a){return this.getScreenModeDelegate().isModeSupported(a)};Autodesk.Viewing.Viewer.prototype.canChangeScreenMode=function(){return this.isScreenModeSupported(Autodesk.Viewing.Viewer.prototype.kNormal)};Autodesk.Viewing.Viewer.prototype.setScreenMode=function(a){return this.getScreenModeDelegate().setMode(a)};Autodesk.Viewing.Viewer.prototype.getScreenMode=function(){return this.getScreenModeDelegate().getMode()};
Autodesk.Viewing.Viewer.prototype.nextScreenMode=function(){var a=this.getScreenModeDelegate().getNextMode();return void 0!==a?this.setScreenMode(a):!1};Autodesk.Viewing.Viewer.prototype.escapeScreenMode=function(){var a=this.getScreenModeDelegate().getEscapeMode();return void 0!==a?this.setScreenMode(a):!1};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ErrorCodes={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,RTC_ERROR:11};var ENABLE_OCTM_MG2=!1,IS_WORKER="undefined"!==typeof self&&"undefined"===typeof window;
if(IS_WORKER){var debug=function(a){self.postMessage({debug:1,message:a})},f2d=null;IS_CONCAT_BUILD||(importScripts("../AutodeskNamespace.js"),importScripts("../compatibility.js"),importScripts("../../thirdparty/three.js/LmvMatrix4.js"),importScripts("../lmvtk/gunzip.min.js"),importScripts("../lmvtk/unzip.min.js"),ENABLE_OCTM_MG2&&(importScripts("../lmvtk/inflate.min.js"),importScripts("../lmvtk/octm_mg2.js")),importScripts("../lmvtk/BVHBuilder.js"),importScripts("../lmvtk/InputStream.js"),importScripts("../lmvtk/VbUtils.js"),
importScripts("../lmvtk/VertexBufferBuilder.js"),importScripts("../lmvtk/PackReader.js"),importScripts("../lmvtk/Geoms.js"),importScripts("../lmvtk/Materials.js"),importScripts("../lmvtk/Lights.js"),importScripts("../lmvtk/Cameras.js"),importScripts("../lmvtk/Fragments.js"),importScripts("../lmvtk/Instances.js"),importScripts("../lmvtk/Package.js"),importScripts("../lmvtk/PackReader.js"),importScripts("../lmvtk/Propdb.js"),importScripts("../lmvtk/F2d.js"),importScripts("../lmvtk/F2dProbe.js"),importScripts("../lmvtk/CheckedInputStream.js"),
importScripts("../net/Xhr.js"),importScripts("GeomWorker.js"),importScripts("SvfWorker.js"),importScripts("PropWorker.js"),importScripts("F2dParseWorker.js"),importScripts("F2dStreamWorker.js"),importScripts("CloudRenderingWorker.js"),importScripts("../application/Viewer.js"),importScripts("../ErrorCodes.js"));self.addEventListener("message",function(a){var b=a.data;if(b.hasOwnProperty("operation")){b.basePath="";if(b.url){var c=b.url.lastIndexOf("/");-1!=c&&(b.basePath=b.url.substr(0,c+1))}b.onFailureCallback=
function(a,b,c){403==a?self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED,"Access denied to remote resource",{url:c.url,httpStatus:a,httpStatusText:b}):404==a?self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:c.url,httpStatus:a,httpStatusText:b}):500<=a&&600>a?self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:c.url,httpStatus:a,httpStatusText:b}):c.exception?self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FAILURE,
"Network failure",{url:c.url,exception:c.exception.toString(),stack:c.exception.stack}):self.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",{url:c.url,httpStatus:a,httpStatusText:b})};b.errorHandler=new XhrErrorHandler(self);a=a.data.operation;"LOAD_GEOMETRY"==a?doGeomLoad(self,b):"LOAD_SVF"==a?doLoadSvf(self,b):"LOAD_SVF_CONTD"==a?doLoadSvfContinued(self,b):"GET_PROPERTIES"==a?doPropertyGet(self,b):"SEARCH_PROPERTIES"==a?doPropertySearch(self,
b):"GET_OBJECT_TREE"==a?doObjectTreeParse(self,b):"PARSE_F2D"==a?doParseF2D(self,b):"PARSE_F2D_FRAME"==a?doParseF2DFrame(self,b):"STREAM_F2D"==a?doStreamF2D(self,b):"CLOUD_RENDERING"==a?doCloudRendering(self,b):"SVF_TO_SPD"==a&&doSvfToSpd(self,b)}},!1);self.raiseError=function(a,b,c){self.postMessage({error:{code:a,msg:b,args:c}})}};
