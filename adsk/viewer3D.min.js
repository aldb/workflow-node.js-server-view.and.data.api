/*
 Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2014 Autodesk Inc.  Copyright (c) 2014 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2013 Autodesk Inc.  Copyright (c) 2014 Autodesk Inc.  Copyright (c) 2014 Autodesk Inc. */
var IS_CONCAT_BUILD=!0,BUILD_LMV_WORKER_URL="lmvworker.min.js",LMV_WORKER_URL=BUILD_LMV_WORKER_URL,ENABLE_DEBUG=!1,ENABLE_TRACE=!1,ENABLE_INLINE_WORKER=!0;AutodeskNamespace=function(a){var b=this;a=a.split(".");for(var c=0;c<a.length;++c)b[a[c]]=b[a[c]]||{},b=b[a[c]];return b};var _isIE11=!!navigator.userAgent.match(/Trident\/7\./);
"undefined"!==typeof window&&_isIE11&&function(){function a(a,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var f=document.createEvent("CustomEvent");f.initCustomEvent(a,c.bubbles,c.cancelable,c.detail);return f}a.prototype=window.CustomEvent.prototype;window.CustomEvent=a}();
ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){!b||b>this.byteLength?b=this.byteLength:0>b&&(b=this.byteLength+b,0>b&&(b=0));0>a&&(a=this.byteLength+a,0>a&&(a=0));if(b<=a)return new ArrayBuffer;for(var c=b-a,f=new Uint8Array(this,a,c),d=new Uint8Array(c),g=0;g<c;g++)d[g]=f[g];return d.buffer});"undefined"!==typeof window&&(window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);
function launchFullscreen(a,b){a.requestFullscreen?a.requestFullscreen(b):a.mozRequestFullScreen?a.mozRequestFullScreen(b):a.webkitRequestFullscreen?a.webkitRequestFullscreen(b):a.msRequestFullscreen&&a.msRequestFullscreen(b)}function exitFullscreen(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()}
function inFullscreen(){return document.fullscreenEnabled||document.mozFullScreenElement||document.webkitIsFullScreen||document.msFullscreenElement?!0:!1}function fullscreenElement(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function isFullscreenAvailable(a){return a.requestFullscreen||a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen}
function getAndroidVersion(a){a=a||navigator.userAgent;return(a=a.match(/Android\s([0-9\.]*)/))?a[1]:!1}function isTouchDevice(){return"ontouchstart"in window}function isIOSDevice(){return/ip(ad|hone|od)/.test(navigator.userAgent.toLowerCase())}function isAndroidDevice(){return-1!==navigator.userAgent.toLowerCase().indexOf("android")}function isMobileDevice(){return isIOSDevice()||isAndroidDevice()}
function detectWebGL(){if(window.WebGLRenderingContext){for(var a=document.createElement("canvas"),b=["webgl","experimental-webgl","moz-webgl","webkit-3d"],c=!1,f=0;4>f;f++)try{if((c=a.getContext(b[f]))&&"function"===typeof c.getParameter)return 1}catch(d){}return 0}return-1}function touchStartToClick(a){a.preventDefault();a.stopPropagation();a.target.click()}(function(){var a="undefined"!==typeof window&&null!==window?window:self;a.performance||(a.performance=Date)})();
"undefined"!==typeof window&&!function(a,b,c,f){function d(a,b,c){return setTimeout(q(a,c),b)}function g(a,b,c){return Array.isArray(a)?(h(a,c[b],c),!0):!1}function h(a,b,c){var d;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==f)for(d=0;d<a.length;)b.call(c,a[d],d,a),d++;else for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a)}function k(a,b,c){for(var d=Object.keys(b),g=0;g<d.length;)(!c||c&&a[d[g]]===f)&&(a[d[g]]=b[d[g]]),g++;return a}function l(a,b){return k(a,b,!0)}function n(a,b,c){var d=
b.prototype;b=a.prototype=Object.create(d);b.constructor=a;b._super=d;c&&k(b,c)}function q(a,b){return function(){return a.apply(b,arguments)}}function m(a,b){return typeof a==Ia?a.apply(b?b[0]||f:f,b):a}function p(a,b,c){h(D(b),function(b){a.addEventListener(b,c,!1)})}function t(a,b,c){h(D(b),function(b){a.removeEventListener(b,c,!1)})}function v(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function D(a){return a.trim().split(/\s+/g)}function w(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);
for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function F(a){return Array.prototype.slice.call(a,0)}function B(a,b,c){for(var d=[],g=[],f=0;f<a.length;){var h=b?a[f][b]:a[f];0>w(g,h)&&d.push(a[f]);g[f]=h;f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function z(a,b){for(var c,d,g=b[0].toUpperCase()+b.slice(1),h=0;h<Fa.length;){if(c=Fa[h],d=c?c+g:b,d in a)return d;h++}return f}function G(a){a=a.ownerDocument;return a.defaultView||a.parentWindow}
function A(a,b){var c=this;this.manager=a;this.callback=b;this.element=a.element;this.target=a.options.inputTarget;this.domHandler=function(b){m(a.options.enable,[a])&&c.handler(b)};this.init()}function E(a){var b=a.options.inputClass;return new (b?b:Ja?R:za?ba:ta?Y:K)(a,H)}function H(a,b,c){var d=c.pointers.length,g=c.changedPointers.length,h=b&ka&&0===d-g,d=b&(fa|qa)&&0===d-g;c.isFirst=!!h;c.isFinal=!!d;h&&(a.session={});c.eventType=b;b=a.session;h=c.pointers;d=h.length;b.firstInput||(b.firstInput=
I(c));1<d&&!b.firstMultiple?b.firstMultiple=I(c):1===d&&(b.firstMultiple=!1);var g=b.firstInput,k=(d=b.firstMultiple)?d.center:g.center,m=c.center=J(h);c.timeStamp=Aa();c.deltaTime=c.timeStamp-g.timeStamp;c.angle=N(k,m);c.distance=C(k,m);var g=c.center,k=b.offsetDelta||{},m=b.prevDelta||{},l=b.prevInput||{};(c.eventType===ka||l.eventType===fa)&&(m=b.prevDelta={x:l.deltaX||0,y:l.deltaY||0},k=b.offsetDelta={x:g.x,y:g.y});c.deltaX=m.x+(g.x-k.x);c.deltaY=m.y+(g.y-k.y);c.offsetDirection=L(c.deltaX,c.deltaY);
d?(g=d.pointers,g=C(h[0],h[1],Xa)/C(g[0],g[1],Xa)):g=1;c.scale=g;d?(d=d.pointers,h=N(h[1],h[0],Xa)-N(d[1],d[0],Xa)):h=0;c.rotation=h;k=b.lastInterval||c;h=c.timeStamp-k.timeStamp;c.eventType!=qa&&(h>Ba||k.velocity===f)?(g=k.deltaX-c.deltaX,k=k.deltaY-c.deltaY,m=g/h||0,l=k/h||0,h=m,d=l,m=aa(m)>aa(l)?m:l,g=L(g,k),b.lastInterval=c):(m=k.velocity,h=k.velocityX,d=k.velocityY,g=k.direction);c.velocity=m;c.velocityX=h;c.velocityY=d;c.direction=g;b=a.element;v(c.srcEvent.target,b)&&(b=c.srcEvent.target);
c.target=b;a.emit("hammer.input",c);a.recognize(c);a.session.prevInput=c}function I(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:ua(a.pointers[c].clientX),clientY:ua(a.pointers[c].clientY)},c++;return{timeStamp:Aa(),pointers:b,center:J(b),deltaX:a.deltaX,deltaY:a.deltaY}}function J(a){var b=a.length;if(1===b)return{x:ua(a[0].clientX),y:ua(a[0].clientY)};for(var c=0,d=0,g=0;b>g;)c+=a[g].clientX,d+=a[g].clientY,g++;return{x:ua(c/b),y:ua(d/b)}}function L(a,b){return a===b?wa:aa(a)>=aa(b)?0<
a?ya:Oa:0<b?Ca:ab}function C(a,b,c){c||(c=bb);var d=b[c[0]]-a[c[0]];a=b[c[1]]-a[c[1]];return Math.sqrt(d*d+a*a)}function N(a,b,c){c||(c=bb);return 180*Math.atan2(b[c[1]]-a[c[1]],b[c[0]]-a[c[0]])/Math.PI}function K(){this.evEl=Ra;this.evWin=Sa;this.allow=!0;this.pressed=!1;A.apply(this,arguments)}function R(){this.evEl=cb;this.evWin=fb;A.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}function T(){this.evTarget=gb;this.evWin=na;this.started=!1;A.apply(this,arguments)}function ba(){this.evTarget=
db;this.targetIds={};A.apply(this,arguments)}function X(a,b){var c=F(a.touches),d=this.targetIds;if(b&(ka|oa)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var g,f=F(a.changedTouches),h=[],k=this.target;if(g=c.filter(function(a){return v(a.target,k)}),b===ka)for(c=0;c<g.length;)d[g[c].identifier]=!0,c++;for(c=0;c<f.length;)d[f[c].identifier]&&h.push(f[c]),b&(fa|qa)&&delete d[f[c].identifier],c++;return h.length?[B(g.concat(h),"identifier",!0),h]:void 0}function Y(){A.apply(this,arguments);var a=
q(this.handler,this);this.touch=new ba(this.manager,a);this.mouse=new K(this.manager,a)}function W(a,b){this.manager=a;this.set(b)}function U(a){if(-1<a.indexOf(Ga))return Ga;var b=-1<a.indexOf(Ta),c=-1<a.indexOf(Ua);return b&&c?Ta+" "+Ua:b||c?b?Ta:Ua:-1<a.indexOf(Ha)?Ha:Va}function O(a){this.id=Na++;this.manager=null;this.options=l(a||{},this.defaults);a=this.options.enable;this.options.enable=a===f?!0:a;this.state=ia;this.simultaneous={};this.requireFail=[]}function da(a){return a==ab?"down":a==
Ca?"up":a==ya?"left":a==Oa?"right":""}function V(a,b){var c=b.manager;return c?c.get(a):a}function M(){O.apply(this,arguments)}function la(){M.apply(this,arguments);this.pY=this.pX=null}function ga(){M.apply(this,arguments)}function ja(){O.apply(this,arguments);this._input=this._timer=null}function Z(){M.apply(this,arguments)}function ea(){M.apply(this,arguments)}function ca(){O.apply(this,arguments);this.pCenter=this.pTime=!1;this._input=this._timer=null;this.count=0}function Q(a,b){b=b||{};var c=
b.recognizers;return b.recognizers=c===f?Q.defaults.preset:c,new ha(a,b)}function ha(a,b){b=b||{};this.options=l(b,Q.defaults);this.options.inputTarget=this.options.inputTarget||a;this.handlers={};this.session={};this.recognizers=[];this.element=a;this.input=E(this);this.touchAction=new W(this,this.options.touchAction);ma(this,!0);h(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]);a[3]&&b.requireFailure(a[3])},this)}function ma(a,b){var c=a.element;h(a.options.cssProps,
function(a,d){c.style[z(c.style,d)]=b?a:""})}function La(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0);d.gesture=c;c.target.dispatchEvent(d)}var Fa=" webkit moz MS ms o".split(" "),Wa=b.createElement("div"),Ia="function",ua=Math.round,aa=Math.abs,Aa=Date.now,Na=1,Da=/mobile|tablet|ip(ad|hone|od)|android/i,ta="ontouchstart"in a,Ja=z(a,"PointerEvent")!==f,za=ta&&Da.test(navigator.userAgent),Ba=25,ka=1,oa=2,fa=4,qa=8,wa=1,ya=2,Oa=4,Ca=8,ab=16,Ka=ya|Oa,Pa=Ca|ab,Da=Ka|Pa,bb=["x","y"],Xa=["clientX",
"clientY"];A.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler);this.evTarget&&p(this.target,this.evTarget,this.domHandler);this.evWin&&p(G(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&t(this.element,this.evEl,this.domHandler);this.evTarget&&t(this.target,this.evTarget,this.domHandler);this.evWin&&t(G(this.element),this.evWin,this.domHandler)}};var Ya={mousedown:ka,mousemove:oa,mouseup:fa},Ra="mousedown",Sa="mousemove mouseup";
n(K,A,{handler:function(a){var b=Ya[a.type];b&ka&&0===a.button&&(this.pressed=!0);b&oa&&1!==a.which&&(b=fa);this.pressed&&this.allow&&(b&fa&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:"mouse",srcEvent:a}))}});var Za={pointerdown:ka,pointermove:oa,pointerup:fa,pointercancel:qa,pointerout:qa},Qa={2:"touch",3:"pen",4:"mouse",5:"kinect"},cb="pointerdown",fb="pointermove pointerup pointercancel";a.MSPointerEvent&&(cb="MSPointerDown",fb="MSPointerMove MSPointerUp MSPointerCancel");
n(R,A,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),d=Za[d],g=Qa[a.pointerType]||a.pointerType,f="touch"==g,h=w(b,a.pointerId,"pointerId");d&ka&&(0===a.button||f)?0>h&&(b.push(a),h=b.length-1):d&(fa|qa)&&(c=!0);0>h||(b[h]=a,this.callback(this.manager,d,{pointers:b,changedPointers:[a],pointerType:g,srcEvent:a}),c&&b.splice(h,1))}});var eb={touchstart:ka,touchmove:oa,touchend:fa,touchcancel:qa},gb="touchstart",na="touchstart touchmove touchend touchcancel";n(T,A,
{handler:function(a){var b=eb[a.type];if(b===ka&&(this.started=!0),this.started){var c,d=F(a.touches);c=F(a.changedTouches);c=(b&(fa|qa)&&(d=B(d.concat(c),"identifier",!0)),[d,c]);b&(fa|qa)&&0===c[0].length-c[1].length&&(this.started=!1);this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}}});var xa={touchstart:ka,touchmove:oa,touchend:fa,touchcancel:qa},db="touchstart touchmove touchend touchcancel";n(ba,A,{handler:function(a){var b=xa[a.type],c=X.call(this,
a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:"touch",srcEvent:a})}});n(Y,A,{handler:function(a,b,c){var d="mouse"==c.pointerType;if("touch"==c.pointerType)this.mouse.allow=!1;else if(d&&!this.mouse.allow)return;b&(fa|qa)&&(this.mouse.allow=!0);this.callback(a,b,c)},destroy:function(){this.touch.destroy();this.mouse.destroy()}});var ib=z(Wa.style,"touchAction"),r=ib!==f,Va="auto",Ha="manipulation",Ga="none",Ta="pan-x",Ua="pan-y";W.prototype={set:function(a){"compute"==
a&&(a=this.compute());r&&(this.manager.element.style[ib]=a);this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return h(this.manager.recognizers,function(b){m(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){if(!r){var b=a.srcEvent;a=a.offsetDirection;if(this.manager.session.prevented)return void b.preventDefault();var c=this.actions,d=-1<c.indexOf(Ga),g=-1<c.indexOf(Ua),
c=-1<c.indexOf(Ta);return d||g&&a&Ka||c&&a&Pa?this.preventSrc(b):void 0}},preventSrc:function(a){this.manager.session.prevented=!0;a.preventDefault()}};var ia=1;O.prototype={defaults:{},set:function(a){return k(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(g(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=V(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return g(a,"dropRecognizeWith",
this)?this:(a=V(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(g(a,"requireFailure",this))return this;var b=this.requireFail;return a=V(a,this),-1===w(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(g(a,"dropRequireFailure",this))return this;a=V(a,this);a=w(this.requireFail,a);return-1<a&&this.requireFail.splice(a,1),this},hasRequireFailures:function(){return 0<this.requireFail.length},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},
emit:function(a){function b(g){c.manager.emit(c.options.event+(g?d&16?"cancel":d&8?"end":d&4?"move":d&2?"start":"":""),a)}var c=this,d=this.state;8>d&&b(!0);b();8<=d&&b(!0)},tryEmit:function(a){return this.canEmit()?this.emit(a):void(this.state=32)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(32|ia)))return!1;a++}return!0},recognize:function(a){a=k({},a);return m(this.options.enable,[this,a])?(this.state&56&&(this.state=ia),this.state=this.process(a),
void(this.state&30&&this.tryEmit(a))):(this.reset(),void(this.state=32))},process:function(){},getTouchAction:function(){},reset:function(){}};n(M,O,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&6;a=this.attrTest(a);return d&&(c&qa||!a)?b|16:d||a?c&fa?b|8:b&2?b|4:2:32}});n(la,M,{defaults:{event:"pan",threshold:10,pointers:1,direction:Da},getTouchAction:function(){var a=this.options.direction,
b=[];return a&Ka&&b.push(Ua),a&Pa&&b.push(Ta),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,g=a.direction,f=a.deltaX,h=a.deltaY;return g&b.direction||(b.direction&Ka?(g=0===f?wa:0>f?ya:Oa,c=f!=this.pX,d=Math.abs(a.deltaX)):(g=0===h?wa:0>h?Ca:ab,c=h!=this.pY,d=Math.abs(a.deltaY))),a.direction=g,c&&d>b.threshold&&g&b.direction},attrTest:function(a){return M.prototype.attrTest.call(this,a)&&(this.state&2||!(this.state&2)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX;
this.pY=a.deltaY;var b=da(a.direction);b&&this.manager.emit(this.options.event+b,a);this._super.emit.call(this,a)}});n(ga,M,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ga]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&2)},emit:function(a){(this._super.emit.call(this,a),1!==a.scale)&&this.manager.emit(this.options.event+(1>a.scale?"in":"out"),a)}});n(ja,O,{defaults:{event:"press",pointers:1,
time:500,threshold:5},getTouchAction:function(){return[Va]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,g=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!g||!c||a.eventType&(fa|qa)&&!f)this.reset();else if(a.eventType&ka)this.reset(),this._timer=d(function(){this.state=8;this.tryEmit()},b.time,this);else if(a.eventType&fa)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(a){8===this.state&&(a&&a.eventType&fa?this.manager.emit(this.options.event+
"up",a):(this._input.timeStamp=Aa(),this.manager.emit(this.options.event,this._input)))}});n(Z,M,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ga]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&2)}});n(ea,M,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Ka|Pa,pointers:1},getTouchAction:function(){return la.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;
return c&(Ka|Pa)?b=a.velocity:c&Ka?b=a.velocityX:c&Pa&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&aa(b)>this.options.velocity&&a.eventType&fa},emit:function(a){var b=da(a.direction);b&&this.manager.emit(this.options.event+b,a);this.manager.emit(this.options.event,a)}});n(ca,O,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[Ha]},process:function(a){var b=this.options,
c=a.pointers.length===b.pointers,g=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&ka&&0===this.count)return this.failTimeout();if(g&&f&&c){if(a.eventType!=fa)return this.failTimeout();c=this.pTime?a.timeStamp-this.pTime<b.interval:!0;g=!this.pCenter||C(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp;this.pCenter=a.center;g&&c?this.count+=1:this.count=1;this._input=a;if(0===this.count%b.taps)return this.hasRequireFailures()?(this._timer=d(function(){this.state=
8;this.tryEmit()},b.interval,this),2):8}return 32},failTimeout:function(){return this._timer=d(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});Q.VERSION="2.0.4";Q.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Z,{enable:!1}],[ga,{enable:!1},["rotate"]],[ea,{direction:Ka}],[la,{direction:Ka},
["swipe"]],[ca],[ca,{event:"doubletap",taps:2},["tap"]],[ja]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};ha.prototype={set:function(a){return k(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?2:1},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);
var c,d=this.recognizers,g=b.curRecognizer;(!g||g&&g.state&8)&&(g=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],2===b.stopped||g&&c!=g&&!c.canRecognizeWith(g)?c.reset():c.recognize(a),!g&&c.state&14&&(g=b.curRecognizer=c),f++}},get:function(a){if(a instanceof O)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(g(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),
a.manager=this,this.touchAction.update(),a},remove:function(a){if(g(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(w(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return h(D(a),function(a){c[a]=c[a]||[];c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return h(D(a),function(a){b?c[a].splice(w(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&La(a,b);var c=this.handlers[a]&&this.handlers[a].slice();
if(c&&c.length){b.type=a;b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ma(this,!1);this.handlers={};this.session={};this.input.destroy();this.element=null}};k(Q,{INPUT_START:ka,INPUT_MOVE:oa,INPUT_END:fa,INPUT_CANCEL:qa,STATE_POSSIBLE:ia,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:wa,DIRECTION_LEFT:ya,DIRECTION_RIGHT:Oa,DIRECTION_UP:Ca,DIRECTION_DOWN:ab,
DIRECTION_HORIZONTAL:Ka,DIRECTION_VERTICAL:Pa,DIRECTION_ALL:Da,Manager:ha,Input:A,TouchAction:W,TouchInput:ba,MouseInput:K,PointerEventInput:R,TouchMouseInput:Y,SingleTouchInput:T,Recognizer:O,AttrRecognizer:M,Tap:ca,Pan:la,Swipe:ea,Pinch:ga,Rotate:Z,Press:ja,on:p,off:t,each:h,merge:l,extend:k,inherit:n,bindFn:q,prefixed:z});a[c]=Q}(window,document,"Hammer");AutodeskNamespace("Autodesk.Viewing");
(function(){var a=Autodesk.Viewing;a.EventDispatcher=function(){};a.EventDispatcher.prototype={constructor:a.EventDispatcher,apply:function(b){b.addEventListener=a.EventDispatcher.prototype.addEventListener;b.hasEventListener=a.EventDispatcher.prototype.hasEventListener;b.removeEventListener=a.EventDispatcher.prototype.removeEventListener;b.fireEvent=a.EventDispatcher.prototype.fireEvent;b.dispatchEvent=a.EventDispatcher.prototype.fireEvent},addEventListener:function(a,c){void 0===this.listeners&&
(this.listeners={});"undefined"==typeof this.listeners[a]&&(this.listeners[a]=[]);this.listeners[a].push(c)},hasEventListener:function(a,c){if(void 0===this.listeners)return!1;var f=this.listeners;return void 0!==f[a]&&-1!==f[a].indexOf(c)?!0:!1},removeEventListener:function(a,c){void 0===this.listeners&&(this.listeners={});if(this.listeners[a]instanceof Array)for(var f=this.listeners[a],d=0,g=f.length;d<g;d++)if(f[d]===c){f.splice(d,1);break}},fireEvent:function(a){void 0===this.listeners&&(this.listeners=
{});"string"==typeof a&&(a={type:a});a.target||(a.target=this);if(!a.type)throw Error("event type unknown.");if(this.listeners[a.type]instanceof Array)for(var c=this.listeners[a.type].slice(),f=0;f<c.length;f++)c[f].call(this,a)}}})();AutodeskNamespace("Autodesk.Viewing.Private");
(function(){function a(a){for(var b in d)document.addEventListener(b,a,!1)}function b(a){for(var b in d)document.removeEventListener(b,a,!1)}var c=Autodesk.Viewing,f=Autodesk.Viewing.Private,d=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","MSFullscreenChange"];c.ScreenMode={kNormal:0,kFullBrowser:1,kFullScreen:2};c.ScreenModeDelegate=function(b){this.viewer=b;this.bindFullscreenEventListener=this.fullscreenEventListener.bind(this);this.getMode()===c.ScreenMode.kFullScreen&&a(this.bindFullscreenEventListener)};
c.ScreenModeDelegate.prototype.uninitialize=function(){b(this.bindFullscreenEventListener);this.viewer=null};c.ScreenModeDelegate.prototype.isModeSupported=function(a){return!0};c.ScreenModeDelegate.prototype.setMode=function(a){var b=this.getMode();return a!==b&&this.isModeSupported(a)?(this.doScreenModeChange(b,a),this.onScreenModeChanged(b,a),!0):!1};c.ScreenModeDelegate.prototype.getMode=function(){throw"Implement getMode() in derived class";};c.ScreenModeDelegate.prototype.getNextMode=function(){var a=
this.getMode(),b,d=c.ScreenMode;a===d.kNormal&&this.isModeSupported(d.kFullBrowser)?b=d.kFullBrowser:a===d.kNormal&&this.isModeSupported(d.kFullScreen)?b=d.kFullScreen:a===d.kFullBrowser&&this.isModeSupported(d.kFullScreen)?b=d.kFullScreen:a===d.kFullBrowser&&this.isModeSupported(d.kNormal)?b=d.kNormal:a===d.kFullScreen&&this.isModeSupported(d.kNormal)?b=d.kNormal:a===d.kFullScreen&&this.isModeSupported(d.kFullBrowser)&&(b=d.kFullBrowser);return b};c.ScreenModeDelegate.prototype.getEscapeMode=function(){return this.getMode()!==
c.ScreenMode.kNormal?c.ScreenMode.kNormal:void 0};c.ScreenModeDelegate.prototype.fullscreenEventListener=function(){if(inFullscreen())this.viewer.resize();else{var a=c.ScreenMode;this.doScreenModeChange(a.kFullScreen,a.kNormal);this.onScreenModeChanged(a.kFullScreen,a.kNormal)}};c.ScreenModeDelegate.prototype.doScreenModeChange=function(a,b){throw"Implement doScreenModeChange() in derived class";};c.ScreenModeDelegate.prototype.onScreenModeChanged=function(d,f){d===c.ScreenMode.kFullScreen?b(this.bindFullscreenEventListener):
f===c.ScreenMode.kFullScreen&&a(this.bindFullscreenEventListener);this.viewer.resize();this.viewer.fireEvent({type:c.FULLSCREEN_MODE_EVENT,mode:f})};c.ApplicationScreenModeDelegate=function(a){c.ScreenModeDelegate.call(this,a)};c.ApplicationScreenModeDelegate.prototype=Object.create(c.ScreenModeDelegate.prototype);c.ApplicationScreenModeDelegate.prototype.constructor=c.ApplicationScreenModeDelegate;c.ApplicationScreenModeDelegate.prototype.isModeSupported=function(a){return a!==c.ScreenMode.kFullBrowser};
c.ApplicationScreenModeDelegate.prototype.getMode=function(){return inFullscreen()?c.ScreenMode.kFullScreen:c.ScreenMode.kNormal};c.ApplicationScreenModeDelegate.prototype.doScreenModeChange=function(a,b){var d=this.viewer.container;b===c.ScreenMode.kNormal?(d.classList.remove("viewer-fill-browser"),exitFullscreen()):b===c.ScreenMode.kFullScreen&&(d.classList.add("viewer-fill-browser"),launchFullscreen(d))};c.NullScreenModeDelegate=function(a){c.ScreenModeDelegate.call(this,a)};c.NullScreenModeDelegate.prototype=
Object.create(c.ScreenModeDelegate.prototype);c.NullScreenModeDelegate.prototype.constructor=c.ScreenModeDelegate;c.NullScreenModeDelegate.prototype.isModeSupported=function(a){return!1};c.NullScreenModeDelegate.prototype.getMode=function(){return c.ScreenMode.kNormal};c.ScreenModeMixin=function(){};c.ScreenModeMixin.prototype={setScreenModeDelegate:function(a){this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null);this.screenModeDelegateClass=a?a:null===a?
c.NullScreenModeDelegate:c.ApplicationScreenModeDelegate},getScreenModeDelegate:function(){this.screenModeDelegate||(this.screenModeDelegate=new this.screenModeDelegateClass(this));return this.screenModeDelegate},isScreenModeSupported:function(a){return this.getScreenModeDelegate().isModeSupported(a)},canChangeScreenMode:function(){return this.isScreenModeSupported(Autodesk.Viewing.ScreenMode.kNormal)},setScreenMode:function(a){var b=f.logger;b&&b.log({category:"screen_mode",value:a});return this.getScreenModeDelegate().setMode(a)},
getScreenMode:function(){return this.getScreenModeDelegate().getMode()},nextScreenMode:function(){var a=this.getScreenModeDelegate().getNextMode();return void 0!==a?this.setScreenMode(a):!1},escapeScreenMode:function(){var a=this.getScreenModeDelegate().getEscapeMode();return void 0!==a?this.setScreenMode(a):!1},apply:function(a){var b=c.ScreenModeMixin.prototype;a.setScreenModeDelegate=b.setScreenModeDelegate;a.getScreenModeDelegate=b.getScreenModeDelegate;a.isScreenModeSupported=b.isScreenModeSupported;
a.canChangeScreenMode=b.canChangeScreenMode;a.setScreenMode=b.setScreenMode;a.getScreenMode=b.getScreenMode;a.nextScreenMode=b.nextScreenMode;a.escapeScreenMode=b.escapeScreenMode}}})();AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.inWorkerThread="undefined"!==typeof self&&"undefined"===typeof window;a.ViewingService={};a.ViewingService.shouldRefreshToken=function(a){var c=!1;if(401===a.statusCode){a=a.responseText;try{var f=a?JSON.parse(a):{}}catch(d){}c=!a||f.errorCode&&"AUTH-006"===f.errorCode}else c=403===a.statusCode;return c};a.ViewingService.refreshToken=function(b,c){a.inWorkerThread?(self.addEventListener("message",function(a){a.data&&a.data.tokenRefreshed?b(a):c(a)}),self.postMessage({refreshToken:!0})):
a.refreshTokenAndCookie(b,c)};a.ViewingService.generateUrl=function(b,c,f){if(0!==f.indexOf("urn:"))return f;b+="/";"items"!==c&&(f=f.substr(4));return b="bubbles"===c?0==a.env.indexOf("Autodesk")?b+f:b+(c+"/"+f):b+(c+"/"+encodeURIComponent(f))};a.ViewingService.get=function(b,c,f,d,g,h){h=h?h:{};f=a.ViewingService.generateUrl(b,c,f);h.queryParams&&(f=f+"?"+h.queryParams);var k=new XMLHttpRequest;try{var l=function(a){200===k.status?d(k.response?k.response:k.responseText):n(a)},n=function(m){!h.retriedOnce&&
a.ViewingService.shouldRefreshToken(k)?a.ViewingService.refreshToken(function(k){h.retriedOnce=!0;a.ViewingService.get(b,c,f,d,g,h)},function(a){g(k.status,k.statusText,{url:f})}):g(k.status,k.statusText,{url:f})},q=h.hasOwnProperty("asynchronous")?h.asynchronous:!0;k.open("GET",f,q);h.hasOwnProperty("responseType")&&(k.responseType=h.responseType);k.withCredentials=!0;h.hasOwnProperty("withCredentials")&&(k.withCredentials=h.withCredentials);if(h.headers)for(var m in h.headers)k.setRequestHeader(m,
h.headers[m]);q&&(k.onload=l,k.onerror=n,k.ontimeout=n);k.send();a.inWorkerThread?self.postMessage({assetRequest:[f,h.headers,null]}):a.assets.push([f,h.headers,null]);q||l(null)}catch(p){g(k.status,k.statusText,{url:f,exception:p})}}})();
var Xhr=function(){var a=function(a,c,f){this.xhr=new XMLHttpRequest;this.errorHandler=a;this.success=!1;this.viewing_url=f;this.auth=c};a.prototype.generateUrl=function(a,c,f){var d=a.indexOf("urn:");0===d&&this.viewing_url&&((f=f&&f.feature?f.feature:null)?"render"==f?(a=a.substr(4),a=this.viewing_url+"/"+f+"/"+encodeURIComponent(a)):"bubbles"==f?(a=a.substr(4),a=this.viewing_url+"/"+f+"/"+encodeURIComponent(a)):"comments"==f?(a=a.substr(4),a=this.viewing_url+"/"+f+"/file/"+encodeURIComponent(a)):
a=this.viewing_url+"/"+f+"/"+encodeURIComponent(a.substr(d)):a=this.viewing_url+"/items/"+encodeURIComponent(a.substr(d)));c&&(a=a+"?"+c);return a};a.prototype.addHeaders=function(a){for(var c in a)this.xhr.setRequestHeader(c,a[c])};a.prototype.get=function(a,c,f,d,g,h){a=this.generateUrl(a,h,{feature:g});try{this.xhr.open("GET",a,!!d),this.xhr.responseType=f,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),d&&(this.xhr.onload=d),this.addHeaders(c),this.xhr.send()}catch(k){return this.errorHandler&&
this.errorHandler.networkFailure(a,k),null}this.errorCheck(a,200);return this.xhr.response};a.prototype.post=function(a,c,f,d,g,h){a=this.generateUrl(a,null,{feature:h});c["Content-Type"]||(c["Content-Type"]="application/json");try{this.xhr.open("POST",a,!!g),this.xhr.responseType=d,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),g&&(this.xhr.onload=g),this.addHeaders(c),this.xhr.send(f)}catch(k){return this.errorHandler&&this.errorHandler.networkFailure(a,k),null}this.errorCheck(a,200,201);
return this.xhr.response};a.prototype.getRange=function(a,c,f,d,g,h){a=this.generateUrl(path);c.Range="bytes="+d+"-"+g;try{this.xhr.open("GET",a,!!h),this.xhr.responseType=f,this.success=!1,this.auth&&(this.xhr.withCredentials=!0),h&&(this.xhr.onload=h),this.addHeaders(c),this.xhr.send()}catch(k){return this.errorHandler&&this.errorHandler.networkFailure(a,k),null}this.errorCheck(a,206);return this.xhr.response};a.prototype.head=function(a){a=this.generateUrl(path);try{this.xhr.open("GET",a,!1),this.success=
!1,this.auth&&(this.xhr.withCredentials=!0),this.addHeaders([]),this.xhr.send()}catch(c){return this.errorHandler&&this.errorHandler.networkFailure(a,c),null}this.errorCheck(a,200);a=[];a["Accept-Ranges"]=this.xhr.getResponseHeader("Accept-Ranges");a["Content-Length"]=this.xhr.getResponseHeader("Content-Length");return a};a.prototype.errorCheck=function(a,c){if(4===this.xhr.readyState&&this.xhr.status){var f;for(f=1;f<arguments.length&&this.xhr.status!==arguments[f];f++);f===arguments.length&&this.errorHandler?
this.errorHandler.unsuccessfulResponse(a,this.xhr.status,this.xhr.statusText):this.success=!0}else this.success=!0};return a}(),XhrErrorHandler=function(){var a=function(a){this.host=a;this.ignoreFileNotFound=!1};a.prototype.networkFailure=function(a,c){this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FAILURE,"Network failure",{url:a,exception:c.toString(),stack:c.stack})};a.prototype.unsuccessfulResponse=function(a,c,f){403==c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED,
"Access denied to remote resource",{url:a,httpStatus:c,httpStatusText:f}):404==c?this.ignoreFileNotFound||this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND,"Remote resource not found",{url:a,httpStatus:c,httpStatusText:f}):500<=c&&600>c?this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR,"Server error when accessing resource",{url:a,httpStatus:c,httpStatusText:f}):this.host.raiseError(Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE,"Unhandled response code from server",
{url:a,httpStatus:c,httpStatusText:f})};return a}();
if("undefined"!==typeof window){var trace=function(a){"\n"==a[a.length-1]&&(a=a.substring(0,a.length-1));console.log((performance.now()/1E3).toFixed(3)+": "+a)},RTCPeerConnection=null,getUserMedia=null,attachMediaStream=null,reattachMediaStream=null,webrtcDetectedBrowser=null,webrtcDetectedVersion=null;if(navigator.mozGetUserMedia)webrtcDetectedBrowser="firefox",webrtcDetectedVersion=parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]),RTCPeerConnection=mozRTCPeerConnection,RTCSessionDescription=
mozRTCSessionDescription,RTCIceCandidate=mozRTCIceCandidate,getUserMedia=navigator.mozGetUserMedia.bind(navigator),createIceServer=function(a,b,c){var f=null,d=a.split(":");0===d[0].indexOf("stun")?f={url:a}:0!==d[0].indexOf("turn")||-1===a.indexOf("transport=udp")&&-1!==a.indexOf("?transport")||(f={url:a.split("?")[0],credential:c,username:b});return f},attachMediaStream=function(a,b){console.log("Attaching media stream");a.mozSrcObject=b;a.play()},reattachMediaStream=function(a,b){console.log("Reattaching media stream");
a.mozSrcObject=b.mozSrcObject;a.play()},MediaStream.prototype.getVideoTracks=function(){return[]},MediaStream.prototype.getAudioTracks=function(){return[]};else if(navigator.webkitGetUserMedia){var match=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./),webrtcDetectedBrowser="chrome",webrtcDetectedVersion=match?parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2]):40;createIceServer=function(a,b,c){var f=null,d=a.split(":");0===d[0].indexOf("stun")?f={url:a}:0===d[0].indexOf("turn")&&
(28>webrtcDetectedVersion?(a=a.split("turn:"),f={url:"turn:"+b+"@"+a[1],credential:c}):f={url:a,credential:c,username:b});return f};RTCPeerConnection=webkitRTCPeerConnection;getUserMedia=navigator.webkitGetUserMedia.bind(navigator);attachMediaStream=function(a,b){"undefined"!==typeof a.srcObject?a.srcObject=b:"undefined"!==typeof a.mozSrcObject?a.mozSrcObject=b:"undefined"!==typeof a.src?a.src=URL.createObjectURL(b):console.log("Error attaching stream to element.")};reattachMediaStream=function(a,
b){a.src=b.src};webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks},webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks});webkitRTCPeerConnection.prototype.getLocalStreams||(webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})}else console.log("Browser does not appear to be WebRTC-capable")}AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.config={userName:""};a.setUserName=function(b){a.config.userName=b};a.MessageClient=function(b,f){function d(){return a.config.userName&&a.config.userName.length?a.config.userName:n?n.slice(0,5):"Unknown"}function g(a){switch(a.type){case "txt":if(0==a.msg.indexOf("/nick ")){var b=m.getUserById(a.from,a.roomId),c=a.msg.slice(6);c.length&&(b.name=c,b.id==n&&(b.name+=" (you)"));m.dispatchEvent({type:"userListChange",data:a,channelId:a.roomId})}break;case "joinok":b=
q[a.roomId];stderr("joined channel "+a.roomId);b.users=a.users&&a.users.length?a.users:[];for(c=0;c<b.users.length;c++)b.users[c].name&&b.users[c].name.length||(b.users[c].name=b.users[c].id.slice(0,5));var c=d(),g={id:n,name:c+" (you)",isSelf:!0,status:0};b.userSet[n]||(b.users.push(g),b.userSet[n]=g);0!=g.id.indexOf(c)&&m.sendChatMessage("/nick "+c,a.roomId);break;case "join_error":break;case "sessionId":stderr("Connect successful, your id is: "+a.id);n=a.id;break;case "joined":a.userStatus="joined";
a.user.name&&a.user.name.length||(a.user.name=a.user.id.slice(0,5));a.roomId&&((b=q[a.roomId])?(b.users.push(a.user),stderr(a.user+" joined room "+a.roomId)):stderr("Channel "+a.roomId+" does not exist for socket "+n));break;case "left":a.userStatus="left";stderr(a.user+" left room "+a.room);for(b in q){for(var c=q[b].users,g=-1,f=0;f<c.length;f++)if(c[f].id==a.user){g=f;break}-1!=g&&c.splice(g,1);delete q[b].userSet[a.user]}break;case "camera":case "pointer":break;default:stderr(a)}m.dispatchEvent({type:k[a.type],
data:a,channelId:a.roomId})}function h(a){m.dispatchEvent({type:"socketError",data:a})}var k={camera:"cameraChange",pointer:"pointerMove",joystick:"joystick",state:"viewerState",txt:"chatReceived",joinok:"userListChange",sessionId:"connectSucceeded",joined:"userListChange",left:"userListChange","private":"privateMessage",join_error:"socketError"},l,n=null,q={},m=this;this.connect=function(a){if(!l)return"undefined"!==typeof window.WebSocket?(this.sessionID=a,l=io.connect(b+"?sessionID="+a,{path:f,
forceNew:!0}),l.on("message",g),l.on("connect_error",h),l.on("error",h),!0):!1};this.join=function(a){q[a]={id:a,users:[],userSet:{}};l||this.connect();l.emit("join",{roomId:a,name:d()})};this.disconnect=function(){l&&(l.disconnect(),l=null,q={},n=null)};this.sendMessage=function(a,b,c){l.emit("message",{type:a,from:n,msg:b,roomId:c})};this.sendPrivateMessage=function(a,b){l.emit("message",{type:"private",target:a,from:n,msg:b})};this.sendChatMessage=function(a,b){var c={type:"txt",from:n,msg:a,roomId:b};
l.emit("message",c);g(c)};this.getUserById=function(a,b){for(var c=q[b].users,d=0;d<c.length;d++)if(c[d].id==a)return c[d];return null};this.getLocalId=function(){return n};this.getChannelInfo=function(a){return q[a]};this.isConnected=function(){return l}};a.MessageClient.prototype.constructor=a.MessageClient;Autodesk.Viewing.EventDispatcher.prototype.apply(a.MessageClient.prototype);var b={};a.MessageClient.GetInstance=function(c,f){c||(c=a.EnvironmentConfigurations[a.env].RTC);var d=b[c];if(d)return d;
d=new a.MessageClient(c,f);return b[c]=d}})();AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.P2PClient=function(a){function c(a){try{q=new RTCPeerConnection(w),q.onicecandidate=function(a){a.candidate?n.sendPrivateMessage(p,{type:"candidate",label:a.candidate.sdpMLineIndex,id:a.candidate.sdpMid,candidate:a.candidate.candidate}):stderr("End of candidates.")},q.ondatachannel=function(a){stderr("Data channel added.");v=a.channel;v.onmessage=h;l.dispatchEvent({type:"dataChannelAdded",data:a.channel})},q.onaddstream=function(a){stderr("Remote stream added.");
l.dispatchEvent({type:"remoteStreamAdded",data:a.stream})},q.onremovestream=function(a){stderr("Remote stream removed. Event: ",a);l.dispatchEvent({type:"remoteStreamRemoved",data:a.stream})},a&&(v=q.createDataChannel("sendDataChannel",{reliable:!1,ordered:!1}),v.onmessage=h)}catch(b){stderr("Failed to create PeerConnection, exception: "+b.message),alert("Cannot create RTCPeerConnection object.")}}function f(a){stderr("createOffer() error: ",e)}function d(a){q.setLocalDescription(a);n.sendPrivateMessage(p,
a);if(D.length){for(a=0;a<D.length;a++)q.addIceCandidate(D[a]);D=[]}}function g(a){a=a.split("\n");for(var b=!1,c=!1,d=!1,g=0;g<a.length;g++)0==a[g].indexOf("a=mid:data")&&(b=!0),0==a[g].indexOf("a=mid:video")&&(d=!0),0==a[g].indexOf("a=mid:audio")&&(c=!0);return b&&!d&&!c}function h(a){a=JSON.parse(a.data);switch(a.type){case "camera":l.dispatchEvent({type:"cameraChange",data:a});break;case "joystick":l.dispatchEvent({type:"joystick",data:a});break;case "state":l.dispatchEvent({type:"viewerState",
data:a})}}function k(){m=!1;q.close();p=t=q=null}var l=this,n=a,q,m=!1,p,t,v,D=[],w={iceServers:[{url:"stun:stun.l.google.com:19302"}]},F={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},B={mandatory:{OfferToReceiveAudio:!1,OfferToReceiveVideo:!1}};n.addEventListener("privateMessage",function(a){var b=a.data.msg;stderr("Client received message:"+JSON.stringify(b));"offer"!=b.type||m?"answer"===b.type&&m?q.setRemoteDescription(new RTCSessionDescription(b)):"candidate"===b.type?(a=new RTCIceCandidate({sdpMLineIndex:b.label,
candidate:b.candidate}),m?q.addIceCandidate(a):D.push(a)):"bye"===b&&m&&(l.dispatchEvent({type:"remoteHangup",data:null}),stderr("Session terminated."),k()):(stderr("Received offer. Accepting."),l.receiveCall(a.data))});this.hangup=function(){stderr("Hanging up.");m&&(n.sendPrivateMessage(p,"bye"),k())};this.initUserMedia=function(a){var b={video:!0,audio:!0};window.getUserMedia(b,function(b){stderr("Adding local stream.");a&&a(b);l.dispatchEvent({type:"localStreamAdded",data:b})},function(a){stderr("getUserMedia error: ",
a)});stderr("Getting user media with constraints",b)};this.callUser=function(a,b){p?stderr("Already in a call. Ignoring call request."):(p=a,stderr("Calling user "+p),b?(c(!0),m=!0,stderr("Sending data channel offer to peer"),q.createOffer(d,f)):this.initUserMedia(function(a){t=a;m||"undefined"==typeof t||(c(!1),q.addStream(t),m=!0,stderr("Sending audio/video offer to peer"),q.createOffer(d,f))}))};this.receiveCall=function(a){p=a.from;p||(p=a.senderId);g(a.msg.sdp)?(c(!0),m=!0,q.setRemoteDescription(new RTCSessionDescription(a.msg)),
stderr("Sending data-only answer to peer."),q.createAnswer(d,null,B)):this.initUserMedia(function(b){t=b;m||"undefined"==typeof t||(c(!1),q.addStream(t),m=!0);q.setRemoteDescription(new RTCSessionDescription(a.msg));stderr("Sending audio+video answer to peer.");q.createAnswer(d,null,F)})};this.getCurrentCallTarget=function(){return p};this.dataChannel=function(){return v}};a.P2PClient.prototype.constructor=a.P2PClient;Autodesk.Viewing.EventDispatcher.prototype.apply(a.P2PClient.prototype)})();AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.Logger=function(b){this.queue=[];b.eventCallback&&(this.callback=b.eventCallback);this.sessionId=b.sessionId;if(!this.sessionId){var c=Date.now()+"";this.sessionId=parseFloat((1E4*Math.random()|0)+""+c.substring(4))}this.endpoint=b.endpoint?b.endpoint+"/logs":null;this.flushThreshold=b.flushThreshold||10;this.ready=!1;this.retries=0;this.lastFlushTime=Date.now();this.heartbeat=null;b={category:"viewer_start",touch:isTouchDevice(),env:a.env,referer:window.location.href,
version:LMV_VIEWER_VERSION};this.log(b)};a.Logger.prototype.setupWS=function(){var a=this;a.reconnectPending=!1;if(this.endpoint){stderr("Opening web socket.");var c=function(){a.ready=!0;a.lastConnectTime=Date.now();stderr("Web socket opened successfully.");0<a.retries&&(a.retries=0,a.socket.send({category:"reconnect",sessionId:this.sessionId}));a.flush()},f=function(){a.reconnectPending||a.xhr||(a.ready=!1,3>a.retries?(stderr("Attempting web socket reconnect."),a.retries++,a.reconnectPending=!0,
setTimeout(function(){a.setupWS()},3E3)):(stderr("Giving up on web sockets. Trying POST."),a.setupXHR()))},d=function(a){console.log(a.message);f()},g=function(c){6E4<Date.now()-a.lastConnectTime?(stderr("Web socket closed due to inactivity."),a.socket=null,a.ready=!1,a.retries=0):f()};try{this.socket=new WebSocket("wss://"+this.endpoint,"lmv-log-v1"),this.socket.onopen=c,this.socket.onerror=d,this.socket.onclose=g,this.socket.onmessage=function(a){console.log(a.data)}}catch(h){a.setupXHR()}}};a.Logger.prototype.setupXHR=
function(){this.socket=null;this.xhr=new XMLHttpRequest;this.ready=!0;this.retries=0;this.flush();var a=this;this.heartbeat&&clearInterval(this.heartbeat);this.heartbeat=setInterval(function(){a.flush()},6E4);"undefined"!==typeof window&&window.addEventListener("beforeunload",function(){a.log({category:"viewer_stop"},!0)})};a.Logger.prototype.flush=function(){if(!(2<this.retries)&&this.queue.length&&this.ready){var a=this,c=this.queue;this.queue=[];var f=JSON.stringify(c);if(this.socket)try{this.socket.send(f)}catch(d){}else if(this.endpoint)try{var g=
this.xhr;g.open("POST","https://"+this.endpoint,!0);g.send(f);g.onreadystatechange=function(){4==g.readyState&&200!==g.status&&(a.retries++,a.queue.unshift(c))}}catch(h){}else stderr(this.queue);this.lastFlushTime=Date.now()}};a.Logger.prototype.log=function(a,c){this.callback&&this.callback(a);2<this.retries||(a.timestamp=Date.now(),a.sessionId=this.sessionId,this.queue.push(a),this.socket||this.ready?(this.socket||this.queue.length>this.flushThreshold||6E4<a.timestamp-this.lastFlushTime||c)&&this.flush():
this.setupWS())}})();
var Autocam=Autocam||function(a,b,c,f,d){function g(b){D=!0;a.target.copy(m.center);a.pivot.copy(m.pivot);a.worldup?a.worldup.copy(m.sceneUpDirection):a.up.copy(m.sceneUpDirection);f&&f(b);D=!1}function h(a,b){var c=new THREE.Vector2(0,0);c.x=a/window.innerWidth;c.y=b/window.innerHeight;return c}function k(a,b,c){var d,g,f,h=0,k=null,l=null,n=m.snapOrbitDeadZone,q=m.orbitMultiplier;"h"==a?(a=m.snapOrbitThresholdH,d=m.snapOrbitAccelerationAX,g=m.snapOrbitAccelerationBX,f=1-m.snapOrbitAccelerationPointX,l=
m.lockDeltaX,k=m.lockedX):(a=m.snapOrbitThresholdV,d=m.snapOrbitAccelerationAY,g=m.snapOrbitAccelerationBY,f=1-m.snapOrbitAccelerationPointY,l=m.lockDeltaY,k=m.lockedY);k?(l+=c,l<-n?h=(l+n)*q*1/g:l>n&&(h=(l-n)*q*1/g)):(h=Math.abs(b)>a?c*q:Math.abs(b)>f*a?0<c*b?c*q*d:c*q*1/d:0<c*b?c*q*g:c*q*1/g,0<h*b&&Math.abs(h)>Math.abs(b)&&(this.lockDeltaX=this.lockDeltaY=0,h=b));return h}function l(a,b){var c=!1,d=window.innerWidth,g=a.x%d,f=window.innerHeight,h=a.y%f,f=0<h?h-b.y:f+h-b.y;30>Math.abs(0<g?g-b.x:
d+g-b.x)&&30>Math.abs(f)&&(c=!0);return c}function n(a,b,c){if(!ba||!a){if(a){var d=new THREE.Vector2;d.x=(b.x-c.x)/window.innerWidth;b.x=c.x+(b.x-c.x)%window.innerWidth;d.y=(b.y-c.y)/window.innerHeight;b.y=c.y+(b.y-c.y)%window.innerHeight}ba=a}}function q(a){var b=m.sceneFrontDirection.clone().cross(m.sceneUpDirection),c=Math.abs(Math.abs(a.dot(m.sceneUpDirection))-1),d=Math.abs(Math.abs(a.dot(m.sceneFrontDirection))-1);a=Math.abs(Math.abs(a.dot(b))-1);return 1E-5>c||1E-5>d||1E-5>a}var m=this,p=
null,t=null,v=null,D=!1;this.camera=a;this.renderer="WEBGL";this.startState={};this.navApi=b;this.orthographicFaces=!1;var w=Date.now(),F,B=!1;this.showPivot=function(a){d&&d(a)};this.setViewCubeContainer=function(a){v=a};this.setWorldUpVector=function(a){!D&&a&&0<a.lengthSq()&&!a.normalize().equals(this.sceneUpDirection)&&(this.sceneUpDirection.copy(a),this.sceneFrontDirection.copy(this.getWorldFrontVector()),this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize(),
p&&requestAnimationFrame(p.render))};this.getWorldUpVector=function(){return this.sceneUpDirection.clone()};this.getWorldRightVector=function(){var a=this.sceneUpDirection.clone();Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):0<=a.z?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x);return a.normalize()};this.getWorldFrontVector=function(){return this.getWorldUpVector().cross(this.getWorldRightVector()).normalize()};this.goToView=function(a){this.navApi.getIsLocked()||(a={position:a.position.clone(),up:a.up.clone(),
center:a.center.clone(),pivot:a.pivot.clone(),fov:a.fov,worldUp:a.worldUp.clone(),isOrtho:a.isOrtho},m.elapsedTime=0,this.animateTransition(a))};this.getCurrentView=function(){return{position:a.position.clone(),up:a.up.clone(),center:this.center.clone(),pivot:this.pivot.clone(),fov:a.fov,worldUp:this.sceneUpDirection.clone(),isOrtho:!1===a.isPerspective}};this.setCurrentViewAsHome=function(a){a?(this.navApi.setRequestFitToView(!0),B=!0):this.homeVector=this.getCurrentView()};this.setHomeViewFrom=
function(a){var b=a.pivot?a.pivot:this.center,c=a.target?a.target:this.pivot,d=a.worldup?a.worldup:this.sceneUpDirection;this.homeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone(),isOrtho:!1===a.isPerspective};this.originalHomeVector={position:a.position.clone(),up:a.up.clone(),center:c.clone(),pivot:b.clone(),fov:a.fov,worldUp:d.clone(),worldFront:this.sceneFrontDirection.clone(),isOrtho:!1===a.isPerspective}};this.toPerspective=function(){a.isPerspective||
(a.toPerspective(),g(!1))};this.toOrthographic=function(){a.isPerspective&&(a.toOrthographic(),g(!1))};this.setOrthographicFaces=function(a){this.orthographicFaces=a};this.goHome=function(){this.navApi.getIsLocked()||(this.navApi.setPivotSetFlag(!1),this.goToView(this.homeVector))};this.resetHome=function(){this.homeVector.position.copy(this.originalHomeVector.position);this.homeVector.up.copy(this.originalHomeVector.up);this.homeVector.center.copy(this.originalHomeVector.center);this.homeVector.pivot.copy(this.originalHomeVector.pivot);
this.homeVector.fov=this.originalHomeVector.fov;this.homeVector.worldUp.copy(this.originalHomeVector.worldUp);this.homeVector.isOrtho=this.originalHomeVector.isOrtho;this.goHome()};this.getView=function(){return this.center.clone().sub(a.position)};this.setCameraUp=function(b){var c=this.dir.clone(),d=c.cross(b).normalize();0===d.lengthSq()&&(c.copy(this.dir),b.z>b.y?c.y+=1E-4:c.z+=1E-4,d=c.cross(b).normalize());a.up.copy(d).cross(this.dir).normalize()};(function U(){requestAnimationFrame(U);var a=
Date.now();F=a-w;w=a})();this.ortho=!1;this.center=a.target?a.target.clone():new THREE.Vector3(0,0,0);this.pivot=a.pivot?a.pivot.clone():this.center.clone();this.sceneUpDirection=a.worldup?a.worldup.clone():a.up.clone();this.sceneFrontDirection=this.getWorldFrontVector();this.dir=this.getView();this.setCameraUp(a.up);this.saveCenter=this.center.clone();this.savePivot=this.pivot.clone();this.saveEye=a.position.clone();this.saveUp=a.up.clone();var z,G,A,E;this.cubeFront=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();
this.setHomeViewFrom(a);var H=new THREE.Quaternion,I=new THREE.Quaternion,J=new THREE.Quaternion,L=new THREE.Quaternion,C,N;this.userPanSpeed=.5;this.userLookSpeed=2;this.userHeightSpeed=5;this.walkMultiplier=1;this.userZoomSpeed=1.015;this.orbitMultiplier=5;this.currentlyAnimating=!1;this.alignOrbitUpDirection=this.preserveOrbitUpDirection=a.keepSceneUpright=!0;this.doCustomOrbit=this.constrainOrbitVertical=this.constrainOrbitHorizontal=!1;this.snapOrbitDeadZone=.045;this.snapOrbitThresholdH=this.snapOrbitThresholdV=
THREE.Math.degToRad(15);this.snapOrbitAccelerationAX=this.snapOrbitAccelerationAY=1.5;this.snapOrbitAccelerationBX=this.snapOrbitAccelerationBY=2;this.snapOrbitAccelerationPointX=this.snapOrbitAccelerationPointY=.5;this.alignDirTable=Array(26);this.alignDirTable[0]=new THREE.Vector3(-1,0,0);this.alignDirTable[1]=new THREE.Vector3(1,0,0);this.alignDirTable[2]=new THREE.Vector3(0,-1,0);this.alignDirTable[3]=new THREE.Vector3(0,1,0);this.alignDirTable[4]=new THREE.Vector3(0,0,-1);this.alignDirTable[5]=
new THREE.Vector3(0,0,1);this.alignDirTable[6]=new THREE.Vector3(-1,-1,0);this.alignDirTable[7]=new THREE.Vector3(-1,1,0);this.alignDirTable[8]=new THREE.Vector3(1,-1,0);this.alignDirTable[9]=new THREE.Vector3(1,1,0);this.alignDirTable[10]=new THREE.Vector3(0,-1,-1);this.alignDirTable[11]=new THREE.Vector3(0,-1,1);this.alignDirTable[12]=new THREE.Vector3(0,1,-1);this.alignDirTable[13]=new THREE.Vector3(0,1,1);this.alignDirTable[14]=new THREE.Vector3(-1,0,-1);this.alignDirTable[15]=new THREE.Vector3(1,
0,-1);this.alignDirTable[16]=new THREE.Vector3(-1,0,1);this.alignDirTable[17]=new THREE.Vector3(1,0,1);this.alignDirTable[18]=new THREE.Vector3(-1,-1,-1);this.alignDirTable[19]=new THREE.Vector3(-1,-1,1);this.alignDirTable[20]=new THREE.Vector3(-1,1,-1);this.alignDirTable[21]=new THREE.Vector3(-1,1,1);this.alignDirTable[22]=new THREE.Vector3(1,-1,-1);this.alignDirTable[23]=new THREE.Vector3(1,-1,1);this.alignDirTable[24]=new THREE.Vector3(1,1,-1);this.alignDirTable[25]=new THREE.Vector3(1,1,1);this.useSnap=
this.combined=!1;this.lockDeltaX=0;this.lockedX=!1;this.lockDeltaY=this.lastSnapRotateX=0;this.lockedY=!1;this.lastSnapRotateY=0;this.lastSnapDir=new THREE.Vector3(0,0,0);this.bottomLimit=this.topLimit=!1;this.maxSceneBound=this.minSceneBound=0;var K={destinationPercent:1,duration:1,zoomToFitScene:!0,useOffAxis:!1};this.shotParams=K;var R,T;this.zoomDelta=new THREE.Vector2;var ba,X=new THREE.Vector3,Y=new THREE.Vector3;this.rewindParams={history:[],startTime:void 0,thumbnailSize:56,thumbnailGapSize:12,
maxHistorySize:25,snappingEnabled:!0,timelineIndex:0,timelineIndexSlide:0,open:!1,openLocation:new THREE.Vector2(0,0),openBracket:new THREE.Vector2(0,0),openBracketA:new THREE.Vector2(0,0),openBracketB:new THREE.Vector2(0,0),openLocationOrigin:new THREE.Vector2(0,0),locationOffset:new THREE.Vector2(0,0),snapOffset:new THREE.Vector2(0,0),slideOffset:new THREE.Vector2(0,0),snapped:!0,resetWeights:!1,recordEnabled:!1,elementIsRecording:!1};this.viewCubeMenuOpen=!1;this.menuSize=new THREE.Vector2(0,0);
this.menuOrigin=new THREE.Vector2(0,0);a.lookAt(this.center);this.setCube=function(a){p=a};this.loadObject=function(a,b,c){loader=new THREE.JSONLoader;loader.load(a,function(a,d){var g=new THREE.MeshPhongMaterial(d);mesh=new THREE.Mesh(a,g);mesh.scale=b;mesh.position.copy(c);mesh.geometry.computeBoundingBox();g=mesh.geometry.boundingBox.clone();Y.set(g.max.x,g.max.y,g.max.z);X.set(g.min.x,g.min.y,g.min.z);Y.multiply(b);X.multiply(b);scene.add(mesh);objects.push(mesh)})};this.sync=function(b){b.isPerspective!==
a.isPerspective&&(b.isPerspective?a.toPerspective():(a.toOrthographic(),b.saveFov&&(a.saveFov=b.saveFov)));a.fov=b.fov;a.position.copy(b.position);b.target&&(this.center.copy(b.target),a.target.copy(b.target));b.pivot&&(this.pivot.copy(b.pivot),a.pivot.copy(b.pivot));this.dir.copy(this.center).sub(a.position);this.setCameraUp(b.up);b=b.worldup?b.worldup:b.up;1E-4<b.distanceToSquared(this.sceneUpDirection)&&this.setWorldUpVector(b);B&&!this.navApi.getTransitionActive()&&(B=!1,this.setCurrentViewAsHome(!1));
p&&requestAnimationFrame(p.render)};this.refresh=function(){p&&p.refreshCube()};THREE.Box2.prototype.setCenter=function(a){var b=new THREE.Vector2(Math.abs(this.max.x-this.min.x)/2,Math.abs(this.max.y-this.min.y)/2);this.min.copy(a).sub(b);this.max.copy(a).add(b);return this};THREE.Box2.prototype.getIcon2DCoords=function(a,b){var c=this.center;b.set((a.x-c.x)/(this.size().x/2),(a.y-c.y)/(this.size().y/2))};THREE.Matrix3.prototype.makeRotationFromQuaternion=function(a){var b=this.elements,c=a.x,d=
a.y,g=a.z,f=a.w,h=c+c,k=d+d,m=g+g;a=c*h;var l=c*k,c=c*m,n=d*k,d=d*m,g=g*m,h=f*h,k=f*k,f=f*m;b[0]=1-(n+g);b[3]=l-f;b[6]=c+k;b[1]=l+f;b[4]=1-(a+g);b[7]=d-h;b[2]=c-k;b[5]=d+h;b[8]=1-(a+n);return this};THREE.Quaternion.prototype.setFromRotationMatrix3=function(a){var b=a.elements,c=b[0];a=b[3];var d=b[6],g=b[1],f=b[4],h=b[7],k=b[2],m=b[5],b=b[8],l=c+f+b;0<l?(c=.5/Math.sqrt(l+1),this.w=.25/c,this.x=(m-h)*c,this.y=(d-k)*c,this.z=(g-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this.w=(m-h)/c,this.x=.25*c,this.y=
(a+g)/c,this.z=(d+k)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this.w=(d-k)/c,this.x=(a+g)/c,this.y=.25*c,this.z=(h+m)/c):(c=2*Math.sqrt(1+b-c-f),this.w=(g-a)/c,this.x=(d+k)/c,this.y=(h+m)/c,this.z=.25*c);return this};THREE.Quaternion.prototype.rotate=function(a){var b=(new THREE.Matrix4).makeRotationFromQuaternion(this).elements,b=(new THREE.Matrix3).set(b[0],b[1],b[2],b[4],b[5],b[6],b[8],b[9],b[10]);return a.applyMatrix3(b)};THREE.Vector3.prototype.findAngleWith=function(a,b){var c=0,d=this.clone().normalize().clone().dot(a.clone().normalize()),
c=this.clone().cross(a).clone().normalize();if(c.clone().length()<Number.MIN_VALUE)c=0<d?0:180;else{b=0<c.clone().dot(b.clone().normalize())?c:-c;var g=(new THREE.Quaternion).setFromAxisAngle(b,90*THREE.Math.degToRad),g=g.clone().rotate(a).clone().normalize().clone().dot(this),c=Math.acos(d)*THREE.Math.radToDeg;Math.abs(c-90)<Number.MIN_VALUE&&(c=90);if(90>c&&0<d*g||90<c&&0>d*g||90==c&&0<g)c*=-1}return c=THREE.Math.degToRad(c)};"contains"in String.prototype||(String.prototype.contains=function(a,
b){return-1!==String.prototype.indexOf.call(this,a,b)});Math.linearClamp=function(a,b,c){return a<=b?0:a>=c?1:(a-b)/(c-b)};Math.easeClamp=function(a,b,c){return a<=b?0:a>=c?1:.5*(Math.sin(((a-b)/(c-b)-.5)*Math.PI)+1)};Math.linearInterp=function(a,b,c){return b*(1-a)+c*a};Math.equalityClamp=function(a,b,c){return a<=b?b:a>=c?c:a};Math.round2=function(a){return Math.round(100*a)/100};Math.round1=function(a){return Math.round(10*a)/10};this.animateTransition=function(b){if(b){var c=!1,d=0;this.setCameraOrtho(b.isOrtho);
if(m.elapsedTime>=K.duration)d=1,m.center.copy(b.center),m.pivot.copy(b.pivot),a.position.copy(b.position),a.up.copy(b.up),b.isOrtho||(a.fov=b.fov),(c=!b.worldUp.equals(this.sceneUpDirection))&&this.setWorldUpVector(b.worldUp),this.currentlyAnimating=!1,g(c),this.showPivot(!1),p&&requestAnimationFrame(p.render),this.addHistoryElement(),this.navApi.setTransitionActive(!1);else{this.currentlyAnimating=!0;this.showPivot(!0);this.navApi.setTransitionActive(!0);d=Math.easeClamp(m.elapsedTime/K.duration,
0,K.destinationPercent);oneMinusTime=1-d;m.elapsedTime+=F/500;var c=m.center.clone().multiplyScalar(oneMinusTime).add(b.center.clone().multiplyScalar(d)),f=a.position.clone().multiplyScalar(oneMinusTime).add(b.position.clone().multiplyScalar(d)),h=a.up.clone().multiplyScalar(oneMinusTime).add(b.up.clone().multiplyScalar(d)),k=a.pivot.clone().multiplyScalar(oneMinusTime).add(b.pivot.clone().multiplyScalar(d)),l=this.sceneUpDirection.clone().multiplyScalar(oneMinusTime).add(b.worldUp.clone().multiplyScalar(d)),
d=a.fov*oneMinusTime+b.fov*d;m.center.copy(c);m.pivot.copy(k);a.position.copy(f);a.up.copy(h);b.isOrtho||(a.fov=d);(c=1E-4<l.distanceToSquared(this.sceneUpDirection))&&this.setWorldUpVector(l);a.lookAt(m.center);g(c);p&&requestAnimationFrame(p.render);requestAnimationFrame(function(){m.animateTransition(b)})}}};this.sphericallyInterpolateTransition=function(b){var c,d,f;c=0;this.currentlyAnimating=!0;this.navApi.setTransitionActive(!0);m.elapsedTime>=K.duration?(c=1,this.currentlyAnimating=!1):(c=
Math.easeClamp(m.elapsedTime/K.duration,0,K.destinationPercent),m.elapsedTime+=F/500);1===c?(d=T.position,c=T.center,f=T.up):(f=new THREE.Matrix3,d=H.clone(),d.slerp(I,c),f.makeRotationFromQuaternion(d),d=Math.linearInterp(c,C,N),f=f.elements,c=R.center.clone().multiplyScalar(1-c).add(T.center.clone().multiplyScalar(c)),d=c.clone().sub((new THREE.Vector3(f[0],f[1],f[2])).multiplyScalar(d)),f=new THREE.Vector3(f[3],f[4],f[5]));m.center.copy(c);a.position.copy(d);a.up.copy(f);m.navApi.getUsePivotAlways()||
m.pivot.copy(c);a.lookAt(m.center);!0===this.currentlyAnimating?(this.showPivot(!0),requestAnimationFrame(function(){m.sphericallyInterpolateTransition(b)})):(this.navApi.setTransitionActive(!1),this.showPivot(!1),this.addHistoryElement(),this.orthographicFaces&&this.isFaceView()&&this.setCameraOrtho(!0),b&&b());g(!1);p&&requestAnimationFrame(p.render)};this.getOrientation=function(){if(p){var b=Math.round1(a.up.x),c=Math.round1(a.up.y),d=Math.round1(a.up.z),g=this.sceneFrontDirection.clone(),f=this.sceneUpDirection.clone(),
h=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();g.x=Math.round1(g.x);g.y=Math.round1(g.y);g.z=Math.round1(g.z);f.x=Math.round1(f.x);f.y=Math.round1(f.y);f.z=Math.round1(f.z);h.x=Math.round1(h.x);h.y=Math.round1(h.y);h.z=Math.round1(h.z);var k=h.clone().multiplyScalar(-1),m=f.clone().multiplyScalar(-1),l=g.clone().multiplyScalar(-1);switch(p.currentFace){case "front":if(f.x==b&&f.y==c&&f.z==d)return"up";if(m.x==b&&m.y==c&&m.z==d)return"down";if(h.x==b&&h.y==c&&h.z==d)return"right";
if(k.x==b&&k.y==c&&k.z==d)return"left";break;case "right":if(f.x==b&&f.y==c&&f.z==d)return"up";if(m.x==b&&m.y==c&&m.z==d)return"down";if(l.x==b&&l.y==c&&l.z==d)return"left";if(g.x==b&&g.y==c&&g.z==d)return"right";break;case "left":if(f.x==b&&f.y==c&&f.z==d)return"up";if(m.x==b&&m.y==c&&m.z==d)return"down";if(g.x==b&&g.y==c&&g.z==d)return"left";if(l.x==b&&l.y==c&&l.z==d)return"right";break;case "back":if(f.x==b&&f.y==c&&f.z==d)return"up";if(m.x==b&&m.y==c&&m.z==d)return"down";if(k.x==b&&k.y==c&&k.z==
d)return"right";if(h.x==b&&h.y==c&&h.z==d)return"left";break;case "top":if(l.x==b&&l.y==c&&l.z==d)return"down";if(g.x==b&&g.y==c&&g.z==d)return"up";if(h.x==b&&h.y==c&&h.z==d)return"right";if(k.x==b&&k.y==c&&k.z==d)return"left";break;case "bottom":if(g.x==b&&g.y==c&&g.z==d)return"down";if(l.x==b&&l.y==c&&l.z==d)return"up";if(h.x==b&&h.y==c&&h.z==d)return"right";if(k.x==b&&k.y==c&&k.z==d)return"left"}}};this.setCameraOrtho=function(b){b&&a.isPerspective&&a.toOrthographic();b||a.isPerspective||a.toPerspective()};
this.resetOrientation=function(){this.setCameraOrtho(this.originalHomeVector.isOrtho);this.sceneUpDirection.copy(this.originalHomeVector.worldUp);this.sceneFrontDirection.copy(this.originalHomeVector.worldFront);this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize();this.setCameraUp(this.sceneUpDirection);g(!0)};this.setCurrentViewAsFront=function(){p&&(p.currentFace="front");this.sceneUpDirection.copy(a.up.clone());this.sceneFrontDirection.copy(this.getView()).normalize();
this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize();this.orthographicFaces&&this.setCameraOrtho(!0);g(!0)};this.setCurrentViewAsTop=function(){p&&(p.currentFace="top");this.sceneUpDirection.copy(this.getView()).multiplyScalar(-1).normalize();this.sceneFrontDirection.copy(a.up);this.cubeFront.copy(this.sceneFrontDirection).cross(this.sceneUpDirection).normalize();g(!0)};this.calculateCubeTransform=function(b){var c=this.sceneUpDirection.clone(),d=this.sceneFrontDirection.clone(),
g=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();R=a.clone();R.center=m.center.clone();R.pivot=m.pivot.clone();T=a.clone();T.center=m.center.clone();T.pivot=m.pivot.clone();var f=new THREE.Vector3(0,0,0);b.contains("back")&&(f=f.add(d));b.contains("front")&&(f=f.sub(d));b.contains("top")&&(f=f.add(c));b.contains("bottom")&&(f=f.sub(c));b.contains("right")&&(f=f.add(g));b.contains("left")&&(f=f.sub(g));b=c;var h=f.clone().normalize();if(1-Math.abs(h.dot(c))<Number.MIN_VALUE)for(var k=
this.getView().normalize(),d=[d.clone(),d.clone().negate(),g.clone(),g.clone().negate()],c=0<h.dot(c)?1:-1,k=k.clone().add(a.up.clone().multiplyScalar(c)).normalize(),g=-2,h=0;4>h;h++){var l=k.dot(d[h]);l>g&&(g=l,b=d[h].multiplyScalar(c))}N=C=this.getView().length();T.position.copy(T.center.clone().add(f.multiplyScalar(N/f.length())));T.up.copy(b);f=R.center.clone().sub(R.position).normalize();b=f.clone().cross(R.up).normalize();d=b.clone().cross(f).normalize();c=new THREE.Matrix3;c.set(f.x,d.x,b.x,
f.y,d.y,b.y,f.z,d.z,b.z);H.setFromRotationMatrix3(c);f=T.center.clone().sub(T.position).normalize();b=f.clone().cross(T.up).normalize();d=b.clone().cross(f).normalize();c.set(f.x,d.x,b.x,f.y,d.y,b.y,f.z,d.z,b.z);J.setFromAxisAngle(f,0);L.setFromAxisAngle(d,0);I.setFromRotationMatrix3(c);I.multiply(J).multiply(L).normalize()};this.centerShot=function(b){if(!R||b)m.elapsedTime=0,R=T=a.clone(),R.center=m.center;b=m.pivot.clone();var c=b.clone().sub(R.position),d=R.center.clone().sub(R.position).normalize(),
f=R.up.clone(),h=d.clone().cross(f).normalize(),f=h.clone().cross(d).normalize(),d=h.clone().multiplyScalar(h.dot(c)),c=f.clone().multiplyScalar(f.dot(c)),c=d.clone().add(c);T.position.copy(R.position.clone().add(c));T.center=b;T.pivot=b;b=0;m.elapsedTime>=K.duration?b=1:(b=Math.easeClamp(m.elapsedTime/K.duration,0,K.destinationPercent),m.elapsedTime+=F/2E3);c=a.position.clone().multiplyScalar(1-b).add(T.position.clone().multiplyScalar(b));f=m.center.clone().multiplyScalar(1-b).add(T.center.clone().multiplyScalar(b));
d=m.pivot.clone().multiplyScalar(1-b).add(T.pivot.clone().multiplyScalar(b));a.position.copy(c);m.center.copy(f);m.pivot.copy(d);a.lookAt(m.center);g(!1);1===b?this.addHistoryElement():requestAnimationFrame(function(){m.centerShot(!1)})};this.levelShot=function(){var b=this.getView(),c=b.length(),d=this.sceneUpDirection.clone(),f=a.up.clone().normalize(),b=b.normalize(),g=b.dot(d);1-Math.abs(g)>Number.MIN_VALUE?(f=b.clone().cross(d),b=d.clone().cross(f),b.normalize()):b=f.clone();b.multiplyScalar(c);
c={center:b.add(a.position),up:d,position:a.position,pivot:m.center.clone().add(b),fov:a.fov,worldUp:d};m.elapsedTime=0;m.animateTransition(c)};this.fitToWindow=function(){var b=this.getView(),c=a.up.clone();b.normalize();c.normalize();T=a.clone();T.center=m.center;var d=c,c=d.clone();if(!(Math.abs(c.clone().dot(b))<Number.MIN_VALUE)&&(b.normalize(),c=d.clone().dot(b),c=b.clone().multiplyScalar(c),c=d.clone().sub(c),c.length()<Number.MIN_VALUE)){for(var d=new THREE.Vector3(0,0,0),c=[new THREE.Vector3(0,
1,0),new THREE.Vector3(1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,1,1),new THREE.Vector3(1,0,1),new THREE.Vector3(1,1,0),new THREE.Vector3(1,1,1)],f=0;7>f;f++)if(Math.abs(c[f].dot(b))<Number.MIN_VALUE){d=c[f];break}c=d}c.normalize();c.normalize();T.up.copy(c);f=b.clone().cross(c);f.normalize();var g=X.clone(),h=Y.clone(),k=[g,h],d=new THREE.Vector3(h.x-g.x,h.y-g.y,h.z-g.z);k[2]=new THREE.Vector3(h.x,g.y,h.z);k[3]=new THREE.Vector3(h.x,g.y,g.z);k[4]=new THREE.Vector3(h.x,h.y,g.z);k[5]=new THREE.Vector3(g.x,
h.y,h.z);k[6]=new THREE.Vector3(g.x,h.y,g.z);k[7]=new THREE.Vector3(g.x,g.y,h.z);for(g=0;8>g;g++)h=k[g].clone().sub(a.position),k[g].setX(h.clone().dot(f)),k[g].setY(h.clone().dot(c)),k[g].setZ(h.clone().dot(b));var g=THREE.Math.degToRad(a.topFov),h=THREE.Math.degToRad(a.bottomFov),l=THREE.Math.degToRad(a.leftFov),n=THREE.Math.degToRad(a.rightFov),q,w,p,t;q=0<=l?Number.MAX_VALUE:Number.MIN_VALUE;w=0<=n?Number.MAX_VALUE:Number.MIN_VALUE;p=0<=g?Number.MAX_VALUE:Number.MIN_VALUE;t=0<=h?Number.MAX_VALUE:
Number.MIN_VALUE;for(var B=1/Math.tan(n),z=-1/Math.tan(l),N=1/Math.tan(g),F=-1/Math.tan(h),v=0;8>v;v++){var G=k[v].clone(),A=G.z-z*G.x;q=0<=l?Math.min(q,A):Math.max(q,A);A=G.z-B*G.x;w=0<=n?Math.min(w,A):Math.max(w,A);A=G.z-N*G.y;p=0<=g?Math.min(p,A):Math.max(p,A);A=G.z-F*G.y;t=0<=h?Math.min(t,A):Math.max(t,A)}k=(w-q)/(z-B);q=z*k+q;t=(t-p)/(N-F);p=N*t+p;N=0;q<=p?(g=(g-h)/2,Math.abs(g)>Number.MIN_VALUE&&(g=1/Math.tan(g),t=t-p/g+q/g),N=q):(g=(n-l)/2,Math.abs(g)>Number.MIN_VALUE&&(g=1/Math.tan(g),k=k-
q/g+p/g),N=p);g=new THREE.Vector3(k,t,N);f=f.clone().multiplyScalar(g.x);c=c.clone().multiplyScalar(g.y);g=b.clone().multiplyScalar(g.z);g=f.clone().add(c.clone().add(g));T.position.add(g);c=d.clone().sub(T.position).dot(b);T.center=T.position.clone().add(b.multiplyScalar(c));T.pivot=d.clone();b={center:T.center,up:T.up,position:T.position,pivot:T.pivot,fov:a.fov,worldUp:m.sceneUpDirection.clone()};m.elapsedTime=0;m.animateTransition(b)};this.updatePivotPosition=function(b){var c;c=new THREE.Vector3(b.x/
window.innerWidth*2-1,2*-(b.y/window.innerHeight)+1,.5);c=c.unproject(a);c=(new THREE.Raycaster(a.position,c.sub(a.position).normalize())).intersectObjects(objects);if("zoom"==m.mode)if(void 0!==c[0])b=c[0].point,m.pivot.copy(b);else{b.y=Math.abs(b.y-window.innerHeight);var d=a.position;c=m.center.clone().sub(d);var g=a.up,f=c.clone().cross(g),h=c.clone().length(),k=h*Math.tan(THREE.Math.degToRad(a.leftFov)),l=h*Math.tan(THREE.Math.degToRad(a.rightFov)),n=h*Math.tan(THREE.Math.degToRad(a.topFov)),
h=h*Math.tan(THREE.Math.degToRad(a.bottomFov)),k=b.x*(k+l)/window.innerWidth-k;b=b.y*(n+h)/window.innerHeight-h;g=g.clone().normalize().clone().multiplyScalar(b);f=f.clone().normalize().clone().multiplyScalar(k);m.ortho?b=d.clone().add(f).clone().add(g):(b=d,c=c.clone().add(g).clone().add(f));m.pivot.copy(b.clone().add(c))}else void 0!==c[0]?(wheel.cursorImage("pivot"),b=c[0].point,m.isMouseDown||m.pivot.copy(b)):wheel.cursorImage("SWInvalidArea")};this.onDrawHeight=function(b,c,d,g,f){b=new THREE.Vector3(0,
1,0);b=a.position.clone().dot(b);b=Math.linearClamp(b,m.minSceneBound,m.maxSceneBound)-.5;v&&(v.find("img#updownImageA").remove(),v.prepend('<img src="'+f+'SWheighthandleA.png" id="updownImageA" style="position:fixed; z-index:9999; top:'+(d-86*b)+"px; left:"+c+'px;"/>'),g||v.prepend('<img src="'+f+'SWheighthandleI.png" id="updownImageI" style="position:fixed; z-index:9998; top:'+(d-86*b)+"px; left:"+c+'px;"/>'))};this.drawDropdownMenu=function(a,b,d,g,f,h,k){var m=0;if(t)h.appendChild(t);else{t=document.createElement("div");
t.className="dropDownMenu";t.style.top="100px";t.style.left="-400px";for(var l=0,n=0;n<a.length;n++){var q;if(null===a[n])q=document.createElement("li"),q.style.height="1px",l+=1,q.style.backgroundColor="#E0E0E0";else{var w=Autodesk.Viewing.i18n.translate(a[n]);if(d[n]){q=document.createElement("div");var p=document.createElement("input"),B=document.createElement("label");p.type="checkbox";p.className="dropDownMenuCheck";B.innerHTML=w;B.className="dropDownMenuCheckText";q.appendChild(p);q.appendChild(B);
q.className="dropDownMenuCheckbox"}else q=document.createElement("li"),q.textContent=w,q.className=b[n]?"dropDownMenuItem":"dropDownMenuItemDisabled";q.id="menuItem"+m;m++;l+=25;q.setAttribute("data-i18n",a[n])}t.appendChild(q)}h.appendChild(t);m=t.getBoundingClientRect().width;this.menuSize.x=m;this.menuSize.y=l}for(n=m=0;n<a.length;n++)null!==a[n]&&(d[n]&&(l=document.getElementById("menuItem"+m))&&(l.children[0].checked=d[n]()),m++);a=f-15;d=g+1;f=c.getBoundingClientRect();d+this.menuSize.x>f.right&&
(d=g-this.menuSize.x-1);a+this.menuSize.y>f.bottom&&(a=f.bottom-this.menuSize.y);a-=k.y;d-=k.x;t.style.top=a+"px";t.style.left=d+"px";this.menuOrigin.x=d;this.menuOrigin.y=a};this.removeDropdownMenu=function(a){a.removeChild(t)};this.isFaceView=function(){var b=this.center.clone().sub(a.position).normalize();return q(b)&&q(a.up)};this.startInteraction=function(a,b){this.startCursor=new THREE.Vector2(a,b);this.startState={saveCenter:this.center.clone(),saveEye:this.camera.position.clone(),savePivot:this.pivot.clone(),
saveUp:this.camera.up.clone()};this.lockDeltaX=0;this.lockedX=!1;this.lockDeltaY=this.lastSnapRotateX=0;this.lockedY=!1;this.lastSnapRotateY=0;this.lastSnapDir=new THREE.Vector3(0,0,0)};this.orbit=function(b,c,d,f){if(!this.navApi.getIsLocked()&&!0!==this.currentlyAnimating){var l="wheel";m.orthographicFaces&&!a.isPerspective&&(a.toPerspective(),f&&f.saveEye.copy(this.camera.position));f&&(l="cube");"cube"==l?(this.saveCenter.copy(f.saveCenter),this.saveEye.copy(f.saveEye),this.savePivot.copy(f.savePivot),
this.saveUp.copy(f.saveUp),this.doCustomOrbit=this.useSnap=!0):(this.saveCenter.copy(this.center),this.savePivot.copy(this.pivot),this.saveEye.copy(a.position),this.saveUp.copy(a.up),this.doCustomOrbit=this.useSnap=!1);m.combined&&void 0==G&&(G=this.saveCenter.clone(),z=this.saveEye.clone(),E=this.savePivot.clone(),A=this.saveUp.clone());if(this.preserveOrbitUpDirection){var l=h(b.x-c.x,b.y-c.y),n=h(d.x,d.y);c=this.sceneUpDirection.clone();var q=this.sceneFrontDirection.clone(),w=this.sceneFrontDirection.clone().cross(this.sceneUpDirection).normalize();
d=m.combined?E:this.savePivot;f=m.combined?z:this.saveEye;var p=m.combined?G:this.saveCenter,t=m.combined?A:this.saveUp,B=d.clone().sub(f).normalize(),N=p.clone().sub(f).normalize(),F=N.clone().cross(t);b=f.clone().sub(d).length();f=f.clone().sub(p).length();B=B.clone().multiplyScalar(-1);N=N.clone().multiplyScalar(-1);t=t.clone();this.constrainOrbitHorizontal||(-.009>c.dot(this.saveUp)&&(l.x=-l.x,n.x=-n.x),p=0,this.lastSnapRotateX=p=m.combined?n.x*this.orbitMultiplier:this.useSnap?this.lastSnapRotateX+
k("h",0,-n.x):l.x*this.orbitMultiplier,p=(new THREE.Quaternion).setFromAxisAngle(c,-p),B.applyQuaternion(p),N.applyQuaternion(p),F.applyQuaternion(p),t.applyQuaternion(p));this.constrainOrbitVertical||(q=q.clone().multiplyScalar(q.dot(F)),w=w.clone().multiplyScalar(w.dot(F)),w=q.clone().add(w),w.clone().normalize(),F=0,m.combined?F=n.y*this.orbitMultiplier:(n=k("v",0,n.y),F=this.useSnap?this.lastSnapRotateY+n:l.y*this.orbitMultiplier),l=(new THREE.Quaternion).setFromAxisAngle(w,-F),this.navApi.getOrbitPastWorldPoles()||
(n=t.clone(),n.applyQuaternion(l).normalize(),0>c.dot(n)&&(n=N.clone(),n.applyQuaternion(l).normalize(),c=n.angleTo(c),Math.abs(c)>.5*Math.PI&&(c-=0<c?Math.PI:-Math.PI),F-=c,l.setFromAxisAngle(w,-F))),B.applyQuaternion(l).normalize(),N.applyQuaternion(l).normalize(),t.applyQuaternion(l).normalize(),this.lastSnapRotateY=F);d=B.multiplyScalar(b).add(d);a.position.copy(d);a.up.copy(t);this.center.copy(d);this.center.sub(N.multiplyScalar(f));m.combined&&(G.copy(this.center),z.copy(a.position),E.copy(this.pivot),
A.copy(a.up))}a.lookAt(this.center);g(!1)}};this.endInteraction=function(){};this.look=function(b){if(!this.navApi.getIsLocked()){var c=h(b.x,b.y),d=this.userLookSpeed;b=this.getView();var f=a.up,k=b.clone().cross(f).normalize(),m=this.sceneUpDirection.clone(),c=c.clone();c.x*=Math.PI;c.y*=Math.PI/a.aspect;c.multiplyScalar(d);d=(new THREE.Quaternion).setFromAxisAngle(k,-c.y);if(a.keepSceneUpright&&!this.navApi.getOrbitPastWorldPoles()){var l=f.clone();l.applyQuaternion(d).normalize();0>l.dot(m)&&
(l=b.clone(),l.applyQuaternion(d),l=l.angleTo(m),Math.abs(l)>.5*Math.PI&&(l-=0<l?Math.PI:-Math.PI),c.y-=l,d.setFromAxisAngle(k,-c.y))}b=d.clone().rotate(b);f=d.clone().rotate(f);f.normalize();k=a.keepSceneUpright?m:f;k=(new THREE.Quaternion).setFromAxisAngle(k,-c.x);b=k.clone().rotate(b);f=k.clone().rotate(f);this.center.copy(b.add(a.position));a.up.copy(f);a.lookAt(this.center);g(!1)}};this.pan=function(b){if(!this.navApi.getIsLocked()){b=h(b.x,b.y);var c=this.getView(),d=a.up.clone().cross(c),f=
c.clone().cross(d);d.normalize();f.normalize();c.normalize();var k=this.pivot.clone().sub(a.position),k=c.clone().dot(k),c=k*(Math.tan(THREE.Math.degToRad(a.leftFov))+Math.tan(THREE.Math.degToRad(a.rightFov))),k=k*(Math.tan(THREE.Math.degToRad(a.topFov))+Math.tan(THREE.Math.degToRad(a.bottomFov))),c=b.x*Math.abs(c);b=b.y*Math.abs(k);k=new THREE.Vector3;d=d.clone().multiplyScalar(c);f=f.clone().multiplyScalar(b);k=d.clone().add(f).clone().multiplyScalar(this.userPanSpeed);a.position.add(k);this.center.add(k);
a.lookAt(this.center);g(!1)}};this.zoom=function(b){if(!this.navApi.getIsLocked()){var c=this.userZoomSpeed,d=Number.MAX_VALUE;b=b.x+b.y;var f=Math.pow(c,b),h=this.pivot.clone().sub(this.pivot.clone().sub(this.saveEye).clone().multiplyScalar(f)),k=h.clone().add(m.D.clone().multiplyScalar(m.D.clone().dot(this.pivot.clone().sub(h).clone())));if(!(f>=d)){if(0<b){Math.pow(c,b-0);if(0>b)return;a.position.copy(h);this.center.copy(k);h.clone().sub(this.saveEye).dot(m.D)>d&&a.position.copy(this.saveEye.sub(m.D).clone().multiplyScalar(d))}else a.position.copy(h),
this.center.copy(k);a.lookAt(this.center);g(!1)}}};this.walk=function(b,c,d,f,k){if(!this.navApi.getIsLocked()){d=this.sceneUpDirection.clone();f=this.sceneFrontDirection.clone();k=this.sceneFrontDirection.clone().cross(this.sceneUpDirection);l(b,c)?(wheel.cursorImage("SWWalk"),n(!0,b,c),x=c.x,y=c.y):n(!1,b,c);x=b.x;y=b.y;var m=h(x-c.x,y-c.y),q=-m.x,w=-m.y,p=0>q?-1:1,m=0>w?-1:1,t=Math.abs(q),B=Math.abs(w),B=new THREE.Vector2(30,30),B=h(B.x,B.y),t=l(b,c)?0:Math.abs(q)-B.x,B=l(b,c)?0:Math.abs(w)-B.y,
t=t/.25,B=B/.25,t=1>t?Math.easeClamp(t,0,1):Math.pow(t,1),B=1>B?Math.easeClamp(B,0,1):Math.pow(B,1),q=0<t?t*p:0,m=0<B?B*m:0;b=this.getView();c=b.length();b.normalize();b.clone().cross(a.up).normalize();k=k.clone().multiplyScalar(k.clone().dot(b));k=f.clone().multiplyScalar(f.clone().dot(b)).clone().add(k);k=k.clone().length()>Number.MIN_VALUE?k.normalize():a.up;f=1*m*this.walkMultiplier;m=Math.cos(.65);1!=m&&(d.clone().dot(a.up)<-Number.MIN_VALUE&&d.clone().dot(b)<-m||d.clone().dot(a.up)>Number.MIN_VALUE&&
d.clone().dot(b)>m)&&(k=-k);q=-q*this.walkMultiplier*.05;m=a.up;if(d.clone().dot(a.up)<-Number.MIN_VALUE||Math.abs(d.clone().dot(a.up))<Number.MIN_VALUE&&d.clone().dot(b)>Number.MIN_VALUE)q=-q;m=d;q=(new THREE.Quaternion).setFromAxisAngle(m,q);q.normalize();b=q.clone().rotate(b);b.normalize();a.up.copy(q.clone().rotate(a.up));a.up.normalize();a.position.add(k.clone().multiplyScalar(f));this.center.copy(a.position.clone().add(b.clone().multiplyScalar(c)));d.normalize();a.lookAt(this.center);g(!1)}};
this.updown=function(b){if(!this.navApi.getIsLocked()){var c=Math.pow(b,2);0>b&&(c=-c);c=h(0,c);c.y=.01*c.y*(m.maxSceneBound-m.minSceneBound);c=m.userHeightSpeed*c.y;var d=m.m_amount;if(0===b)c=0;else{var f=m.saveEye.clone().sub(worldUp.clone().multiplyScalar(d+c)),d=m.saveEye.clone().sub(worldUp.clone().multiplyScalar(d)),k=0,k=(m.maxSceneBound-m.minSceneBound)/1E3;m.topLimit&&0<b?(k=m.maxSceneBound-k,m.topLimit=!1):m.bottomLimit&&0>b?(k=m.minSceneBound+k,m.bottomLimit=!1):k=f.dot(worldUp);b=d.dot(worldUp);
k<m.minSceneBound?b<m.minSceneBound&&(m.bottomLimit=!0,c=0):k>m.maxSceneBound&&b>m.maxSceneBound&&(m.topLimit=!0,c=0)}m.m_amount+=c;b=new THREE.Vector3(0,1,0);c=m.saveEye.clone().sub(b.clone().multiplyScalar(m.m_amount));f=c.clone().dot(b);a.position.copy(c);f<m.minSceneBound&&a.position.add(b.clone().multiplyScalar(m.minSceneBound-f));f>m.maxSceneBound&&a.position.add(b.clone().multiplyScalar(m.maxSceneBound-f));this.center.copy(a.position.clone().add(m.saveCenter.clone().sub(m.saveEye)));a.lookAt(this.center);
g(!1)}};this.addHistoryElement=function(){};this.addIntermediateHistoryElement=function(){this.rewindParams.history=this.rewindParams.snapped?this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):0<this.rewindParams.slideOffset.x?this.rewindParams.history.slice(0,this.rewindParams.timelineIndex):this.rewindParams.history.slice(0,this.rewindParams.timelineIndex+1);this.addHistoryElement()};this.clearHistory=function(){this.rewindParams.history.length=0;this.rewindParams.timelineIndex=
0;this.rewindParams.timelineIndexSlide=0;this.rewindParams.resetWeights=!0};this.openTimeline=function(a){this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex;this.rewindParams.resetWeights&&(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=this.rewindParams.snappingEnabled);0===this.rewindParams.history.length&&this.addHistoryElement();for(var b=0;b<this.rewindParams.history.length;b++){var c=this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize;this.rewindParams.history[b].thumbnailBounds.setCenter((new THREE.Vector2(a.x+
(b-this.rewindParams.timelineIndex)*c,a.y)).add(this.rewindParams.slideOffset));this.rewindParams.resetWeights&&(this.rewindParams.history[b].weight=b==this.rewindParams.timelineIndex?1:0)}this.rewindParams.resetWeights&&(this.rewindParams.resetWeights=!1);c=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize);this.rewindParams.open=!0;this.rewindParams.openLocation=a.clone();this.rewindParams.openLocationOrigin=a.clone();this.rewindParams.openBracket=a.clone();this.rewindParams.openBracketA=
new THREE.Vector2(c,a.y);this.rewindParams.openBracketB=new THREE.Vector2(window.innerWidth-c,a.y);this.rewindParams.openBracketA.x>this.rewindParams.openBracketB.x&&(a=this.rewindParams.openBracketA.x,this.rewindParams.openBracketA.x=this.rewindParams.openBracketB.x,this.rewindParams.openBracketB.x=a);this.rewindParams.locationOffset=new THREE.Vector2(0,0);this.rewindParams.snapOffset=new THREE.Vector2(0,0)};this.slideTimeline=function(a){if(this.rewindParams.open&&0!==this.rewindParams.history.length){var b=
a.clone().add(this.rewindParams.locationOffset),c=2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize);a=window.innerWidth-c;var d=this.rewindParams.history[0].thumbnailBounds.center().x,f=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x,g=0;b.x<this.rewindParams.openBracketA.x&&(g=b.x-this.rewindParams.openBracketA.x,d-=g,c<d&&(g=Math.min(g+(d-c),0)));b.x>this.rewindParams.openBracketB.x&&(g=b.x-this.rewindParams.openBracketB.x,c=f-g,a>c&&
(g=Math.max(g+(c-a),0)));this.rewindParams.openLocation.x+=g;this.rewindParams.openBracketA.x+=g;this.rewindParams.openBracketB.x+=g;this.rewindParams.openBracket.x=b.x-(this.rewindParams.openLocation.x-this.rewindParams.openLocationOrigin.x);a=new THREE.Vector2(-g,0);b=b.clone().sub(this.rewindParams.openLocation.clone().sub(this.rewindParams.openLocationOrigin));a.x+=this.rewindParams.snapOffset.x;this.rewindParams.snapOffset.x=0;c=!1;if(this.rewindParams.snappingEnabled)for(f=0;f<this.rewindParams.history.length;f++)if(d=
this.rewindParams.history[f].thumbnailBounds.center().add(a),4>Math.abs(d.x-b.x)||this.rewindParams.snapped&&16>Math.abs(d.x-b.x)){c=!0;0!==g?(this.rewindParams.snapOffset.x=d.x-b.x,a.x-=this.rewindParams.snapOffset.x):this.rewindParams.openBracket.x+=d.x-b.x;b.x=d.x;break}this.rewindParams.snapped=c;c=-1;for(f=g=0;f<this.rewindParams.history.length;f++){d=this.rewindParams.history[f].thumbnailBounds.clone();this.rewindParams.history[f].thumbnailBounds.setCenter(this.rewindParams.history[f].thumbnailBounds.center().add(a));
if(this.rewindParams.history[f].thumbnail){var h=this.rewindParams.history[f].thumbnailBounds.center().x-this.rewindParams.thumbnailSize/2;$("#rewindFrame"+f).css("left",h);$("#rewindBorder"+f).css("left",h-4)}h=new THREE.Vector2(2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize),2*(this.rewindParams.thumbnailGapSize+this.rewindParams.thumbnailSize));d.setFromCenterAndSize(d.center(),h);h=new THREE.Vector2(0,0);d.getIcon2DCoords(b,h);h=1-Math.abs(Math.equalityClamp(h.x,-1,1));
this.rewindParams.history[f].weight=h;0===f&&b.x<d.center().x&&(this.rewindParams.history[f].weight=1);f===this.rewindParams.history.length-1&&b.x>d.center().x&&(this.rewindParams.history[f].weight=1);g+=this.rewindParams.history[f].weight;this.rewindParams.history[f].weight>c&&(c=this.rewindParams.history[f].weight,this.rewindParams.snappingEnabled&&1==this.rewindParams.history[f].weight?(this.rewindParams.slideOffset.x=0,this.rewindParams.snapped=!0):this.rewindParams.slideOffset.x=this.rewindParams.history[f].thumbnailBounds.center().x-
b.x,this.rewindParams.timelineIndexSlide=f)}for(a=0;a<this.rewindParams.history.length;a++)this.rewindParams.history[a].weight/=g;a=this.rewindParams.history[0].thumbnailBounds.center().x;b=this.rewindParams.history[this.rewindParams.history.length-1].thumbnailBounds.center().x;this.rewindParams.openBracket.x<a?(this.rewindParams.locationOffset.x+=a-this.rewindParams.openBracket.x,this.rewindParams.openBracket.x=a):this.rewindParams.openBracket.x>b&&(this.rewindParams.locationOffset.x+=b-this.rewindParams.openBracket.x,
this.rewindParams.openBracket.x=b)}};this.shiftBackOneElement=function(){0!==this.rewindParams.history.length&&(0<this.rewindParams.timelineIndex||0!==this.rewindParams.slideOffset.x)&&((this.rewindParams.snapped||0<this.rewindParams.slideOffset.x)&&this.rewindParams.timelineIndex--,this.rewindParams.timelineIndexSlide=this.rewindParams.timelineIndex,this.rewindParams.resetWeights=!0,m.elapsedTime=0,this.animateToRewindIndex())};this.animateToRewindIndex=function(){var b=this.rewindParams.timelineIndex,
c=0;m.elapsedTime>=K.duration?c=1:(c=Math.easeClamp(m.elapsedTime/K.duration,0,K.destinationPercent),m.elapsedTime+=F/500);m.center.copy(m.center.clone().multiplyScalar(1-c).clone().add(this.rewindParams.history[b].camera.center.clone().multiplyScalar(c)));a.position.copy(a.position.clone().multiplyScalar(1-c).clone().add(this.rewindParams.history[b].camera.position.clone().multiplyScalar(c)));a.up.copy(this.rewindParams.history[b].camera.up);m.pivot.copy(m.center);a.lookAt(m.center);g(!1);p&&requestAnimationFrame(p.render);
1!==c&&requestAnimationFrame(function(){m.animateToRewindIndex()})};this.closeTimeline=function(){this.rewindParams.timelineIndex!=this.rewindParams.timelineIndexSlide&&(this.rewindParams.timelineIndex=this.rewindParams.timelineIndexSlide);this.rewindParams.open=!1};this.getInterpolatedCamera=function(){var b=new THREE.PerspectiveCamera(70,window.innerWidth/window.innerHeight,1,1E4);b.center=new THREE.Vector3(0,0,0);b.pivot=new THREE.Vector3(0,0,0);b.leftFov=0;b.rightFov=0;b.topFov=0;b.bottomFov=
0;b.up.set(0,0,0);for(var c=0;c<this.rewindParams.history.length;c++){var d=this.rewindParams.history[c].camera,f=this.rewindParams.history[c].weight;b.center.add(d.center.clone().multiplyScalar(f));b.position.add(d.position.clone().multiplyScalar(f));b.up.add(d.up.clone().multiplyScalar(f));b.rotation.add(d.rotation.clone().multiplyScalar(f));b.pivot.add(d.pivot.clone().multiplyScalar(f));b.leftFov+=d.leftFov*f;b.rightFov+=d.rightFov*f;b.topFov+=d.topFov*f;b.bottomFov+=d.bottomFov*f}a.position.copy(b.position);
a.up.copy(b.up);a.rotation=b.rotation;a.leftFov=b.leftFov;a.rightFov=b.rightFov;a.topFov=b.topFov;a.bottomFov=b.bottomFov;m.center.copy(b.center);m.pivot.copy(b.pivot);a.lookAt(m.center);a.up.normalize();g(!1)}};
Autocam.ViewCube=function(a,b,c,f){function d(a,b){var c={};0===a.type.indexOf("touch")?0<a.touches.length?(c.clientX=a.touches[0].clientX,c.clientY=a.touches[0].clientY,c.pageX=a.touches[0].pageX,c.pageY=a.touches[0].pageY,c.screenX=a.touches[0].screenX,c.screenY=a.touches[0].screenY,c.movementX=c.screenX-b.prevX,c.movementY=c.screenY-b.prevY,c.which=h.navApi.getUseLeftHandedInput()?3:1):c=b.prevCoords:(c.clientX=a.clientX,c.clientY=a.clientY,c.pageX=a.pageX,c.pageY=a.pageY,c.screenX=a.screenX,c.screenY=
a.screenY,c.which=a.which,ja?(c.movementX=a.movementX||a.mozMovementX||a.webkitMovementX||0,c.movementY=a.movementY||a.mozMovementY||a.webkitMovementY||0):(c.movementX=c.screenX-b.prevX,c.movementY=c.screenY-b.prevY));b.prevX=c.screenX;b.prevY=c.screenY;return b.prevCoords=c}var g=this,h=b,k=b.camera;b.setCube(this);g.currentFace="front";var l="top,front;top right;top,left;top,back;bottom,front;bottom,right;bottom,left;bottom,back;left,front;front,right;right,back;back,left".split(";"),n="front,top,right back,top,right front,top,left back,top,left front,bottom,right back,bottom,right front,bottom,left back,bottom,left".split(" "),
q=["Go Home",null,"Orthographic","Perspective","Perspective with Ortho Faces",null,"Set current view as Home","Focus and set as Home","Reset Home",null,"Set current view as Front","Set current view as Top","Reset orientation"],m=[!0,null,!0,!0,!0,null,!0,!0,!0,null,!0,!0,!0],p=[null,null,function(){return!h.orthographicFaces&&!k.isPerspective},function(){return!h.orthographicFaces&&k.isPerspective},function(){return h.orthographicFaces},null,null,null,null,null,null,null,null],t,v,D,w,F,B,z;g.camera=
new THREE.PerspectiveCamera(45,window.innerWidth/window.innerHeight,1,2E3);g.camera.position.copy(k.position);g.center=new THREE.Vector3(0,0,0);g.camera.lookAt(g.center);var G,A,E,H,I,J=[],L,C=[],N=[],K=[],R=[],T=null,ba=null,X=null,Y,W,U,O,da,V=0,M,la=0,ga=!0,ja=!1,Z=!1,ea=-1!=navigator.userAgent.search("Chrome"),ca=-1!=navigator.platform.search("Win32"),Q=!1,ha=!1,ma=[];this.height=this.width=0;this.animSpeed=500;this.animate=!0;this.compass=!1;this.viewScaleFactorCompass=1.5;this.viewScale=1;this.draggable=
!0;this.wantHomeButton=!1;this.wantContextMenu=this.wantRollArrows=!0;this.inactiveOpacity=.5;var La=function(a){a=a.getBoundingClientRect();return{x:a.left,y:a.top,w:a.width,h:a.height}},Fa=function(){h.navApi.getIsLocked()||(c.style.opacity="1.0",ha=!1);requestAnimationFrame(g.render)},Wa=function(a){if(ha||h.viewCubeMenuOpen||h.navApi.getIsLocked())h.navApi.getIsLocked()||(c.style.opacity=1);else{var b=Math.max(4*Math.abs((a.clientX-M.x)/M.w-.5)-1,0);a=Math.max(4*Math.abs((a.clientY-M.y)/M.h-.5)-
1,0);b=Math.max(0,Math.min(Math.sqrt(b*b+a*a),1));c.style.opacity=1-b*(1-g.inactiveOpacity)}},Ia=function(){h.viewCubeMenuOpen||(c.style.opacity=g.inactiveOpacity,ha=!0,requestAnimationFrame(g.render))},ua=function(a){var b=new Image;b.crossOrigin="anonymous";var c=new THREE.Texture(b);b.onload=function(){c.needsUpdate=!0;la++;11<=la&&requestAnimationFrame(g.render)};b.src=a;return c},aa=function(a,b,c){var d=new THREE.Vector3;d.copy(a);d=d.unproject(b);return(new THREE.Raycaster(b.position,d.sub(b.position).normalize())).intersectObjects(c)},
Aa=function(a,b){var c=a.clientX-b.x,d=a.clientY-b.y,c=c/b.w*2-1,d=(b.h-d)/b.h*2-1;return new THREE.Vector3(c,d,.5)},Na=function(a){a.preventDefault();a.stopPropagation();if(!h.navApi.getIsLocked()&&!h.currentlyAnimating){a=d(a,g);M=La(c);c.removeEventListener("mousemove",za,!1);document.addEventListener("mouseup",Ja,!1);document.addEventListener("touchend",Ja,!1);h.navApi.getUsePivotAlways()||(h.pivot.copy(h.center),h.navApi.setPivotPoint(h.center),h.navApi.setPivotSetFlag(!1));h.startInteraction(a.pageX,
a.pageY);0==h.rewindParams.history.length&&h.addHistoryElement();h.rewindParams.snapped&&h.rewindParams.timelineIndex+1==h.rewindParams.history.length||h.addIntermediateHistoryElement();var b=h.navApi.getUseLeftHandedInput()?1:3;a.which!==b&&(0>=g.animSpeed?console.error("animSpeed cannot be 0 or less, use ViewCube.animate flag to turn on and off animation"):(a=Aa(a,M),a=aa(a,g.camera,R),0<a.length&&(wa(),g.draggable&&(document.addEventListener("mousemove",Da,!1),document.addEventListener("touchmove",
Da,!1),ja&&(c.requestPointerLock(),Z=ea&&ca)))))}},Da=function(a){a.preventDefault();a.stopPropagation();0>=g.animSpeed?(document.removeEventListener("mousemove",Da,!1),document.removeEventListener("touchmove",Da,!1),console.error("animSpeed cannot be 0 or less")):h.currentlyAnimating||(a=d(a,g),ja&&Z&&(Z=!1,a.movementX=a.movementY=0),a.movementX===a.movementY&&0===a.movementX?h.currentlyAnimating=!1:(ga=!1,Q=!0,h.showPivot(!0),h.currentCursor=new THREE.Vector2(a.pageX,a.pageY),h.orbit(h.currentCursor,
h.startCursor,new THREE.Vector3(-a.movementX,a.movementY,0),h.startState),g.camera.lookAt(g.center),requestAnimationFrame(g.render)))},ta=function(a){a||(document.removeEventListener("mouseup",Ja,!1),document.removeEventListener("touchend",Ja,!1));document.removeEventListener("mousemove",Da,!1);document.removeEventListener("touchmove",Da,!1);c.addEventListener("mousemove",za,!1)},Ja=function(a){a.preventDefault();a.stopPropagation();var b,f,l;if(h.currentlyAnimating||Q)h.endInteraction(),h.showPivot(!1),
Q=!1,ta(!1);else{var n=d(a,g);if(h.viewCubeMenuOpen){a=n.clientX-M.x;b=n.clientY-M.y;if(h.menuOrigin.x<=a&&a<=h.menuOrigin.x+h.menuSize.x&&h.menuOrigin.y<=b&&b<=h.menuOrigin.y+h.menuSize.y)switch(Math.floor((b-5-h.menuOrigin.y)/25)){case 0:h.goHome();break;case 1:h.setOrthographicFaces(!1);h.toOrthographic();break;case 2:h.setOrthographicFaces(!1);h.toPerspective();break;case 3:h.setOrthographicFaces(!0);ga?h.toOrthographic():h.toPerspective();break;case 4:h.setCurrentViewAsHome(!1);break;case 5:h.setCurrentViewAsHome(!0);
break;case 6:h.resetHome();break;case 7:h.setCurrentViewAsFront();break;case 8:h.setCurrentViewAsTop();break;case 9:h.resetOrientation()}h.viewCubeMenuOpen=!1;h.removeDropdownMenu(c);(n.clientX<M.x||n.clientX>M.w+M.x||n.clientY<M.y||n.clientY>M.h+M.y)&&Ia();g.mouseMoveSave&&g.processMouseMove(g.mouseMoveSave);ta(!1)}else if(b=h.navApi.getUseLeftHandedInput()?1:3,n.which===b)h.viewCubeMenuOpen=!0,h.drawDropdownMenu(q,m,p,n.clientX,n.clientY,c,M),ta(!0);else{l=Aa(n,M);b=aa(l,g.camera,R);f=aa(l,z,C);
l=aa(l,z,K);if(0<f.length&&ga){var w=h.getOrientation();switch(g.currentFace){case "front":switch(w){case "up":f[0].object===C[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):f[0].object===C[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case "right":f[0].object===C[0]?(h.calculateCubeTransform("right"),g.currentFace=
"right"):f[0].object===C[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case "down":f[0].object===C[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[3]&&
(h.calculateCubeTransform("right"),g.currentFace="right");break;case "left":f[0].object===C[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):f[0].object===C[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case "right":switch(w){case "up":f[0].object===C[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===
C[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[3]&&(h.calculateCubeTransform("front"),g.currentFace="front");break;case "right":f[0].object===C[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[3]&&(h.calculateCubeTransform("top"),
g.currentFace="top");break;case "down":f[0].object===C[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[3]&&(h.calculateCubeTransform("back"),g.currentFace="back");break;case "left":f[0].object===C[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[1]?(h.calculateCubeTransform("back"),g.currentFace=
"back"):f[0].object===C[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case "left":switch(w){case "up":f[0].object===C[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[3]&&(h.calculateCubeTransform("back"),g.currentFace="back");
break;case "right":f[0].object===C[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[2]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case "down":f[0].object===C[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===
C[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[3]&&(h.calculateCubeTransform("front"),g.currentFace="front");break;case "left":f[0].object===C[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case "back":switch(w){case "up":f[0].object===
C[0]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[1]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;case "right":f[0].object===C[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):f[0].object===C[2]?(h.calculateCubeTransform("bottom"),
g.currentFace="bottom"):f[0].object===C[3]&&(h.calculateCubeTransform("top"),g.currentFace="top");break;case "down":f[0].object===C[0]?(h.calculateCubeTransform("bottom"),g.currentFace="bottom"):f[0].object===C[1]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):f[0].object===C[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case "left":f[0].object===C[0]?(h.calculateCubeTransform("right"),g.currentFace=
"right"):f[0].object===C[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[2]?(h.calculateCubeTransform("top"),g.currentFace="top"):f[0].object===C[3]&&(h.calculateCubeTransform("bottom"),g.currentFace="bottom")}break;case "top":switch(w){case "up":f[0].object===C[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):
f[0].object===C[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case "right":f[0].object===C[0]?(h.calculateCubeTransform("right"),g.currentFace="right"):f[0].object===C[1]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[3]&&(h.calculateCubeTransform("back"),g.currentFace="back");break;case "down":f[0].object===C[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===
C[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;case "left":f[0].object===C[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):f[0].object===C[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[3]&&(h.calculateCubeTransform("front"),
g.currentFace="front")}break;case "bottom":switch(w){case "up":f[0].object===C[0]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[1]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[2]?(h.calculateCubeTransform("right"),g.currentFace="right"):f[0].object===C[3]&&(h.calculateCubeTransform("left"),g.currentFace="left");break;case "right":f[0].object===C[0]?(h.calculateCubeTransform("right"),g.currentFace="right"):f[0].object===C[1]?(h.calculateCubeTransform("left"),
g.currentFace="left"):f[0].object===C[2]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[3]&&(h.calculateCubeTransform("front"),g.currentFace="front");break;case "down":f[0].object===C[0]?(h.calculateCubeTransform("back"),g.currentFace="back"):f[0].object===C[1]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[2]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[3]&&(h.calculateCubeTransform("right"),g.currentFace="right");break;
case "left":f[0].object===C[0]?(h.calculateCubeTransform("left"),g.currentFace="left"):f[0].object===C[1]?(h.calculateCubeTransform("right"),g.currentFace="right"):f[0].object===C[2]?(h.calculateCubeTransform("front"),g.currentFace="front"):f[0].object===C[3]&&(h.calculateCubeTransform("back"),g.currentFace="back")}}h.elapsedTime=0;h.sphericallyInterpolateTransition()}if(0<l.length){h.elapsedTime=0;if(g.wantHomeButton&&l[0].object===K[O]){h.goHome();ta(!1);return}if(g.wantContextMenu&&l[0].object===
K[da]){h.viewCubeMenuOpen=!0;h.drawDropdownMenu(q,m,p,n.clientX,n.clientY,c,M);ta(!0);return}g.wantRollArrows&&ga&&(l[0].object===K[Y]||l[0].object===K[W])&&(n=l[0].object===K[W],f={center:h.center.clone(),position:k.position.clone(),pivot:k.pivot.clone(),fov:k.fov,worldUp:h.sceneUpDirection.clone(),isOrtho:!1===k.isPerspective},l=h.center.clone().sub(k.position).normalize(),n?f.up=k.up.clone().cross(l):(f.up=k.up.clone().multiplyScalar(-1),f.up.cross(l)),f.up.normalize(),h.elapsedTime=0,h.animateTransition(f))}0<
b.length&&(g.currentFace=b[0].object.name,h.orthographicFaces&&-1!==g.currentFace.indexOf(",")&&h.setCameraOrtho(!1),h.calculateCubeTransform(g.currentFace),h.elapsedTime=0,g.mouseMoveSave=a,h.sphericallyInterpolateTransition(function(){g.mouseMoveSave&&g.processMouseMove(g.mouseMoveSave)}));ta(!1)}}};this.processMouseMove=function(a){var b,c;if(h.viewCubeMenuOpen||h.currentlyAnimating)g.mouseMoveSave=a;else{g.mouseMoveSave=null;a=d(a,g);c=Aa(a,M);a=aa(c,g.camera,N);b=aa(c,z,C);c=aa(c,z,K);T&&!Q&&
(T.material.color.setHex(14540253),T=null,requestAnimationFrame(g.render));if(0<b.length&&!Q){T=b[0].object;for(b=L.children.length;0<=--b;)if(T===C[b]){T=L.children[b];T.material.color.setHex(45055);break}requestAnimationFrame(g.render)}ba&&!Q&&(ba.material.opacity=0,ba=null,requestAnimationFrame(g.render));0<a.length&&!Q&&(ba=a[0].object,ba.material.opacity=.3,requestAnimationFrame(g.render));0<c.length&&!Q?X!==c[0].object&&(g.wantHomeButton&&c[0].object===K[O]?(X=c[0].object,K[O].material.map=
ma[0]):g.wantRollArrows&&c[0].object===K[Y]?(X=c[0].object,K[U].material.map=ma[1]):g.wantRollArrows&&c[0].object===K[W]?(X=c[0].object,K[U].material.map=ma[2]):g.wantContextMenu&&c[0].object===K[da]?(X=c[0].object,K[da].material.map=ma[6]):g.wantHomeButton&&X===K[O]?(X=null,K[O].material.map=ma[3]):!g.wantRollArrows||X!==K[Y]&&X!==K[W]&&X!==K[U]?g.wantContextMenu&&X===K[da]&&(X=null,K[da].material.map=ma[5]):(X=null,K[U].material.map=ma[4]),requestAnimationFrame(g.render)):null===X||Q||(g.wantHomeButton&&
X===K[O]?(X=null,K[O].material.map=ma[3]):!g.wantRollArrows||X!==K[Y]&&X!==K[W]&&X!==K[U]?g.wantContextMenu&&X===K[da]&&(X=null,K[da].material.map=ma[5]):(X=null,K[U].material.map=ma[4]),requestAnimationFrame(g.render))}};var za=function(a){h.navApi.getIsLocked()||g.processMouseMove(a)},Ba=function(){M=La(c);g.width=c.offsetWidth;g.height=c.offsetHeight;g.camera.aspect=g.width/g.height;g.camera.updateProjectionMatrix();g.camera.topFov=g.camera.bottomFov=g.camera.fov/2;g.camera.leftFov=g.camera.rightFov=
g.camera.aspect*g.camera.fov/2;B.setSize(g.width,g.height);requestAnimationFrame(g.render)},ka=function(a,b){var c,d=new THREE.Geometry;c=new THREE.Vector3(0,0,0);var f=new THREE.Vector3(60,-60,105),g=new THREE.Vector3(60,60,105),h=new THREE.Vector3(-60,60,105),k=new THREE.Vector3(-60,-60,105);d.vertices.push(c);d.vertices.push(f);d.vertices.push(g);d.vertices.push(h);d.vertices.push(k);d.faces.push(new THREE.Face3(1,2,3));d.faces.push(new THREE.Face3(1,3,4));d.applyMatrix((new THREE.Matrix4).makeRotationX(a));
d.applyMatrix((new THREE.Matrix4).makeRotationY(b));d.computeFaceNormals();d.computeVertexNormals();c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0});return new THREE.Mesh(d,c)},oa=function(a,b,c){var d=new THREE.Geometry,f=new THREE.Vector3(60,105,105),g=new THREE.Vector3(-60,105,105),h=new THREE.Vector3(-60,60,105),k=new THREE.Vector3(60,60,105),m=new THREE.Vector3(60,105,60),l=new THREE.Vector3(-60,105,60),n=new THREE.Vector3(-60,105,105),q=new THREE.Vector3(60,
105,105);d.vertices.push(f);d.vertices.push(g);d.vertices.push(h);d.vertices.push(k);d.vertices.push(m);d.vertices.push(l);d.vertices.push(n);d.vertices.push(q);d.faces.push(new THREE.Face3(0,1,2));d.faces.push(new THREE.Face3(0,2,3));d.faces.push(new THREE.Face3(4,5,6));d.faces.push(new THREE.Face3(4,6,7));d.applyMatrix((new THREE.Matrix4).makeRotationX(a));d.applyMatrix((new THREE.Matrix4).makeRotationY(b));d.applyMatrix((new THREE.Matrix4).makeRotationZ(c));d.computeFaceNormals();d.computeVertexNormals();
a=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0});return new THREE.Mesh(d,a)},fa=function(a,b){var c,d=new THREE.Geometry;c=new THREE.Vector3(105,105,105);var f=new THREE.Vector3(60,105,105),g=new THREE.Vector3(60,60,105),h=new THREE.Vector3(105,60,105),k=new THREE.Vector3(105,105,60),m=new THREE.Vector3(105,105,105),l=new THREE.Vector3(105,60,105),n=new THREE.Vector3(105,60,60),q=new THREE.Vector3(105,105,105),w=new THREE.Vector3(105,105,60),p=new THREE.Vector3(60,
105,60),t=new THREE.Vector3(60,105,105);d.vertices.push(c);d.vertices.push(f);d.vertices.push(g);d.vertices.push(h);d.vertices.push(k);d.vertices.push(m);d.vertices.push(l);d.vertices.push(n);d.vertices.push(q);d.vertices.push(w);d.vertices.push(p);d.vertices.push(t);d.faces.push(new THREE.Face3(0,1,2));d.faces.push(new THREE.Face3(0,2,3));d.faces.push(new THREE.Face3(4,5,6));d.faces.push(new THREE.Face3(4,6,7));d.faces.push(new THREE.Face3(8,9,10));d.faces.push(new THREE.Face3(8,10,11));d.applyMatrix((new THREE.Matrix4).makeRotationX(a));
d.applyMatrix((new THREE.Matrix4).makeRotationY(b));d.computeFaceNormals();d.computeVertexNormals();c=new THREE.MeshBasicMaterial({overdraw:!0,opacity:0,color:45055,transparent:!0});return new THREE.Mesh(d,c)},qa=function(a){var b=h.cubeFront.clone(),c=h.sceneUpDirection.clone(),d=b.clone().cross(c);c.copy(d).cross(b);b.normalize();c.normalize();d.normalize();var f=(new THREE.Vector3(b.x,c.x,d.x)).multiplyScalar(a.x);f.add((new THREE.Vector3(b.y,c.y,d.y)).multiplyScalar(a.y));f.add((new THREE.Vector3(b.z,
c.z,d.z)).multiplyScalar(a.z));return f};this.render=function(){var a=g.compass?g.viewScaleFactorCompass*g.viewScale:g.viewScale,b=h.center.clone().sub(k.position).normalize(),c=k.up.normalize(),b=qa(b),c=qa(c);g.camera.position.copy(b);g.camera.position.multiplyScalar(-a/g.camera.position.length());g.camera.up=c.normalize();g.camera.lookAt(g.center);ga=h.isFaceView();!ga||ha||h.currentlyAnimating?wa():(F.add(L),a=g.wantRollArrows?1:0,K[U].material.opacity=a,K[da].material.opacity=a);I.material.opacity=
ha?0:g.wantContextMenu?1:0;E.material.opacity=ha?0:g.wantHomeButton?1:0;B.clear();B.render(t,g.camera);B.render(v,g.camera);B.render(w,g.camera);B.render(D,g.camera);B.render(F,z)};var wa=function(){F.remove(L);K[U].material.opacity=0;K[da].material.opacity=0};this.refreshCube=function(){Ba()};this.setSize=function(a,b){g.width=a;g.height=b;if(1<c.children.length)for(var d=1;d<c.children.length;d++)c.children[d].style.bottom=(g.height/5).toString()+"px";Ba()};this.useTransparency=function(a){(ha=
a)?(c.onmouseover=Fa,c.onmousemove=Wa,c.onmouseout=Ia,Ia()):(c.onmouseover=null,c.onmouseout=null,c.onmousemove=null,c.style.opacity="1.0")};(function(){var a=c.getBoundingClientRect();g.width=a.width;g.height=a.height;M=La(c);z=new THREE.PerspectiveCamera(70,g.height/g.width,1,1E4);z.position.set(0,0,500);t=new THREE.Scene;v=new THREE.Scene;D=new THREE.Scene;w=new THREE.Scene;F=new THREE.Scene;ga=!0;V=200;g.viewScale=3.5*V;var b=THREE.LinearFilter,a=Autodesk.Viewing.Private.getResourceUrl,d=f||"res/textures/",
k=(new THREE.DDSLoader).load(a(d+"VCcrossRGBA8small.dds"));k.minFilter=k.maxFilter=b;d=THREE.ShaderLib.cube;d=new THREE.ShaderMaterial({fragmentShader:d.fragmentShader,vertexShader:d.vertexShader,uniforms:THREE.UniformsUtils.clone(d.uniforms),depthWrite:!1});d.uniforms.tCube.value=k;var m=new THREE.BoxGeometry(V,V,V,2,2,2),k=new THREE.BoxGeometry(V+1,V+1,V+1,2,2,2);G=new THREE.Mesh(m,d);G.position.set(0,0,0);v.add(G);d=ua(a("res/textures/VCedge1.png"));d.minFilter=d.maxFilter=b;A=new THREE.Mesh(k,
new THREE.MeshBasicMaterial({map:d,overdraw:!1,transparent:!0,shading:THREE.SmoothShading}));A.position.set(0,0,0);w.add(A);var b=V,d=new THREE.Geometry,k=new THREE.Vector3(-30,0,0),m=new THREE.Vector3(30,0,0),q=new THREE.Vector3(0,-30,0);d.vertices.push(k);d.vertices.push(m);d.vertices.push(q);d.faces.push(new THREE.Face3(1,0,2));d.computeFaceNormals();var q=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),p=new THREE.MeshBasicMaterial({overdraw:!0,
color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),ea=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),ca=new THREE.MeshBasicMaterial({overdraw:!0,color:14540253,transparent:!1,opacity:1,shading:THREE.FlatShading}),k=new THREE.PlaneBufferGeometry(.5*V,.3*V,2,2),m=new THREE.MeshBasicMaterial({transparent:!0,opacity:0}),q=new THREE.Mesh(d,q),Q=new THREE.Mesh(k,m);q.position.set(0,b,0);Q.position.set(0,.9*b,.1);var p=new THREE.Mesh(d,
p),ha=new THREE.Mesh(k,m);p.position.set(0,-b,0);ha.position.set(0,.9*-b,.1);p.rotation.z+=Math.PI;ha.rotation.z+=Math.PI;var ea=new THREE.Mesh(d,ea),Z=new THREE.Mesh(k,m);ea.position.set(b,0,0);Z.position.set(.9*b,0,.1);ea.rotation.z-=Math.PI/2;Z.rotation.z-=Math.PI/2;d=new THREE.Mesh(d,ca);k=new THREE.Mesh(k,m);d.position.set(-b,0,0);k.position.set(.9*-b,0,.1);d.rotation.z+=Math.PI/2;k.rotation.z+=Math.PI/2;L=new THREE.Object3D;L.position.set(0,0,0);L.add(q);L.add(p);L.add(ea);L.add(d);F.add(Q);
F.add(ha);F.add(Z);F.add(k);F.add(L);C.push(Q);C.push(ha);C.push(Z);C.push(k);b=new THREE.PlaneBufferGeometry(V/3,V/3,2,2);d=new THREE.MeshBasicMaterial({map:ua(a("res/textures/VChome.png")),transparent:!0,shading:THREE.FlatShading});E=new THREE.Mesh(b,d);E.position.set(-V,V,0);O=K.length;F.add(E);K.push(E);b=new THREE.PlaneBufferGeometry(1.5*V,1.5*V,2,2);d=new THREE.MeshBasicMaterial({map:ua(a("res/textures/VCarrows.png")),shading:THREE.FlatShading,transparent:!0});b=new THREE.Mesh(b,d);b.position.set(.5*
V+20,.5*V+20,0);d=new THREE.PlaneBufferGeometry(.6*V,.45*V,2,2);k=new THREE.MeshBasicMaterial({transparent:!0,opacity:0});d=new THREE.Mesh(d,k);d.position.set(.5*V+20,V+20,.1);k=new THREE.PlaneBufferGeometry(.45*V,.6*V,2,2);m=new THREE.MeshBasicMaterial({transparent:!0,opacity:0});k=new THREE.Mesh(k,m);k.position.set(V+20,.5*V+20,.1);F.add(b);F.add(d);F.add(k);Y=K.length;K.push(d);W=K.length;K.push(k);U=K.length;K.push(b);b=new THREE.PlaneBufferGeometry(V/2.3,V/2.3,2,2);d=new THREE.MeshBasicMaterial({map:ua(a("res/textures/VCcontext.png")),
transparent:!0,shading:THREE.FlatShading});I=new THREE.Mesh(b,d);I.position.set(V,-V,0);da=K.length;F.add(I);K.push(I);b=new THREE.Geometry;b.vertices.push(new THREE.Vector3(0,0,0));b.vertices.push(new THREE.Vector3(-V/2,-V/2-20,-V/2));b.vertices.push(new THREE.Vector3(V/2,-V/2-20,-V/2));b.vertices.push(new THREE.Vector3(V/2,-V/2-20,V/2));b.vertices.push(new THREE.Vector3(-V/2,-V/2-20,V/2));b.faces.push(new THREE.Face3(4,3,2));b.faces.push(new THREE.Face3(4,2,1));d=new THREE.MeshBasicMaterial({color:0,
transparent:!0,opacity:.5});H=new THREE.Mesh(b,d);t.add(H);d=[];k=[];d[0]=fa(0,0);d[1]=fa(0,Math.PI/2);d[2]=fa(0,-Math.PI/2);d[3]=fa(0,Math.PI);d[4]=fa(Math.PI/2,0);d[5]=fa(Math.PI/2,Math.PI/2);d[6]=fa(Math.PI/2,-Math.PI/2);d[7]=fa(Math.PI/2,Math.PI);k[0]=oa(0,0,0);k[1]=oa(0,Math.PI/2,0);k[2]=oa(0,-Math.PI/2,0);k[3]=oa(0,Math.PI,0);k[4]=oa(Math.PI/2,0,0);k[5]=oa(Math.PI/2,Math.PI/2,0);k[6]=oa(Math.PI/2,-Math.PI/2,0);k[7]=oa(Math.PI/2,Math.PI,0);k[8]=oa(0,0,Math.PI/2);k[9]=oa(0,0,-Math.PI/2);k[10]=
oa(-Math.PI/2,0,-Math.PI/2);k[11]=oa(-Math.PI,0,-Math.PI/2);J.push(ka(0,0));J[0].name="front";N.push(J[0]);R.push(J[0]);D.add(J[0]);J.push(ka(0,Math.PI/2));J[1].name="right";N.push(J[1]);R.push(J[1]);D.add(J[1]);J.push(ka(0,Math.PI));J[2].name="back";N.push(J[2]);R.push(J[2]);D.add(J[2]);J.push(ka(0,-Math.PI/2));J[3].name="left";N.push(J[3]);R.push(J[3]);D.add(J[3]);J.push(ka(Math.PI/2,0));J[4].name="bottom";N.push(J[4]);R.push(J[4]);D.add(J[4]);J.push(ka(-Math.PI/2,0));J[5].name="top";N.push(J[5]);
R.push(J[5]);D.add(J[5]);b=J.length;for(m=0;m<d.length;m++)J.push(d[m]),J[b+m].name=n[m],D.add(J[b+m]),N.push(J[b+m]),R.push(J[b+m]);b=J.length;for(m=0;m<k.length;m++)J.push(k[m]),J[b+m].name=l[m],D.add(J[b+m]),N.push(J[b+m]),R.push(J[b+m]);"CANVAS"===h.renderer.toUpperCase()?B=new THREE.CanvasRenderer:"WEBGL"===h.renderer.toUpperCase()?B=new FireflyWebGLRenderer({alpha:!0,antialias:!0}):(console.log("Incorrect use of Autocam.renderer property"),B=new THREE.CanvasRenderer);g.useTransparency(!0);g.setSize(g.width,
g.height);g.camera.topFov=g.camera.bottomFov=g.camera.fov/2;g.camera.leftFov=g.camera.rightFov=g.camera.aspect*g.camera.fov/2;B.autoClear=!1;B.setSize(g.width,g.height);B.sortObjects=!1;c.appendChild(B.domElement);c.addEventListener("touchstart",Na,!1);c.addEventListener("mousedown",Na,!1);c.addEventListener("mousemove",za,!1);window.addEventListener("resize",Ba,!1);ja=!1;ma.push(ua(a("res/textures/VChomeS.png")));ma.push(ua(a("res/textures/VCarrowsS0.png")));ma.push(ua(a("res/textures/VCarrowsS1.png")));
ma.push(ua(a("res/textures/VChome.png")));ma.push(ua(a("res/textures/VCarrows.png")));ma.push(ua(a("res/textures/VCcontext.png")));ma.push(ua(a("res/textures/VCcontextS.png")))})()};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ToolController=function(a,b,c,f,d){function g(a,c){return b.navigation.getUseLeftHandedInput()&&0===a||k&&1===a||h&&!l&&0===a&&c.ctrlKey}this.domElement=b.canvasWrap;this.selector=a.selector;this.autocam=c;this.lastClickY=this.lastClickX=-1;var h=-1!=navigator.userAgent.search("Mac OS"),k=-1!=navigator.userAgent.search("Firefox");a=-1!==navigator.userAgent.search("Chrome");var l=-1!==navigator.userAgent.search("Safari")&&!a,n={},q=[],m=!1,p=-1,t=-1,v=!1,D=null,w=void 0,F=!1,B={},
z=this;this.__registerToolByName=function(a,b){n[b]=a};this.registerTool=function(a){var b=a.getNames();if(!b||0==b.length)return console.log("Cannot register tool with no name."),!1;for(var c=!1,d=0;d<b.length;++d)"default"!==b[d]&&(this.__registerToolByName(a,b[d]),c=!0);a.utilities=f;a.controller=this;a.register&&a.register();return c};this.deregisterTool=function(a){this.deactivateTool(a.getName());var b=a.getNames();if(!b||0==b.length)return!1;for(var c=b.length;0<=--c;)this.__deregisterToolName(b[c]);
a.deregister&&a.deregister();a.utilities=null;a.controller=null;return!0};this.__deregisterToolName=function(a){if(a in n){for(var b=q.length;0<=--b;)q[b]===a&&(n[a].deactivate(a),q.splice(b,1));delete n[a]}};this.getTool=function(a){return n[a]};this.getActiveToolName=function(){var a=q.length;return 0<a?q[a-1]:"default"};this.activateTool=function(a){if(m)return!1;var c=n[a];if(c){var d=null;"intercept"===q[q.length-1]&&(d=q.pop());q.push(a);c.activate(a);d&&q.push(d);b.fireEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,
toolName:a,active:!0});return!0}stderr("activateTool not found: "+a);return!1};this.deactivateTool=function(a){if(m)return!1;for(var c=q.length;0<=--c;)if(q[c]===a)return q.splice(c,1),n[a].deactivate(a),b.fireEvent({type:Autodesk.Viewing.TOOL_CHANGE_EVENT,toolName:a,active:!1}),!0;stderr("deactivateTool not found: "+a);return!1};this.getToolNames=function(){return Object.keys(n)};this.setDefaultTool=function(a){var b=this.getDefaultTool();return a&&a!==b?(this.__registerToolByName(a,"default"),b&&
b.deactivate("default"),a.activate("default"),!0):!1};this.getDefaultTool=function(){return n["default"]};this.setDefaultTool(d);this.setIsLocked=function(a){var b=m;m=!!a;return b};this.getIsLocked=function(){return m};this.__checkCursor=function(){for(var a=null,c=q.length;0<=--c;){var d=n[q[c]];if("getCursor"in d&&(a=d.getCursor()))break}a||(a="auto");D!=a&&(D=b.canvas.style.cursor=a)};this.update=function(a){this.__checkCursor();var c=!1;f&&f.update()&&(c=!0);for(var d=q.length;0<=--d;){var g=
n[q[d]];"update"in g&&g.update(a)&&(c=!0)}b.navigation.getCamera().dirty?(b.navigation.updateCamera(),this.cameraUpdated=c=!0):this.cameraUpdated=!1;c?(b.navigation.updateCamera(),this.moveDelay=Date.now()+150):0!==this.moveDelay&&(0<this.moveDelay-Date.now()?c=!0:this.moveDelay=0);return c};this.__clientToCanvasCoords=function(a,c,d){var f=b.navigation.getScreenViewport(),g=f.width,h=f.height,k=a.clientX-f.left,f=a.clientY-f.top;a.canvasX=k;a.canvasY=f;a.normalizedX=k/g*2-1;a.normalizedY=(h-f)/h*
2-1;c&&c.set(k/g,f/h,0);d&&d.set(k,f)};this.__invokeStack=function(a,b,c){for(var d=q.length;0<=--d;){var f=n[q[d]];if(a in f&&f[a](b,c))return!0}d=this.getDefaultTool();return a in d&&d[a](b,c)?!0:!1};this.distributeEvent=function(a,b,c){return this.__invokeStack(a,b,c)};this.handleResize=function(){b.navigation.setScreenViewport(b.container.getBoundingClientRect());for(var a=q.length;0<=--a;){var c=n[q[a]];"handleResize"in c&&c.handleResize()}};this.handleSingleClick=function(a){var b=this.applyButtonMappings(a);
this.lastClickX=a.clientX;this.lastClickY=a.clientY;this.__invokeStack("handleSingleClick",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleDoubleClick=function(a){var b=this.applyButtonMappings(a);this.__invokeStack("handleDoubleClick",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleSingleTap=function(a){this.lastClickX=a.canvasX;this.lastClickY=a.canvasY;this.__invokeStack("handleSingleTap",a)&&(a.preventDefault(),a.stopPropagation())};this.handleDoubleTap=function(a){this.lastClickX=
a.canvasX;this.lastClickY=a.canvasY;this.__invokeStack("handleDoubleTap",a)&&(a.preventDefault(),a.stopPropagation())};this.handleWheelInput=function(a,b){this.__invokeStack("handleWheelInput",a)&&(b.preventDefault(),b.stopPropagation())};this.applyButtonMappings=function(a){var c=a.button;"buttons"in a&&(a.firefoxSpoof?c=0:!v||a.buttons&1?2===c&&a.buttons&1&&(c=0,a.firefoxSpoof=v=!0):(a.firefoxSpoof=!0,v=!1,c=0));b.navigation.getUseLeftHandedInput()&&(c=0===c?2:2===c?0:c);return c};this.applyKeyMappings=
function(a,b){switch(a.keyCode){case 91:case 93:case 224:return h&&a.metaKey&&a.shiftKey?null:17;case 16:return b&&h&&a.metaKey?null:16;case 61:return 187;case 173:case 109:return 189}return a.keyCode};this.handleKeyDown=function(a){var b=this.applyKeyMappings(a,!0);b&&this.__invokeStack("handleKeyDown",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleKeyUp=function(a){var b=this.applyKeyMappings(a,!0);b&&this.__invokeStack("handleKeyUp",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleButtonDown=
function(a,b){this.__invokeStack("handleButtonDown",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleButtonUp=function(a,b){this.__invokeStack("handleButtonUp",a,b)&&(a.preventDefault(),a.stopPropagation())};this.handleMouseMove=function(a){this.__invokeStack("handleMouseMove",a)&&(a.preventDefault(),a.stopPropagation())};this.handleBlur=function(a){this.__invokeStack("handleBlur",a)&&(a.preventDefault(),a.stopPropagation())};this.keydown=function(a){if(!(!z.domElement.contains(w)||document.activeElement instanceof
HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement)){if(document.activeElement){var b=document.activeElement.getAttribute("contenteditable");if("true"===b||""===b)return}h&&a.metaKey&&91!=a.keyCode&&93!=a.keyCode||z.handleKeyDown(a)}};this.keyup=function(a){h&&a.metaKey&&91!=a.keyCode&&93!=a.keyCode||z.handleKeyUp(a)};this.mousedown=function(a){function b(a){z.applyButtonMappings(a)===c&&(document.removeEventListener("mouseup",b),z.mouseup(a))}_isIE11&&inFullscreen()||document.activeElement.blur();
z.__clientToCanvasCoords(a);var c=z.applyButtonMappings(a);z.handleButtonDown(a,c);p=a.canvasX;t=a.canvasY;if(g(c,a)){var d=void 0!==B.time&&500>a.timeStamp-B.time,f=void 0!==B.x&&void 0!==B.y&&2>=Math.abs(B.x-a.canvasX)&&2>=Math.abs(B.y-a.canvasY);if(!d||!f||B.clickCount&&2<=B.clickCount)B.clickCount=0;B.clickCount?1===B.clickCount&&(B.clickCount=2):(B.clickCount=1,B.x=a.canvasX,B.y=a.canvasY,B.time=a.timeStamp)}document.addEventListener("mouseup",b,!1)};this.mousemove=function(a){z.__clientToCanvasCoords(a);
var b=t-a.canvasY;if(2<Math.abs(p-a.canvasX)||2<Math.abs(b))t=p=-1;z.handleMouseMove(a)};this.mouseup=function(a){z.__clientToCanvasCoords(a);var b=z.applyButtonMappings(a);z.handleButtonUp(a,b);var c=p-a.canvasX,d=t-a.canvasY;t=p=-1;2>=Math.abs(c)&&2>=Math.abs(d)&&z.handleSingleClick(a);g(b,a)&&2===B.clickCount&&(z.handleDoubleClick(a),B.clickCount=0,B.x=void 0,B.y=void 0,B.time=void 0)};this.doubleclick=function(a){z.__clientToCanvasCoords(a);p=a.canvasX;t=a.canvasY;z.handleDoubleClick(a)};this.mousewheel=
function(a){var b=0;a.wheelDelta?b=a.wheelDelta/40:a.detail&&(b=-a.detail);z.handleWheelInput(b,a)};this.blur=function(a){z.handleBlur(a)};this.mouseover=function(a){w=a.target};this.enableMouseButtons=function(a){a&&!F?(this.domElement.addEventListener("mousedown",this.mousedown,!1),this.domElement.addEventListener("dblclick",this.doubleclick,!1),window.addEventListener("mousemove",this.mousemove,!1),window.addEventListener("mouseover",this.mouseover,!1)):!a&&F&&(this.domElement.removeEventListener("mousedown",
this.mousedown),this.domElement.removeEventListener("dblclick",this.doubleclick),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseover",this.mouseover));var b=F;F=a;return b};this.enableMouseButtons(!0);this.domElement.addEventListener("mousewheel",this.mousewheel,!1);this.domElement.addEventListener("DOMMouseScroll",this.mousewheel,!1);window.addEventListener("keydown",this.keydown,!1);window.addEventListener("keyup",this.keyup,!1);window.addEventListener("blur",
this.blur,!1);this.uninitialize=function(){F&&(window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseover",this.mouseover));window.removeEventListener("keydown",this.keydown);window.removeEventListener("keyup",this.keyup);window.removeEventListener("blur",this.blur);z=q=n=this.autocam=this.selector=this.domElement=null};this.set2DMode=function(a){};this.setAutocam=function(a){};this.syncCamera=function(){};this.recordHomeView=function(){var a=b.navigation.getCamera();
c.sync(a);c.setHomeViewFrom(a)}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ViewingUtilities=function(a,b,c){this.autocam=b;var f=c.getCamera(),d={},g={},h=new function(a){var b=0,c=new THREE.SphereGeometry(1),d=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:.6,transparent:!0}),f=new THREE.Mesh(c,d);a.createOverlayScene("pivot");a.addOverlay("pivot",f);f.visible=!1;this.shown=function(){return f.visible};this.show=function(c,g,h){f.scale.x=g;f.scale.y=g;f.scale.z=g;f.position.set(c.x,c.y,c.z);d.opacity=.6;f.visible=!0;a.invalidate(!1,!1,!0);
b=h?Date.now()+500:0};this.hide=function(){f.visible&&(f.visible=!1,a.invalidate(!1,!1,!0),b=0)};this.fade=function(){if(0<b){var a=b-Date.now();if(0>=a)return this.hide(),!0;d.opacity=a/500*.6;return!0}return!1};this.fading=function(){return 0<b}}(a);this.transitionView=function(a,d,g,h,m,p){m=m||c.getWorldUpVector();if(p)if(h=m,p=d.clone().sub(a),0===p.lengthSq())h=p.copy(h);else{var t=p.clone().cross(h);0===t.lengthSq()&&(h.z>h.y?p.y-=1E-4:p.z-=1E-4,t.crossVectors(p,h));h=t.cross(p).normalize()}h||
(h=f.up);b.goToView({position:a,center:d,pivot:d,fov:g,up:h,worldUp:m,isOrtho:!1===f.isPerspective})};this.goHome=function(){b.goHome()};this.getHitPoint=function(b,c){c=2*(1-c)-1;var d=new THREE.Vector3(2*b-1,c,1);return(d=a.hitTestViewport(d,!1))?d.intersectPoint:null};this.activatePivot=function(a){var b=f.isPerspective?c.getPivotPlaneDistance():c.getEyeVector().length(),d=c.getVerticalFov(),b=2*b*Math.tan(THREE.Math.degToRad(.5*d)),d=c.getScreenViewport(),b=5*b/(d.height*(window.devicePixelRatio||
1));h.show(c.getPivotPoint(),b,a)};this.pivotActive=function(a,b){a=a&&!c.getIs2D();b=b||!1;!a&&h.shown()?h.hide():a&&this.activatePivot(b)};this.pivotUpdate=function(){h.shown()&&h.fade()&&a.invalidate(!1,!1,!0)};this.setPivotPoint=function(a,b,d){c.setPivotPoint(a);b||c.setTarget(a);d&&c.setPivotSetFlag(!0);this.setTemporaryPivot(null);c.getIs2D()||h.shown()&&this.activatePivot(h.fading())};this.savePivot=function(a){a||(a="default");d[a]=c.getPivotPoint();g[a]=c.getPivotSetFlag()};this.restorePivot=
function(a){a||(a="default");if(d[a]){var b=g[a];this.setPivotPoint(d[a],!0,b);b||c.setPivotSetFlag(!1);delete d[a];delete g[a]}};this.setTemporaryPivot=function(a){if(a){var b=c.getPivotPoint(),f=c.getPivotSetFlag();this.setPivotPoint(a,!0,f);d.TEMP=b;g.TEMP=f}else delete d.TEMP,delete g.TEMP};this.removeTemporaryPivot=function(){this.restorePivot("TEMP")};this.getBoundingBox=function(b){return a.getFitBounds(b)};this.fitToView=function(b){b=c.fitBounds(b,a.getFitBounds(!1));this.activatePivot(!0);
return b};this.update=function(){c.getRequestFitToView()&&!c.getTransitionActive()&&(c.setRequestFitToView(!1),this.fitToView());c.getRequestHomeView()&&!c.getTransitionActive()&&(c.setRequestHomeView(!1),this.goHome());var a=c.getRequestTransition();a&&!c.getTransitionActive()&&(c.setRequestTransition(!1),this.transitionView(a.position,a.coi,a.fov,a.up,a.worldUp,a.reorient));return!1}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.DefaultHandler=function(a,b,c){this.clickConfig=null;this.getNames=function(){return["default"]};this.getName=function(){return this.getNames()[0]};this.setClickBehavior=function(a){this.clickConfig=a};this.getClickBehavior=function(){return this.clickConfig};this.activate=function(a){};this.deactivate=function(a){};this.handleAction=function(b,d){for(var g=0;g<b.length;++g)switch(b[g]){case "selectOnly":a.selector&&d.node&&a.selector.setSelection([d.node]);break;case "deselectAll":a.selector&&
a.selector.setSelection([]);break;case "selectToggle":a.selector&&d.node&&a.selector.toggleSelection(d.node);break;case "isolate":d.node&&a.isolate(d.node);break;case "showAll":a.showAll();break;case "setCOI":d.intersectPoint&&(c.setPivotPoint(d.intersectPoint,!0,!0),c.pivotActive(!0,!0));break;case "hide":d.node&&a.hideMultiple([d.node]);break;case "show":d.node&&a.showMultiple([d.node]);break;case "toggleVisibility":d.node&&a.toggleVisibility(d.node);break;case "focus":a.selector&&(d.node?a.selector.setSelection([d.node]):
a.selector.setSelection([]),c.fitToView())}};this.handleSingleClick=function(b,d){var g=b.ctrlKey||b.metaKey,h=b.shiftKey,k=b.altKey;if(0===d){var l=new THREE.Vector3(b.normalizedX,b.normalizedY,1),l=a.hitTestViewport(l,!1),n="click";g&&(n+="Ctrl");h&&(n+="Shift");k&&(n+="Alt");g=l&&l.node?"onObject":"offObject";if(this.clickConfig&&this.clickConfig[n]&&this.clickConfig[n][g])return this.handleAction(this.clickConfig[n][g],l),!0}else if(1===d&&h&&!k&&!g&&(l=new THREE.Vector3(b.normalizedX,b.normalizedY,
1),l=a.hitTestViewport(l,!1),l.intersectPoint))return c.setPivotPoint(l.intersectPoint,!0,!0),c.pivotActive(!0,!0),!0;return!1};this.handleDoubleClick=function(f,d){if(null!=a.selector&&0===d){var g=new THREE.Vector3(f.normalizedX,f.normalizedY,1);(g=a.hitTestViewport(g,!1))&&g.node?a.selector.setSelection([g.node]):a.selector.clearSelection();c.fitToView();return!0}return 1===d?(b.fitBounds(!1,c.getBoundingBox(!0)),b.setPivotSetFlag(!1),!0):!1};this.handleSingleTap=function(c){return c.hasOwnProperty("pointers")&&
2===c.pointers.length?(b.setRequestHomeView(!0),!0):null!=a.selector?(c=new THREE.Vector3(c.normalizedX,c.normalizedY,1),(c=a.hitTestViewport(c,!1))&&c.node?a.selector.setSelection([c.node]):a.selector.clearSelection(),!0):!1};this.handleDoubleTap=function(a){a=this.handleSingleTap(a,0);c.fitToView();return a};this.handlePressHold=function(b){return"press"===b.type?(b.clientX=b.pointers[0].clientX,b.clientY=b.pointers[0].clientY,a.api.triggerContextMenu(b)):!1}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.GestureHandler=function(a){var b=a.navigation,c=["gestures"],f=this,d=!0,g=null,h=isTouchDevice();b.setIsTouchDevice(h);h&&(g=new Hammer.Manager(a.canvasWrap,{recognizers:[[Hammer.Tap,{event:"doubletap2",pointers:2,taps:2,interval:400,threshold:6,posThreshold:40}],[Hammer.Tap,{event:"doubletap",taps:2,interval:400,threshold:6,posThreshold:30}],[Hammer.Tap,{event:"singletap2",pointers:2,threshold:6}],[Hammer.Tap,{event:"singletap",threshold:6}],[Hammer.Pan,{event:"drag3",pointers:3,
threshold:15}],[Hammer.Pan,{event:"pan",pointers:2,threshold:20}],[Hammer.Pan,{event:"drag",pointers:1}],[Hammer.Rotate,{enable:!0,threshold:7}],[Hammer.Pinch,{enable:!0,threshold:.05}],[Hammer.Press,{event:"press",time:500}]],inputClass:Hammer.TouchInput}),a.canvasWrap.addEventListener("touchstart",function(a){a.preventDefault()},!1));this.getNames=function(){return c};this.getName=function(){return c[0]};this.__clientToCanvasCoords=function(a){var c=b.getScreenViewport(),d=c.width,f=c.height,g;
a.hasOwnProperty("center")?(g=a.center.x-c.left,c=a.center.y-c.top):(g=a.pointers[0].clientX-c.left,c=a.pointers[0].clientY-c.top);a.canvasX=g;a.canvasY=c;a.normalizedX=g/d*2-1;a.normalizedY=(f-c)/f*2-1};this.distributeGesture=function(a){f.__clientToCanvasCoords(a);f.controller.distributeEvent("handleGesture",a)&&a.preventDefault();a=a.type;-1!==a.indexOf("end",a.length-3)&&g.stop()};this.onSingleTap=function(a){f.__clientToCanvasCoords(a);f.controller.distributeEvent("handleSingleTap",a)&&a.preventDefault()};
this.onDoubleTap=function(a){f.__clientToCanvasCoords(a);f.controller.distributeEvent("handleDoubleTap",a)&&a.preventDefault()};this.onPressHold=function(a){f.__clientToCanvasCoords(a);"press"===a.type?d=f.controller.enableMouseButtons(!1):f.controller.enableMouseButtons(d);f.controller.distributeEvent("handlePressHold",a)&&a.preventDefault()};this.activate=function(a){g&&(g.on("dragstart dragmove dragend",this.distributeGesture),g.on("panstart panmove panend",this.distributeGesture),g.on("pinchstart pinchmove pinchend",
this.distributeGesture),g.on("rotatestart rotatemove rotateend",this.distributeGesture),g.on("drag3start drag3move drag3end",this.distributeGesture),g.on("singletap",this.onSingleTap),g.on("singletap2",this.onSingleTap),g.on("doubletap",this.onDoubleTap),g.on("doubletap2",this.onDoubleTap),g.on("press pressup",this.onPressHold),g.get("doubletap2").recognizeWith("doubletap"),g.get("singletap2").recognizeWith("singletap"),g.get("singletap").requireFailure("doubletap"))};this.deactivate=function(a){g&&
(g.off("dragstart dragmove dragend",this.distributeGesture),g.off("panstart panmove panend",this.distributeGesture),g.off("pinchstart pinchmove pinchend",this.distributeGesture),g.off("rotatestart rotatemove rotateend",this.distributeGesture),g.off("drag3start drag3move drag3end",this.distributeGesture),g.off("singletap",this.onSingleTap),g.off("singletap2",this.onSingleTap),g.off("doubletap",this.onDoubleTap),g.off("doubletap2",this.onDoubleTap),g.off("press pressup",this.onPressHold))};this.update=
function(){return!1};this.handleBlur=function(a){return!1}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.OrbitDollyPanTool=function(a,b){function c(a,b){var c=window.innerWidth,d=window.innerHeight;Y.set((a-.5*c-0)/(.5*c),(.5*d+0-b)/(.5*d),0);c=Y.length();1<c?Y.normalize():Y.z=Math.sqrt(1-c*c);R.copy(h.position).sub(h.pivot);ba.copy(h.up).setLength(Y.y);ba.add(X.copy(h.up).cross(R).setLength(Y.x));ba.add(R.setLength(Y.z));return ba}var f=this,d=-1!=navigator.userAgent.search("Mac OS"),g=b.navigation,h=g.getCamera(),k=["orbit","freeorbit","dolly","pan"],l=k[0],n=[l],q=l,m=null,p=0,t=
0,v=!1,D=null,w=!1,F,B,z=null,G=-5,A=new THREE.Vector3,E=new THREE.Vector3,H=new THREE.Vector2,I=new THREE.Vector2,J=new THREE.Vector2,L=new THREE.Vector2,C=new THREE.Vector3,N=new THREE.Vector3,K=new THREE.Vector3,R=new THREE.Vector3,T=new THREE.Vector3,ba=new THREE.Vector3,X=new THREE.Vector3,Y=new THREE.Vector3,W=new THREE.Vector3,U=new THREE.Quaternion,O=[!1,!1,!1,!1,!1,!1],da=0,V=0,M=0,la=0,ga=1,ja=5,Z=.025;this.getNames=function(){return k};this.getName=function(){return k[0]};this.activate=
function(a){n.push(a);q=a};this.deactivate=function(a){var b=n.length-1;0<b&&n[b]===a&&(n.pop(),q=n[b-1])};this.adjustDollyLookSpeed=function(a){0===a?(Z=.025,ja=5):(Z*=0<a?1.1:.9,ja*=0<a?1.1:.9,1E-6>Z&&(Z=1E-6),1E-6>ja&&(ja=1E-6))};this.getDollySpeed=function(a){var b=g.getEyeVector(),c=g.getPosition();a=a.clone().sub(c).dot(b.normalize())*Z;return.01>Math.abs(a)?0>a?-.01:.01:a};this.getLookSpeed=function(){return ja};this.coiIsActive=function(){return g.getPivotSetFlag()&&g.isPointVisible(g.getPivotPoint())};
this.adjustSpeed=function(a){this.adjustDollyLookSpeed(a);this.utilities.autocam&&(this.utilities.autocam.orbitMultiplier=this.getLookSpeed())};this.initTracking=function(a,b){var c;if(h.isPerspective){c=.5*(h.near+h.far);var d=this.utilities.getHitPoint(a,b),f=g.getPosition();d&&d.sub?(c=d.sub(f),d=g.getEyeVector().normalize(),c=Math.abs(d.dot(c))):g.getPivotSetFlag()&&g.isPointVisible(g.getPivotPoint())&&(d=g.getPivotPlaneDistance(),1E-5<d&&(c=d))}else c=g.getEyeVector().length();ga=c};this.initOrbit=
function(){this.utilities.setTemporaryPivot(0>=g.getPivotPoint().sub(g.getPosition()).dot(g.getEyeVector())?g.getTarget():null)};this.getCursor=function(){switch(l){case "freeorbit":case "orbit":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto";
case "dolly":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAgVBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8mJiYAAADNzc2/v7+fn59paWlPT08MDAwICAj6+vqpqak7Ozv29vby8vLp6em2traAgIBkZGRZWVlAQEAaGhpISEgkS7tbAAAAFHRSTlMAOvhpZD8mkQWegMy9qY1YVE01EYiqlE0AAADZSURBVCjPbY9ZloMgEAAbEbfsmRZZXbJn7n/AAX2RQVN/VD26AXLOeZLDGo6IbfI9tHq8cdxuj1HwvgCoaiHqKoRk+M3hB9jueUW8PnfsE/bJ3vms7nCkq7NoE3s99AXxoh8vFoXCpknrn5faAuJCenT0xPkYqnxQFJaU0gdZrsKm8aHZrAIffBj40mc1jsTfIJRWegq6opTMvlfqLqYg7kr1ZB7jFgeaMC59N//8O4WZ1IiPF8b5wMHcJn8zB4g4mc77zpxgAbMSUVoGK4iV0hL4wrksz+H0Bw5+E+HrniDQAAAAAElFTkSuQmCC), auto";
case "pan":return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAABHVBMVEUAAABPTk4AAAAAAAAJCQkRERE0MzQQEBAODg4QEBB4d3dbWlo9PDw/Pj4vLy8sLCwZGBgWFhYcHBwKCgoSEhIAAAAKCgoICAgKCgoQEBAODg4EBAQICAgPDw8REREMDAx2dnY0NDQvLy9QUFAaGhomJSYjIyM7OjokJCQNDA0mJiYNDQ0AAAAUFBQJCQkQEBAEBAQNDQ0PDw8VFRX///+amJkAAAD5+fnz8/PKycn9/f339vbi4eLR0dDNzMyAgIB8e3xycHH7+/vw7+/o6OjX1ta7urq4t7iwsLCnp6eioqKbmppva21OTk74+Pjl5eXc3Nzb29vLy8vDw8PDwsKrqqqdnZ2WlpaSkpKTkZKMiouEg4NkZGRISEgxLzBpgbsEAAAANHRSTlMA+fiQXgngKSYG/vX17uvBuqackpCNg3BpUkpAPBwTDvj18+vl0s/NwrOwoZZ+TDg4NBkBGrzX8QAAAP5JREFUKM99j9Vuw0AQRdeuKZyGkyZNmbnXDLHDVGb8/8/oy7paK1bO0+oc7WiGnGiaxq+QRTQAOh8f9Jv4H/Ge8PZPrCdlvkxfYluUT2WyyCq3mZ7unwlKVLcqOzA/Mf71j0TWJ/Ym6rPeca05Ni4iIevYc7yoUD2zQFhq71BdI9nvBeBabFDSPe8DswlUc1Riw3VxbH0NHBUPQ0jrbDnPYDjALQBMq9E7nkC5y7VDKTZlUg8Q0lmjvl74zlYErgvKa42GPKf3/a0kQmYCDY1SYMDosqMoiWrGwz/uAbNvc/fNon4kXRKGq+PUo2Mb96afV0iUxqGU2s4VBbKUP65NL/LKF+7ZAAAAAElFTkSuQmCC), auto"}return null};
this.getMotionDelta=function(a,b){var c=g&&g.getReverseZoomDirection()?-1.5:1.5;d&&(c*=-1);O[0]&&(E.x+=.01,J.x+=20);O[1]&&(E.x-=.01,J.x-=20);O[2]&&(E.y+=.01,J.y+=20);O[3]&&(E.y-=.01,J.y-=20);O[4]&&(E.z+=c);O[5]&&(E.z-=c);var c=E.x-A.x,f=E.y-A.y,h=E.z-A.z;.001>Math.abs(c)&&(c=0);.001>Math.abs(f)&&(f=0);.001>Math.abs(h)&&(h=0);a.set(c,f,h);b&&b.set(J.x-I.x,J.y-I.y)};this.stepMotionDelta=function(a,b){b?(A.x+=.6*a.x,A.y+=.6*a.y,A.z+=.6*a.z):A.copy(E);I.copy(J)};this.update=function(){var a=!1,c=!1,d;
this.getMotionDelta(C,L);d=C.x;var f=C.y,n=C.z;v||this.checkInteractionMode();(v=-1<G)&&this.controller.setIsLocked(!0);if(0!==d||0!==f||0!==n){switch(l){case "orbit":this.utilities.autocam&&this.utilities.autocam.startState&&(L.x=-L.x,D&&this.utilities.autocam.orbit(J,D,L.multiplyScalar(2),this.utilities.autocam.startState));break;case "freeorbit":R.subVectors(h.position,h.pivot);T.subVectors(h.position,h.target);c=T.length();T.normalize();if(d=Math.acos(N.dot(K)/N.length()/K.length()))d*=2,W.crossVectors(N,
K).normalize(),U.setFromAxisAngle(W,-d),R.applyQuaternion(U),h.up.applyQuaternion(U),K.applyQuaternion(U),T.applyQuaternion(U),N.copy(K);h.position.addVectors(h.pivot,R);h.target.subVectors(h.position,T.multiplyScalar(c));h.dirty=!0;break;case "dolly":n*=.6;0<=G?(f=-f,n=Math.abs(d)>Math.abs(f)?d:f,n*=100,c=d=.5):(d=g.getScreenViewport(),c=F/d.width,d=B/d.height);c=!g.getIs2D()&&g.getZoomTowardsPivot()?this.coiIsActive()?g.getPivotPoint():g.getWorldPoint(.5,.5):g.getWorldPoint(c,d);g.dollyFromPoint(n*
this.getDollySpeed(c),c);break;case "pan":g.panRelative(-d,f,ga);break;case "dollypan":0===d&&0===f||g.panRelative(-d,f,ga),d=g.getScreenViewport(),c=F/d.width,d=B/d.height,c=g.getWorldPoint(c,d),d=g.getPosition(),d=g.getIs2D()?d.sub(c).length():ga,f=(p/t-1)*d,g.dollyFromPoint(f,c),p=t,ga=d+f}c=!0}this.stepMotionDelta(C,"pan"!==l&&"dollypan"!==l);-1===G&&1E-5>Math.abs(n)&&(this.interactionEnd(-1),c=a=!0);(da||V)&&-1!==k.indexOf(b.getActiveNavigationTool())&&(c=!0);!w&&(a||-5<G)&&(-1<G&&(A.copy(E),
this.utilities.removeTemporaryPivot()),this.utilities.autocam.endInteraction(),G=-5,v&&this.controller.setIsLocked(!1),v=!1,m=D=null);c?this.utilities.pivotActive(g.getPivotSetFlag(),-1>=G):this.utilities.pivotUpdate();return h.dirty};this.checkInteractionMode=function(){var a;a=1===G&&da?n[1]:2===G&&da&&!V&&!M||2===G&&V&&!da&&!M||"dolly"===q&&!V&&"pinch"!==m||0!==C.z?M||V||da||2!==G&&1!==G?"dolly":"pan":!(2!==G||da||V^M)||2===G&&da&&M||1===G&&!da&&!M||1===G&&V||1===G&&M&&!V||0===G&&da&&!M&&!V||"pan"===
q&&1!==G&&!V&&"pinch"!==m||la?"pan":"pan"===m||"pinch"===m?"dollypan":q;a!==l&&(l=a,("pan"===l&&-1<G||"dollypan"===l)&&this.initTracking(A.x,A.y))};this.interactionStart=function(a,b){if(b||a>G)G=a,w=!0,-1<a&&("pan"===l&&this.initTracking(A.x,A.y),"orbit"===l&&this.initOrbit()),this.utilities.pivotActive(g.getPivotSetFlag(),-1===a),this.utilities.autocam&&(this.utilities.autocam.sync(h),this.utilities.autocam.startInteraction(I.x,I.y),D=I.clone())};this.interactionCheck=function(){(O[0]||O[1]||O[2]||
O[3]||O[4]||O[5]||da||M||V||la)&&this.interactionStart(-4,!0)};this.interactionEnd=function(a){a===G&&(-1!==a&&this.utilities.pivotActive(!1),w=!1)};this.handleWheelInput=function(b){if(this.isDragging)return!1;if(g.getIs2D()){var c=g.getScreenViewport(),c=a.intersectGround(F+c.width,B+c.height);this.utilities.setPivotPoint(c,!0,!0)}g.getReverseZoomDirection()&&(b*=-1);E.z+=b;c=Date.now();z||(z=c);0!=b&&this.interactionStart(-1);return!0};this.resetKeys=function(){this.autoMove(-1,!1);la=V=M=da=0};
this.autoMove=function(a,b){b&&this.isDragging||(0>a?O[0]=O[1]=O[2]=O[3]=O[4]=O[5]=b:O[a]=b,b||this.interactionEnd(-4),this.interactionCheck())};this.updateModifierState=function(a){M=d&&a.metaKey||a.ctrlKey?1:0;da=a.shiftKey?1:0;V=a.altKey?1:0};this.handleKeyDown=function(a,b){this.updateModifierState(a);var c=!1;switch(b){case 187:this.adjustSpeed(1);c=!0;break;case 189:this.adjustSpeed(-1);c=!0;break;case 48:this.adjustSpeed(0);c=!0;break;case 37:this.autoMove(0,!0);c=!0;break;case 39:this.autoMove(1,
!0);c=!0;break;case 33:this.autoMove(2,!0);c=!0;break;case 34:this.autoMove(3,!0);c=!0;break;case 38:this.autoMove(4,!0);c=!0;break;case 40:this.autoMove(5,!0);c=!0;break;default:return!1}this.isDragging||this.interactionStart(-4);return c};this.handleKeyUp=function(a,b){this.updateModifierState(a);var c=!1;switch(b){case 37:this.autoMove(0,!1);c=!0;break;case 39:this.autoMove(1,!1);c=!0;break;case 33:this.autoMove(2,!1);c=!0;break;case 34:this.autoMove(3,!1);c=!0;break;case 38:this.autoMove(4,!1);
c=!0;break;case 40:this.autoMove(5,!1);c=!0;break;default:return!1}c&&(this.interactionEnd(-4),w||this.interactionCheck());return c};this.handleDollyPan=function(a){F=a.canvasX;B=a.canvasY;var b=g.getScreenViewport();J.x=H.x+a.deltaX;J.y=H.y+a.deltaY;E.x=J.x/b.width;E.y=J.y/b.height;var b=a.pointers[1].clientX-a.pointers[0].clientX,c=a.pointers[1].clientY-a.pointers[0].clientY;t=Math.sqrt(b*b+c*c);a=a.type;-1!==a.indexOf("start",a.length-5)&&(p=t)};this.handleGesture=function(a){switch(a.type){case "dragstart":return m=
"drag",this.handleButtonDown(a,0);case "dragmove":return"drag"===m?this.handleMouseMove(a):!1;case "dragend":if("drag"===m)return this.handleButtonUp(a,0),m=null,!0;break;case "panstart":return m="pan",this.isDragging=!0,A.x=.5*(a.normalizedX+1),A.y=1-.5*(a.normalizedY+1),H.set(a.canvasX,a.canvasY),I.set(a.canvasX,a.canvasY),this.interactionStart(3),this.handleDollyPan(a),!0;case "panmove":return"pan"===m?this.handleDollyPan(a):!1;case "panend":if("pan"===m)return this.isDragging=!1,this.handleDollyPan(a),
this.interactionEnd(3),!0;break;case "pinchstart":return this.isDragging=!0,m="pinch",A.x=.5*(a.normalizedX+1),A.y=1-.5*(a.normalizedY+1),H.set(a.canvasX,a.canvasY),I.set(a.canvasX,a.canvasY),this.interactionStart(3),this.handleDollyPan(a),!0;case "pinchmove":return"pinch"===m?this.handleDollyPan(a):!1;case "pinchend":if("pinch"===m)return this.isDragging=!1,this.handleDollyPan(a),this.interactionEnd(3),!0}return!1};this.handleButtonDown=function(a,b){this.updateModifierState(a);A.x=.5*(a.normalizedX+
1);A.y=1-.5*(a.normalizedY+1);I.set(a.canvasX,a.canvasY);E.copy(A);J.copy(I);N.copy(c(a.canvasX,a.canvasY));K.copy(N);F=a.canvasX;B=a.canvasY;this.isDragging=!0;this.interactionStart(b);return!0};this.handleButtonUp=function(a,b){this.updateModifierState(a);E.x=.5*(a.normalizedX+1);E.y=1-.5*(a.normalizedY+1);J.set(a.canvasX,a.canvasY);K.copy(c(a.canvasX,a.canvasY));N.copy(K);F=a.canvasX;B=a.canvasY;this.interactionEnd(b);this.isDragging=!1;return!0};this.handleMouseMove=function(b){this.updateModifierState(b);
if(!this.isDragging)return A.x=.5*(b.normalizedX+1),A.y=1-.5*(b.normalizedY+1),I.set(b.canvasX,b.canvasY),E.x=A.x,E.y=A.y,J.copy(I),F=b.canvasX,B=b.canvasY,a.rolloverObject(F,B),!1;E.x=.5*(b.normalizedX+1);E.y=1-.5*(b.normalizedY+1);J.set(b.canvasX,b.canvasY);K.copy(c(b.canvasX,b.canvasY));F=b.canvasX;B=b.canvasY;return!0};this.handleBlur=function(a){this.resetKeys();this.interactionEnd(G)};b.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,function(a){f.handleBlur(a)})};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.HotGestureTool=function(a){navigator.userAgent.search("Mac OS");a.navigation.getCamera();var b=["hottouch"],c=null,f=null,d=!1,g=!1,h=null;this.getNames=function(){return b};this.getName=function(){return b[0]};this.activate=function(a){};this.deactivate=function(a){};this.__checkStart=function(){h&&(this.controller.distributeEvent("handleGesture",h),h=null)};this.update=function(){if(this.controller.getIsLocked())return!1;var b=a.getActiveNavigationTool(),h=!1===d&&!0===g,n=!0===
d&&!1===g;if(h||n){h=h?"worldup":"fov";if(b===h)return!1;if(b===c)return a.setActiveNavigationTool(h),c=h,this.__checkStart(),!1;f=b;a.setActiveNavigationTool(h);c=h;this.__checkStart()}else c&&(a.setActiveNavigationTool(f),f=c=null);return!1};this.resetKeys=function(){};this.updateModifierState=function(a){};this.handleGesture=function(a){if(a===h)return!1;switch(a.type){case "drag3start":h=a;d=!0;break;case "drag3end":d=!1;break;case "rotatestart":h=a;g=!0;break;case "rotateend":g=!1}return!1};
this.handleKeyDown=function(a,b){this.updateModifierState(a);return!1};this.handleKeyUp=function(a,b){this.updateModifierState(a);return!1};this.handleButtonDown=function(a,b){this.updateModifierState(a);return!1};this.handleButtonUp=function(a,b){this.updateModifierState(a);return!1};this.handleMouseMove=function(a){this.updateModifierState(a);return!1};this.handleBlur=function(a){this.resetKeys();return!1}};"use strict";AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.HotkeyManager=function(){function a(a,b){return a-b}function b(){var a=d.join(),b,c;for(c=0;c<h.length;)b=h[c],b.keys===a?h.splice(c,1):c++;for(c=0;c<g.length;)b=g[c],b.keys!==a?g.splice(c,1):c++}function c(a,c){var k=d.join(),m=d.slice(0),p=d.indexOf(c);-1<p&&d.splice(p,1);var t=d.join(),v=d.slice(0);b();for(var D=[],w=[],F,p=f.length-1;0<=p;p--)F=f[p],F.keys===k&&F.onRelease?D.unshift(F):F.keys===t&&F.onPress&&w.unshift(F);for(p=D.length-1;0<=p&&(F=D[p],!F.onRelease(m));p--)F.options.tryUntilSuccess&&
h.unshift(F);for(p=w.length-1;0<=p&&(F=w[p],!F.onPress(v));p--)F.options.tryUntilSuccess&&g.unshift(F)}var f=[],d=[],g=[],h=[],k=["hotkeys"];return{pushHotkeys:function(b,c,d){if(f.some(function(a){return a.id===b}))return!1;for(var g=0;g<c.length;g++)f.push({id:b,keys:c[g].keycodes.sort(a).join(),onPress:c[g].onPress,onRelease:c[g].onRelease,options:d||{}});return!0},popHotkeys:function(a){for(var b=!1,c=f.length-1;0<=c;c--)f[c].id===a&&(f.splice(c,1),b=!0);return b},handleKeyDown:function(a,c){if(-1===
d.indexOf(c)){for(var k=d.join(),m=d.slice(0),p=0;p<d.length&&d[p]<c;)p++;d.splice(p,0,c);var t=d.join(),v=d.slice(0);b();for(var D=[],w=[],F,p=f.length-1;0<=p;p--)F=f[p],F.keys===k&&F.onRelease?D.unshift(F):F.keys===t&&F.onPress&&w.unshift(F);for(p=D.length-1;0<=p&&(F=D[p],!F.onRelease(m));p--)F.options.tryUntilSuccess&&h.unshift(F);for(p=w.length-1;0<=p&&(F=w[p],!F.onPress(v));p--)F.options.tryUntilSuccess&&g.unshift(F)}},handleKeyUp:c,handleBlur:function(){for(var a=d.length-1;0<=a;a--)c(null,
d[a])},getName:function(){return k[0]},getNames:function(){return k},activate:function(){},deactivate:function(){},update:function(){var a,b;for(b=0;b<h.length;)a=h[b],!0===a.onRelease(a.keys.split())?h.splice(b,1):b++;for(b=0;b<g.length;)a=g[b],!0===a.onPress(a.keys.split())?g.splice(b,1):b++;return!1},KEYCODES:{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,INSERT:45,DELETE:46,ZERO:48,a:65,b:66,c:67,d:68,
e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,SLASH:191,LBRACKET:219,RBRACKET:221,SINGLEQUOTE:222}}};Autodesk.Viewing.theHotkeyManager=new Autodesk.Viewing.HotkeyManager;AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.FovTool=function(a){var b=a.navigation,c=b.getCamera(),f=["fov"],d=!1,g=0,h=null,k=null,l=!1,n=0,q=-5,m=new THREE.Vector3,p=new THREE.Vector3,t=new THREE.Vector3,v=null;this.getNames=function(){return f};this.getName=function(){return f[0]};this.activate=function(a){n=0};this.deactivate=function(a){q=-5};this.getCursor=function(){return 0!==n&&-5===q?null:"url(data:image/x-icon;base64,AAACAAEAGBgAAAAAAACICQAAFgAAACgAAAAYAAAAMAAAAAEAIAAAAAAAYAkAABMLAAATCwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAACEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAnAwMD/yEhIf8AAABmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAGknJyf/goKC/8/Pz/8aGhr/AAAALQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////AAAA/wAAAAAAAAAAAAAAAAAAAAAAAABTFBQU/2lpaf/MzMz///////////+Wlpb/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAOAAAAKFTU1P/t7e3////////////8PDw////////////AQEB/wAAAAEAAAAAAAAAFAAAAH0KCgr/AAAAYwAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAjCwsL/6Ghof/t7e3///////Dw8P9MTEz/LS0t//Pz8///////Ghoa/wAAABoAAAANDQ0N/319ff+rq6v/Y2Nj/wAAAK8AAABGAAAA////////////AAAA/wAAAF0hISH/jIyM////////////sLCw/xEREf8AAACHAAAArKysrP//////V1dX/wAAAFcAAABSUlJS//f39///////8PDw/6+vr/86Ojr/LS0t////////////FRUV/1xcXP/Gxsb/+Pj4//Hx8f9MTEz/AAAAsAAAAEcAAAAAAAAAZ2dnZ///////pKSk/wAAAKQAAACtra2t///////////////////////m5ub/kZGR/wAAAP8AAAD/q6ur//Hx8f//////vb29/x0dHf8AAACIAAAAAAAAAAAAAAAAAAAAOjo6Ov//////5+fn/wAAAOcAAADd3d3d////////////////////////////+/v7/9bW1v/i4uL//v7+//Pz8/9hYWH/AAAAvQAAAFQAAAAAAAAAAAAAAAAAAAAAAAAAJycnJ//6+vr//////wMDA/8AAADv7+/v/////////////////////////////////////////////////7y8vP8ODg7/AAAAKwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJiYmJv/6+vr//////wkJCf8AAADv7+/v//////////////////////////////////f39//9/f3//////+np6f+UlJT/GBgY/wAAAH0AAAACAAAAAAAAAAAAAAAAAAAAKSkpKf///////v7+/w0NDf8AAADd3d3d////////////////////////////29vb/39/f/+Xl5f/5+fn////////////5ubm/1RUVP8CAgL/AAAAPwAAAAAAAAAAAAAAOTk5Of//////8PDw/wgICP8AAAChoaGh/////////////////+np6f+YmJj/QkJC/wAAAP8AAAD/UFBQ/7e3t//39/f///////////+oqKj/EBAQ/wAAAIgAAAAAAAAAZ2dnZ///////29vb/wEBAf8AAAA4NTU1/9zc3P/t7e3/tbW1/01NTf8AAACYAAAA////////////AwMD/wsLC/9oaGj/y8vL////////////8fHx/zg4OP8AAACWAAAApaWlpf//////n5+f/wAAAJ8AAAAAAAAAczg4OP9LS0v/EhIS/wAAAE0AAAAAAAAA////////////FRUV/wAAABUAAABoJSUl/4GBgf/i4uL///////////9+fn7/Pz8///b29v//////SkpK/wAAAEoAAAAAAAAAAAAAADgAAABLAAAAEgAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAJQAAAIE8PDz/np6e//z8/P/////////////////8/Pz/CQkJ/wAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAA8DAwM/09PT/+7u7v///////////+QkJD/AAAAkwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////Dw8P/wAAAA8AAAAAAAAAAAAAAAAAAAAAAAAADAAAAFIYGBj/aGho/729vf8WFhb/AAAAJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////FRUV/wAAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAQEB/w8PD/8AAABUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////DAwM/wAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlgAAAP8AAAD/AAAAlgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8x/h/nO/4fw1D+HwFy/h4BRu4YAHOGEABkAAAAXAAAIFwAAOBnAAHgIAAD4GUAAOB4AABgXAAAIGMAAABtggAAVMYYAHT+HgE7/g8BcP4Pw2/+D+dc/h//XP///2c=), auto"};
this.getMotionDelta=function(a){var b=p.x-m.x,c=p.y-m.y,d=p.z-m.z;.001>Math.abs(b)&&(b=0);.001>Math.abs(c)&&(c=0);.001>Math.abs(d)&&(d=0);a.set(b,c,d)};this.stepMotionDelta=function(a,b){b?(m.x+=.6*a.x,m.y+=.6*a.y,m.z+=.6*a.z):m.copy(p)};this.getAccumulatedWheelDelta=function(){var a=Date.now(),b=0;k&&100<a-k?(b=0>g&&-3<g?-3:0<g&&3>g?3:g,g=0,k=h=null,l=!1):h&&100<a-h&&(l?3<=Math.abs(g)&&(b=g,g=0):(b=0>g&&-3<g?-3:0<g&&3>g?3:g,l=!0,g=0));return b};this.update=function(){var a=!1,f=-5<q;if(-5<q){this.controller.setIsLocked(!0);
this.getMotionDelta(t);var g=t.x,h=t.y,k=t.z;if(0!==g||0!==h||0!==k)f=!0,0<=q?(h=-h,k=Math.abs(g)>Math.abs(h)?g:h,0!==k&&(k*=-1,b.setVerticalFov(b.getVerticalFov()*(1+k),!0))):(g=this.getAccumulatedWheelDelta()/3,0!==g&&b.setFocalLength(b.getFocalLength()+g,!0));this.stepMotionDelta(t,!0);-1===q&&1E-5>Math.abs(k)&&(this.interactionEnd(-1),a=!0)}f?this.utilities.pivotActive(b.getPivotSetFlag(),!0):this.utilities.pivotUpdate();!d&&(a||-5<q)&&(-1<q&&m.copy(p),q=-5,this.controller.setIsLocked(!1));return c.dirty};
this.interactionStart=function(a,c){if(c||a>q)q=a,d=!0;b.toPerspective()};this.interactionEnd=function(a){a===q&&(-1!==a&&this.utilities.pivotActive(!1),d=!1)};this.handleWheelInput=function(a){if(-1<q)return!1;b.getReverseZoomDirection()&&(a*=-1);p.z+=a;g+=a;var c=Date.now();h||(h=c);k=c;0!=a&&this.interactionStart(-1);return!0};this.handleGesture=function(a){switch(a.type){case "dragstart":return this.handleButtonDown(a,0);case "dragmove":return this.handleMouseMove(a);case "dragend":return this.handleButtonUp(a,
0);case "drag3start":return v="drag",this.handleButtonDown(a,0);case "drag3move":return"drag"===v?this.handleMouseMove(a):!1;case "drag3end":"drag"===v&&this.handleButtonUp(a,0),v=null}return!1};this.handleButtonDown=function(a,b){n+=1<<b;return 2!==b?(m.x=.5*(a.normalizedX+1),m.y=1-.5*(a.normalizedY+1),p.copy(m),this.interactionStart(b),!0):!1};this.handleButtonUp=function(a,b){n-=1<<b;return 2!==b?(p.x=.5*(a.normalizedX+1),p.y=1-.5*(a.normalizedY+1),this.interactionEnd(b),!0):!1};this.handleMouseMove=
function(a){p.x=.5*(a.normalizedX+1);p.y=1-.5*(a.normalizedY+1);return-1<q};this.handleBlur=function(a){this.interactionEnd(q);return!1}};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.WorldUpTool=function(a,b){var c=b.navigation,f=c.getCamera(),d=["worldup"],g=this,h=function(){var a=new THREE.Vector3;return function(b,c,d,f){b=new THREE.Vector3(b,c,d);c=f.dot(b);a.copy(f);a.multiplyScalar(c);return b.sub(a)}}(),k=2*Math.PI,l=!1,n=!1,q=!1,m=new function(a,b){function d(a,b){var c=Math.abs(a-b);return c>k?c:Math.min(k-c,c)}function f(a,b){var c=m(a);if(1E-5>c.distanceToSquared(b))return!0;D.set(-b.x,-b.y,-b.z);return 1E-5>c.distanceToSquared(D)}function g(a){return a>
k?a:0>=a?a+Math.PI:a-Math.PI}function m(a){v.set(0,0,0);if(0<=a){var b=3<=a?-1:1;a%=3;0===a&&(v.x=b);1===a&&(v.y=b);2===a&&(v.z=b)}ca&&v.multiplyScalar(-1);return v}function l(a,b){for(var c=d(Z[0],a),f=0,g=1;6>g;++g){var h=d(Z[g],a);h<c&&(c=h,f=g)}return c<b?f:-1}function n(a){if(0!==a){var b=30*Math.PI/180,d=D.copy(ba.position).sub(W).normalize();T.setFromAxisAngle(d,a);a=c.getWorldUpVector();d=Math.abs(d.angleTo(a));(d<b||Math.PI-d<b)&&a.copy(c.getCameraUpVector());a.applyQuaternion(T);c.setIsLocked(!1);
c.setWorldUpVector(a,!0);c.setIsLocked(!0)}}function q(a,b){0>a.dot(b)&&(b=b.clone().multiplyScalar(-1));c.orient(la,W,ba.position,b);la.position.copy(b.multiplyScalar(.495));for(var f=!1,g=Q?La:ma,h=0;6>h;++h){var k=d(Z[h],ea),l;l=a;l=k<g?1E-5>m(h).distanceToSquared(l):!1;l&&(f=!0);k=l?4:3*(1-3*k/Math.PI);1>k&&(k=1);k*=X;ja[h].visible=l;l=ga[h];l.scale.x=k;l.scale.y=k;l.scale.z=k}O.visible=f;da.visible=f;return V.visible=f}function w(a){ea+=a;ea>Math.PI?ea-=k:ea<=-Math.PI&&(ea=k+ea);var b;a:{if(!Q&&
(b=l(ea,ma),0<=b)){Q=!0;ea=Z[b];b=m(b);break a}b=!1}if(b)ha=ea,a=b,c.setIsLocked(!1),c.setWorldUpVector(a,!0),c.setIsLocked(!0);else if(Q&&0>l(ea,La)?(Q=!1,b=!0):b=!1,b)n(ea-ha),ha=0;else{if(Q)return!1;n(a)}return!0}var p=2*Math.tan(THREE.Math.degToRad(15)),t=new THREE.MeshPhongMaterial({color:12303291,ambient:12303291,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1}),v=new THREE.Vector3,D=new THREE.Vector3,T=new THREE.Quaternion,ba=new THREE.PerspectiveCamera(30,b.aspect,b.near,b.far),X=1,Y=
1,W=null,U=null,O=null,da=null,V=null,M=null,la=null,ga=null,ja=null,Z=Array(6),ea=0,ca=!1,Q=!0,ha=0,ma=5*Math.PI/180,La=7*Math.PI/180,Fa=1;a.createOverlayScene("roll",null,null,ba);this.updateRollCamera=function(a,c){ba.position.copy(b.position);ba.quaternion.copy(b.quaternion);ba.up.copy(b.up);ba.aspect=b.aspect;a&&c&&(ba.near=c-a,ba.far=c+a);ba.updateProjectionMatrix()};this.isSnapped=function(){return Q};this.resize=function(){var a=Fa*p,c=a*b.aspect,a=(1>b.aspect?c:a)*Y;M.scale.x=a;M.scale.y=
a;M.scale.z=a};this.start=function(b,c){this.updateHUD(b,c);a.addOverlay("roll",M)};this.updateHUD=function(a,k){W=a;.35>k?k=.35:.8<k&&(k=.8);Y=k;X=.8/k;var m=v.copy(a).sub(b.position);Fa=m.length();var l=Fa*p,n=l*b.aspect,l=(1>b.aspect?n:l)*k;this.updateRollCamera(l,Fa);var n=c.getWorldUpVector(),w=c.getCameraUpVector();if(!M){M=new THREE.Object3D;var F=new THREE.RingGeometry(.5-.01*X,.5,60);U=F=new THREE.Mesh(F,t);var H=.007*X,E=new THREE.BoxGeometry(.93,H,H),I=new THREE.BoxGeometry(H,.93,H),H=
new THREE.BoxGeometry(H,H,.93);O=new THREE.Mesh(E,t);da=new THREE.Mesh(I,t);V=new THREE.Mesh(H,t);M.add(O);M.add(da);M.add(V);la=new THREE.Mesh(new THREE.CircleGeometry(.005),t);M.add(la);ga=Array(6);ja=Array(6);for(E=0;6>E;++E)I=.0025*X,ga[E]=new THREE.Mesh(new THREE.CircleGeometry(.005*X,16),t),ja[E]=new THREE.Mesh(new THREE.CircleGeometry(I,16),t),ja[E].visible=!1,ga[E].add(ja[E]),F.add(ga[E]);M.add(F)}c.orient(U,a,ba.position,n);F=m.clone().normalize();E=Array(3);m=Array(6);E[0]=h(1,0,0,F);E[1]=
h(0,1,0,F);E[2]=h(0,0,1,F);I=w.clone().cross(F).normalize();for(F=0;3>F;++F)H=E[F],m[F]=H.length(),.1>m[F]?Z[F]=1E3:(H.multiplyScalar(1/m[F]),Z[F]=Math.atan2(I.dot(H),w.dot(H)));Z[3]=g(Z[0]);Z[4]=g(Z[1]);Z[5]=g(Z[2]);m[3]=m[0];m[4]=m[1];m[5]=m[2];F=ma+La+2*Math.PI/180;for(E=0;6>E;++E)if(1E3!==Z[E])for(I=E+1;6>I;++I)if(1E3!==Z[I]&&d(Z[E],Z[I])<F)if(m[E]<m[I]&&!f(E,n)||f(I,n)){Z[E]=1E3;break}else Z[I]=1E3;for(F=0;6>F;++F)1E3!==Z[F]?(m=D.set(0,0,1),T.setFromAxisAngle(m,Z[F]),m=D.set(0,.54,0),m.applyQuaternion(T),
ga[F].position.copy(m),ga[F].visible=!0):ga[F].visible=!1;M.scale.x=l;M.scale.y=l;M.scale.z=l;M.position.copy(a);ha=ea=0;ca=0>n.dot(w);Q=q(n,w)};this.handleRoll=function(a,b,d){this.updateRollCamera();q(c.getWorldUpVector(),c.getCameraUpVector());return 0!==a||0!==b?(a=d.x-a-.5,b=d.y-b-.5,w(Math.atan2(d.y-.5,d.x-.5)-Math.atan2(b,a))):!1};this.handleRollTouch=function(a){this.updateRollCamera();q(c.getWorldUpVector(),c.getCameraUpVector());a-=ea;return.001<Math.abs(a)?w(a):!1};this.end=function(){a.removeOverlay("roll",
M)}}(a,f),p=new THREE.Vector3,t=new THREE.Vector3,v=new THREE.Vector3,D=null,w=0;this.getNames=function(){return d};this.getName=function(){return d[0]};this.activate=function(a){b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange);q=!1};this.deactivate=function(a){m.end();c.setIsLocked(!1);b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange);this.utilities.restorePivot();D=null;q=l=!1};this.getCursor=function(){return"auto"};this.getMotionDelta=
function(a){var b=t.x-p.x,c=t.y-p.y,d=t.z-p.z;.001>Math.abs(b)&&(b=0);.001>Math.abs(c)&&(c=0);.001>Math.abs(d)&&(d=0);a.set(b,c,d)};this.stepMotionDelta=function(){p.copy(t)};this.update=function(){if(!q){var a=c.getEyeVector(),b=.5*(f.near+f.far);a.normalize().multiplyScalar(b);a=a.add(f.position);this.utilities.savePivot();this.utilities.setPivotPoint(a,!0,!0);this.utilities.pivotActive(!0);m.start(a,.65);q=!0}a=n;this.getMotionDelta(v);var b=v.x,d=v.y,g=v.z;if(n||"roll"===D||l&&(0!==b||0!==d||
0!==g))n="roll"===D?m.handleRollTouch(w):m.handleRoll(b,d,t);this.stepMotionDelta();f.dirty&&(a=!0);return a};this.handleResize=function(){m.resize();n=!0};this.handleGesture=function(a){switch(a.type){case "dragstart":return D="drag",this.handleButtonDown(a,0);case "dragmove":return this.handleMouseMove(a);case "dragend":return D=null,this.handleButtonUp(a,0);case "rotatestart":c.setIsLocked(!0);b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange);D="roll";w=THREE.Math.degToRad(a.rotation);
var d=a.pointers[1].clientX-a.pointers[0].clientX;a=a.pointers[1].clientY-a.pointers[0].clientY;Math.sqrt(d*d+a*a);d=c.getScreenViewport();Math.min(d.width,d.height);return!0;case "rotatemove":return w=THREE.Math.degToRad(a.rotation),"roll"===D;case "rotateend":c.setIsLocked(!1),b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,this.handleCameraChange),w=THREE.Math.degToRad(a.rotation),D=null}return!1};this.handleWheelInput=function(a){return!0};this.handleCameraChange=function(){var a=c.getEyeVector(),
b=.5*(f.near+f.far);a.normalize().multiplyScalar(b);a=a.add(f.position);m.updateHUD(a,.65)};this.handleButtonDown=function(a,d){p.x=.5*(a.normalizedX+1);p.y=1-.5*(a.normalizedY+1);t.copy(p);l=!0;D=null;c.setIsLocked(!0);this.controller.setIsLocked(!0);b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,g.handleCameraChange);return!0};this.handleButtonUp=function(a,d){t.x=.5*(a.normalizedX+1);t.y=1-.5*(a.normalizedY+1);l=!1;n=!0;c.setIsLocked(!1);this.controller.setIsLocked(!1);b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,
g.handleCameraChange);return!0};this.handleMouseMove=function(a){t.x=.5*(a.normalizedX+1);t.y=1-.5*(a.normalizedY+1);return!0};this.handleBlur=function(a){l=!1;D=null;return!1}};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.Selector=function(a){function b(a){var c=a.dbId||a.fragIds;if(0<h[c])h[c]--,0==h[c]&&g.viewer.highlightObjectNode(g.model,a,!1);else if(0>h[c])throw"Selection State machine broken. Negatively selected object!";if(a.children)for(c=0;c<a.children.length;c++)b(a.children[c])}function c(a,b){var d=a.dbId||a.fragIds;h[d]?h[d]++:(g.viewer.highlightObjectNode(g.model,a,!0,b),h[d]=1);if(a.children)for(d=0;d<a.children.length;d++)c(a.children[d],!0)}function f(a){g.isSelected(a)||
(g.selectedObjectIds[a.dbId]=a,g.selectionCount++,c(a))}function d(a){g.isSelected(a)&&(b(a),g.selectedObjectIds[a.dbId]=null,g.selectionCount--)}var g=this;this.viewer=a;this.model=null;this.selectedObjectIds={};this.selectionCount=0;var h={};a.api.addEventListener(Autodesk.Viewing.ISOLATE_EVENT,function(a){g.deselectInvisible()});a.api.addEventListener(Autodesk.Viewing.HIDE_EVENT,function(a){g.deselectInvisible()});this.getSelectionLength=function(){return g.selectionCount};this.getSelection=function(){var a=
[],b=g.selectedObjectIds,c;for(c in b)b[c]&&a.push(b[c]);return a};this.clearSelection=function(a){if(0<this.selectionCount){var c=g.selectedObjectIds,d;for(d in c)c[d]&&b(c[d]);g.selectedObjectIds={};g.selectionCount=0;a||this.fireSelectionChangedEvent()}};this.fireSelectionChangedEvent=function(){var a=[],b=[],c=g.selectedObjectIds,d;for(d in c){var f=c[d];f&&(a.push(f.dbId),b.push(f.fragIds))}a={type:Autodesk.Viewing.SELECTION_CHANGED_EVENT,dbIdArray:a,fragIdsArray:b,nodeArray:this.getSelection()};
this.viewer.api.fireEvent(a)};this.isSelected=function(a){if(a&&this.selectedObjectIds[a.dbId])return!0};this.toggleSelection=function(a){a?(this.isSelected(a)?d(a):f(a),g.fireSelectionChangedEvent()):console.error("Attempting to select a null node.")};this.setSelectionIds=function(a){this.setSelection(this.model.getNodesByIds(a))};this.selectionIsEqual=function(a){if(this.selectionCount!==a.length)return!1;for(var b=0;b<a.length;b++)if(!this.isSelected(a[b]))return!1;return!0};this.setSelection=
function(a){if(!this.selectionIsEqual(a)&&(this.clearSelection(!0),null!=a)){for(var b=0;b<a.length;b++)f(a[b]);this.fireSelectionChangedEvent()}};this.deselectInvisible=function(){var a=!1,b=g.selectedObjectIds,c;for(c in b){var f=b[c];f&&0==f.visible&&(d(f),a=!0)}a&&this.fireSelectionChangedEvent()};this.toggleSelectionId=function(a){this.toggleSelection(this.model.getNodeById(a))};this.isSelectedOrParentIsSelected=function(a){for(;a;){if(this.isSelected(a))return!0;a=a.parent}return!1};this.getSelectionBounds=
function(){var a=new THREE.Box3,b=new THREE.Box3,c=this.model.getData().instanceTree,d=this.viewer.modelQueue().getFragmentList(),f=g.selectedObjectIds,h;for(h in f)c.enumNodeFragments(parseInt(h),function(c){d.getWorldBounds(c,b);a.union(b)},!0);return a};this.getSelectionVisibility=function(){var a=!1,b=!1,c=g.selectedObjectIds,d;for(d in c){var f=c[d];if(f&&(Autodesk.Viewing.Private.VisibilityManager.isVisible(f)?a=!0:b=!0,a&&b))break}return{hasVisible:a,hasHidden:b}};this.uninitialize=function(){this.selectedObjectIds=
this.model=this.viewer=null}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.VisibilityManager=function(a){this.viewerImpl=a;this.model=null;this.isolatedNodes=[];this.hiddenNodes=[]};Autodesk.Viewing.Private.VisibilityManager.prototype.getIsolatedNodes=function(){return this.isolatedNodes.slice(0)};Autodesk.Viewing.Private.VisibilityManager.prototype.getHiddenNodes=function(){return this.hiddenNodes.slice(0)};
Autodesk.Viewing.Private.VisibilityManager.prototype.isolate=function(a){a?this.isolateMultiple([a]):this.isolateNone()};Autodesk.Viewing.Private.VisibilityManager.prototype.isolateNone=function(){this.viewerImpl.setModelVisibility(this.model,!0);var a=this.model?this.model.getRoot():null;a&&this.setVisibilityOnNode(a,!0);this.hiddenNodes=[];this.isolatedNodes=[];this.viewerImpl.resetIsolation(this.model);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.ISOLATE_EVENT,nodeIdArray:[]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.isolateMultiple=function(a){if(a&&0!=a.length){var b=this.model?this.model.getRoot():null;b&&this.setVisibilityOnNode(b,!1);this.viewerImpl.setModelVisibility(this.model,!1);this.isolatedNodes=a.slice(0);this.hiddenNodes=[];for(b=0;b<a.length;b++)this.setVisibilityOnNode(a[b],!0),this.viewerImpl.needGhostedPass=!0;this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.ISOLATE_EVENT,nodeIdArray:a})}else this.isolateNone();this.viewerImpl.invalidate(!0)};
Autodesk.Viewing.Private.VisibilityManager.prototype.hideMultiple=function(a){for(var b=0;b<a.length;++b)this.setVisibilityOnNode(a[b],!1);0<a.length&&this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:a})};Autodesk.Viewing.Private.VisibilityManager.prototype.hide=function(a){this.setVisibilityOnNode(a,!1);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.showMultiple=function(a){for(var b=0;b<a.length;++b)this.setVisibilityOnNode(a[b],!0);0<a.length&&this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:a})};Autodesk.Viewing.Private.VisibilityManager.prototype.show=function(a){this.setVisibilityOnNode(a,!0);this.viewerImpl.api.fireEvent({type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.toggleVisibility=function(a){var b=Autodesk.Viewing.Private.VisibilityManager.isVisible(a);this.setVisibilityOnNode(a,!b);this.viewerImpl.api.fireEvent(b?{type:Autodesk.Viewing.HIDE_EVENT,nodeIdArray:[a]}:{type:Autodesk.Viewing.SHOW_EVENT,nodeIdArray:[a]})};
Autodesk.Viewing.Private.VisibilityManager.prototype.setVisibilityOnNode=function(a,b){var c=this.viewerImpl,f=this.model,d=this;(function k(a){if(a.visible&&!b)for(var g=0,q=d.isolatedNodes.length;g<q;++g)if(d.isolatedNodes[g].dbId===a.dbId){d.isolatedNodes.splice(g,1);break}a.visible=b;g=a.fragIds;if(void 0!==g)if(Array.isArray(g))for(q=0;q<g.length;q++)c.setFragmentVisibility(f,g[q],b);else c.setFragmentVisibility(f,g,b);if(a.children)for(g=0;g<a.children.length;g++)k(a.children[g])})(a);this.viewerImpl.needGhostedPass=
!0;var g=this.hiddenNodes.indexOf(a);b&&-1!==g?this.hiddenNodes.splice(g,1):b||-1!==g||this.hiddenNodes.push(a)};Autodesk.Viewing.Private.VisibilityManager.isVisible=function(a){return null!=a.visible?a.visible:!0};Autodesk.Viewing.Private.VisibilityManager.prototype.areAllVisible=function(){return this.viewerImpl.isWholeModelVisible(this.model)};AutodeskNamespace("Autodesk.Viewing.Private");LMV_WORKER_URL||(LMV_WORKER_URL="src/workers/MainWorker.js");
void 0==ENABLE_INLINE_WORKER&&(ENABLE_INLINE_WORKER=!1);
(function(){var a=Autodesk.Viewing.Private,b=null;a.initWorkerScript=function(c,f){if(ENABLE_INLINE_WORKER&&!b){var d=new XMLHttpRequest,g=LMV_WORKER_URL,h=a.getResourceUrl(LMV_WORKER_URL);h&&(g=h);d.open("GET",g,!0);d.withCredentials=!1;d.onload=function(){var a;window.URL=window.URL||window.webkitURL;try{a=new Blob([d.responseText],{type:"application/javascript"})}catch(f){a=new BlobBuilder,a.append(d.responseText),a=a.getBlob()}b=URL.createObjectURL(a);c&&c()};d.send()}else c&&c()};a.createWorker=
function(){return ENABLE_INLINE_WORKER?new Worker(b):new Worker(a.getResourceUrl(LMV_WORKER_URL))};a.createWorkerWithTokenRefresh=function(){var b=a.createWorker();b.checkTokenRefresh=function(f){return f.data&&f.data.refreshToken?((new a.TokenRefreshHandler).refreshToken(function(){stderr("Token refreshed in thread");b.postMessage({tokenRefreshed:!0})},function(){stderr("Failed token refresh in thread");b.postMessage({tokenRefreshed:!1})}),!0):f.data&&f.data.assetRequest?(a.assets&&a.assets.push(f.data.assetRequest),
!0):!1};b.addEventListenerWithTokenRefresh=function(a){var d=function(d){b.checkTokenRefresh(d)||a(d)};b.addEventListener("message",d,!1);return d};b.removeEventListener=function(a){b.removeEventListener("message",a)};return b}})();AutodeskNamespace("Autodesk.Viewing.Private");
var NUM_WORKER_THREADS=isMobileDevice()?2:6,WORKER_LOAD_GEOMETRY="LOAD_GEOMETRY",WORKER_LOAD_SVF="LOAD_SVF",WORKER_LOAD_SVF_CONTD="LOAD_SVF_CONTD",WORKER_GET_PROPERTIES="GET_PROPERTIES",WORKER_SEARCH_PROPERTIES="SEARCH_PROPERTIES",WORKER_BUILD_EXTERNAL_ID_MAPPING="BUILD_EXTERNAL_ID_MAPPING",WORKER_GET_OBJECT_TREE="GET_OBJECT_TREE",WORKER_PARSE_F2D="PARSE_F2D",WORKER_STREAM_F2D="STREAM_F2D",WORKER_PARSE_F2D_FRAME="PARSE_F2D_FRAME";
(function(){function a(a,b,c){b=b.transforms;if(!b)return null;var d=a.elements;c*=12;d[0]=b[c+0];d[1]=b[c+1];d[2]=b[c+2];d[3]=0;d[4]=b[c+3];d[5]=b[c+4];d[6]=b[c+5];d[7]=0;d[8]=b[c+6];d[9]=b[c+7];d[10]=b[c+8];d[11]=0;d[12]=b[c+9];d[13]=b[c+10];d[14]=b[c+11];d[15]=1;return a}function b(a){if((a=a.data)&&a.debug)stderr(a.message);else if(a.cbId){var b=n[a.cbId];if(a&&a.error){if(b[1])b[1](a.error)}else if(b[0])b[0](a.result);delete n[a.cbId]}}function c(a,b){var c=l++;n[c]=[a,b];return c}var f=Autodesk.Viewing,
d=Autodesk.Viewing.Private;d.SvfLoader=function(a){this.viewer3DImpl=a;this.next_pack=0;this.loading=!1;this.tmpMatrix=new THREE.Matrix4;this.logger=d.logger;this.loadTime=0;this.domainParam=auth?"domain="+encodeURIComponent(window.location.origin):"";d.accessToken&&(f.HTTP_REQUEST_HEADERS.Authorization="Bearer "+d.accessToken)};d.SvfLoader.prototype.uninitialize=function(){this.viewer3DImpl=this.svf=null};d.SvfLoader.prototype.pathToURL=function(a){if("http://"==a.substr(0,7)||"https://"==a.substr(0,
8)||"file:///"==a.substr(0,8)||"urn:"==a.substr(0,4))return a;var b=window.location.pathname,c=b.lastIndexOf("/"),b=b.substr(0,c+1);return window.location.protocol+"//"+window.location.host+b+a};d.SvfLoader.prototype.loadFile=function(a,b,c,f,g){if(this.loading)return console.log("Loading of SVF already in progress. Ignoring new request."),!1;this.svfWorker&&(this.svfWorker.terminate(),this.svfWorker=null);this.parsingWorker&&(this.parsingWorker.terminate(),this.parsingWorker=null);this.streamingWorker&&
(this.streamingWorker.terminate(),this.streamingWorker=null);this.propWorker&&(this.propWorker.terminate(),this.propWorker=null);if(this.pack_workers){for(var h=0;h<this.pack_workers.length;h++)this.pack_workers[h].terminate();this.pack_workers=null}h=a.indexOf("urn:");if(-1!=h){a=decodeURIComponent(a);h=a.substr(h,a.substr(h).indexOf("/"));stderr("Extracted URN: "+h);var k=h.lastIndexOf(":");this.svfUrn=h.substr(k+1)}else this.svfUrn=a;this.sharedDbPath=c;this.currentLoadPath=a;var l=this.isf2d=
-1!=a.indexOf(".f2d"),n=this;d.initWorkerScript(function(){l?n.loadFydoCB(a,b,f,g):n.loadSvfCB(a,b,f,g)});return!0};d.SvfLoader.prototype.interceptManifest=void 0;d.SvfLoader.prototype.loadSvfCB=function(a,b,c,g){this.t0=(new Date).getTime();this.failedToLoadSomeGeometryPacks=null;var h=this,k={url:h.pathToURL(a),headers:f.HTTP_REQUEST_HEADERS,objectIds:b,auth:auth,viewing_url:VIEWING_URL,queryParams:this.domainParam,bvhOptions:{isWeakDevice:isAndroidDevice()||isIOSDevice()}},l=this.svfWorker=d.createWorkerWithTokenRefresh("SVF Load");
l.addEventListenerWithTokenRefresh(function(a){var b=function(){l.terminate();l=null};if(a.data&&a.data.manifest)h.interceptManifest(a.data.manifest),k.operation=WORKER_LOAD_SVF_CONTD,k.manifest=a.data.manifest,l.postMessage(k);else if(a.data&&a.data.svf){var d=h.svf=a.data.svf;h.failedToLoadSomeGeometryPacks&&(g&&g(h.failedToLoadSomeGeometryPacks.code,h.failedToLoadSomeGeometryPacks.msg),h.failedToLoadSomeGeometryPacks=null);h.onSvfLoadDone(d);c&&c(d);h.viewer3DImpl.api.fireEvent({type:f.MODEL_ROOT_LOADED_EVENT,
svf:d});var m=d.geompacks.length;if(m)for(var m=Math.min(m,NUM_WORKER_THREADS),n=0;n<m;n++){var q=d.geompacks[n];q.loading=!0;h.loadGeometryPack(q.id,q.uri);h.next_pack=n+1}else h.onGeomLoadDone();1==a.data.progress&&(h.loading=!1,b());d.fragments.polygonCounts||(d.fragments.polygonCounts=new Int32Array(d.fragments.length))}else a.data&&a.data.bvh?1==a.data.progress&&(h.svf.bvh||(h.svf.bvh=a.data.bvh,h.viewer3DImpl.setBVH(new NodeArray(h.svf.bvh.nodes,h.svf.bvh.useLeanNodes),h.svf.bvh.primitives)),
h.loading=!1,b()):a.data&&a.data.progress?1==a.data.progress&&(h.loading=!1,b()):a.data&&a.data.error?(h.loading=!1,b(),g&&g(a.data.error.code,a.data.error.msg)):a.data&&a.data.debug?stderr(a.data.message):(stderr("SVF download failed."),h.loading=!1,b())});k.operation=WORKER_LOAD_SVF;k.interceptManifest=!!this.interceptManifest;l.postMessage(k);return!0};d.SvfLoader.prototype.loadFydoCB=function(a,b,c,g){this.t0=Date.now();var h=this.pathToURL(a),k=this.streamingWorker=d.createWorker(),l=this.parsingWorker=
d.createWorker(),n=this,B={};k.addEventListener("message",function(a){if(a.data&&"F2DBLOB"==a.data.type){var b={operation:WORKER_PARSE_F2D,data:a.data.buffer,metadata:a.data.metadata,manifest:a.data.manifest,basePath:a.data.basePath,f2dLoadOptions:B,url:h};l.postMessage(b,[b.data]);k.terminate()}else a.data&&"F2DSTREAM"==a.data.type?(b={operation:WORKER_PARSE_F2D_FRAME,data:a.data.frames,url:h,f2dLoadOptions:B},a.data.metadata&&(b.metadata=a.data.metadata,b.manifest=a.data.manifest),a.data.finalFrame&&
(b.finalFrame=!0),a.data.progress&&n.viewer3DImpl.signalProgress(100*a.data.progress),l.postMessage(b,b.data?[b.data]:void 0),a.data.finalFrame&&k.terminate()):a.data&&"F2DAssetURL"==a.data.type?d.assets=d.assets.concat(a.data.urls):a.data&&a.data.debug?stderr(a.data.message):a.data&&a.data.error?(n.loading=!1,k.terminate(),g&&g.call(this,a.data.error.code,a.data.error.msg)):(stderr("F2D download failed."),n.loading=!1,k.terminate())},!1);l.addEventListener("message",function(a){if(a.data&&a.data.f2d){var b=
n.svf=a.data.f2d;l.terminate();stderr("Num polylines: "+b.numPolylines);stderr("Line segments: "+b.numLineSegs);stderr("Circular arcs: "+b.numCircles);stderr("Ellipitcal arcs:"+b.numEllipses);stderr("Plain triangles:"+b.numTriangles);stderr("Total # of op codes generated by fydo.parse: "+b.opCount);n.onSvfLoadDone(n.svf);c&&c(n.svf);n.viewer3DImpl.api.fireEvent({type:f.MODEL_ROOT_LOADED_EVENT,svf:n.svf});for(var d=0;d<b.meshes.length;d++)n.processReceivedMesh2D(b.meshes[d],d);b.meshes=null;n.onGeomLoadDone();
n.loading=!1}else if(a.data&&a.data.f2dframe){var h=0;a.data.meshes?(b=a.data.bbox,n.svf.bbox=new THREE.Box3(b.min,b.max)):n.svf=a.data.f2dframe;h=a.data.baseIndex;b=n.svf;b.fragments&&b.fragments.initialized?b.maxObjectNumber=a.data.maxObjectNumber:(n.onSvfLoadDone(b),c&&c(b),n.viewer3DImpl.api.fireEvent({type:f.MODEL_ROOT_LOADED_EVENT,svf:b}));if(a.data.meshes&&a.data.meshes.length){for(d=0;d<a.data.meshes.length;d++)n.processReceivedMesh2D(a.data.meshes[d],h+d);a.data.finalFrame&&(n.onGeomLoadDone(),
n.loading=!1,l.terminate())}}else a.data&&a.data.progress||(a.data&&a.data.debug?stderr(a.data.message):a.data&&a.data.error?(n.loading=!1,l.terminate(),stderr("Error while parsing F2d: "+JSON.stringify(a.data.error.args)),g&&g.call(this,a.data.error.code,a.data.error.msg)):(stderr("F2D download failed."),n.loading=!1,l.terminate()))},!1);k.postMessage({operation:WORKER_STREAM_F2D,url:h,headers:f.HTTP_REQUEST_HEADERS,objectIds:b,auth:auth,viewing_url:VIEWING_URL,queryParams:this.domainParam});return!0};
d.SvfLoader.prototype.loadGeometryPack=function(a,b){var c,g,h,k,l=this;c=function(a){if(a.data&&a.data.mesh){if(l.processReceivedMesh(a.data),1<=a.data.progress){--l.pack_workers[a.data.workerId].queued;a=!0;for(k=0;k<l.pack_workers.length;k++)if(0!=l.pack_workers[k].queued){a=!1;break}if(a){for(k=0;k<NUM_WORKER_THREADS;k++)l.pack_workers[k].terminate();l.pack_workers=null}l.svf.fragments.numLoaded==l.svf.fragments.length&&(l.svf.proteinMaterials&&PROTEIN_ROOT&&PRISM_ROOT||l.viewer3DImpl.matman().loadTextures(l.svf),
l.onGeomLoadDone())}}else if(a.data&&a.data.progress){--l.pack_workers[a.data.workerId].queued;if(l.next_pack<l.svf.geompacks.length){a=null;var b=l.viewer3DImpl.modelQueue().geomPacksMissingLastFrame();for(h=0;h<b.length&&(a=l.svf.geompacks[b[h]],a.loading);++h);if(!a||a.loading)for(;l.next_pack<l.svf.geompacks.length&&(a=l.svf.geompacks[l.next_pack++],a.loading););a&&!a.loading?(a.loading=!0,l.loadGeometryPack(a.id,a.uri)):(l.viewer3DImpl.modelQueue().enforceBvh=!1,l.svf.fragments.packIds=null)}l.viewer3DImpl.signalProgress(100*
l.next_pack/l.svf.geompacks.length)}else a.data&&a.data.debug?stderr(a.data.message):a.data&&a.data.error?l.failedToLoadSomeGeometryPacks={code:a.data.error.code,msg:a.data.error.msg}:l.pack_workers[a.data.workerId].queued-=2};if(!this.pack_workers)for(this.pack_workers=[],h=0;h<NUM_WORKER_THREADS;h++)g=d.createWorkerWithTokenRefresh("Mesh Load"),g.addEventListenerWithTokenRefresh(c),g.queued=0,this.pack_workers.push(g);g=0;c=this.pack_workers[0].queued;for(h=1;h<NUM_WORKER_THREADS;h++)this.pack_workers[h].queued<
c&&(g=h,c=this.pack_workers[h].queued);c=this.pack_workers[g];c.queued+=2;var n=this.pathToURL(this.svf.basePath+b);g={operation:WORKER_LOAD_GEOMETRY,url:n,packId:parseInt(a),headers:f.HTTP_REQUEST_HEADERS,workerId:g,auth:auth,viewing_url:VIEWING_URL,queryParams:this.domainParam};c.postMessage(g)};var g={},h={},k;d.SvfLoader.prototype.processReceivedMesh=function(b){var c=b.mesh,f=new THREE.BufferGeometry;f.byteSize=0;f.vb=c.vb;f.vbNeedsUpdate=!0;f.byteSize+=c.vb.byteLength;f.vbstride=c.vbstride;
c.isLines&&(f.isLines=c.isLines);b.is2d&&(f.is2d=!0);f.numInstances=c.numInstances;for(var l in c.vblayout){var n=f.attributes,D=l,w;a:{var F=l;w=c.vblayout[l];var B=f.numInstances,z=void 0;if(w.array)z=new THREE.BufferAttribute(w.array,w.itemSize);else{F=F+"|"+w.bytesPerItem+"|"+w.normalize+"|"+w.isPattern+"|"+w.divisor+"|"+w.offset;if(z=g[F]){w=z;break a}z=new THREE.BufferAttribute(void 0,w.itemSize);g[F]=z}z.bytesPerItem=w.bytesPerItem;z.normalize=w.normalize;z.isPattern=w.isPattern;B&&(z.divisor=
w.divisor);w.array?geometry.byteSize+=w.array.byteLength:w.hasOwnProperty("offset")?z.itemOffset=w.offset:stderr("VB attribute is neither interleaved nor separate. Something is wrong with the buffer specificaiton.");w=z}n[D]=w}d.memoryOptimizedLoading?(k||(k=new THREE.BufferAttribute(void 0,1)),f.attributes.index=k,f.ib=c.indices):f.addAttribute("index",new THREE.BufferAttribute(c.indices,1));l="";for(var G in f.attributes)l+=G+"|";G=h[l];G||(G=Object.keys(f.attributes),h[l]=G);f.attributesKeys=G;
f.byteSize+=c.indices.byteLength;65535<c.vb.length/c.vbstride&&stderr("Mesh with >65535 vertices. It will fail to draw.");d.memoryOptimizedLoading?(f.boundingBox=null,f.boundingSphere=null):(f.boundingBox=(new THREE.Box3).copy(c.boundingBox),f.boundingSphere=(new THREE.Sphere).copy(c.boundingSphere));f.drawcalls=null;f.offsets=null;b.geometry=f;b.mesh=null;f=b.packId+":"+b.meshIndex;c=this.svf;G=c.fragments;l=G.mesh2frag[f];if(void 0===l)stderr("Mesh "+f+" was not referenced by any fragments.");else{n=
Array.isArray(l)?l.length:1;n=this.viewer3DImpl.addGeometry(b.geometry,n);b=(b.geometry.attributes.index.array||b.geometry.ib).length/3;if(Array.isArray(l))for(w=0;w<l.length;w++)B=0|l[w],D=G.materials[B].toString(),G.polygonCounts&&(G.polygonCounts[B]=b),this.viewer3DImpl.addMeshInstance(n,B,D,a(this.tmpMatrix,G,B));else w=a(this.tmpMatrix,G,0|l),D=G.materials[l].toString(),G.polygonCounts&&(G.polygonCounts[0|l]=b),this.viewer3DImpl.addMeshInstance(n,0|l,D,w);G.mesh2frag[f]=null;G.numLoaded+=l.length||
1;b=G.numLoaded;c.geomPolyCount>c.nextRepaintPolys&&(c.numRepaints++,c.nextRepaintPolys+=1E4*Math.pow(1.5,c.numRepaints),this.viewer3DImpl.invalidate(!1,!0));this.isf2d&&0==b%20&&this.viewer3DImpl.invalidate(!1,!0)}};d.SvfLoader.prototype.processReceivedMesh2D=function(a,b){var c={mesh:a,is2d:!0,packId:"0",meshIndex:b},d="0:"+b,f=this.svf.fragments;f.fragId2dbId[b]=c.mesh.dbIds;for(var g in c.mesh.dbIds){var h=parseInt(g),k=f.dbId2fragId[h];Array.isArray(k)?k.push(b):f.dbId2fragId[h]="undefined"!==
typeof k?[k,b]:b}f.mesh2frag[d]=b;f.materials[b]=this.viewer3DImpl.matman().create2DMaterial(this.svf,a.material);f.length++;this.processReceivedMesh(c)};d.SvfLoader.prototype.onSvfLoadDone=function(a){this.isf2d&&(a.fragments={},a.fragments.mesh2frag={},a.fragments.materials=[],a.fragments.fragId2dbId=[],a.fragments.dbId2fragId=[],a.fragments.length=0,a.fragments.initialized=!0);a.geomPolyCount=0;a.instancePolyCount=0;a.geomMemory=0;a.fragments.numLoaded=0;a.meshCount=0;a.gpuNumMeshes=0;a.gpuMeshMemory=
0;a.nextRepaintPolys=1E4;a.numRepaints=0;a.basePath="";var b=this.currentLoadPath.lastIndexOf("/");-1!=b&&(a.basePath=this.currentLoadPath.substr(0,b+1));b=Date.now();this.loadTime+=b-this.t0;stderr("SVF load: "+(b-this.t0));this.loadPropertyDb();this.viewer3DImpl.matman().convertMaterials(a);this.t0=b;a.bbox=(new THREE.Box3).copy(a.bbox);if(a.cameras)for(b=0;b<a.cameras.length;b++){var c=a.cameras[b];c.position=(new THREE.Vector3).copy(c.position);c.target=(new THREE.Vector3).copy(c.target);c.up=
(new THREE.Vector3).copy(c.up)}a.proteinMaterials&&PROTEIN_ROOT&&PRISM_ROOT&&this.viewer3DImpl.matman().loadTextures(a);stderr("scene bounds: "+JSON.stringify(a.bbox));this.viewer3DImpl.signalProgress(5,"Hold on, getting the model...")};d.SvfLoader.prototype.makeBVH=function(a){var b=performance.now();a.bvh=new BVHBuilder(a.fragments,a.simplemats);a.bvh.build({isWeakDevice:isAndroidDevice()||isIOSDevice()});a=performance.now();stderr("BVH build time: "+(a-b))};d.SvfLoader.prototype.onGeomLoadDone=
function(){this.svf.loadDone=!0;this.svf.fragments.entityIndexes=null;this.svf.fragments.mesh2frag=null;var a=Date.now(),b="Fragments load time: "+(a-this.t0);this.loadTime+=a-this.t0;this.isf2d||this.svf.bvh||(this.makeBVH(this.svf),this.viewer3DImpl.setBVH(this.svf.bvh.nodes,this.svf.bvh.primitives));stderr(b);this.logger&&(a={category:"model_load_stats",is_f2d:this.isf2d,has_prism:this.viewer3DImpl.matman().hasPrism,load_time:this.loadTime,geometry_size:this.viewer3DImpl.modelQueue().getGeometryList().geomMemory,
meshes_count:this.viewer3DImpl.modelQueue().getGeometryList().geoms.length,urn:this.svfUrn},this.logger.log(a,!0));d.assets&&window.webkit&&(window.webkit.messageHandlers.callbackHandler.postMessage({command:"assets",data:d.assets}),d.assets=null);this.currentLoadPath=null;this.isf2d=void 0;this.viewer3DImpl.onLoadComplete()};var l=1,n={};d.SvfLoader.prototype.loadPropertyDb=function(){var a=this;this.propWorker||(this.propWorker=d.createWorkerWithTokenRefresh("Property"),this.propWorker.addEventListenerWithTokenRefresh(b));
var g=c(function(b){var c=b.instanceTree,d=b.instanceBoxes;c?(a.svf.instanceTree=new InstanceTree(c,d,b.objectCount,b.maxTreeDepth),a.svf.fragToNodeDone=!0):b.objectCount&&(a.svf.hasObjectProperties=b.objectCount);a.viewer3DImpl.api.fireEvent({type:f.OBJECT_TREE_CREATED_EVENT,svf:a.svf})},function(b){a.svf.propertyDbError=b;a.viewer3DImpl.api.fireEvent({type:f.OBJECT_TREE_UNAVAILABLE_EVENT,svf:a.svf})}),h=this.pathToURL(this.svf.basePath);this.sharedDbPath&&!this.svf.propertydb.values.length&&(h=
this.sharedDbPath,stderr("Using shared property db: "+h));this.propWorker.postMessage({operation:WORKER_GET_OBJECT_TREE,url:h,propertydb:this.svf.propertydb,headers:f.HTTP_REQUEST_HEADERS,fragToDbId:this.svf.fragments.fragId2dbId,fragBoxes:this.svf.fragments.boxes,auth:auth,viewing_url:VIEWING_URL,cbId:g,queryParams:this.domainParam})};d.SvfLoader.prototype.asyncPropertyOperation=function(a,b,d){var g=this;if(g.svf.instanceTree||g.svf.hasObjectProperties){var h=c(b,d);a.cbId=h;this.propWorker.postMessage(a)}else if(g.svf.propertyDbError)d(g.svf.propertyDbError);
else{var k=function(c){g.viewer3DImpl.api.removeEventListener(f.OBJECT_TREE_CREATED_EVENT,k);g.viewer3DImpl.api.removeEventListener(f.OBJECT_TREE_UNAVAILABLE_EVENT,k);c.svf.instanceTree||c.svf.hasObjectProperties||c.svf.propertyDbError?g.asyncPropertyOperation(a,b,d):d({code:f.UNKNOWN_FAILURE,msg:"Failed to load properties."})};g.viewer3DImpl.api.addEventListener(f.OBJECT_TREE_CREATED_EVENT,k);g.viewer3DImpl.api.addEventListener(f.OBJECT_TREE_UNAVAILABLE_EVENT,k)}};d.SvfLoader.prototype.getProperties=
function(a,b,c){this.asyncPropertyOperation({operation:WORKER_GET_PROPERTIES,dbId:a},b,c)};d.SvfLoader.prototype.searchProperties=function(a,b,c,d){this.asyncPropertyOperation({operation:WORKER_SEARCH_PROPERTIES,searchText:a,attributeNames:b},c,d)};d.SvfLoader.prototype.getExternalIdMapping=function(a,b){this.asyncPropertyOperation({operation:WORKER_BUILD_EXTERNAL_ID_MAPPING},a,b)};d.SvfLoader.prototype.getObjectTree=function(a,b){var c=this;if(c.svf.instanceTree)a(c.svf.instanceTree.root);else if(c.svf.propertyDbError)b(c.svf.propertyDbError);
else{var d=function(){c.viewer3DImpl.api.removeEventListener(f.OBJECT_TREE_CREATED_EVENT,d);c.viewer3DImpl.api.removeEventListener(f.OBJECT_TREE_UNAVAILABLE_EVENT,d);c.getObjectTree(a,b)};c.viewer3DImpl.api.addEventListener(f.OBJECT_TREE_CREATED_EVENT,d);c.viewer3DImpl.api.addEventListener(f.OBJECT_TREE_UNAVAILABLE_EVENT,d)}}})();
function NodeArray(a,b){this.bytes_per_node=b?32:36;var c,f;a instanceof ArrayBuffer?(c=a.byteLength/this.bytes_per_node,f=a,this.nodeCount=c):(c=a|0,f=new ArrayBuffer(this.bytes_per_node*c),this.nodeCount=0);this.nodeCapacity=c;this.nodesRaw=f;this.is_lean_node=b;this.node_stride=this.bytes_per_node/4;this.node_stride_short=this.bytes_per_node/2;this.nodesF=new Float32Array(this.nodesRaw);this.nodesI=new Int32Array(this.nodesRaw);this.nodesS=new Uint16Array(this.nodesRaw)}
NodeArray.prototype.setLeftChild=function(a,b){this.nodesI[a*this.node_stride+6]=b};NodeArray.prototype.getLeftChild=function(a){return this.nodesI[a*this.node_stride+6]};NodeArray.prototype.setPrimStart=function(a,b){this.is_lean_node?this.nodesI[a*this.node_stride+6]=b:this.nodesI[a*this.node_stride+8]=b};NodeArray.prototype.getPrimStart=function(a){return this.is_lean_node?this.nodesI[a*this.node_stride+6]:this.nodesI[a*this.node_stride+8]};
NodeArray.prototype.setPrimCount=function(a,b){this.nodesS[a*this.node_stride_short+14]=b};NodeArray.prototype.getPrimCount=function(a){return this.nodesS[a*this.node_stride_short+14]};NodeArray.prototype.setFlags=function(a,b,c,f){this.nodesS[a*this.node_stride_short+15]=f<<3|c<<2|b&3};NodeArray.prototype.getFlags=function(a){return this.nodesS[a*this.node_stride_short+15]};
NodeArray.prototype.setBox0=function(a,b){var c=a*this.node_stride,f=this.nodesF;f[c]=b[0];f[c+1]=b[1];f[c+2]=b[2];f[c+3]=b[3];f[c+4]=b[4];f[c+5]=b[5]};NodeArray.prototype.getBoxThree=function(a,b){var c=a*this.node_stride,f=this.nodesF;b.min.x=f[c];b.min.y=f[c+1];b.min.z=f[c+2];b.max.x=f[c+3];b.max.y=f[c+4];b.max.z=f[c+5]};NodeArray.prototype.setBoxThree=function(a,b){var c=a*this.node_stride,f=this.nodesF;f[c]=b.min.x;f[c+1]=b.min.y;f[c+2]=b.min.z;f[c+3]=b.max.x;f[c+4]=b.max.y;f[c+5]=b.max.z};
NodeArray.prototype.makeEmpty=function(a){a*=this.node_stride;var b=this.nodesI;b[a+6]=-1;b[a+7]=0;this.is_lean_node||(b[a+8]=-1)};NodeArray.prototype.realloc=function(a){if(this.nodeCount+a>this.nodeCapacity){var b=0|3*this.nodeCapacity/2;b<this.nodeCount+a&&(b=this.nodeCount+a);a=new ArrayBuffer(b*this.bytes_per_node);var c=new Int32Array(a);c.set(this.nodesI);this.nodeCapacity=b;this.nodesRaw=a;this.nodesF=new Float32Array(a);this.nodesI=c;this.nodesS=new Uint16Array(a)}};
NodeArray.prototype.nextNodes=function(a){this.realloc(a);var b=this.nodeCount;this.nodeCount+=a;for(var c=0;c<a;c++)this.makeEmpty(b+c);return b};NodeArray.prototype.getRawData=function(){return this.nodesRaw.slice(0,this.nodeCount*this.bytes_per_node)};
var BOX_STRIDE=6,POINT_STRIDE=3,BOX_EPSILON=1E-5,BOX_SCALE_EPSILON=1E-5,MAX_DEPTH=15,MAX_BINS=16,BVHModule=function(){function a(a,b,c){a[0]>b[c]&&(a[0]=b[c]);a[3]<b[c]&&(a[3]=b[c]);a[1]>b[c+1]&&(a[1]=b[c+1]);a[4]<b[c+1]&&(a[4]=b[c+1]);a[2]>b[c+2]&&(a[2]=b[c+2]);a[5]<b[c+2]&&(a[5]=b[c+2])}function b(a,b,c){a[0]>b[c]&&(a[0]=b[c]);a[1]>b[c+1]&&(a[1]=b[c+1]);a[2]>b[c+2]&&(a[2]=b[c+2]);a[3]<b[c+3]&&(a[3]=b[c+3]);a[4]<b[c+4]&&(a[4]=b[c+4]);a[5]<b[c+5]&&(a[5]=b[c+5])}function c(a,b){a[0]>b[0]&&(a[0]=b[0]);
a[1]>b[1]&&(a[1]=b[1]);a[2]>b[2]&&(a[2]=b[2]);a[3]<b[3]&&(a[3]=b[3]);a[4]<b[4]&&(a[4]=b[4]);a[5]<b[5]&&(a[5]=b[5])}function f(a,b,c,d){for(var f=0;3>f;f++)a[b+f]=c[d+3+f]-c[d+f]}function d(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5]}function g(a){a[0]=Infinity;a[1]=Infinity;a[2]=Infinity;a[3]=-Infinity;a[4]=-Infinity;a[5]=-Infinity}function h(a){var b=a[3]-a[0],c=a[4]-a[1];a=a[5]-a[2];return 0>b||0>c||0>a?0:2*(b*c+c*a+a*b)}function k(){this.vb_left=new Float32Array(6);this.vb_right=
new Float32Array(6);this.cb_left=new Float32Array(6);this.cb_right=new Float32Array(6);this.num_left=0;this.num_bins=this.best_cost=this.best_split=-1}function l(){this.box_bbox=new Float32Array(6);this.box_centroid=new Float32Array(6);this.num_prims=0}function n(){this.BL=new Float32Array(6);this.CL=new Float32Array(6);this.AL=this.NL=0}k.prototype.reset=function(){this.num_left=0;this.num_bins=this.best_cost=this.best_split=-1};l.prototype.reset=function(){this.num_prims=0;g(this.box_bbox);g(this.box_centroid)};
n.prototype.reset=function(){this.AL=this.NL=0;g(this.BL);g(this.CL)};for(var q=[],m=0;m<MAX_BINS;m++)q.push(new l);for(var p=[],m=0;m<MAX_BINS-1;m++)p.push(new n);var t=new Float32Array(6),v=new Float32Array(6),D=new Float32Array(3);return{bvh_subdivide:function(m,l,n,z,G,A,E,H){f(D,0,A,0);var I=m.nodes,J=E?m.frags_per_leaf_node_transparent:m.frags_per_leaf_node,L=E?m.frags_per_inner_node_transparent:m.frags_per_inner_node,C=m.max_polys_per_node,N=0;D[1]>D[0]&&(N=1);D[2]>D[N]&&(N=2);I.setBox0(l,
G);var K=0;G=0;if(m.polygonCounts)for(var R=n;R<=z&&!(K+=m.polygonCounts[m.primitives[R]],G++,K>C);R++);R=z-n+1;if(R<=J&&K<C||1===R||H>MAX_DEPTH||D[N]<m.scene_epsilon)I.setLeftChild(l,-1),I.setPrimStart(l,n),I.setPrimCount(l,z-n+1),I.setFlags(l,0,0,E?1:0);else{if(L){L=n;N=m.primitives;J=m.centroids;C=z-L+1;C>m.frags_per_inner_node&&(C=m.frags_per_inner_node);C>G&&(C=G);I.setPrimStart(l,L);I.setPrimCount(l,C);L+=C;g(A);for(G=L;G<=z;G++)a(A,J,3*N[G]);f(D,0,A,0);N=0;D[1]>D[0]&&(N=1);D[2]>D[N]&&(N=2);
n+=I.getPrimCount(l)}G=new k;var T=n,L=N;if(D[L]<m.scene_epsilon)G.best_cost=Infinity;else{J=MAX_BINS;J>z-T+1&&(J=z-T+1);for(C=0;C<J;C++)q[C].reset();for(C=0;C<J-1;C++)p[C].reset();var C=G.num_bins=J,K=m.centroids,R=m.primitives,ba=m.boxes,X=C*(1-BOX_SCALE_EPSILON)/D[L];A=A[L];for(var Y=m.sort_prims;T<=z;T++){var W=R[T]|0,U=X*(K[3*W+L]-A)|0;0>U?U=0:U>=C&&(U=C-1);Y[T]=U;q[U].num_prims++;b(q[U].box_bbox,ba,6*W);a(q[U].box_centroid,K,3*W)}d(p[0].BL,q[0].box_bbox);d(p[0].CL,q[0].box_centroid);p[0].AL=
h(p[0].BL);p[0].NL=q[0].num_prims;for(C=1;C<J-1;C++)A=q[C],L=p[C],d(L.BL,p[C-1].BL),c(L.BL,A.box_bbox),L.AL=h(L.BL),d(L.CL,p[C-1].CL),c(L.CL,A.box_centroid),L.NL=p[C-1].NL+A.num_prims;C=J-1;d(t,q[C].box_bbox);d(v,q[C].box_centroid);R=h(t);J=q[C].num_prims;L=C;K=R*J+p[C-1].AL*p[C-1].NL;d(G.vb_right,t);d(G.cb_right,q[C].box_centroid);d(G.vb_left,p[C-1].BL);d(G.cb_left,p[C-1].CL);G.num_left=p[C-1].NL;for(--C;1<=C;C--)A=q[C],c(t,A.box_bbox),c(v,A.box_centroid),R=h(t),J+=A.num_prims,A=R*J+p[C-1].AL*p[C-
1].NL,A<=K&&(K=A,L=C,d(G.vb_right,t),d(G.cb_right,v),d(G.vb_left,p[C-1].BL),d(G.cb_left,p[C-1].CL),G.num_left=p[C-1].NL);G.best_split=L;G.best_cost=K}if(0>G.num_bins)I.setPrimCount(l,I.getPrimCount(l)+z-n+1);else{A=m.primitives;J=m.sort_prims;L=0;C=n|0;R=G.best_split|0;for(K=n;K<=z;K++)ba=A[K]|0,J[K]<R?A[C++]=ba:J[L++]=ba;for(K=0;K<L;K++)A[C+K]=J[K];A=I.nextNodes(2);I.setFlags(l,N,.5*(G.vb_left[3+N]+G.vb_left[N])<.5*(G.vb_right[3+N]+G.vb_right[N])?0:1,E?1:0);I.setLeftChild(l,A);m.recursion_stack.push([m,
A+1,n+G.num_left,z,G.vb_right,G.cb_right,E,H+1]);m.recursion_stack.push([m,A,n,n+G.num_left-1,G.vb_left,G.cb_left,E,H+1])}}},compute_boxes:function(c){var d=c.boxv_o,h=c.boxc_o,k=c.boxv_t,m=c.boxc_t;g(d);g(h);g(k);g(m);for(var l=c.centroids,n=c.boxes,q=0,t=c.prim_count;q<t;q++){var p=l,v=3*q,C=n,N=6*q;p[v]=.5*(C[N]+C[N+3]);p[v+1]=.5*(C[N+1]+C[N+4]);p[v+2]=.5*(C[N+2]+C[N+5]);q>=c.first_transparent?(a(m,l,3*q),b(k,n,6*q)):(a(h,l,3*q),b(d,n,6*q))}f(D,0,c.boxv_o,0);d=Math.max(D[0],D[1],D[2]);c.scene_epsilon=
BOX_EPSILON*d},box_area:function(a,b){var c=a[b+3]-a[b],d=a[b+4]-a[b+1],f=a[b+5]-a[b+2];return 0>c||0>d||0>f?0:2*(c*d+d*f+f*c)}}}();
function BVHBuilder(a,b){this.boxes=a.boxes;this.polygonCounts=a.polygonCounts;this.materials=a.materials;this.materialDefs=b;this.prim_count=a.length;this.frags_per_inner_node=this.frags_per_leaf_node=-1;this.nodes=null;this.work_buf=new ArrayBuffer(4*this.prim_count);this.sort_prims=new Int32Array(this.work_buf);this.primitives=new Int32Array(this.prim_count);this.centroids=new Float32Array(POINT_STRIDE*this.prim_count);this.boxv_o=new Float32Array(6);this.boxc_o=new Float32Array(6);this.boxv_t=
new Float32Array(6);this.boxc_t=new Float32Array(6);this.recursion_stack=[]}
BVHBuilder.prototype.sortPrimitives=function(){for(var a=new Float32Array(this.work_buf),b=this.materialDefs,c=this.materials,f=this.primitives,d=0,g=0,h=this.prim_count;g<h;g++){f[g]=g;var k=b[c[g]]?b[c[g]].transparent:!1;k&&d++;l?(a[g]=BVHModule.box_area(this.boxes,BOX_STRIDE*g),k&&(a[g]=-a[g])):a[g]=k?-1:1}var l=!1;if(d&&d<this.prim_count){b=new Int32Array(d);g=k=c=0;for(h=this.prim_count;g<h;g++)0<=a[g]?f[c++]=f[g]:b[k++]=f[g];f.set(b,this.prim_count-d)}this.first_transparent=this.prim_count-
d};
BVHBuilder.prototype.build=function(a){var b=a&&!!a.useSlimNodes;if(b)this.frags_per_leaf_node=1,this.frags_per_inner_node=0,this.frags_per_leaf_node_transparent=1,this.frags_per_inner_node_transparent=0,this.max_polys_per_node=Infinity;else{var c=a.isWeakDevice?.5:1;this.frags_per_leaf_node=0|32*c;this.frags_per_inner_node=0|this.frags_per_leaf_node;this.frags_per_leaf_node_transparent=this.frags_per_leaf_node;this.frags_per_inner_node_transparent=0;this.max_polys_per_node=0|1E4*c}if(this.nodes&&this.nodes.is_lean_node==
b)this.nodes.nodeCount=0;else{b=this.prim_count/this.frags_per_leaf_node;for(c=1;c<b;)c*=2;this.nodes=new NodeArray(c,a?a.useSlimNodes:!1)}this.sortPrimitives();BVHModule.compute_boxes(this);a=this.nodes.nextNodes(2);for(BVHModule.bvh_subdivide(this,a,0,this.first_transparent-1,this.boxv_o,this.boxc_o,!1,0);this.recursion_stack.length;)b=this.recursion_stack.pop(),BVHModule.bvh_subdivide(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);for(BVHModule.bvh_subdivide(this,a+1,this.first_transparent,this.prim_count-
1,this.boxv_t,this.boxc_t,!0,0);this.recursion_stack.length;)b=this.recursion_stack.pop(),BVHModule.bvh_subdivide(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7])};AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.VertexBufferReader=function(a){this.vb=a.vb.buffer;this.vbf=new Float32Array(this.vb);this.vbi=new Int32Array(this.vb);this.stride=a.vbstride;this.vcount=this.vbf.length/this.stride;this.useInstancing=!1};a.VertexBufferReader.prototype.getIdAt=function(a){return this.vbi[a*this.stride+7]};a.VertexBufferReader.prototype.getVertexFlagAt=function(a){return this.vbi[a*this.stride+8]};a.VertexBufferReader.prototype.decodeLineAt=function(a,c,f){var d=this.stride*
a;a=this.vbf[d];c=this.vbf[d+1];var g=this.vbf[d+2],h=this.vbf[d+3],d=a+h*Math.cos(g),g=c+h*Math.sin(g);if(f.onLineSegment)f.onLineSegment(a,c,d,g)};a.VertexBufferReader.prototype.decodeCircularArcAt=function(a,c,f){var d=this.stride*a;a=this.vbf[d];c=this.vbf[d+1];var g=this.vbf[d+2],h=this.vbf[d+3],d=this.vbf[d+5];if(f.onCircularArc)f.onCircularArc(a,c,g,h,d)};a.VertexBufferReader.prototype.decodeEllipticalArcAt=function(a,c,f){var d=this.stride*a;a=this.vbf[d];c=this.vbf[d+1];var g=this.vbf[d+
2],h=this.vbf[d+3],k=this.vbf[d+5],l=this.vbf[d+9],d=this.vbf[d+10];if(f.onEllipticalArc)f.onEllipticalArc(a,c,g,h,k,l,d)};a.VertexBufferReader.prototype.enumGeomsForObject=function(a,c){for(var f=0;f<this.vcount;){var d=this.getVertexFlagAt(f),g=d&240,h=d&15,d=d>>16&255;if(this.getIdAt(f)===a)switch(g){case 16:this.decodeLineAt(f,d,c);break;case 32:this.decodeCircularArcAt(f,d,c);break;case 48:this.decodeEllipticalArcAt(f,d,c)}f+=h&&g?4:1}}})();var OUTSIDE=0,INTERSECTS=1,CONTAINS=2;
function FrustumIntersector(){this.frustum=new THREE.Frustum;this.viewProj=new THREE.Matrix4;this.viewDir=[0,0,1];this.ar=1;this.viewport=new THREE.Vector3(1,1,1)}FrustumIntersector.prototype.reset=function(a){this.viewProj.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse);this.frustum.setFromMatrix(this.viewProj);var b=a.matrixWorldInverse.elements;this.ar=a.aspect;this.viewDir[0]=-b[2];this.viewDir[1]=-b[6];this.viewDir[2]=-b[10]};
FrustumIntersector.prototype.projectedArea=function(){var a,b;return function(c){a||(a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],b=new THREE.Box2);var f=this.viewProj;a[0].set(c.min.x,c.min.y,c.min.z);a[1].set(c.min.x,c.min.y,c.max.z);a[2].set(c.min.x,c.max.y,c.min.z);a[3].set(c.min.x,c.max.y,c.max.z);a[4].set(c.max.x,c.min.y,c.min.z);a[5].set(c.max.x,c.min.y,c.max.z);a[6].set(c.max.x,c.max.y,c.min.z);
a[7].set(c.max.x,c.max.y,c.max.z);for(c=0;8>c;c++){var d=a[c],g=d.x,h=d.y,k=d.z,l=f.elements,n=l[3]*g+l[7]*h+l[11]*k+l[15];0>n&&(n=-n);n=1/n;d.x=(l[0]*g+l[4]*h+l[8]*k+l[12])*n;d.y=(l[1]*g+l[5]*h+l[9]*k+l[13])*n}b.makeEmpty();b.setFromPoints(a);-1>b.min.x&&(b.min.x=-1);-1>b.min.y&&(b.min.y=-1);1<b.max.x&&(b.max.x=1);1<b.max.y&&(b.max.y=1);return(b.max.x-b.min.x)*(b.max.y-b.min.y)}}();
FrustumIntersector.prototype.intersectsBox=function(){var a,b;return function(c){a||(a=new THREE.Vector3,b=new THREE.Vector3);for(var f=this.frustum.planes,d=0,g=0;6>g;g++){var h=f[g];a.x=0<h.normal.x?c.min.x:c.max.x;b.x=0<h.normal.x?c.max.x:c.min.x;a.y=0<h.normal.y?c.min.y:c.max.y;b.y=0<h.normal.y?c.max.y:c.min.y;a.z=0<h.normal.z?c.min.z:c.max.z;b.z=0<h.normal.z?c.max.z:c.min.z;var k=h.distanceToPoint(a),h=h.distanceToPoint(b);if(0>k&&0>h)return OUTSIDE;0<k&&0<h&&d++}return 6==d?CONTAINS:INTERSECTS}}();
var VBIntersector=function(){function a(){f||(f=new THREE.Matrix4,d=new THREE.Ray,g=new THREE.Vector3,h=new THREE.Vector3,k=new THREE.Vector3)}function b(b,c,q){a();var m=b.geometry,p=b.material,t=m.attributes;f.getInverse(b.matrixWorld);d.copy(c.ray).applyMatrix4(f);var v,D,w,F=c.precision;if(void 0!==t.index){var B=t.index.array||m.ib,t=m.vb?m.vb:t.position.array,z=m.vb?m.vbstride:3;(m=m.offsets)&&0!==m.length||(m=[{start:0,count:B.length,index:0}]);for(var G=0,A=m.length;G<A;++G){v=m[G].start;
for(var E=m[G].index,H=v,I=v+m[G].count;H<I;H+=3){v=E+B[H];D=E+B[H+1];w=E+B[H+2];g.fromArray(t,v*z);h.fromArray(t,D*z);k.fromArray(t,w*z);var J=p.side===THREE.BackSide?d.intersectTriangle(k,h,g,!0):d.intersectTriangle(g,h,k,p.side!==THREE.DoubleSide);if(null!==J){J.applyMatrix4(b.matrixWorld);var L=c.ray.origin.distanceTo(J);L<F||L<c.near||L>c.far||q.push({distance:L,point:J,face:new THREE.Face3(v,D,w,THREE.Triangle.normal(g,h,k)),faceIndex:null,fragId:b.fragId})}}}}else for(t=m.vb?m.vb:t.position.array,
z=m.vb?m.vbstride:3,H=0,I=t.length;H<I;H+=3)v=H,D=H+1,w=H+2,g.fromArray(t,v*z),h.fromArray(t,D*z),k.fromArray(t,w*z),J=p.side===THREE.BackSide?d.intersectTriangle(k,h,g,!0):d.intersectTriangle(g,h,k,p.side!==THREE.DoubleSide),null!==J&&(J.applyMatrix4(b.matrixWorld),L=c.ray.origin.distanceTo(J),L<F||L<c.near||L>c.far||q.push({distance:L,point:J,face:new THREE.Face3(v,D,w,THREE.Triangle.normal(g,h,k)),faceIndex:null,fragId:b.fragId}))}function c(b,c,g){a();var h=c.linePrecision,h=h*h,k=b.geometry;
f.getInverse(b.matrixWorld);d.copy(c.ray).applyMatrix4(f);var t=new THREE.Vector3,v=new THREE.Vector3,D=new THREE.Vector3,w=new THREE.Vector3,F=b.mode===THREE.LineStrip?1:2;if(k instanceof THREE.BufferGeometry){var B=k.attributes;if(void 0!==B.index){var z=B.index.array,B=k.vb?k.vb:B.position.array,G=k.vb?k.vbstride:3;(k=k.offsets)&&0!==k.length||(k=[{start:0,count:z.length,index:0}]);for(var A=0;A<k.length;A++)for(var E=k[A].start,H=k[A].count,I=k[A].index,J=E;J<E+H-1;J+=F){var L=I+z[J+1];t.fromArray(B,
(I+z[J])*G);v.fromArray(B,L*G);L=d.distanceSqToSegment(t,v,w,D);L>h||(L=d.origin.distanceTo(w),L<c.near||L>c.far||g.push({distance:L,point:D.clone().applyMatrix4(b.matrixWorld),face:null,faceIndex:null,fragId:b.fragId}))}}else for(B=k.vb?k.vb:B.position.array,G=k.vb?k.vbstride:3,J=0;J<B.length/G-1;J+=F)t.fromArray(B,G*J),v.fromArray(B,G*J+G),L=d.distanceSqToSegment(t,v,w,D),L>h||(L=d.origin.distanceTo(w),L<c.near||L>c.far||g.push({distance:L,point:D.clone().applyMatrix4(b.matrixWorld),face:null,faceIndex:null,
fragId:b.fragId}))}return null}var f,d,g,h,k;return{meshRayCast:b,lineRayCast:c,rayCast:function(a,d,f){return a.isLine?c(a,d,f):b(a,d,f)}}}();function GeometryList(a){this.geoms=[];this.instancePolyCount=this.geomPolyCount=this.gpuNumMeshes=this.gpuMeshMemory=this.geomMemory=0;this.is2d=a.is2d();this.svf=a.getData();this.svf.packFileTotalSize&&this.svf.packFileTotalSize-6*this.svf.primitiveCount<=(Autodesk.Viewing.Private.memoryOptimizedLoading?0:268435456)&&(this.svf.disableStreaming=!0)}
GeometryList.prototype.getGeometry=function(a){return this.geoms[a]};
GeometryList.prototype.addGeometry=function(a,b){var c=Autodesk.Viewing.Private.memoryOptimizedLoading?0:268435456,f=Autodesk.Viewing.Private.memoryOptimizedLoading?0:536870912;this.isf2d&&(f*=2);this.disableStreaming||this.gpuMeshMemory<c?(a.streamingDraw=!1,a.streamingIndex=!1):this.gpuMeshMemory>=f?(a.streamingDraw=!0,a.streamingIndex=!0):1E5>(this.is2d?100001:a.byteSize*(b||1))&&(a.streamingDraw=!0,a.streamingIndex=!0);a.streamingDraw||(this.gpuMeshMemory+=a.byteSize,this.gpuNumMeshes+=1);this.geoms.push(a);
this.geomMemory+=a.byteSize;c=(a.attributes.index.array||a.ib).length/3;this.svf.geomPolyCount=this.geomPolyCount+=c;this.instancePolyCount+=c*(b||1);a.svfid=this.geoms.length-1;return a.svfid};GeometryList.prototype.printStats=function(){stderr("Total geometry size: "+this.geomMemory/1048576+" MB");stderr("Number of meshes: "+this.geoms.length);stderr("Num Meshes on GPU: "+this.gpuNumMeshes);stderr("Net GPU geom memory used: "+this.gpuMeshMemory)};
function InstanceTree(a,b,c,f){this.root=a;this.rootId=a.dbId;this.maxDepth=f;this.boxes=b;this.objectCount=c;this.createDbIdToNodeMapping()}InstanceTree.prototype.createDbIdToNodeMapping=function(){if(this.root){var a=this.dbIdToNode=Array(this.objectCount);(function c(f){a[f.dbId]=f;if(f.children)for(var d=0;d<f.children.length;d++)c(f.children[d])})(this.root)}};InstanceTree.prototype.getNodeById=function(a){return this.dbIdToNode[a]};InstanceTree.prototype.getRootId=function(){return this.rootId};
InstanceTree.prototype.enumNodeFragments=function(a,b,c){function f(a){var h=d.getNodeById(a).fragIds;if(void 0!==h){Array.isArray(h)||b(h);for(var k=0;k<h.length;++k)b(h[k])}c&&d.enumNodeChildren(a,function(a){f(a)})}var d=this;f("number"==typeof a?a:a.dbId)};InstanceTree.prototype.enumNodeChildren=function(a,b,c){function f(a){a=d.getNodeById(a);if(a.children)for(var h=0;h<a.children.length;h++){var k=a.children[h].dbId;b(k);c&&f(k)}}var d=this;f("number"==typeof a?a:a.dbId)};
var MESH_VISIBLE=1,MESH_HIGHLIGHTED=2,MESH_HIDELINES=4,MESH_ISLINE=8,MESH_RENDERFLAG=128;
function FragmentList(a,b){this.fragments=a;this.geoms=b;var c=a.length;(this.isFixedSize=0<a.length)?(this.boxes=a.boxes,this.transforms=a.transforms,this.useThreeMesh=!Autodesk.Viewing.Private.memoryOptimizedLoading):(this.transforms=this.boxes=null,this.useThreeMesh=!0);0>=c&&(c=1);this.vizmeshes=Array(c);this.vizflags=new Uint8Array(c);this.geomids=new Int32Array(c);this.materialids=new Int32Array(c);this.materialmap={};for(var f=0;f<c;f++)this.vizflags[f]=1;this.allVisible=!0;this.allVisibleDirty=
!1}
FragmentList.prototype.setMesh=function(a,b){var c=this.vizmeshes[a];c&&(stderr("duplicate fragment."),c.parent.remove(c));this.useThreeMesh?(this.vizmeshes[a]=b,b.fragId=a,b.dbId=this.fragments.fragId2dbId[a]|0):(this.geomids[a]=b.geometry.svfid,this.materialids[a]=b.material.id,this.materialmap[b.material.id]||(this.materialmap[b.material.id]=b.material));this.vizflags.length<=a&&(this.isFixedSize&&(console.warn("Attempting to resize a fragments list that was initialized with fixed data. This will have a performance impact."),this.transforms=
this.boxes=null,this.isFixedSize=!1),c=2*this.vizflags.length,c<this.vizmeshes.length&&(c=this.vizmeshes.length),c=new Uint8Array(c),c.set(this.vizflags),this.vizflags=c);this.vizflags[a]=1|(b.isLine?MESH_ISLINE:0)};FragmentList.prototype.setFlagFragment=function(a,b,c){var f=this.vizflags[a];if(!!(f&b)==c)return!1;this.vizflags[a]=c?f|b:f&~b;return!0};FragmentList.prototype.setFlagGlobal=function(a,b){var c=this.vizflags,f=0,d=c.length;if(b)for(;f<d;f++)c[f]|=a;else for(var g=~a;f<d;f++)c[f]&=g};
FragmentList.prototype.hideLines=function(a){var b=MESH_HIDELINES,c=this.vizflags,f=this.vizmeshes,d=0,g=c.length;if(a)for(;d<g;d++)f[d]&&f[d].isLine&&(c[d]|=b);else for(a=~b;d<g;d++)f[d]&&f[d].isLine&&(c[d]&=a);this.allVisibleDirty=!0};FragmentList.prototype.isFragVisible=function(a){return 1==(this.vizflags[a]&3)};FragmentList.prototype.isLine=function(a){return!!(this.vizflags[a]&MESH_ISLINE)};
FragmentList.prototype.areAllVisible=function(){if(this.allVisibleDirty){for(var a=this.vizflags,b=!0,c=0,f=a.length;c<f;c++)if(0===(a[c]&1)){b=!1;break}this.allVisible=b;this.allVisibleDirty=!1}return this.allVisible};
FragmentList.prototype.getVizmesh=function(){var a;return function(b){if(this.useThreeMesh)return this.vizmeshes[b];a||(a=new THREE.Mesh(void 0,void 0,!0),a.isTemp=!0,a.dbId=0,a.fragId=-1);a.geometry=this.geoms.getGeometry(this.geomids[b]);a.material=this.getMaterial(b);a.dbId=this.getDbIds(b);a.fragId=b;a.visible=!0;a.isLine=this.isLine(b);this.getOriginalWorldMatrix(b,a.matrixWorld);return a}}();
FragmentList.prototype.getMaterialId=function(a){return this.useThreeMesh?this.vizmeshes[a].material.id:this.materialids[a]};FragmentList.prototype.getMaterial=function(a){return this.useThreeMesh?this.vizmeshes[a].material.id:this.materialmap[this.materialids[a]]};FragmentList.prototype.getCount=function(){return this.vizflags.length};FragmentList.prototype.getDbIds=function(a){return this.fragments.fragId2dbId[a]};
FragmentList.prototype.dispose=function(){if(this.useThreeMesh)for(var a={type:"removed"},b={type:"dispose"},c=0;c<this.vizmeshes.length;c++){var f=this.vizmeshes[c];f&&(f.dispatchEvent(a),f.geometry.dispatchEvent(b),f.material.dispatchEvent(b),f.material.needsUpdate=!0)}};FragmentList.prototype.setVisibility=function(a,b){this.setFlagFragment(a,MESH_VISIBLE,b);this.allVisibleDirty=!0};
FragmentList.prototype.setAllVisibility=function(a){this.setFlagGlobal(MESH_VISIBLE,a);this.allVisible=a;this.allVisibleDirty=!1};FragmentList.prototype.getOriginalWorldMatrix=function(a,b){var c=12*a,f=b.elements,d=this.transforms;f[0]=d[c];f[1]=d[c+1];f[2]=d[c+2];f[3]=0;f[4]=d[c+3];f[5]=d[c+4];f[6]=d[c+5];f[7]=0;f[8]=d[c+6];f[9]=d[c+7];f[10]=d[c+8];f[11]=0;f[12]=d[c+9];f[13]=d[c+10];f[14]=d[c+11];f[15]=1};
FragmentList.prototype.getWorldBounds=function(a,b){var c=this.useThreeMesh?this.vizmeshes[a]:null,f=c?c.matrixWorld:null;if(this.isFixedSize){var d=12*a,g=!0;if(f){var h=f.elements,k=this.transforms;if(h[0]!==k[d]||h[1]!==k[d+1]||h[2]!==k[d+2]||h[4]!==k[d+3]||h[5]!==k[d+4]||h[6]!==k[d+5]||h[8]!==k[d+6]||h[9]!==k[d+7]||h[10]!==k[d+8]||h[12]!==k[d+9]||h[13]!==k[d+10]||h[14]!==k[d+11])g=!1}if(g){c=this.boxes;f=6*a;b.min.x=c[f];b.min.y=c[f+1];b.min.z=c[f+2];b.max.x=c[f+3];b.max.y=c[f+4];b.max.z=c[f+
5];return}}b.copy(c.geometry.boundingBox).applyMatrix4(f)};function RenderBatch(a,b,c,f){this.frags=a;this.indices=b;this.start=c;this.count=f;this.nextItem=c;this.overrideMaterial=null;this.sortDone=!1;this.avgFrameTime=void 0;this.numAdded=0;this.boundingBox=new THREE.Box3;this.boundingBoxHidden=new THREE.Box3;this.sortObjects=!1;this.frustumCulled=!0;this.forceVisible=!1;this.renderImmediate=!a.useThreeMesh;this.tmpBox=new THREE.Box3}
RenderBatch.prototype.getIndices=function(){return Array.isArray(this.indices)?this.indices[0]:this.indices};
RenderBatch.prototype.sortByMaterial=function(){if(!(this.numAdded<this.count)){var a=this.frags,b=this.getIndices();b||stderr("Only indexed RenderSubsets can be sorted.");var c=b.subarray(this.start,this.start+this.count);Array.prototype.sort.call(c,function(c,d){var g=a.getMaterialId(b[c]),h=a.getMaterialId(b[d]);return void 0===g?h?1:0:void 0===h?-1:g-h});b.set(c,this.start);this.numAdded=0;this.sortDone=!0}};
RenderBatch.prototype.add=function(){return function(a,b){a.batch=this;this.frags.getWorldBounds(b,this.tmpBox);this.boundingBox.union(this.tmpBox);this.numAdded++;if(this.frags.useThreeMesh&&this.frags.vizmeshes[b]!=a){this.nextItem++;var c=this.getIndices();c?this.frags.vizmeshes[c[this.nextItem++]]=a:this.frags.vizmeshes[this.nextItem++]=a;this.sortDone=!1}else this.nextItem<=b&&(this.nextItem=b+1)}}();
RenderBatch.prototype.forEach=function(){return function(a,b,c){for(var f=this.getIndices(),d=this.frags,g=this.start,h=this.nextItem;g<h;g++){var k=f?f[g]:g,l=d.getVizmesh(k);(c||l&&l.geometry)&&(!b||d.vizflags[k]&b)&&a(l,k)}}}();RenderBatch.prototype.raycast=function(){return function(a,b){if(!1!==a.ray.isIntersectionBox(this.boundingBox)){var c=this,f=this.tmpBox;this.forEach(function(d,g){c.frags.getWorldBounds(g,f);a.ray.isIntersectionBox(f)&&VBIntersector.rayCast(d,a,b)},MESH_VISIBLE)}}}();
RenderBatch.prototype.calculateBounds=function(){return function(){this.boundingBox.makeEmpty();this.boundingBoxHidden.makeEmpty();var a=this.frags.vizflags,b=this.boundingBox,c=this.boundingBoxHidden,f=this.frags,d=this.tmpBox;this.forEach(function(g,h){f.getWorldBounds(h,d);var k=a[h];k&1&&b.union(d);0===(k&127)&&c.union(d)})}}();
RenderBatch.prototype.applyVisibility=function(){function a(a,q){if(!a&&b.useThreeMesh)g&&g(q);else if(b.getWorldBounds(q,l),h&&!f.intersectsBox(l))a?a.visible=!1:stderr("Unexpected null mesh"),c[q]&=~MESH_RENDERFLAG;else{var m,p=c[q]&127;switch(d){case RENDER_HIDDEN:m=!(p&MESH_VISIBLE);break;case RENDER_HIGHLIGHTED:m=p&MESH_HIGHLIGHTED;break;default:m=1==(p&(MESH_VISIBLE|MESH_HIGHLIGHTED|MESH_HIDELINES))}a&&(a.visible=!!m);c[q]=p|(m?MESH_RENDERFLAG:0);k=k&&!m}}var b,c,f,d,g,h,k,l;return function(n,
q,m){k=!0;f=q;d=n;g=m;n=f.intersectsBox(d===RENDER_HIDDEN?this.boundingBoxHidden:this.boundingBox);if(n===OUTSIDE)return k;c=this.frags.vizflags;b=this.frags;h=n!==CONTAINS;l=this.tmpBox;this.forEach(a,null,g);return k}}();var MAX_FRAGS_PER_GROUP=333;
function RenderQueue(a){function b(a){W.length<NUM_WORKER_THREADS&&(a=w.fragments.packIds[a],-1==W.indexOf(a)&&W.push(a))}function c(a){for(var b=H[a],c=J;c>I&&H[E[c-1]]>b;)E[c]=E[c-1],c--;E[c]=a;J++}function f(a){var b=z.getLeftChild(a);-1!==b&&(f(b),f(b+1));t.makeEmpty();-1!==b&&(z.getBoxThree(b,U),t.union(U),z.getBoxThree(b+1,U),t.union(U));z.getPrimCount(a)&&(t.union(A[a].boundingBox),t.union(A[a].boundingBoxHidden));z.setBoxThree(a,t)}var d=a.is2d(),g=!1,h=0,k=0,l=null,n=!0,q=0,m=new THREE.Box3,
p=new THREE.Box3;this.visibleBoundsDirty=!1;for(var t=new THREE.Box3,v=new GeometryList(a),D=a.getData().fragments,w=new FragmentList(D,v),F=[new Int32Array(D.length)],B=0;B<D.length;B++)F[0][B]=B;var z=null,G=null,A=null,E=null,H=null,I,J,L=!1,C=!1,N=new FrustumIntersector,K=new THREE.Raycaster,R=RENDER_NORMAL,T=!1,ba=0,B=MAX_FRAGS_PER_GROUP;a.is2d()&&(B/=6);if(isIOSDevice()||isAndroidDevice())B/=3;for(var B=B|0,X=0<B?B:MAX_FRAGS_PER_GROUP,D=0|(D.length+X-1)/X,Y=Array(D),B=0;B<D;B++)Y[B]=new RenderBatch(w,
F,B*X,X),Y[B].sortDone=!1;if(a=a.getBoundingBox())m.copy(a),p.copy(a);var W=[];this.addMeshInstance=function(a,b){w.setMesh(a,b);if(F[0].length<=a){var c=2*F[0].length;c<=a&&(c=a+1);c=new Int32Array(c);c.set(F[0]);F[0]=c;this.visibleBoundsDirty=!0}F[0][a]=a;c=0|a/X;if(Y){var d=Y[c];d||(Y[c]=d=new RenderBatch(w,F,c*X,X))}w.getWorldBounds(a,t);m.union(t);p.union(t);b.frustumCulled=!1;d&&d.add(b,a)};this.renderSome=function(a,c){var f=performance.now(),m,q=0===k;n&&q&&!T&&(l=null,T=!0);for(var t;t=L?
this.nextBatchBVH():this.nextBatch();){t.sortDone||d||t.sortByMaterial();t.applyVisibility(R,N,w.fragments.packIds?b:null)||(a(t),h++);m=performance.now();var p=m-f,f=m;t.avgFrameTime=void 0===t.avgFrameTime?p:.9*t.avgFrameTime+.1*p;c-=t.avgFrameTime;m=!1;n&&q&&null!==l?t==l&&(m=!0):0>=c&&(m=!0);if(m)break}t||(g=!0);n&&q&&null==l&&(l=t);t&&q||(l=null,T=!1);return c};this.enforceBvh=!1;this.reset=function(a,b){k=0;ba++;g=!1;R=b;L=!1;W=[];N.reset(a);if(E)if(this.enforceBvh||!Y)L=!0;else{var c=p.size().length(),
d=p.center();a.position.distanceTo(d)<.5*c&&(L=!0)}!0===L&&(J=I=0,E[J++]=0,C=!1,h=0)};this.nextBatch=function(){return k==Y.length?null:Y[k++]};this.nextBatchBVH=function(){C||I!==J||(E[J++]=1,C=!0);for(;I!==J;){var a=E[--J];z.getBoxThree(a,t);if(N.intersectsBox(t)!==OUTSIDE){var b=z.getLeftChild(a);if(-1!==b){var d=z.getFlags(a),f=0>N.viewDir[d&3]?1:0,g=d>>2&1,h=d>>3&1,k=d=0;C?(f^1^h&&(g=1-g),E[J++]=b+g,E[J++]=b+(1-g)):(f=b+g,b=b+1-g,z.getBoxThree(f,t),H[f]=d=N.projectedArea(t),z.getBoxThree(b,t),
H[b]=k=N.projectedArea(t),0<d&&c(f),0<k&&c(b))}if(0!==z.getPrimCount(a))return A[a]}C||I!==J||(E[J++]=1,C=!0)}return null};this.isDone=function(){return g};this.setHighlighted=function(a,b){var c=w.setFlagFragment(a,MESH_HIGHLIGHTED,b);c&&(b?q++:q--);return c};this.setVisibility=function(a,b){w.setVisibility(a,b);this.visibleBoundsDirty=!0};this.setAllVisibility=function(a){w.setAllVisibility(a);this.visibleBoundsDirty=!0};this.hideLines=function(a){w.hideLines(a)};this.hasHighlighted=function(){return!!q};
this.isFragVisible=function(a){return w.isFragVisible(a)};this.areAllVisible=function(){return w.areAllVisible()};var U=new THREE.Box3;this.getVisibleBounds=function(a){if(this.visibleBoundsDirty){m.makeEmpty();p.makeEmpty();if(z){for(var b=0;b<A.length;b++){var c=A[b];c&&(c.calculateBounds(),m.union(c.boundingBox),p.union(c.boundingBox),p.union(c.boundingBoxHidden))}f(0);f(1);if(Y)for(b=0;b<Y.length;b++)Y[b].calculateBounds()}else for(b=0;b<Y.length;b++)Y[b].calculateBounds(),m.union(Y[b].boundingBox),
p.union(Y[b].boundingBox),p.union(Y[b].boundingBoxHidden);this.visibleBoundsDirty=!1}return a?p:m};this.rayIntersect=function(a,b,c,d){this.visibleBoundsDirty&&this.getVisibleBounds();K.set(a,b);a=[];if(d)for(b=0;b<d.length;b++){var f=w.getVizmesh(d[b]);if(f=VBIntersector.rayCast(f,K,a))f.fragId=d[b],a.push(f)}else if(L)for(b=[1,0],d=new THREE.Vector3;b.length;){if(f=b.pop(),z.getBoxThree(f,t),null!==K.ray.intersectBox(t,d)){var g=z.getLeftChild(f);-1!==g&&(b.push(g),b.push(g+1));0!==z.getPrimCount(f)&&
A[f].raycast(K,a)}}else for(b=0;b<Y.length;b++)Y[b].raycast(K,a);if(!a.length)return null;a.sort(function(a,b){return a.distance-b.distance});f=d=null;for(b=0;b<a.length;b++){var h=a[b].fragId;if(!v.is2d&&this.isFragVisible(h)&&(g=w.getMaterial(h),!c||!g.transparent)){d=a[b].point;var f=a[b].face,k=!1;if(g.cutplanes)for(var m=0;m<g.cutplanes.length;m++)k|=0>g.cutplanes[m].dot(new THREE.Vector4(d.x,d.y,d.z,1));if(k)f=d=object=null;else break}}return[h,d,f]};this.getRenderProgress=function(){return L?
h/A.length:k/Y.length};this.getFragmentList=function(){return w};this.getGeometryList=function(){return v};this.getSceneCount=function(){return L?A.length:Y.length};this.cleanup=function(){w.dispose()};this.setBVH=function(a,b){G=b;A=Array(a.nodeCount);z=a;E=new Int32Array(a.nodeCount+1);H=new Float32Array(a.nodeCount);for(var c=0;c<a.nodeCount;c++){var d=a.getPrimCount(c);d&&(A[c]=new RenderBatch(w,G,a.getPrimStart(c),d),A[c].nextItem=A[c].start+d,a.getFlags(c)&8&&(A[c].sortObjects=!0),a.getBoxThree(c,
A[c].boundingBox))}n=!1;w.useThreeMesh||(Y=null)};this.getGeomScenes=function(){return Y||A};this.geomPacksMissingLastFrame=function(){return W}}
function RenderContext(){function a(){function a(b){b.material.blending=THREE.NoBlending;b.material.depthWrite=!1;b.material.depthTest=!1}var b=NormalsShader;c=new THREE.ShaderMaterial({fragmentShader:b.fragmentShader,vertexShader:b.vertexShader,uniforms:THREE.UniformsUtils.clone(b.uniforms)});c.blending=THREE.NoBlending;c.packedNormals=!0;l=new LmvShaderPass(SAOShader);a(l);k=new LmvShaderPass(SAOBlurShader);a(k);q=new LmvShaderPass(SAOMinifyFirstShader);a(q);n=new LmvShaderPass(SAOMinifyShader);
a(n);m=new LmvShaderPass(FXAAShader);a(m);p=new LmvShaderPass(CelShader);a(p);t=new LmvShaderPass(BlendShader);a(t);h=new LmvShaderPass(BackgroundShader);a(h);v=new LmvShaderPass(CopyShader);a(v)}var b,c,f,d,g,h,k,l,n,q,m,p,t,v,D=!1,w,F=null,B=null,z=null,G=null,A=null,E=null,H=0,I=0,J=1,L,C,N=!1,K=new Uint8Array(4),R=(new THREE.Color).setRGB(1,1,1),T=(new THREE.Color).setRGB(0,0,0),ba=null,X=!1,Y=!1,W=!1,U=!1,O=0,da=0,V=[.42,0,1,1],M={antialias:!0,sao:!1,useHdrTarget:!1,haveTwoSided:!1,useSSAA:!1,
idbuffer:!0,customPresentPass:!1,toonShaded:!1},la,ga,ja;this.settings=M;this.init=function(c,d,f){init_FireflyPhongShader();init_BackgroundShader();init_BlendShader();init_CelShader();init_CopyShader();init_FXAAShader();init_LineShader();init_NormalsShader();init_SAOBlurShader();init_SAOMinifyShader();init_SAOShader();c?(X=-1!=window.navigator.userAgent.indexOf("Firefox")&&-1!=window.navigator.userAgent.indexOf("Mac OS"),Y=isAndroidDevice()||isIOSDevice(),M.idbuffer=!Y,L=d,C=f,b=c,a(),this.initPostPipeline(M.sao,
M.antialias,!1)):console.error("You need a gl context to make a renderer. Things will go downhill from here.")};this.overlayUpdate=function(a){if(0===O||-1===O)return!1;a=t.uniforms.highlightIntensity.value;var b=.004*(performance.now()-da),b=Math.min(b,1),c=3*V[1],d=3*(V[3]-V[1])-c,b=(((1-c-d)*b+d)*b+c)*b;return a!=b?(t.uniforms.highlightIntensity.value=b,!0):!1};this.beginScene=function(a,c,f,k){d=c;g=f;D=!1;if(B){k&&(ba?(b.setClearColor(ba,1),b.clearTarget(B,!0,!0,!1)):(b.clearTarget(B,!1,!0,!1),
h.render(b,B,null)));E&&(b.setClearColor(R,1),b.clearTarget(E,!0,!1,!1));if(M.sao||M.toonShaded)k&&(b.setClearColor(T,0),b.clearTarget(w,!0,!1,!1)),f=c.near,k=c.far,l.uniforms.cameraNear.value=f,l.uniforms.cameraFar.value=k,p.uniforms.cameraNear.value=f,p.uniforms.cameraFar.value=k,q.uniforms.cameraNear.value=f,q.uniforms.cameraInvNearFar.value=1/(f-k),f=c.projectionMatrix.elements,c.isPerspective?(l.uniforms.projInfo.value.set(-2/(B.width*f[0]),-2/(B.height*f[5]),(1-f[8])/f[0],(1+f[9])/f[5]),p.uniforms.projInfo.value.copy(l.uniforms.projInfo.value),
l.uniforms.isOrtho.value=0,p.uniforms.isOrtho.value=0):(l.uniforms.projInfo.value.set(-2/(B.width*f[0]),-2/(B.height*f[5]),(1-f[12])/f[0],(1-f[13])/f[5]),p.uniforms.projInfo.value.copy(l.uniforms.projInfo.value),l.uniforms.isOrtho.value=1,p.uniforms.isOrtho.value=1),l.uniforms.projScale.value=.125*B.height*f[5];this.renderScenePart(a,!0,!0,!1,!0)}else L||N||(console.error("Rendering to a canvas that was resized to zero. If you see this message you may be accidentally leaking a viewer instance."),
N=!0)};this.renderScenePart=function(a,h,k,m,l){D=!1;l=l?g:void 0;W&&U?M.idbuffer&&m&&(M.sao||M.toonShaded)?b.render(a,d,[B,w,E],!1,l):M.sao||M.toonShaded?b.render(a,d,[B,w],!1,l):M.idbuffer&&m?b.render(a,d,[B,E]):b.render(a,d,B,!1,l):(U?M.idbuffer&&m?b.render(a,d,[B,E],!1,l):b.render(a,d,B,!1,l):(h&&b.render(a,d,B,!1,l),M.idbuffer&&m&&f&&(h=a.overrideMaterial,a.overrideMaterial=f,b.render(a,d,E,!1,void 0),a.overrideMaterial=h)),(M.sao||M.toonShaded)&&k&&(h=a.overrideMaterial,a.overrideMaterial=c,
b.render(a,d,w,!1,void 0),a.overrideMaterial=h))};this.clearAllOverlays=function(){b.clearTarget(z,!0,!1,!1)};this.renderOverlays=function(a,c){var f=0,g;for(g in a)if(a.hasOwnProperty(g)){var h=a[g],k=h.scene,m=h.camera?h.camera:d;k.children.length&&(f||(f=1,b.setClearColor(T,0),b.clearTarget(z,!0,!1,!1)),h.materialPre&&(k.overrideMaterial=h.materialPre),b.render(k,m,z,!1,c),h.materialPost&&(k.overrideMaterial=h.materialPost,b.context.depthFunc(b.context.GREATER),b.render(k,m,z,!1,c),b.context.depthFunc(b.context.LEQUAL)),
k.overrideMaterial=null)}t.uniforms.useOverlay.value=f};this.computeSSAO=function(a){if(a||!M.sao||M.toonShaded)t.uniforms.useAO.value=0;else{if(!D){if(F){a=F[0];q.uniforms.resolution.value.set(1/a.width,1/a.height);q.render(b,a,w);for(var c=1;c<F.length;c++){var d=F[c];n.uniforms.resolution.value.set(1/d.width,1/d.height);n.render(b,d,a);a=d}}l.render(b,A,B);k.uniforms.axis.value.set(1,0);k.render(b,G,A);k.uniforms.axis.value.set(0,1);k.render(b,A,G);D=!0}t.uniforms.useAO.value=1}};this.presentBuffer=
function(a){!a&&!M.antialias||M.sao||t.uniforms.useOverlay.value||t.uniforms.objID.value?M.antialias?(t.render(b,G,B),a?(m.render(b,A,G),a.render(b,null,A)):M.toonShaded?(p.render(b,A,G),m.render(b,null,A)):m.render(b,null,G)):a?(t.render(b,G,B),a.render(b,null,G)):M.toonShaded?(t.render(b,G,B),p.render(b,A,G),v.render(b,null,A)):t.render(b,null,B):M.antialias?a?(m.render(b,G,B),a.render(b,null,G)):M.toonShaded?(p.render(b,G,B),m.render(b,null,G)):m.render(b,null,B):a.render(b,null,B)};this.composeFinalFrame=
function(a,b,c){M.sao&&!M.toonShaded&&this.computeSSAO(a);c||this.presentBuffer()};this.cleanup=function(){B&&(B.dispose(),B=null);w&&(w.dispose(),w=null);z&&(z.dispose(),z=null);G&&(G.dispose(),G=null);A&&(A.dispose(),A=null);if(F){for(var a=0;a<F.length;a++)F[a].dispose();F=[]}};this.setSize=function(a,c,d){L=a;C=c;var f=0|a*b.devicePixelRatio,g=0|c*b.devicePixelRatio;M.logicalWidth=a;M.logicalHeight=c;M.deviceWidth=f;M.deviceHeight=g;if(0==a&&0==c)this.cleanup();else{b.setSize(a,c);stderr("width: "+
f+" height: "+g);a=1/f;c=1/g;if(M.useSSAA||M.toonShaded&&1>=b.devicePixelRatio)f*=2,g*=2,d=!0;if(d||!B||B.width!=f||B.height!=g)stderr("Reallocating render targets."),this.cleanup(),B=new THREE.WebGLRenderTarget(f,g,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,type:M.useHdrTarget?THREE.FloatType:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:!1}),z=new THREE.WebGLRenderTarget(f,g,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,
stencilBuffer:!1,generateMipmaps:!1}),z.shareDepthFrom=B,A=G=w=null,F=[];if(M.antialias||M.sao||M.customPresentPass||M.toonShaded)if(d||!G||G.width!=f||G.height!=g)G=new THREE.WebGLRenderTarget(f,g,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1,depthBuffer:!1,generateMipmaps:!1});if(M.sao||M.toonShaded){if(d||!w||w.width!=f||w.height!=g){var h=THREE.FloatType;isMobileDevice()&&(h=THREE.HalfFloatType=3E3);w=new THREE.WebGLRenderTarget(f,g,{minFilter:THREE.NearestFilter,
magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:h,stencilBuffer:!1});w.shareDepthFrom=B;F=[];for(h=0;5>h;h++){var n=new THREE.WebGLRenderTarget(0|f/(2<<h),0|g/(2<<h),{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat,depthBuffer:!1,stencilBuffer:!1});n.generateMipmaps=!1;F.push(n);l.uniforms["tDepth_mip"+(h+1)].value=n}W=!X&&b.verifyMRTWorks([B,w]);A=G.clone()}!A&&M.antialias&&M.customPresentPass&&(A=G.clone());l.uniforms.size.value.set(f,g);l.uniforms.tDepth.value=
w;k.uniforms.size.value.set(f,g);k.uniforms.resolution.value.set(a,c);p.uniforms.tDepth.value=w}if(M.idbuffer){if(d||!E||E.width!=f||E.height!=g)E=new THREE.WebGLRenderTarget(f,g,{minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBFormat,type:THREE.UnsignedByteType,stencilBuffer:!1,generateMipmaps:!1}),E.shareDepthFrom=B,(U=!X&&b.verifyMRTWorks([B,E]))||console.warn("ID buffer requested, but MRT is not supported. Some features will not work.");p.uniforms.tID.value=E}else E&&
(E.dispose(),E=null);m.uniforms.resolution.value.set(a,c);p.uniforms.resolution.value.set(a,c);t.uniforms.tOverlay.value=z;t.uniforms.tAO.value=A;t.uniforms.useAO.value=M.sao?1:0;t.uniforms.resolution.value.set(a,c);t.uniforms.tID.value=E}};this.getMaxAnisotropy=function(){return b.getMaxAnisotropy()};this.hasMRT=function(){return!X&&b.supportsMRT()};this.applyMRTFlags=function(a){var b=a.mrtNormals,c=a.mrtIdBuffer;a.mrtNormals=this.hasMRT()&&W&&(M.sao||M.toonShaded);a.mrtIdBuffer=this.hasMRT()&&
U&&M.idbuffer;if(a.mrtNormals!==b||a.mrtIdBuffer!==c)a.needsUpdate=!0};this.initPostPipeline=function(a,b){M.sao=a&&!_isIE11;M.antialias=b&&!_isIE11;M.sao&&(M.toonShaded=!1);M.haveTwoSided&&(c.side=THREE.DoubleSide);c.needsUpdate=!0;l.material.needsUpdate=!0;k.material.needsUpdate=!0;q.material.needsUpdate=!0;n.material.needsUpdate=!0;m.material.needsUpdate=!0;p.material.needsUpdate=!0;t.material.needsUpdate=!0;h.material.needsUpdate=!0;v.material.needsUpdate=!0;this.setSize(L,C)};this.setClearColors=
function(a,b){ba=b?a.equals(b)||Y?new THREE.Color(.5*(a.x+b.x),.5*(a.y+b.y),.5*(a.z+b.z)):void 0:a.clone();ba||(h.uniforms.color1.value.copy(a),h.uniforms.color2.value.copy(b))};this.setAOOptions=function(a,b){void 0!==a&&(l.uniforms.radius.value=a);void 0!==b&&(l.uniforms.intensity.value=b);D=!1};this.getAORadius=function(){return l.uniforms.radius.value};this.getAOIntensity=function(){return l.uniforms.intensity.value};this.setTonemapExposureBias=function(a){H=a};this.getExposureBias=function(){return H};
this.setTonemapMethod=function(a){I=a;b.gammaInput=0===a?!1:!0};this.getToneMapMethod=function(){return I};this.toggleTwoSided=function(a){M.haveTwoSided!=a&&c&&(c.side=a?THREE.DoubleSide:THREE.FrontSide,c.needsUpdate=!0);M.haveTwoSided=a};this.toggleCelShading=function(a){M.sao=!a;M.toonShaded=a;M.idbuffer=a;this.initPostPipeline(M.sao,M.antialias)};this.enter2DMode=function(a){f=a;la=M.sao;ga=M.antialias;ja=M.idbuffer;M.idbuffer=!0;t.material.defines.IS_2D="";this.initPostPipeline(!1,!1)};this.exit2DMode=
function(){f=null;M.idbuffer=ja;delete t.material.defines.IS_2D;this.initPostPipeline(la,ga)};this.idAtPixel=function(a,c){if(!E)return 0;b.readPixels(E,.5*(a+1)*E.width,.5*(c+1)*E.height,1,1,K);return K[2]<<16|K[1]<<8|K[0]};this.rolloverObjectViewport=function(a,b){var c=this.idAtPixel(a,b);if(c==O)return!1;t.uniforms.highlightIntensity.value=0;da=performance.now();O=c;if(0===c||16777215==c)c=0,K[0]=K[1]=K[2]=K[3]=0;t.uniforms.objID.value=c;t.uniforms.objIDv3.value.set(K[0]/255,K[1]/255,K[2]/255);
return!0};this.setUnitScale=function(a){J=a};this.getUnitScale=function(){return J};this.getBlendPass=function(){return t};this.getColorTarget=function(){return B};this.getDepthMaterial=function(){return c}}
function init_FXAAShader(){"undefined"===typeof FXAAShader&&(FXAAShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvarying vec2 vUv;\n#define FXAA_SPAN_MAX     8.0\n#define FXAA_EDGE_THRESHOLD_MIN (1.0/24.0)\n#define FXAA_EDGE_THRESHOLD (1.0/8.0)\n#define FXAA_SEARCH_THRESHOLD (1.0/4.0)\n#define FXAA_SEARCH_STEPS 16\n#define FXAA_SUBPIX_TRIM (1.0/8.0)\n#define FXAA_SUBPIX_TRIM_SCALE (1.0/(1.0 - FXAA_SUBPIX_TRIM))\n#define FXAA_SUBPIX_CAP (7.0/8.0)\nvec4 getColor(sampler2D tex, vec2 uv) {\nvec4 c = texture2D(tex, uv);\nreturn c;\n}\nfloat FxaaLuma(vec3 rgb) {\nreturn rgb.y * (0.587/0.299) + rgb.x; }\nvec4 FxaaFilterReturn(vec4 rgba) {\nreturn rgba;}\nvec3 FxaaLerp3(vec3 a, vec3 b, float amountOfA) {\nreturn (vec3(-amountOfA) * b) +\n((a * vec3(amountOfA)) + b); }\nvec4 FxaaTex(sampler2D tex, vec2 pos) {\nreturn getColor(tex, pos.xy);}\nvec4 FxaaTexOff(sampler2D tex, vec2 pos, vec2 offset, vec2 resolution) {\nvec2 uv = pos.xy + offset * resolution;\nreturn getColor(tex, uv);}\nvoid main() {\nvec3 rgbN = FxaaTexOff( tDiffuse, vUv, vec2(0.0,-1.0), resolution ).xyz;\nvec3 rgbE = FxaaTexOff( tDiffuse, vUv, vec2(1.0, 0.0), resolution ).xyz;\nvec3 rgbW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,0.0), resolution ).xyz;\nvec3 rgbS = FxaaTexOff( tDiffuse, vUv, vec2(0.0, 1.0), resolution ).xyz;\nvec4 rgbaM = FxaaTex( tDiffuse, vUv);\nvec3 rgbM  = rgbaM.xyz;\nfloat lumaN = FxaaLuma(rgbN);\nfloat lumaE = FxaaLuma(rgbE);\nfloat lumaW = FxaaLuma(rgbW);\nfloat lumaS = FxaaLuma(rgbS);\nfloat lumaM = FxaaLuma(rgbM);\nfloat rangeMin = min(lumaM, min(min(lumaN, lumaW), min(lumaS, lumaE)));\nfloat rangeMax = max(lumaM, max(max(lumaN, lumaW), max(lumaS, lumaE)));\nfloat range = rangeMax - rangeMin;\nif(range < max(FXAA_EDGE_THRESHOLD_MIN, rangeMax * FXAA_EDGE_THRESHOLD)) {\ngl_FragColor = FxaaFilterReturn(rgbaM); return;}\nvec3 rgbL = rgbN + rgbW + rgbM + rgbE + rgbS;\nfloat lumaL = (lumaN + lumaW + lumaE + lumaS) * 0.25;\nfloat rangeL = abs(lumaL - lumaM);\nfloat blendL = max(0.0, (rangeL / range) - FXAA_SUBPIX_TRIM) * FXAA_SUBPIX_TRIM_SCALE;\nblendL = min(FXAA_SUBPIX_CAP, blendL);\nvec3 rgbNW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,-1.0), resolution ).xyz;\nvec3 rgbNE = FxaaTexOff( tDiffuse, vUv, vec2(1.0,-1.0), resolution ).xyz;\nvec3 rgbSW = FxaaTexOff( tDiffuse, vUv, vec2(-1.0,1.0), resolution ).xyz;\nvec3 rgbSE = FxaaTexOff( tDiffuse, vUv, vec2(1.0,1.0), resolution ).xyz;\nfloat opacity  = rgbaM.w;\nrgbL += (rgbNW + rgbNE + rgbSW + rgbSE);\nrgbL *= vec3(1.0/9.0);\nfloat lumaNW = FxaaLuma( rgbNW);\nfloat lumaNE = FxaaLuma( rgbNE);\nfloat lumaSW = FxaaLuma( rgbSW);\nfloat lumaSE = FxaaLuma( rgbSE);\nfloat edgeVert = abs((0.25 * lumaNW) + (-0.5 * lumaN) + (0.25 * lumaNE)) +\nabs((0.50 * lumaW ) + (-1.0 * lumaM) + (0.50 * lumaE )) +\nabs((0.25 * lumaSW) + (-0.5 * lumaS) + (0.25 * lumaSE));\nfloat edgeHorz = abs((0.25 * lumaNW) + (-0.5 * lumaW) + (0.25 * lumaSW)) +\nabs((0.50 * lumaN ) + (-1.0 * lumaM) + (0.50 * lumaS )) +\nabs((0.25 * lumaNE) + (-0.5 * lumaE) + (0.25 * lumaSE));\nbool horzSpan = edgeHorz >= edgeVert;\nfloat lengthSign = horzSpan ? -resolution.y : -resolution.x;\nif(!horzSpan) lumaN = lumaW;\nif(!horzSpan) lumaS = lumaE;\nfloat gradientN = abs(lumaN - lumaM);\nfloat gradientS = abs(lumaS - lumaM);\nlumaN = (lumaN + lumaM) * 0.5;\nlumaS = (lumaS + lumaM) * 0.5;\nbool pairN = gradientN >= gradientS;\nif(!pairN) lumaN = lumaS;\nif(!pairN) gradientN = gradientS;\nif(!pairN) lengthSign *= -1.0;\nvec2 posN;\nposN.x = vUv.x + (horzSpan ? 0.0 : lengthSign * 0.5);\nposN.y = vUv.y + (horzSpan ? lengthSign * 0.5 : 0.0);\ngradientN *= FXAA_SEARCH_THRESHOLD;\nvec2 posP = posN;\nvec2 offNP = horzSpan ? vec2(resolution.x, 0.0) : vec2(0.0, resolution.y);\nfloat lumaEndN = lumaN;\nfloat lumaEndP = lumaN;\nbool doneN = false;\nbool doneP = false;\nposN += offNP * vec2(-1.0, -1.0);\nposP += offNP * vec2( 1.0,  1.0);\nfor(int i = 0; i < FXAA_SEARCH_STEPS; i++) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTex( tDiffuse, posN.xy).xyz);\nif(!doneP) lumaEndP = FxaaLuma(FxaaTex( tDiffuse, posP.xy).xyz);\ndoneN = doneN || (abs(lumaEndN - lumaN) >= gradientN);\ndoneP = doneP || (abs(lumaEndP - lumaN) >= gradientN);\nif(doneN && doneP) break;\nif(!doneN) posN -= offNP;\nif(!doneP) posP += offNP; }\nfloat dstN = horzSpan ? vUv.x - posN.x : vUv.y - posN.y;\nfloat dstP = horzSpan ? posP.x - vUv.x : posP.y - vUv.y;\nbool directionN = dstN < dstP;\nlumaEndN = directionN ? lumaEndN : lumaEndP;\nif(((lumaM - lumaN) < 0.0) == ((lumaEndN - lumaN) < 0.0))\nlengthSign = 0.0;\nfloat spanLength = (dstP + dstN);\ndstN = directionN ? dstN : dstP;\nfloat subPixelOffset = (0.5 + (dstN * (-1.0/spanLength))) * lengthSign;\nvec3 rgbF = FxaaTex(tDiffuse, vec2(\nvUv.x + (horzSpan ? 0.0 : subPixelOffset),\nvUv.y + (horzSpan ? subPixelOffset : 0.0))).xyz;\ngl_FragColor = FxaaFilterReturn(vec4(FxaaLerp3(rgbL, rgbF, blendL), opacity));\n}"})}
var PackDepthShaderChunk="vec4 packDepth( const in float depth ) {\nvec4 enc = vec4(1.0, 255.0, 65025.0, 160581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0/255.0,1.0/255.0,1.0/255.0,0.0);\nreturn enc;\n}\nfloat unpackDepth( const in vec4 rgba_depth ) {\nreturn dot( rgba_depth, vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/160581375.0) );\n}",TonemapShaderChunk="float luminance_post(vec3 rgb) {\nreturn dot(rgb, vec3(0.299, 0.587, 0.114));\n}\nfloat luminance_pre(vec3 rgb) {\nreturn dot(rgb, vec3(0.212671, 0.715160, 0.072169));\n}\nvec3 xyz2rgb(vec3 xyz) {\nvec3 R = vec3( 3.240479, -1.537150, -0.498535);\nvec3 G = vec3(-0.969256,  1.875992,  0.041556);\nvec3 B = vec3( 0.055648, -0.204043,  1.057311);\nvec3 rgb;\nrgb.b = dot(xyz, B);\nrgb.g = dot(xyz, G);\nrgb.r = dot(xyz, R);\nreturn rgb;\n}\nvec3 rgb2xyz(vec3 rgb) {\nvec3 X = vec3(0.412453, 0.35758, 0.180423);\nvec3 Y = vec3(0.212671, 0.71516, 0.0721688);\nvec3 Z = vec3(0.0193338, 0.119194, 0.950227);\nvec3 xyz;\nxyz.x = dot(rgb, X);\nxyz.y = dot(rgb, Y);\nxyz.z = dot(rgb, Z);\nreturn xyz;\n}\nvec3 xyz2xyY(vec3 xyz) {\nfloat sum = xyz.x + xyz.y + xyz.z;\nsum = 1.0 / sum;\nvec3 xyY;\nxyY.z = xyz.y;\nxyY.x = xyz.x * sum;\nxyY.y = xyz.y * sum;\nreturn xyY;\n}\nvec3 xyY2xyz(vec3 xyY) {\nfloat x = xyY.x;\nfloat y = xyY.y;\nfloat Y = xyY.z;\nvec3 xyz;\nxyz.y = Y;\nxyz.x = x * (Y / y);\nxyz.z = (1.0 - x - y) * (Y / y);\nreturn xyz;\n}\nconst float Shift = 1.0 / 0.18;\nfloat toneMapCanonFilmic_NoGamma(float x) {\nx *= Shift;\nconst float A = 0.2;\nconst float B = 0.34;\nconst float C = 0.002;\nconst float D = 1.68;\nconst float E = 0.0005;\nconst float F = 0.252;\nconst float scale = 1.0/0.833837;\nreturn (((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F) * scale;\n}\nvec3 toneMapCanonFilmic_WithGamma(vec3 x) {\nx *= Shift;\nconst float A = 0.27;\nconst float B = 0.29;\nconst float C = 0.052;\nconst float D = 0.2;\nconst float F = 0.18;\nconst float scale = 1.0/0.897105;\nreturn (((x*(A*x+C*B))/(x*(A*x+B)+D*F))) * scale;\n}",
OrderedDitheringShaderChunk="vec3 orderedDithering(vec3 col) {\nconst vec4 m0 = vec4( 1.0, 13.0,  4.0, 16.0);\nconst vec4 m1 = vec4( 9.0,  5.0, 12.0,  8.0);\nconst vec4 m2 = vec4( 3.0, 15.0,  2.0, 14.0);\nconst vec4 m3 = vec4(11.0,  7.0, 10.0,  6.0);\nint i = int(mod(float(gl_FragCoord.x), 4.0));\nint j = int(mod(float(gl_FragCoord.y), 4.0));\nvec4 biasRow;\nif      (i==0) biasRow = m0;\nelse if (i==1) biasRow = m1;\nelse if (i==2) biasRow = m2;\nelse           biasRow = m3;\nfloat bias;\nif      (j==0) bias = biasRow.x;\nelse if (j==1) bias = biasRow.y;\nelse if (j==2) bias = biasRow.z;\nelse           bias = biasRow.w;\nreturn col + bias / 17.0 / 256.0;\n}",
CutPlanesShaderChunk="#if NUM_CUTPLANES > 0\nuniform vec4 cutplanes[NUM_CUTPLANES];\nuniform vec3 cutplanesOutlineColor;\nuniform float cutplanesOutlineThickness;\nbool checkCutPlanes() {\nbool isCut = false;\nbool isCutEdge = false;\nfor (int i=0; i<NUM_CUTPLANES; i++) {\nfloat dotPlane = dot(vec4(vWorldPosition, 1.0), cutplanes[i]);\nisCut = isCut || (dotPlane > 0.0);\nisCutEdge = isCutEdge || (dotPlane > -cutplanesOutlineThickness);\n}\nif (isCut) {\ndiscard;\nreturn true;\n}\nelse if (isCutEdge) {\ngl_FragColor = vec4(cutplanesOutlineColor, 1.0);\nreturn true;\n}\nreturn false;\n}\n#endif",
PackNormalsShaderChunk="#define kPI 3.14159265358979\nvec2 encodeNormal (vec3 n)\n{\nreturn (vec2(atan(n.y,n.x)/kPI, n.z)+1.0)*0.5;\n}\nvec3 decodeNormal (vec2 enc)\n{\nvec2 ang = enc * 2.0 - 1.0;\nvec2 scth = vec2(sin(ang.x * kPI), cos(ang.x * kPI));\nvec2 scphi = vec2(sqrt(1.0 - ang.y * ang.y), ang.y);\nreturn vec3(scth.y * scphi.x, scth.x * scphi.x, scphi.y);\n}";
function init_CopyShader(){"undefined"===typeof CopyShader&&(CopyShader={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\nvUv = uv;\n}",fragmentShader:"uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\ngl_FragColor = texture2D(tDiffuse, vUv);\n}"})}
function init_CelShader(){"undefined"===typeof CelShader&&(CelShader={uniforms:{tDiffuse:{type:"t",value:null},tDepth:{type:"t",value:null},tID:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},projInfo:{type:"v4",value:new THREE.Vector4(0,0,0,0)},isOrtho:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:["#extension GL_OES_standard_derivatives : enable\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\nuniform sampler2D tID;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraFar;\nuniform float isOrtho;\nuniform vec4 projInfo;\nvarying vec2 vUv;\nvec4 recoverNZ(vec4 nrmz) {\nfloat z = sqrt(1.0 - dot(nrmz.xy, nrmz.xy));\nnrmz.w = -(nrmz.z +cameraNear) / (cameraFar - cameraNear);\nnrmz.z = z;\nreturn nrmz;\n}",TonemapShaderChunk,"vec4 quantize(vec4 c) {\nc *= c;\nfloat L = max(c.x, max(c.y, c.z));\nc.xyz *= floor(L * 8.0 + 0.5) / (8.0 * L);\nc.w = 1.0;\nreturn sqrt(c);\n}\nvec4 quantizeRGB(vec4 c) {\nc *= c;\nc.xyz *= floor(c.xyz * 8.0 + 0.5) / 8.0;\nc.w = 1.0;\nreturn sqrt(c);\n}\nvec3 reconstructCSPosition(vec2 S, float z) {\nreturn vec3((S.xy * projInfo.xy + projInfo.zw) * mix(z, -1.0, isOrtho), z);\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\nreturn normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 getPosition(ivec2 ssP, float depth) {\nvec3 P;\nP = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\nreturn P;\n}\nint isObjectEdge() {\nvec4 MM = texture2D(tID, vUv + vec2( 0.0,  0.0));\nvec4 LL = texture2D(tID, vUv + vec2(-1.0, -1.0) * resolution);\nif (MM != LL) return 1;\nvec4 LM = texture2D(tID, vUv + vec2( 0.0, -1.0) * resolution);\nif (MM != LM) return 1;\nvec4 LR = texture2D(tID, vUv + vec2( 1.0, -1.0) * resolution);\nif (MM != LR) return 1;\nvec4 ML = texture2D(tID, vUv + vec2(-1.0,  0.0) * resolution);\nif (MM != ML) return 1;\nvec4 MR = texture2D(tID, vUv + vec2( 1.0,  0.0) * resolution);\nif (MM != MR) return 1;\nvec4 UL = texture2D(tID, vUv + vec2(-1.0,  1.0) * resolution);\nif (MM != UL) return 1;\nvec4 UM = texture2D(tID, vUv + vec2( 0.0,  1.0) * resolution);\nif (MM != UM) return 1;\nvec4 UR = texture2D(tID, vUv + vec2( 1.0,  1.0) * resolution);\nif (MM != UR) return 1;\nreturn 0;\n}\nfloat normalDiff(vec3 n1, vec3 n2) {\nfloat d = dot(n1.xyz, n2.xyz);\nreturn acos(clamp(d, -1.0, 1.0));\n}\nconst float r = 1.0;\nvoid main() {\nvec4 color = texture2D(tDiffuse, vUv);\nivec2 ssC = ivec2(gl_FragCoord.xy);\nif (isObjectEdge() == 1) {\ngl_FragColor = vec4(0,0,0,1);\nreturn;\n}\nvec4 MM = texture2D(tDepth, vUv + vec2( 0.0,  0.0));\nif (MM.z == 0.0) {\ngl_FragColor = quantize(color);\nreturn;\n}\nvec4 LL = texture2D(tDepth, vUv + vec2(-r, -r) * resolution);\nvec4 LM = texture2D(tDepth, vUv + vec2( 0.0, -r) * resolution);\nvec4 LR = texture2D(tDepth, vUv + vec2( r, -r) * resolution);\nvec4 ML = texture2D(tDepth, vUv + vec2(-r,  0.0) * resolution);\nvec4 MR = texture2D(tDepth, vUv + vec2( r,  0.0) * resolution);\nvec4 UL = texture2D(tDepth, vUv + vec2(-r, r) * resolution);\nvec4 UM = texture2D(tDepth, vUv + vec2( 0.0,  r) * resolution);\nvec4 UR = texture2D(tDepth, vUv + vec2( r,  r) * resolution);\nvec3 C = getPosition(ssC + ivec2(-1, -1), LL.z);\nvec3 LLz = reconstructCSFaceNormal(C);\nC = getPosition(ssC + ivec2( 0, -1), LM.z);\nvec3 LMz = reconstructCSFaceNormal(C);\nC = getPosition(ssC + ivec2( 1, -1), LR.z);\nvec3 LRz = reconstructCSFaceNormal(C);\nC = getPosition(ssC + ivec2(-1, 0), ML.z);\nvec3 MLz = reconstructCSFaceNormal(C);\nC = getPosition(ssC + ivec2( 0, 0), MM.z);\nvec3 MMz = reconstructCSFaceNormal(C);\nC = getPosition(ssC + ivec2( 1, 0), MR.z);\nvec3 MRz = reconstructCSFaceNormal(C);\nC = getPosition(ssC + ivec2(-1, 1), UL.z);\nvec3 ULz = reconstructCSFaceNormal(C);\nC = getPosition(ssC + ivec2(0, 1), UM.z);\nvec3 UMz = reconstructCSFaceNormal(C);\nC = getPosition(ssC + ivec2(1, 1), UR.z);\nvec3 URz = reconstructCSFaceNormal(C);\nLL = recoverNZ(LL);\nLM = recoverNZ(LM);\nLR = recoverNZ(LR);\nML = recoverNZ(ML);\nMM = recoverNZ(MM);\nMR = recoverNZ(MR);\nUL = recoverNZ(UL);\nUM = recoverNZ(UM);\nUR = recoverNZ(UR);\nfloat pLL = normalDiff(LL.xyz, MM.xyz);\nfloat pLM = normalDiff(LM.xyz, MM.xyz);\nfloat pLR = normalDiff(LR.xyz, MM.xyz);\nfloat pML = normalDiff(ML.xyz, MM.xyz);\nfloat pMM = normalDiff(MM.xyz, MM.xyz);\nfloat pMR = normalDiff(MR.xyz, MM.xyz);\nfloat pUL = normalDiff(UL.xyz, MM.xyz);\nfloat pUM = normalDiff(UM.xyz, MM.xyz);\nfloat pUR = normalDiff(UR.xyz, MM.xyz);\nfloat pLLz = normalDiff(LLz.xyz, MMz.xyz);\nfloat pLMz = normalDiff(LMz.xyz, MMz.xyz);\nfloat pLRz = normalDiff(LRz.xyz, MMz.xyz);\nfloat pMLz = normalDiff(MLz.xyz, MMz.xyz);\nfloat pMMz = normalDiff(MMz.xyz, MMz.xyz);\nfloat pMRz = normalDiff(MRz.xyz, MMz.xyz);\nfloat pULz = normalDiff(ULz.xyz, MMz.xyz);\nfloat pUMz = normalDiff(UMz.xyz, MMz.xyz);\nfloat pURz = normalDiff(URz.xyz, MMz.xyz);\nfloat dGx = (dFdx(UL.w) + 2.0 * dFdx(UM.w) + dFdx(UR.w)) - (dFdx(LL.w) + 2.0 * dFdx(LM.w) + dFdx(LR.w)) + (dFdx(UR.w) + 2.0 * dFdx(MR.w) - dFdx(LR.w)) - (dFdx(UL.w) + 2.0 * dFdx(ML.w) - dFdx(LL.w));\nfloat dGy = (dFdy(UL.w) + 2.0 * dFdy(UM.w) + dFdy(UR.w)) - (dFdy(LL.w) + 2.0 * dFdy(LM.w) + dFdy(LR.w)) + (dFdy(UR.w) + 2.0 * dFdy(MR.w) - dFdy(LR.w)) - (dFdy(UL.w) + 2.0 * dFdy(ML.w) - dFdy(LL.w));\nfloat Gn = (abs(pUL - pMM) + 2.0 * abs(pUM - pMM) + abs(pUR - pMM) + 2.0 * abs(pML - pMM) + 2.0 * abs(pMR - pMM) + abs(pLL - pMM) + 2.0 * abs(pLM - pMM) + abs(pLR - pMM));\nfloat Gnz = (abs(pULz - pMMz) + 2.0 * abs(pUMz - pMMz) + abs(pURz - pMMz) + 2.0 * abs(pMLz - pMMz) + 2.0 * abs(pMRz - pMMz) + abs(pLLz - pMMz) + 2.0 * abs(pLMz - pMMz) + abs(pLRz - pMMz));\nfloat G = (abs(UL.w - MM.w) + 2.0 * abs(UM.w - MM.w) + abs(UR.w - MM.w) + 2.0 * abs(ML.w - MM.w) + 2.0 * abs(MR.w - MM.w) + abs(LL.w - MM.w) + 2.0 * abs(LM.w - MM.w) + abs(LR.w - MM.w));\nfloat dd = abs(dFdx(G)) + abs(dFdy(G));\nif (dd > 0.004 || abs(Gnz) > 2.2 || abs(Gn) > 2.0)\ngl_FragColor = vec4(0.0,0.0,0.0,1.0);\nelse\ngl_FragColor = /*vec4(1.0,1.0,1.0,1.0);*/quantize(color);\n}"].join("\n")})}
function init_BlendShader(){"undefined"===typeof BlendShader&&(BlendShader={uniforms:{tDiffuse:{type:"t",value:null},tAO:{type:"t",value:null},useAO:{type:"i",value:0},tOverlay:{type:"t",value:null},useOverlay:{type:"i",value:0},tID:{type:"t",value:null},objID:{type:"i",value:0},objIDv3:{type:"v3",value:new THREE.Vector3(0,0,0)},highlightIntensity:{type:"f",value:1},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},defines:{},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:["uniform sampler2D tDiffuse;\nuniform sampler2D tAO;\nuniform int useAO;\nuniform sampler2D tOverlay;\nuniform int useOverlay;\nuniform vec2 resolution;\nuniform int objID;\nuniform vec3 objIDv3;\nuniform sampler2D tID;\nuniform float highlightIntensity;\nvarying vec2 vUv;",TonemapShaderChunk,"vec4 overlayEdgeDetect(vec2 vUv) {\n#define IS_SELECTION(C) ( (C).b > (C).r && (C).b > (C).g )\n#define CHECK_EDGE_ALPHA(I, J)     { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); maxAlpha = max(maxAlpha, c.a); if (c.a > 0.0 && IS_SELECTION(c)) { hasEdge++; selectionPixel = c; } }\n#define CHECK_EDGE_SELECTION(I, J) { vec4 c = texture2D( tOverlay, vUv+resolution*vec2((I),(J)) ); maxAlpha = max(maxAlpha, c.a); if (c.a <= 0.0) hasEdge++; }\nint hasEdge = 0;\nvec4 center = texture2D(tOverlay, vUv);\nvec4 selectionPixel = vec4(0.0);\nfloat maxAlpha = 0.0;\nbool paintOutline = false;\nif (center.a <= 0.0) {\nCHECK_EDGE_ALPHA(-1.0,-1.0);\nCHECK_EDGE_ALPHA( 0.0,-1.0);\nCHECK_EDGE_ALPHA( 1.0,-1.0);\nCHECK_EDGE_ALPHA(-1.0, 0.0);\nCHECK_EDGE_ALPHA( 1.0, 0.0);\nCHECK_EDGE_ALPHA(-1.0, 1.0);\nCHECK_EDGE_ALPHA( 0.0, 1.0);\nCHECK_EDGE_ALPHA( 1.0, 1.0);\nif (hasEdge != 0) {\ncenter = selectionPixel;\npaintOutline = true;\n}\n}\nelse if (center.a > 0.0 && IS_SELECTION(center)) {\nCHECK_EDGE_SELECTION(-1.0,-1.0);\nCHECK_EDGE_SELECTION( 0.0,-1.0);\nCHECK_EDGE_SELECTION( 1.0,-1.0);\nCHECK_EDGE_SELECTION(-1.0, 0.0);\nCHECK_EDGE_SELECTION( 1.0, 0.0);\nCHECK_EDGE_SELECTION(-1.0, 1.0);\nCHECK_EDGE_SELECTION( 0.0, 1.0);\nCHECK_EDGE_SELECTION( 1.0, 1.0);\nif (hasEdge != 0)\npaintOutline = true;\nelse\ncenter.a = -center.a;\n}\nif (paintOutline) {\nfloat maxComponent = max(center.r, max(center.g, center.b));\ncenter.rgb /= maxComponent;\ncenter.rgb = sqrt(center.rgb);\ncenter.a = 0.5 + 0.5 * maxAlpha * 0.125 * float(hasEdge);\n}\nreturn center;\n}\nvec4 sampleColor() {\nreturn texture2D( tDiffuse, vUv );\n}\nfloat sampleAO() {\nreturn (useAO != 0) ? texture2D(tAO, vUv).r : 1.0;\n}\nvoid main() {\nvec4 texel = sampleColor();\ntexel.rgb *= sampleAO();\nif (useOverlay != 0) {\nvec4 overlay = overlayEdgeDetect(vUv);\nif (overlay.a < 0.0) {\noverlay.a = -overlay.a;\nif (overlay.a >= 0.99) {\noverlay.a = 0.75;\ntexel.rgb = vec3(luminance_post(texel.rgb));\n}\n}\ntexel.rgb = mix(texel.rgb, sqrt(overlay.rgb)/*sqrt=gamma*/, overlay.a);\n}\nif (objID != 0) {\nvec4 idAtPixel = texture2D(tID, vUv);\nvec3 idDelta = abs(idAtPixel.rgb - objIDv3.rgb);\nif (max(max(idDelta.r, idDelta.g), idDelta.b) < 1e-3) {\n#ifdef IS_2D\ntexel.rgb = mix(texel.rgb, vec3(1.0,1.0,0.0), highlightIntensity * 0.25);\n#else\ntexel.rgb += highlightIntensity * 0.2;\n#endif\n}\n}\ngl_FragColor = texel;\n}"].join("\n")})}
LmvShaderPass=function(a,b){this.textureID=void 0!==b?b:"tDiffuse";this.uniforms=THREE.UniformsUtils.clone(a.uniforms);this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:THREE.UniformsUtils.clone(a.defines)});this.renderToScreen=!1;this.enabled=!0;this.clear=!1;this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);var c=new THREE.BufferGeometry,f=new Float32Array(9);f[0]=-1;f[1]=-1;f[2]=0;f[3]=3;f[4]=-1;f[5]=0;f[6]=
-1;f[7]=3;f[8]=0;var d=new Float32Array(6);d[0]=0;d[1]=0;d[2]=2;d[3]=0;d[4]=0;d[5]=2;c.addAttribute("position",new THREE.BufferAttribute(f,3));c.addAttribute("uv",new THREE.BufferAttribute(d,2));this.quad=new THREE.Mesh(c,this.material);this.scene=new THREE.Scene;this.scene.add(this.quad)};
LmvShaderPass.prototype={render:function(a,b,c,f){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c);this.renderToScreen||!b?a.render(this.scene,this.camera):a.render(this.scene,this.camera,b,this.clear)}};
function init_SAOShader(){"undefined"===typeof SAOShader&&(SAOShader={uniforms:{tDepth:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},cameraNear:{type:"f",value:1},cameraFar:{type:"f",value:100},radius:{type:"f",value:10},bias:{type:"f",value:.01},projScale:{type:"f",value:500},projInfo:{type:"v4",value:new THREE.Vector4(0,0,0,0)},intensity:{type:"f",value:.5},isOrtho:{type:"f",value:1},tDepth_mip1:{type:"t",value:null},tDepth_mip2:{type:"t",value:null},tDepth_mip3:{type:"t",
value:null},tDepth_mip4:{type:"t",value:null},tDepth_mip5:{type:"t",value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:["#extension GL_OES_standard_derivatives : enable\n#define USE_MIPMAP 1\nuniform float cameraNear;\nuniform float cameraFar;\nuniform vec2 size;\nuniform float lumInfluence;\nvarying vec2 vUv;\n#define NUM_SAMPLES (17)\n#define LOG_MAX_OFFSET (3)\n#define MAX_MIP_LEVEL (5)\n#define NUM_SPIRAL_TURNS (7)\nuniform float           projScale;\nuniform sampler2D tDepth;\n#ifdef USE_MIPMAP\nuniform sampler2D tDepth_mip1;\nuniform sampler2D tDepth_mip2;\nuniform sampler2D tDepth_mip3;\nuniform sampler2D tDepth_mip4;\nuniform sampler2D tDepth_mip5;\n#endif\nuniform float radius;\nuniform float bias;\nuniform float intensity;\nuniform float isOrtho;\nfloat intensityDivR6 = intensity / pow(radius, 6.0);\nvec2 tapLocation(int sampleNumber, float spinAngle, out float ssR){\nfloat alpha = float(float(sampleNumber) + 0.5) * (1.0 / float(NUM_SAMPLES));\nfloat angle = alpha * (float(NUM_SPIRAL_TURNS) * 6.28) + spinAngle;\nssR = alpha;\nreturn vec2(cos(angle), sin(angle));\n}\nfloat CSZToKey(float z) {\nreturn clamp(z * (1.0 / -cameraFar), 0.0, 1.0);\n}\nvoid packKey(float key, out vec2 p) {\nfloat temp = floor(key * 256.0);\np.x = temp * (1.0 / 256.0);\np.y = key * 256.0 - temp;\n}",
PackDepthShaderChunk,"float unpackDepthNearFar( const in vec4 rgba_depth ) {\nfloat depth = unpackDepth( rgba_depth );\nif (depth == 0.0)\nreturn -cameraFar * 1.0e10;\nreturn depth * (cameraNear - cameraFar) - cameraNear;\n}\nuniform vec4 projInfo;\nvec3 reconstructCSPosition(vec2 S, float z) {\nreturn vec3((S.xy * projInfo.xy + projInfo.zw) * mix(z, -1.0, isOrtho), z);\n}\nvec3 reconstructCSFaceNormal(vec3 C) {\nreturn normalize(cross(dFdy(C), dFdx(C)));\n}\nvec3 reconstructNonUnitCSFaceNormal(vec3 C) {\nreturn cross(dFdy(C), dFdx(C));\n}\nvec2 sizeM1 = vec2(1.0/(size.x), 1.0/(size.y));\nvec3 getPosition(ivec2 ssP, float depth) {\nvec3 P;\nP = reconstructCSPosition(vec2(ssP) + vec2(0.5), depth);\nreturn P;\n}\nvec3 getOffsetPosition(ivec2 ssC, vec2 unitOffset, float ssR) {\nivec2 ssP = ivec2(ssR * unitOffset) + ssC;\nvec3 P;\nvec2 screenUV = (vec2(ssP) + vec2(0.5)) * sizeM1;\n#ifdef USE_MIPMAP\nint mipLevel = int(max(0.0, min(floor(log2(ssR)) - float(LOG_MAX_OFFSET), float(MAX_MIP_LEVEL))));\nif (mipLevel == 0) {\nP.z = texture2D(tDepth, screenUV).z;\nif (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n}\nelse if (mipLevel == 1)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip1, screenUV));\nelse if (mipLevel == 2)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip2, screenUV));\nelse if (mipLevel == 3)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip3, screenUV));\nelse if (mipLevel == 4)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip4, screenUV));\nelse if (mipLevel == 5)\nP.z = unpackDepthNearFar(texture2D(tDepth_mip5, screenUV));\n#else\nP.z = texture2D(tDepth, screenUV).z;\nif (P.z == 0.0) P.z = -cameraFar * 1.0e10;\n#endif\nP = reconstructCSPosition(vec2(ssP) + vec2(0.5), P.z);\nreturn P;\n}\nfloat radius2 = radius * radius;\nfloat invRadius2 = 1.0 / radius2;\nfloat sampleAO(in ivec2 ssC, in vec3 C, in vec3 n_C, in float ssDiskRadius, in int tapIndex, in float randomPatternRotationAngle) {\nfloat ssR;\nvec2 unitOffset = tapLocation(tapIndex, randomPatternRotationAngle, ssR);\nssR *= ssDiskRadius;\nvec3 Q = getOffsetPosition(ssC, unitOffset, ssR);\nvec3 v = Q - C;\nfloat vv = dot(v, v);\nfloat vn = dot(v, n_C);\nconst float epsilon = 0.01;\nfloat f = max(radius2 - vv, 0.0); return f * f * f * max((vn - bias) / (epsilon + vv), 0.0);\n}\nconst bool useNoise = true;\nvec2 rand( const vec2 coord ) {\nvec2 noise;\nif ( useNoise ) {\nfloat nx = dot ( coord, vec2( 12.9898, 78.233 ) );\nfloat ny = dot ( coord, vec2( 12.9898, 78.233 ) * 2.0 );\nnoise = clamp( fract ( 43758.5453 * sin( vec2( nx, ny ) ) ), 0.0, 1.0 );\n} else {\nfloat ff = fract( 1.0 - coord.s * ( size.x / 2.0 ) );\nfloat gg = fract( coord.t * ( size.y / 2.0 ) );\nnoise = vec2( 0.25, 0.75 ) * vec2( ff ) + vec2( 0.75, 0.25 ) * gg;\n}\nreturn ( noise * 2.0  - 1.0 );\n}\nfloat getRandomAngle(vec2 pos) {\nvec2 rnd = rand(pos);\nreturn atan(rnd.y, rnd.x);\n}\nvoid main() {\nivec2 ssC = ivec2(gl_FragCoord.xy);\nvec4 nrmz = texture2D(tDepth, vUv);\nif (nrmz.z == 0.0) {\ngl_FragColor.r = 1.0;\ngl_FragColor.a = 0.0;\npackKey(1.0, gl_FragColor.gb);\nreturn;\n}\nvec3 C = getPosition(ssC, nrmz.z);\npackKey(CSZToKey(C.z), gl_FragColor.gb);\nfloat randomPatternRotationAngle = getRandomAngle(vUv);\nvec3 n_C = vec3(nrmz.x, nrmz.y, sqrt(1.0 - dot(nrmz.xy, nrmz.xy)));\nfloat ssDiskRadius = -projScale * radius / mix(C.z, -1.0, isOrtho);\nfloat sum = 0.0;\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 0, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 1, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 2, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 3, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 4, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 5, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 6, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 7, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 8, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 9, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 10, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 11, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 12, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 13, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 14, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 15, randomPatternRotationAngle);\nsum += sampleAO(ssC, C, n_C, ssDiskRadius, 16, randomPatternRotationAngle);\nfloat A = max(0.0, 1.0 - sum * intensityDivR6 * (5.0 / float(NUM_SAMPLES)));\nif (abs(dFdx(C.z)) < 0.02) {\nA -= dFdx(A) * (mod(float(ssC.x), 2.0) - 0.5);\n}\nif (abs(dFdy(C.z)) < 0.02) {\nA -= dFdy(A) * (mod(float(ssC.y), 2.0) - 0.5);\n}\ngl_FragColor.r = A;\ngl_FragColor.a = 1.0;\n}"].join("\n")})}
function init_SAOBlurShader(){"undefined"===typeof SAOBlurShader&&(SAOBlurShader={uniforms:{tDiffuse:{type:"t",value:null},size:{type:"v2",value:new THREE.Vector2(512,512)},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)},axis:{type:"v2",value:new THREE.Vector2(1,0)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"#define EDGE_SHARPNESS     (1.0)\n#define SCALE               (2)\n#define R                   (4)\n#define VALUE_TYPE        float\n#define VALUE_COMPONENTS   r\n#define VALUE_IS_KEY       0\n#define KEY_COMPONENTS     gb\n#if __VERSION__ >= 330\nconst float gaussian[R + 1] =\nfloat[](0.153170, 0.144893, 0.122649, 0.092902, 0.062970);  // stddev = 2.0\n#endif\nuniform sampler2D   tDiffuse;\nuniform vec2 size;\nuniform vec2 resolution;\nuniform vec2       axis;\nivec2 axisi = ivec2(axis);\n#define  result         gl_FragColor.VALUE_COMPONENTS\n#define  keyPassThrough gl_FragColor.KEY_COMPONENTS\nfloat unpackKey(vec2 p) {\nreturn p.x * (256.0 / 257.0) + p.y * (1.0 / 257.0);\n}\nvarying vec2 vUv;\nvoid main() {\n#   if __VERSION__ < 330\nfloat gaussian[R + 1];\n#       if R == 3\ngaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902;  // stddev = 2.0\n#       elif R == 4\ngaussian[0] = 0.153170; gaussian[1] = 0.144893; gaussian[2] = 0.122649; gaussian[3] = 0.092902; gaussian[4] = 0.062970;  // stddev = 2.0\n#       elif R == 6\ngaussian[0] = 0.111220; gaussian[1] = 0.107798; gaussian[2] = 0.098151; gaussian[3] = 0.083953; gaussian[4] = 0.067458; gaussian[5] = 0.050920; gaussian[6] = 0.036108;\n#       endif\n#   endif\nivec2 ssC = ivec2(gl_FragCoord.xy);\nvec4 temp = texture2D(tDiffuse, vUv);\ngl_FragColor.gb = temp.KEY_COMPONENTS;\ngl_FragColor.a = temp.a;\nVALUE_TYPE sum = temp.VALUE_COMPONENTS;\nif (temp.a == 0.0) {\nresult = sum;\nreturn;\n}\nfloat key = unpackKey(keyPassThrough);\nfloat BASE = gaussian[0];\nfloat totalWeight = BASE;\nsum *= totalWeight;\nint r = -4; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[4];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = -3; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[3];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = -2; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[2];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr=-1; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[1];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = 1; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[1];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = 2; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[2];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = 3; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[3];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nr = 4; {\nvec2 ssUV = vec2(ssC + axisi * (r * SCALE))*resolution;\ntemp = texture2D(tDiffuse, ssUV);\nfloat      tapKey = unpackKey(temp.KEY_COMPONENTS);\nVALUE_TYPE value  = temp.VALUE_COMPONENTS;\nfloat weight = 0.3 + gaussian[4];\nfloat dz = tapKey - key;\nweight *= max(0.0, 1.0 - (EDGE_SHARPNESS * 2000.0) * abs(dz));\nsum += value * weight;\ntotalWeight += weight;\n}\nconst float epsilon = 0.0001;\nresult = sum / (totalWeight + epsilon);\n}"})}
function init_SAOMinifyShader(){"undefined"===typeof SAOMinifyFirstShader&&(SAOMinifyFirstShader={uniforms:{tDiffuse:{type:"t",value:null},cameraNear:{type:"f",value:1},cameraInvNearFar:{type:"f",value:100},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:["uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nuniform float cameraNear;\nuniform float cameraInvNearFar;",
PackDepthShaderChunk,"void main() {\nvec2 ssP = vec2(gl_FragCoord.xy);\nssP = ssP * 2.0 + mod(ssP, 2.0);\nssP = (ssP + 0.5) * resolution * 0.5;\nfloat depth = texture2D(tDiffuse, ssP).z;\nif (depth != 0.0)\ndepth = (depth + cameraNear) * cameraInvNearFar;\ngl_FragColor = packDepth(depth);\n}"].join("\n")},SAOMinifyShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/512,1/512)}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\nvoid main() {\nvec2 ssP = vec2(gl_FragCoord.xy);\nssP = ssP * 2.0 + mod(ssP, 2.0);\nssP = (ssP + 0.5) * resolution * 0.5;\ngl_FragColor = texture2D(tDiffuse, ssP);\n}"})}
function init_FireflyPhongShader(){"undefined"===typeof FireflyPhongShader&&(FireflyPhongShader={uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.lights,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},reflMipIndex:{type:"f",value:0},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)},offsetRepeatBump:{type:"v4",
value:new THREE.Vector4(0,0,1,1)},offsetRepeatAlpha:{type:"v4",value:new THREE.Vector4(0,0,1,1)},irradianceMap:{type:"t",value:null},exposureBias:{type:"f",value:1},envMapExposure:{type:"f",value:1},cutplanes:{type:"v4v",value:[]},cutplanesOutlineColor:{type:"v3",value:new THREE.Vector3(0,1,0)},cutplanesOutlineThickness:{type:"f",value:.05},dbId:{type:"v4",value:new THREE.Vector4(0,0,0,0)}}]),vertexShader:["varying vec3 vViewPosition;\nvarying vec3 vNormal;\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\nuniform vec4 offsetRepeatBump;\n#endif\n#if defined( USE_ALPHAMAP ) || defined( USE_ALPHAMAP )\nvarying vec2 vUvAlpha;\nuniform vec4 offsetRepeatAlpha;\n#endif\n#if defined( USE_ENVMAP )\n#if ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nuniform float refractionRatio;\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#ifdef USE_LOGDEPTHBUF\n#ifdef USE_LOGDEPTHBUF_EXT\nvarying float vFragDepth;\n#endif\nuniform float logDepthBufFC;\n#endif\n#ifdef MRT_NORMALS\nvarying float depth;\n#endif",
PackNormalsShaderChunk,"void main() {\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvUvBump = uv * offsetRepeatBump.zw + offsetRepeatBump.xy;\n#endif\n#if defined( USE_ALPHAMAP )\nvUvAlpha = uv * offsetRepeatAlpha.zw + offsetRepeatAlpha.xy;\n#endif\n#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif\n#ifdef UNPACK_NORMALS\nvec3 objectNormal = decodeNormal(normal);\n#else\nvec3 objectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\nvNormal = normalize( transformedNormal );\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvViewPosition = -mvPosition.xyz;\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\n#endif\n#ifdef USE_LOGDEPTHBUF\nif (projectionMatrix[3][3] == 0.0) {\ngl_Position.z = log2(max(1.0e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n#ifdef USE_LOGDEPTHBUF_EXT\nvFragDepth = 1.0 + gl_Position.w;\n#else\ngl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n#endif\n} else {\n#ifdef USE_LOGDEPTHBUF_EXT\nvFragDepth = 1.0 + vViewPosition.z;\n#else\n#endif\n}\n#endif\n#ifdef MRT_NORMALS\ndepth = mvPosition.z;\n#endif\n}"].join("\n"),
fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\n#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif\n#if defined( USE_MAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvarying vec2 vUvBump;\n#endif\n#if defined( USE_ALPHAMAP )\nvarying vec2 vUvAlpha;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif\n#if defined(TONEMAP_OUTPUT)\nuniform float exposureBias;",
TonemapShaderChunk,"#endif\n#if defined(IRR_RGBM) || defined(ENV_RGBM) || defined(ENV_GAMMA) || defined(IRR_GAMMA)\nuniform float envMapExposure;\n#endif\n#if defined(MRT_ID_BUFFER) || defined(ID_COLOR)\nuniform vec4 dbId;\n#endif\nvec3 RGBMDecode(in vec4 vRGBM, in float exposure) {\nvec3 ret = vRGBM.rgb * (vRGBM.a * 16.0);\nret *= ret;\nret *= exposure;\nreturn ret;\n}\nvec3 GammaDecode(in vec4 vRGBA, in float exposure) {\nreturn vRGBA.xyz * vRGBA.xyz * exposure;\n}\n#ifdef USE_ENVMAP\n#ifdef HAVE_TEXTURE_LOD\n#extension GL_EXT_shader_texture_lod : enable\n#endif\nuniform float reflMipIndex;\nuniform float reflectivity;\nuniform samplerCube envMap;\nmat3 viewInverse3x3 = mat3( viewMatrixInverse[ 0 ].xyz, viewMatrixInverse[ 1 ].xyz, viewMatrixInverse[ 2 ].xyz );\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform float refractionRatio;\n#endif\nvec3 sampleReflection(vec3 dir, float mipIndex) {\ndir.z = -dir.z;\n#ifdef ENV_GAMMA\n#ifdef HAVE_TEXTURE_LOD\nvec4 envTexColor = textureCubeLodEXT( envMap, dir, mipIndex );\n#else\nvec4 envTexColor = textureCube( envMap, dir, mipIndex );\n#endif\nreturn GammaDecode(envTexColor, envMapExposure);\n#elif defined(ENV_RGBM)\n#ifdef HAVE_TEXTURE_LOD\nvec4 envTexColor = textureCubeLodEXT( envMap, dir, mipIndex );\n#else\nvec4 envTexColor = textureCube( envMap, dir, mipIndex );\n#endif\nreturn RGBMDecode(envTexColor, envMapExposure);\n#else\nvec4 envTexColor = textureCube( envMap, dir );\nvec3 cubeColor = envTexColor.xyz;\n#ifdef GAMMA_INPUT\ncubeColor *= cubeColor;\n#endif\nreturn cubeColor;\n#endif\n}\n#endif\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef USE_IRRADIANCEMAP\nuniform samplerCube irradianceMap;\n#endif\n#if MAX_SPOT_LIGHTS > 0 || NUM_CUTPLANES > 0\nvarying highp vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying highp vec3 vViewPosition;\nvarying highp vec3 vNormal;\n#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUvBump );\nvec2 dSTdy = dFdy( vUvBump );\nfloat Hll = bumpScale * texture2D( bumpMap, vUvBump ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUvBump + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUvBump + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif\n#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUvBump.st );\nvec2 st1 = dFdy( vUvBump.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUvBump ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif\n#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif\n#ifdef USE_ALPHAMAP\nuniform sampler2D alphaMap;\n#endif\n#if defined(MRT_NORMALS) || defined(MRT_ID_BUFFER)",
"undefined"!==typeof _isIE11&&_isIE11?"":"#extension GL_EXT_draw_buffers : enable","varying highp float depth;\n#define gl_FragColor gl_FragData[0]\n#endif\n#ifdef USE_LOGDEPTHBUF\nuniform float logDepthBufFC;\n#ifdef USE_LOGDEPTHBUF_EXT\n#extension GL_EXT_frag_depth : enable\nvarying highp float vFragDepth;\n#endif\n#endif\nvec3 Schlick_v3(vec3 v, float cosHV) {\nfloat facing = max(1.0 - cosHV, 0.0);\nfloat facing2 = facing * facing;\nreturn v + (1.0 - v) * facing * facing2 * facing2;\n}\nfloat Schlick_f(float v, float cosHV) {\nfloat facing = max(1.0 - cosHV, 0.0);\nfloat facing2 = facing * facing;\nreturn v + ( 1.0 - v ) * facing2 * facing2 * facing;\n}",
CutPlanesShaderChunk,"void main() {\n#if NUM_CUTPLANES > 0\nif (checkCutPlanes()) return;\n#endif\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );\n#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif\n#ifdef USE_ALPHAMAP\nvec4 texelAlpha = texture2D( alphaMap, vUvAlpha );\ngl_FragColor.a *= texelAlpha.r;\n#endif\n#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif\nfloat specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif\nvec3 normal = normalize( vNormal );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\nvec3 geomNormal = normal;\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\nvec3 viewDirection;\nif (projectionMatrix[3][3] == 0.0) {\nviewDirection = normalize( vViewPosition );\n} else {\nviewDirection = vec3(0.0, 0.0, 1.0);\n}\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\nfloat shininessB = shininess * 4.0;\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewDirection );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininessB ), 0.0 );\nfloat specularNormalization = shininessB * 0.125 + 0.25;\nvec3 schlick = Schlick_v3(specular, dot( lVector, pointHalfVector ) );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization ;\n}\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewDirection );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininessB ), 0.0 );\nfloat specularNormalization = shininessB * 0.125 + 0.25;\nvec3 schlick = Schlick_v3(specular, dot( lVector, spotHalfVector ) );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n}\n}\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewDirection );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininessB ), 0.0 );\nfloat specularNormalization = shininessB * 0.125 + 0.25;\nvec3 schlick = Schlick_v3(specular, dot( dirVector, dirHalfVector ));\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n}\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#ifdef USE_IRRADIANCEMAP\nvec3 worldNormal = viewInverse3x3 * normal;\nvec4 cubeColor4 = textureCube(irradianceMap, vec3(worldNormal.xy, -worldNormal.z));\n#ifdef IRR_GAMMA\nvec3 indirectDiffuse = GammaDecode(cubeColor4, envMapExposure);\n#elif defined(IRR_RGBM)\nvec3 indirectDiffuse = RGBMDecode(cubeColor4, envMapExposure);\n#else\nvec3 indirectDiffuse = cubeColor.xyz;\n#ifdef GAMMA_INPUT\nindirectDiffuse.xyz *= indirectDiffuse.xyz;\n#endif\n#endif\ntotalDiffuse += diffuse * indirectDiffuse;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif\n#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n#endif\n#if defined(USE_ENVMAP)\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n#ifdef ENVMAP_MODE_REFLECTION\nreflectVec = reflect( -viewDirection, normal );\n#else \nreflectVec = refract( -viewDirection, normal, refractionRatio );\n#endif\n#else\nreflectVec = reflect( -viewDirection, normal );\n#endif\nreflectVec = viewInverse3x3 * reflectVec;\nfloat reflectScale = 1.0;\nvec3 cubeColor = sampleReflection(reflectVec, reflMipIndex);\ncubeColor *= reflectScale;\nfloat facing = dot( viewDirection, geomNormal );\nif (facing < -1e-2)\nfacing = 1.0;\nelse\nfacing = max(1e-6, facing);\nvec3 schlickRefl;\n#ifdef METAL\nschlickRefl = specular;\n#else\nschlickRefl = Schlick_v3(specular, facing);\ngl_FragColor.a = mix(gl_FragColor.a, Schlick_f(gl_FragColor.a, facing), reflectivity);\nfloat invSchlick = (1.0 - facing * 0.5);\nfloat invSchlick2 = invSchlick * invSchlick;\nfloat norm_factor = 1.0 - invSchlick * invSchlick2 * invSchlick2;\nnorm_factor = (28.0 / 23.0) * norm_factor;\ngl_FragColor.xyz *= norm_factor * (1.0 - specular);\n#endif\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * schlickRefl.xyz;\n#ifdef CLEARCOAT\nvec3 reflectVecClearcoat = reflect( -viewDirection, geomNormal );\nreflectVecClearcoat = viewInverse3x3 * reflectVecClearcoat;\nvec3 cubeColorClearcoat = sampleReflection(reflectVecClearcoat, 0.0);\nfloat schlickClearcoat = Schlick_f(reflectivity, facing);\ngl_FragColor.xyz = mix(gl_FragColor.xyz, cubeColorClearcoat * schlickClearcoat, 0.5);\n#endif\n#endif\n#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif\n#ifdef TONEMAP_OUTPUT\ngl_FragColor.xyz = toneMapCanonFilmic_WithGamma( exposureBias * gl_FragColor.xyz );\n#endif\n#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\ngl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif\n#ifdef MRT_NORMALS\ngl_FragData[1] = vec4(geomNormal.x, geomNormal.y, depth, gl_FragColor.a < 1.0 ? 0.0 : 1.0);\n#endif\n#ifdef MRT_ID_BUFFER\n#ifdef MRT_NORMALS\nconst int index = 2;\n#else\nconst int index = 1;\n#endif\ngl_FragData[index] = vec4(dbId.rgb, 1.0);\n#elif defined(ID_COLOR)\ngl_FragColor = dbId;\n#endif\n}"].join("\n")},
THREE.ShaderLib.firefly_phong=FireflyPhongShader)}
function init_NormalsShader(){"undefined"===typeof NormalsShader&&(NormalsShader={uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:["varying vec3 vNormal;\nvarying float depth;\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif",PackNormalsShaderChunk,"void main() {\n#ifdef UNPACK_NORMALS\nvec3 objectNormal = decodeNormal(normal);\n#else\nvec3 objectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\nvNormal = normalize( transformedNormal );\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ndepth = mvPosition.z;\nvec4 p_Position = projectionMatrix * mvPosition;\ngl_Position = p_Position;\n}"].join("\n"),fragmentShader:["varying highp vec3 vNormal;\nvarying highp float depth;\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif",
CutPlanesShaderChunk,"void main() {\n#if NUM_CUTPLANES > 0\nif (checkCutPlanes()) return;\n#endif\nvec3 n = vNormal;\nn = n * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nn = normalize( n );\ngl_FragColor = vec4(n.x, n.y, depth, 1.0);\n}"].join("\n")})}
function init_BackgroundShader(){"undefined"===typeof BackgroundShader&&(BackgroundShader={uniforms:{color1:{type:"v3",value:new THREE.Vector3(41/255,76/255,120/255)},color2:{type:"v3",value:new THREE.Vector3(1/255,2/255,3/255)}},vertexShader:"uniform vec3 color1;\nuniform vec3 color2;\nvarying vec3 vColor;\nvoid main() {\nif (uv.y == 0.0)\nvColor = color2;\nelse\nvColor = color1;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:["varying vec3 vColor;",
OrderedDitheringShaderChunk,"void main() {\ngl_FragColor = vec4(orderedDithering(vColor), 1.0);\n}"].join("\n")})}
function init_LineShader(){"undefined"===typeof LineShader&&(LineShader={uniforms:{pixelsPerUnit:{type:"f",value:1},unitsPerPixel:{type:"f",value:1},tLayerMask:{type:"t",value:null},tRaster:{type:"t",value:null},tSelectionTexture:{type:"t",value:null},vSelTexSize:{type:"v2",value:new THREE.Vector2(4096,1)}},attributes:{fields1:0,fields2:0,color4b:0,dbId4b:0,flags4b:0,extraParams:0,instFlags4b:0},defines:{},vertexShader:"#define TAU 6.28318530718\n#define PI 3.14159265358979\n#define HALF_PI 1.57079632679\n#define VBB_LINE_SEGMENT     16.0\n#define VBB_ARC_CIRCULAR     32.0\n#define VBB_ARC_ELLIPTICAL   48.0\n#define VBB_TEX_QUAD         64.0\n#define VBB_ONE_TRIANGLE     80.0\n#define VBB_INSTANCED_FLAG   0.0\n#define VBB_SEG_START_RIGHT  1.0\n#define VBB_SEG_START_LEFT   2.0\n#define VBB_SEG_END_RIGHT    3.0\n#define VBB_SEG_END_LEFT     4.0\nattribute vec3 fields1;\nattribute vec3 fields2;\nattribute vec4 color4b;\nattribute vec4 dbId4b;\nattribute vec4 flags4b;\n#ifdef HAS_ELLIPTICALS\nattribute vec3 extraParams;\n#endif\n#ifdef USE_INSTANCING\nattribute vec4 instFlags4b;\n#endif\nuniform mat4 mvpMatrix;\nuniform float pixelsPerUnit;\nuniform float unitsPerPixel;\nuniform sampler2D tLayerMask;\n#ifdef SELECTION_RENDERER\nuniform sampler2D tSelectionTexture;\nuniform vec2 vSelTexSize;\n#endif\nvarying vec4 outColor;\nvarying vec4 dbId;\nvec2 centralVertex;\nvec2 offsetPosition;\nvarying vec2 offsetDirection;\nvarying vec4 multipurpose;\nvarying float halfWidth;\nvoid strokeLineSegment(float vertexId) {\nfloat distanceAlong = fields2.x;\nfloat isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;\nfloat isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;\nfloat angleTransverse = fields1.z + isLeftSide * HALF_PI;\nfloat st = sin(angleTransverse);\nfloat ct = cos(angleTransverse);\nfloat lwAdjustment = halfWidth + 0.5 * unitsPerPixel;\nvec2 transverseOffset = vec2(ct, st) * lwAdjustment;\noffsetPosition.xy += transverseOffset;\nvec2 moveOffset = isStartCapVertex * isLeftSide * vec2(-transverseOffset.y, transverseOffset.x);\noffsetPosition.xy -= moveOffset;\ncentralVertex.xy -= moveOffset;\nfloat distanceFromStart = max(isStartCapVertex, 0.0) * distanceAlong;\nvec2 along = distanceFromStart * vec2(cos(fields1.z), sin(fields1.z));\noffsetPosition.xy += along;\ncentralVertex.xy += along;\nmultipurpose.x = (isStartCapVertex * lwAdjustment) + distanceFromStart;\nmultipurpose.y = distanceAlong;\nmultipurpose.z = 0.0;\n}\n#ifdef HAS_TRIANGLE_GEOMS\nvoid strokeOneTriangle(float vertexId) {\nhalfWidth = 0.0;\nif (vertexId == VBB_SEG_END_RIGHT)\noffsetPosition.xy = vec2(fields1.z, fields2.x);\nelse if (vertexId == VBB_SEG_END_LEFT)\noffsetPosition.xy = fields2.yz;\n}\n#endif\n#ifdef HAS_RASTER_QUADS\nvoid strokeTexQuad(float vertexId) {\nfloat distanceAlong = fields2.x;\nbool isStartCapVertex = (vertexId < VBB_SEG_END_RIGHT);\nfloat isLeftSide = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? 1.0 : -1.0;\nfloat angleTransverse = fields1.z + isLeftSide * HALF_PI;\nmultipurpose.y = distanceAlong;\nfloat st = sin(angleTransverse);\nfloat ct = cos(angleTransverse);\nfloat moveDist = halfWidth;\nvec2 offset = vec2(ct, st) * moveDist;\noffsetPosition.xy += offset;\nmultipurpose.z = 1.0;\nhalfWidth = 0.0;\nif (isStartCapVertex) {\noffsetPosition.xy += isLeftSide * vec2(0.0, offset.x);\nmultipurpose.x = 0.0;\nmultipurpose.y = max(0.0, isLeftSide);\n}\nelse {\nvec2 along = vec2(cos(fields1.z), sin(fields1.z));\noffsetPosition.xy += distanceAlong * along;\ncentralVertex.xy += distanceAlong * along;\noffsetPosition.xy += isLeftSide * vec2(0.0, -offset.x);\nmultipurpose.x = 1.0;\nmultipurpose.y = max(0.0, isLeftSide);\n}\n}\n#endif\n#ifdef HAS_CIRCLES\nvoid strokeCircularArc(float vertexId) {\nvec2 angles = vec2(fields1.z, fields2.x);\nfloat r = fields2.z;\nif (r * pixelsPerUnit < 0.125)\nr = 0.125 * unitsPerPixel;\nfloat isStart = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;\nfloat isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? -1.0 : 1.0;\nvec2 minPt;\nvec2 maxPt;\nvec2 endsX = vec2(fields1.x) + r * cos(angles);\nvec2 endsY = vec2(fields1.y) + r * sin(angles);\nminPt = maxPt = vec2(endsX.x, endsY.x);\nminPt = min(minPt, vec2(endsX.y, endsY.y));\nmaxPt = max(maxPt, vec2(endsX.y, endsY.y));\nfloat start = angles.x;\nfloat end = angles.y;\nif (end > start) {\nif (start < (0.5 * PI) && end > (0.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y + r));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y + r));\n}\nif (start < PI && end > PI) {\nminPt = min(minPt, vec2(fields1.x - r, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x - r, fields1.y));\n}\nif (start < (1.5 * PI) && end > (1.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y - r));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y - r));\n}\n}\nelse {\nminPt = min(minPt, vec2(fields1.x + r, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x + r, fields1.y));\nif (start < (0.5 * PI) || end > (0.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y + r));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y + r));\n}\nif (start < PI || end > PI) {\nminPt = min(minPt, vec2(fields1.x - r, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x - r, fields1.y));\n}\nif (start < (1.5 * PI) || end > (1.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y - r));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y - r));\n}\n}\nminPt -= halfWidth + 0.5 * unitsPerPixel;\nmaxPt += halfWidth + 0.5 * unitsPerPixel;\nif (isStart<0.0)\noffsetPosition.x = minPt.x;\nelse\noffsetPosition.x = maxPt.x;\nif (isLeft<0.0)\noffsetPosition.y = minPt.y;\nelse\noffsetPosition.y = maxPt.y;\nmultipurpose.x = angles.x;\nmultipurpose.y = -r;\nmultipurpose.z = angles.y;\nmultipurpose.w = -r;\n}\n#endif\n#ifdef HAS_ELLIPTICALS\nvoid strokeEllipticalArc(float vertexId) {\nvec2 angles = vec2(fields1.z, fields2.x);\nfloat isStart = (vertexId < VBB_SEG_END_RIGHT) ? -1.0 : 1.0;\nfloat isLeft = (vertexId == VBB_SEG_END_LEFT || vertexId == VBB_SEG_START_LEFT) ? -1.0 : 1.0;\nfloat major = fields2.z;\nfloat minor = extraParams.x;\nvec2 minPt;\nvec2 maxPt;\nvec2 endsX = vec2(fields1.x) + major * cos(angles);\nvec2 endsY = vec2(fields1.y) + minor * sin(angles);\nminPt = maxPt = vec2(endsX.x, endsY.x);\nminPt = min(minPt, vec2(endsX.y, endsY.y));\nmaxPt = max(maxPt, vec2(endsX.y, endsY.y));\nfloat start = angles.x;\nfloat end = angles.y;\nif (end > start) {\nif (start < (0.5 * PI) && end > (0.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y + minor));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y + minor));\n}\nif (start < PI && end > PI) {\nminPt = min(minPt, vec2(fields1.x - major, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x - major, fields1.y));\n}\nif (start < (1.5 * PI) && end > (1.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y - minor));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y - minor));\n}\n}\nelse {\nminPt = min(minPt, vec2(fields1.x + major, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x + major, fields1.y));\nif (start < (0.5 * PI) || end > (0.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y + minor));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y + minor));\n}\nif (start < PI || end > PI) {\nminPt = min(minPt, vec2(fields1.x - major, fields1.y));\nmaxPt = max(maxPt, vec2(fields1.x - major, fields1.y));\n}\nif (start < (1.5 * PI) || end > (1.5 * PI)) {\nminPt = min(minPt, vec2(fields1.x, fields1.y - minor));\nmaxPt = max(maxPt, vec2(fields1.x, fields1.y - minor));\n}\n}\nminPt -= halfWidth + 0.5 * unitsPerPixel;\nmaxPt += halfWidth + 0.5 * unitsPerPixel;\nif (isStart < 0.0)\noffsetPosition.x = minPt.x;\nelse\noffsetPosition.x = maxPt.x;\nif (isLeft < 0.0)\noffsetPosition.y = minPt.y;\nelse\noffsetPosition.y = maxPt.y;\nmultipurpose.x = angles.x;\nmultipurpose.y = -major;\nmultipurpose.z = angles.y;\nmultipurpose.w = minor;\n}\n#endif\n#ifdef SELECTION_RENDERER\nbool isSelected() {\nvec3 oid = dbId4b.rgb * 255.0;\nfloat id01 = oid.r + oid.g * 256.0;\nfloat t = (id01 + 0.5) * (1.0 / 4096.0);\nfloat flrt = floor(t);\nfloat texU = t - flrt;\nfloat id23 = oid.b * (65536.0 / 4096.0) + flrt;\nt = (id23 + 0.5) / vSelTexSize.y;\nfloat texV = fract(t);\nvec4 selBit = texture2D(tSelectionTexture, vec2(texU, texV));\nreturn selBit.r == 1.0;\n}\n#endif\nbool isLayerOff() {\nvec4 layerBit = texture2D(tLayerMask, flags4b.ba / 255.0);\nreturn layerBit.r == 0.0;\n}\nvoid main() {\ncentralVertex = offsetPosition = fields1.xy;\nif (isLayerOff()) {\noutColor = vec4(0.0);\n}\nelse {\nfloat vertexId = mod(flags4b.x, 16.0);\nfloat geomType = flags4b.x - vertexId;\n#ifdef USE_INSTANCING\nvertexId = instFlags4b.x;\n#endif\nfloat lineWeight = fields2.y;\nif (lineWeight > 0.0) {\nif (lineWeight * pixelsPerUnit < 0.5)\nlineWeight = 0.5 * unitsPerPixel;\n}\nelse {\nlineWeight = abs(lineWeight) * unitsPerPixel;\n}\n#ifdef SELECTION_RENDERER\nif (isSelected())\noutColor = vec4(0.0,0.0,1.0,1.0);\nelse\noutColor = vec4(0.0);\n#else\noutColor = color4b;\n#endif\nhalfWidth = lineWeight;\ndbId = dbId4b;\nif (geomType == VBB_LINE_SEGMENT)\nstrokeLineSegment(vertexId);\n#ifdef HAS_CIRCLES\nelse if (geomType == VBB_ARC_CIRCULAR)\nstrokeCircularArc(vertexId);\n#endif\n#ifdef HAS_ELLIPTICALS\nelse if (geomType == VBB_ARC_ELLIPTICAL)\nstrokeEllipticalArc(vertexId);\n#endif\n#ifdef HAS_RASTER_QUADS\nelse if (geomType == VBB_TEX_QUAD)\nstrokeTexQuad(vertexId);\n#endif\n#ifdef HAS_TRIANGLE_GEOMS\nelse if (geomType == VBB_ONE_TRIANGLE)\nstrokeOneTriangle(vertexId);\n#endif\nelse {\nhalfWidth = 0.0;\nmultipurpose.z = 0.0;\n}\n}\noffsetDirection = offsetPosition - centralVertex;\ngl_Position = mvpMatrix * vec4( offsetPosition.xy, 0.0, 1.0 );\n}",
fragmentShader:"#define TAU 6.28318530717958\n#define PI  3.14159265358979\nuniform float pixelsPerUnit;\nuniform float unitsPerPixel;\nfloat aaRange = 0.5 * unitsPerPixel;\n#ifdef HAS_RASTER_QUADS\nuniform sampler2D tRaster;\n#endif\nvarying vec4 outColor;\nvarying vec4 dbId;\n#ifdef MRT_ID_BUFFER\n#extension GL_EXT_draw_buffers : enable\n#define gl_FragColor gl_FragData[0]\n#endif\nvarying vec2 offsetDirection;\nvarying vec4 multipurpose;\nvarying float halfWidth;\nfloat curveGaussian(float r, float invWidth) {\nfloat amt = clamp(r * invWidth, 0.0, 1.0);\nfloat exponent = amt * 3.5;\nreturn exp(-exponent*exponent);\n}\nvoid fillLineSegment() {\nfloat radius = halfWidth;\nfloat parametricDistance = multipurpose.x;\nfloat segmentLength = multipurpose.y;\nfloat dist;\nfloat offsetLength2 = dot(offsetDirection, offsetDirection);\nfloat ltz = max(0.0, sign(-parametricDistance));\nfloat gtsl = max(0.0, sign(parametricDistance - segmentLength));\nfloat d = (ltz + gtsl) * (parametricDistance - gtsl * segmentLength);\ndist = sqrt(max(0.0, offsetLength2 + d*d));\nfloat range =  dist - radius;\nif (range > aaRange) {\ndiscard;\n}\ngl_FragColor = outColor;\ngl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\n}\n#ifdef HAS_CIRCLES\nvoid fillCircularArc() {\nfloat dist = length(offsetDirection);\nfloat radius = abs(multipurpose.y);\nfloat range =  abs(dist - radius);\nrange -= halfWidth;\nif (range > aaRange) {\ndiscard;\n}\nvec2 angles = multipurpose.xz;\nvec2 direction = offsetDirection;\nfloat angle = atan(direction.y, direction.x);\nif (angles.x > angles.y)\nangles.x -= TAU;\nelse if (angle < 0.0)\nangle += TAU;\nif (angle > angles.x && angle < angles.y) {\ngl_FragColor = outColor;\ngl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\n}\nelse {\ndiscard;\n}\n}\n#endif\n#ifdef HAS_ELLIPTICALS\nfloat DistancePointEllipseSpecial (vec2 e, vec2 y, out vec2 x, float width, float aaRange) {\nfloat dist;\nvec2 esqr = e * e;\nvec2 ey = e * y;\nfloat t0 = -esqr[1] + ey[1];\nfloat t1 = -esqr[1] + length(ey);\nfloat t;\nvec2 r;\nfor (int i = 0; i < 6; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nif (dist > max(2.0 * (width + aaRange), e[0] * 0.05))\nreturn dist;\nfor (int i = 0; i < 6; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nfloat ecc = 1.0 +  0.1 * e[0] / e[1];\nif (dist > max(ecc * (width + aaRange), e[0] * 0.001))\nreturn dist;\nif (dist < (width - aaRange) / ecc)\nreturn dist;\nfor (int i = 0; i < 10; ++i) {\nt = mix(t0, t1, 0.5);//0.5*(t0 + t1);\nr = ey / (vec2(t) + esqr);\nvec2 rsq = r * r;\nfloat f = rsq[0] + rsq[1] - 1.0;\nfloat fsign = sign(f);\nt0 = mix(t0, t, max(0.0, fsign));\nt1 = mix(t1, t, max(0.0, -fsign));\n}\nx = e * r;\ndist = distance(x, y);\nreturn dist;\n}\nfloat DistancePointEllipse(vec2 e, vec2 y, out vec2 locX, float width, float aaRange) {\nvec2 locE, locY;\nfloat diff = sign(e[0] - e[1]);\nvec2 swizzle = vec2(max(diff, 0.0), -min(diff, 0.0));\nlocE.x = dot(e, swizzle.xy);\nlocE.y = dot(e, swizzle.yx);\nlocY.x = dot(y, swizzle.xy);\nlocY.y = dot(y, swizzle.yx);\nvec2 refl = sign(locY);\nlocY *= refl;\nvec2 x;\nfloat distance = DistancePointEllipseSpecial(locE, locY, x, width, aaRange);\nx *= refl;\nlocX.x = dot(x, swizzle.xy);\nlocX.y = dot(x, swizzle.yx);\nreturn distance;\n}\nvoid fillEllipticalArc() {\nvec2 radii = abs(multipurpose.yw);\nvec2 dir = offsetDirection;\nvec2 pos;\nfloat range = DistancePointEllipse(radii, dir, pos, halfWidth, aaRange);\nrange -= halfWidth;\nif (range > aaRange)\ndiscard;\nfloat ar = radii[0] / radii[1];\nvec2 angles = multipurpose.xz;\nfloat angle = atan(ar * pos.y, pos.x);\nif (angles.x > angles.y)\nangles.x -= TAU;\nelse if (angle < 0.0)\nangle += TAU;\nif (angle > angles.x && angle < angles.y) {\ngl_FragColor = outColor;\ngl_FragColor.a *= curveGaussian(range+aaRange, pixelsPerUnit);\n}\nelse {\ndiscard;\n}\n}\n#endif\nvoid main() {\nif (outColor.a == 0.0) {\ndiscard;\n}\nif (halfWidth == 0.0) {\n#ifdef HAS_RASTER_QUADS\nif (multipurpose.z != 0.0)\ngl_FragColor = texture2D(tRaster, multipurpose.xy);\nelse\n#endif\ngl_FragColor = outColor;\n}\nelse if (multipurpose.y < 0.0) {\n#ifdef HAS_CIRCLES\n#ifdef HAS_ELLIPTICALS\nif (multipurpose.y == multipurpose.w)\n#endif\nfillCircularArc();\n#endif\n#ifdef HAS_ELLIPTICALS\n#ifdef HAS_CIRCLES\nelse\n#endif\nfillEllipticalArc();\n#endif\n}\nelse\nfillLineSegment();\n#ifdef MRT_ID_BUFFER\ngl_FragData[1] = vec4(dbId.rgb, 1.0);\n#elif defined(ID_COLOR)\ngl_FragColor = vec4(dbId.rgba);\n#endif\n}"})}
FireflyWebGLProgram=function(){var a=0;return function(b,c,f,d){var g=b.context,h=f.defines,k=f.__webglShader.uniforms,l=f.attributes,n=f.__webglShader.vertexShader,q=f.__webglShader.fragmentShader,m=f.index0AttributeName;void 0===m&&!0===d.morphTargets&&(m="position");var p="SHADOWMAP_TYPE_BASIC";d.shadowMapType===THREE.PCFShadowMap?p="SHADOWMAP_TYPE_PCF":d.shadowMapType===THREE.PCFSoftShadowMap&&(p="SHADOWMAP_TYPE_PCF_SOFT");var t,v;t=[];for(var D in h)v=h[D],!1!==v&&(v="#define "+D+" "+v,t.push(v));
t=t.join("\n");h=g.createProgram();f instanceof THREE.RawShaderMaterial?b=f="":(f=["precision "+d.precision+" float;","precision "+d.precision+" int;",t,d.supportsVertexTextures?"#define VERTEX_TEXTURES":"",b.gammaInput?"#define GAMMA_INPUT":"",b.gammaOutput?"#define GAMMA_OUTPUT":"",d.mrtNormals?"#define MRT_NORMALS":"",d.mrtIdBuffer?"#define MRT_ID_BUFFER":"","#define MAX_DIR_LIGHTS "+d.maxDirLights,"#define MAX_POINT_LIGHTS "+d.maxPointLights,"#define MAX_SPOT_LIGHTS "+d.maxSpotLights,"#define MAX_HEMI_LIGHTS "+
d.maxHemiLights,"#define MAX_SHADOWS "+d.maxShadows,"#define MAX_BONES "+d.maxBones,"#define NUM_CUTPLANES "+d.numCutplanes,d.map?"#define USE_MAP":"",d.envMap?"#define USE_ENVMAP":"",d.envMap?"#define ENVMAP_MODE_REFLECTION":"",d.irradianceMap?"#define USE_IRRADIANCEMAP":"",d.lightMap?"#define USE_LIGHTMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.alphaMap?"#define USE_ALPHAMAP":"",d.vertexColors?"#define USE_COLOR":
"",d.skinning?"#define USE_SKINNING":"",d.useVertexTexture?"#define BONE_TEXTURE":"",d.morphTargets?"#define USE_MORPHTARGETS":"",d.morphNormals?"#define USE_MORPHNORMALS":"",d.wrapAround?"#define WRAP_AROUND":"",d.doubleSided?"#define DOUBLE_SIDED":"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+p:"",d.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",d.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",d.sizeAttenuation?"#define USE_SIZEATTENUATION":
"",d.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",d.useFragDepthExt?"#define USE_LOGDEPTHBUF_EXT":"",d.packedNormals?"#define UNPACK_NORMALS":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\n#ifdef UNPACK_NORMALS\nattribute vec2 normal;\n#else\nattribute vec3 normal;\n#endif\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\n\tattribute vec3 color;\n#endif\n"].join("\n"),
b=["precision "+d.precision+" float;","precision "+d.precision+" int;",d.bumpMap||d.normalMap?"#extension GL_OES_standard_derivatives : enable":"",d.haveTextureLod?"#define HAVE_TEXTURE_LOD":"",t,"#define MAX_DIR_LIGHTS "+d.maxDirLights,"#define MAX_POINT_LIGHTS "+d.maxPointLights,"#define MAX_SPOT_LIGHTS "+d.maxSpotLights,"#define MAX_HEMI_LIGHTS "+d.maxHemiLights,"#define MAX_SHADOWS "+d.maxShadows,"#define NUM_CUTPLANES "+d.numCutplanes,d.alphaTest?"#define ALPHATEST "+d.alphaTest:"",b.gammaInput?
"#define GAMMA_INPUT":"",b.gammaOutput?"#define GAMMA_OUTPUT":"",d.mrtNormals?"#define MRT_NORMALS":"",d.mrtIdBuffer?"#define MRT_ID_BUFFER":"",d.tonemapOutput?"#define TONEMAP_OUTPUT":"",d.useFog&&d.fog?"#define USE_FOG":"",d.useFog&&d.fogExp?"#define FOG_EXP2":"",d.map?"#define USE_MAP":"",d.envMap?"#define USE_ENVMAP":"",d.envMap?"#define ENVMAP_TYPE_CUBE":"",d.envMap?"#define ENVMAP_MODE_REFLECTION":"",d.envMap?"#define ENVMAP_BLENDING_MULTIPLY":"",d.irradianceMap?"#define USE_IRRADIANCEMAP":
"",d.envGammaEncoded?"#define ENV_GAMMA":"",d.irrGammaEncoded?"#define IRR_GAMMA":"",d.envRGBM?"#define ENV_RGBM":"",d.irrRGBM?"#define IRR_RGBM":"",d.lightMap?"#define USE_LIGHTMAP":"",d.bumpMap?"#define USE_BUMPMAP":"",d.normalMap?"#define USE_NORMALMAP":"",d.specularMap?"#define USE_SPECULARMAP":"",d.alphaMap?"#define USE_ALPHAMAP":"",d.vertexColors?"#define USE_COLOR":"",d.metal?"#define METAL":"",d.clearcoat?"#define CLEARCOAT":"",d.wrapAround?"#define WRAP_AROUND":"",d.doubleSided?"#define DOUBLE_SIDED":
"",d.flipSided?"#define FLIP_SIDED":"",d.shadowMapEnabled?"#define USE_SHADOWMAP":"",d.shadowMapEnabled?"#define "+p:"",d.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",d.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",d.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform highp mat4 viewMatrix;\nuniform highp mat4 projectionMatrix;\nuniform highp vec3 cameraPosition;\n#ifdef USE_ENVMAP\nuniform mat4 viewMatrixInverse;\n#endif\n"].join("\n"));n=new THREE.WebGLShader(g,g.VERTEX_SHADER,f+n);q=
new THREE.WebGLShader(g,g.FRAGMENT_SHADER,b+q);g.attachShader(h,n);g.attachShader(h,q);void 0!==m&&g.bindAttribLocation(h,0,m);g.linkProgram(h);!1===g.getProgramParameter(h,g.LINK_STATUS)&&(console.error("THREE.WebGLProgram: Could not initialise shader."),console.error("gl.VALIDATE_STATUS",g.getProgramParameter(h,g.VALIDATE_STATUS)),console.error("gl.getError()",g.getError()));""!==g.getProgramInfoLog(h)&&console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",g.getProgramInfoLog(h));g.deleteShader(n);
g.deleteShader(q);m="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition viewMatrixInverse mvpMatrix dbId".split(" ");d.logarithmicDepthBuffer&&m.push("logDepthBufFC");for(var w in k)m.push(w);d=m;k={};w=0;for(m=d.length;w<m;w++)b=d[w],k[b]=g.getUniformLocation(h,b);this.uniforms=k;var m="position normal uv uv2 tangent color lineDistance".split(" "),F;for(F in l)m.push(F);l=m;F={};d=0;for(k=l.length;d<k;d++)w=l[d],F[w]=g.getAttribLocation(h,w);this.attributes=F;this.attributesKeys=
Object.keys(this.attributes);this.id=a++;this.code=c;this.usedTimes=1;this.program=h;this.vertexShader=n;this.fragmentShader=q;return this}}();
FireflyWebGLRenderer=function(a){function b(a,b){var g=b.geometry,h=a.faces3,k=3*h.length,m=1*h.length,l=3*h.length,h=c(b,a),n=d(h),q=f(h),N=h.vertexColors?h.vertexColors:!1;a.__vertexArray=new Float32Array(3*k);q&&(a.__normalArray=new Float32Array(3*k));g.hasTangents&&(a.__tangentArray=new Float32Array(4*k));N&&(a.__colorArray=new Float32Array(3*k));n&&(0<g.faceVertexUvs.length&&(a.__uvArray=new Float32Array(2*k)),1<g.faceVertexUvs.length&&(a.__uv2Array=new Float32Array(2*k)));b.geometry.skinWeights.length&&
b.geometry.skinIndices.length&&(a.__skinIndexArray=new Float32Array(4*k),a.__skinWeightArray=new Float32Array(4*k));g=null!==ia.get("OES_element_index_uint")&&21845<m?Uint32Array:Uint16Array;a.__typeArray=g;a.__faceArray=new g(3*m);a.__lineArray=new g(2*l);a.__webglFaceCount=3*m;a.__webglLineCount=2*l;if(h.attributes){void 0===a.__webglCustomAttributesList&&(a.__webglCustomAttributesList=[]);for(var t in h.attributes){var m=h.attributes[t],g={},w;for(w in m)g[w]=m[w];if(!g.__webglInitialized||g.createUniqueBuffers)g.__webglInitialized=
!0,l=1,"v2"===g.type?l=2:"v3"===g.type?l=3:"v4"===g.type?l=4:"c"===g.type&&(l=3),g.size=l,g.array=new Float32Array(k*l),g.buffer=r.createBuffer(),g.buffer.belongsToAttribute=t,m.needsUpdate=!0,g.__original=m;a.__webglCustomAttributesList.push(g)}}a.__inittedArrays=!0}function c(a,b){return a.material instanceof THREE.MeshFaceMaterial?a.material.materials[b.materialIndex]:a.material}function f(a){return a instanceof THREE.MeshBasicMaterial&&!a.envMap||a instanceof THREE.MeshDepthMaterial?!1:a&&void 0!==
a.shading&&a.shading===THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function d(a){return a.map||a.lightMap||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a instanceof THREE.ShaderMaterial?!0:!1}function g(a,b,c,d){if(d.streamingDraw||d.offsets&&1<d.offsets.length||!Ga)return d.vaos=null,!1;void 0===d.vaos&&(d.vaos=[]);b=Ga.createVertexArrayOES();d.vaos.push({geomhash:a,vao:b});Ga.bindVertexArrayOES(b);(a=d.attributes.index)&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,a.buffer);var f,g=
null,h=d.vbstride,k=d.offsets&&d.offsets.length?d.offsets[0].index:0;for(f in c)if(a=d.attributes[f],b=c[f],0<=b)if(a){var m=r.FLOAT;1===a.bytesPerItem?m=r.UNSIGNED_BYTE:2===a.bytesPerItem&&(m=r.UNSIGNED_SHORT);r.enableVertexAttribArray(b);void 0!==a.itemOffset?(g!=d.vbbuffer&&(r.bindBuffer(r.ARRAY_BUFFER,d.vbbuffer),g=d.vbbuffer),r.vertexAttribPointer(b,a.itemSize,m,a.normalize,4*h,4*(a.itemOffset+k*h))):(r.bindBuffer(r.ARRAY_BUFFER,a.buffer),g=a.buffer,r.vertexAttribPointer(b,a.itemSize,m,a.normalize,
0,k*a.itemSize*4));Ha&&d.numInstances&&Ha.vertexAttribDivisorANGLE(b,a.divisor||0)}else{Ga.bindVertexArrayOES(null);for(c=0;c<d.vaos.length;c++)Ga.deleteVertexArrayOES(d.vaos[c].vao);d.vaos=null;return!1}return!0}function h(a,b){var c=cb[a];c||(c=r.createBuffer(),cb[a]=c);r.bindBuffer(r.ARRAY_BUFFER,c);r.bufferData(r.ARRAY_BUFFER,b,r.DYNAMIC_DRAW);return c}function k(a,b,c,d,f){var g,k,m=0,l=void 0;f&&(!f.buffer&&c.streamingDraw?(g=cb.index,g||(g=r.createBuffer(),cb.index=g),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,
g),r.bufferData(r.ELEMENT_ARRAY_BUFFER,f.array||c.ib,r.DYNAMIC_DRAW)):r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,f.buffer));for(k in b)if(f=b[k],g=c.attributes[k],0<=f)if(g){var N,t;void 0!==g.itemOffset?(N=c.vbstride,t=g.itemOffset,m!==l&&(c.streamingDraw?m=h("interleavedVB",c.vb):(m=c.vbbuffer,r.bindBuffer(r.ARRAY_BUFFER,m)),l=m)):(N=g.itemSize,t=0,c.streamingDraw?m=h(k,g.array):(m=g.buffer,r.bindBuffer(r.ARRAY_BUFFER,m)));var w=r.FLOAT;1===g.bytesPerItem?w=r.UNSIGNED_BYTE:2===g.bytesPerItem&&(w=r.UNSIGNED_SHORT);
n(f);r.vertexAttribPointer(f,g.itemSize,w,g.normalize,4*N,4*(t+d*N));Ha&&c.numInstances&&Ha.vertexAttribDivisorANGLE(f,g.divisor||0)}else a.defaultAttributeValues&&((g=a.defaultAttributeValues[k])&&2===g.length?r.vertexAttrib2fv(f,a.defaultAttributeValues[k]):g&&3===g.length&&r.vertexAttrib3fv(f,a.defaultAttributeValues[k]));q()}function l(){for(var a=0,b=Za.length;a<b;a++)Za[a]=0}function n(a){Za[a]=1;0===Qa[a]&&(r.enableVertexAttribArray(a),Qa[a]=1)}function q(){for(var a=0,b=Qa.length;a<b;a++)Qa[a]!==
Za[a]&&(r.disableVertexAttribArray(a),Qa[a]=0)}function m(a,b){return a.z!==b.z?b.z-a.z:a.id-b.id}function p(a,b){return a.z!==b.z?a.z-b.z:a.id-b.id}function t(a){F(a,!0)}function v(a){F(a,!1)}function D(a){F(a,!0,!0)}function w(a){F(a,!1,!0)}function F(a,b,c){if(c||!1!==a.visible){if(!(a instanceof THREE.Scene||a instanceof THREE.Group))if(a instanceof RenderBatch)c?a.forEach(b?D:w,MESH_VISIBLE):a.forEach(b?t:v);else{void 0===a.__webglInit&&(a.__webglInit=!0,a.addEventListener("removed",xb));var d=
a.geometry;if(void 0!==d&&void 0===d.__webglInit&&(d.__webglInit=!0,d.addEventListener("dispose",yb),!(d instanceof THREE.BufferGeometry)))if(a instanceof THREE.Mesh)G(a,d);else if(a instanceof THREE.Line&&void 0===d.__webglVertexBuffer){d.__webglVertexBuffer=r.createBuffer();d.__webglColorBuffer=r.createBuffer();d.__webglLineDistanceBuffer=r.createBuffer();aa.info.memory.geometries++;var f=d.vertices.length;d.__vertexArray=new Float32Array(3*f);d.__colorArray=new Float32Array(3*f);d.__lineDistanceArray=
new Float32Array(1*f);d.__webglLineCount=f;var f=d.vertices.length,g=a.material;if(g.attributes){void 0===d.__webglCustomAttributesList&&(d.__webglCustomAttributesList=[]);for(var h in g.attributes){var k=g.attributes[h];if(!k.__webglInitialized||k.createUniqueBuffers){k.__webglInitialized=!0;var m=1;"v2"===k.type?m=2:"v3"===k.type?m=3:"v4"===k.type?m=4:"c"===k.type&&(m=3);k.size=m;k.array=new Float32Array(f*m);k.buffer=r.createBuffer();k.buffer.belongsToAttribute=h;k.needsUpdate=!0}d.__webglCustomAttributesList.push(k)}}d.verticesNeedUpdate=
!0;d.colorsNeedUpdate=!0;d.lineDistancesNeedUpdate=!0}if(void 0===a.__webglActive)if(a.__webglActive=!0,a instanceof THREE.Mesh)if(d instanceof THREE.BufferGeometry)A(ma,d,a);else{if(d instanceof THREE.Geometry)for(d=jb[d.id],h=0,f=d.length;h<f;h++)A(ma,d[h],a)}else a instanceof THREE.Line||a instanceof THREE.PointCloud?A(ma,d,a):(a instanceof THREE.ImmediateRenderObject||a.immediateRenderCallback)&&La.push({id:null,object:a,opaque:null,transparent:null,z:0});if(a instanceof THREE.Light)ha.push(a);
else if((d=ma[a.id])&&(!1===a.frustumCulled||!0===fb.intersectsObject(a)))for(h=0,f=d.length;h<f;h++){var k=g=d[h],l=k.object,m=k.buffer,n=l.geometry,l=l.material;l instanceof THREE.MeshFaceMaterial?(l=l.materials[n instanceof THREE.BufferGeometry?0:m.materialIndex],k.material=l,l.transparent?ua.push(k):Ia.push(k)):l&&(k.material=l,l.transparent?ua.push(k):Ia.push(k));g.render=!0;!0===b&&(na.setFromMatrixPosition(a.matrixWorld),na.applyProjection(eb),g.z=na.z)}}if(a.children)for(h=0,f=a.children.length;h<
f;h++)F(a.children[h],b,c)}}function B(a,b,c,d,f,g){for(var h,k=0,m=a.length;k<m;k++){h=a[k];var l=h.object,n=h.buffer;if(g)h=g;else{h=h.material;if(!h)continue;f&&aa.setBlending(h.blending,h.blendEquation,h.blendSrc,h.blendDst);aa.setDepthTest(h.depthTest);aa.setDepthWrite(h.depthWrite);X(h.polygonOffset,h.polygonOffsetFactor,h.polygonOffsetUnits)}aa.setMaterialFaces(h);n instanceof THREE.BufferGeometry?aa.renderBufferDirect(b,c,d,h,n,l):aa.renderBuffer(b,c,d,h,n,l)}}function z(a,b){if(a.visible){var c;
if(lb)c=lb;else{c=a.material;if(!c)return;mb&&aa.setBlending(c.blending,c.blendEquation,c.blendSrc,c.blendDst);aa.setDepthTest(c.depthTest);aa.setDepthWrite(c.depthWrite);X(c.polygonOffset,c.polygonOffsetFactor,c.polygonOffsetUnits)}aa.renderBufferDirect(qb,rb,Lb,c,a.geometry,a,!0)}}function G(a,c){var d=a.material,f=!1;if(void 0===jb[c.id]||!0===c.groupsNeedUpdate){delete ma[a.id];for(var f=jb,g=c.id,d=d instanceof THREE.MeshFaceMaterial,h=ia.get("OES_element_index_uint")?4294967296:65535,k,m={},
l=c.morphTargets?c.morphTargets.length:0,n=c.morphNormals?c.morphNormals.length:0,q,N={},t=[],w=0,p=c.faces.length;w<p;w++){k=c.faces[w];var z=d?k.materialIndex:0;z in m||(m[z]={hash:z,counter:0});k=m[z].hash+"_"+m[z].counter;k in N||(q={id:zb++,faces3:[],materialIndex:z,vertices:0,numMorphTargets:l,numMorphNormals:n},N[k]=q,t.push(q));N[k].vertices+3>h&&(m[z].counter+=1,k=m[z].hash+"_"+m[z].counter,k in N||(q={id:zb++,faces3:[],materialIndex:z,vertices:0,numMorphTargets:l,numMorphNormals:n},N[k]=
q,t.push(q)));N[k].faces3.push(w);N[k].vertices+=3}f[g]=t;c.groupsNeedUpdate=!1}g=jb[c.id];d=0;for(h=g.length;d<h;d++)m=g[d],void 0===m.__webglVertexBuffer?(f=m,f.__webglVertexBuffer=r.createBuffer(),f.__webglNormalBuffer=r.createBuffer(),f.__webglTangentBuffer=r.createBuffer(),f.__webglColorBuffer=r.createBuffer(),f.__webglUVBuffer=r.createBuffer(),f.__webglUV2Buffer=r.createBuffer(),f.__webglSkinIndicesBuffer=r.createBuffer(),f.__webglSkinWeightsBuffer=r.createBuffer(),f.__webglFaceBuffer=r.createBuffer(),
f.__webglLineBuffer=r.createBuffer(),aa.info.memory.geometries++,b(m,a),c.verticesNeedUpdate=!0,c.morphTargetsNeedUpdate=!0,c.elementsNeedUpdate=!0,c.uvsNeedUpdate=!0,c.normalsNeedUpdate=!0,c.tangentsNeedUpdate=!0,f=c.colorsNeedUpdate=!0):f=!1,(f||void 0===a.__webglActive)&&A(ma,m,a);a.__webglActive=!0}function A(a,b,c){var d=c.id;a[d]=a[d]||[];a[d].push({id:d,buffer:b,object:c,material:null,z:0})}function E(a){var g=a.geometry,h,k;if(g instanceof THREE.BufferGeometry)if(g.streamingDraw){if(!g.streamingIndex){var m=
g.attributes.index;m&&(m.buffer=r.createBuffer(),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,m.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,m.array||g.ib,r.STATIC_DRAW))}}else{g.vb&&void 0===g.vbbuffer&&(g.vbbuffer=r.createBuffer(),g.vbNeedsUpdate=!0);for(var l=g.attributes,n=g.attributesKeys,q=0,N=n.length;q<N;q++){var t=n[q],w=l[t],p="index"===t;(w.array||p&&g.ib)&&void 0===w.buffer&&(w.buffer=r.createBuffer(),w.needsUpdate=!0);if(!0===w.needsUpdate){var z=p?r.ELEMENT_ARRAY_BUFFER:r.ARRAY_BUFFER;r.bindBuffer(z,
w.buffer);r.bufferData(z,w.array||p&&g.ib,r.STATIC_DRAW);w.needsUpdate=!1}}g.vbNeedsUpdate&&(r.bindBuffer(r.ARRAY_BUFFER,g.vbbuffer),r.bufferData(r.ARRAY_BUFFER,g.vb,r.STATIC_DRAW),g.vbNeedsUpdate=!1)}else if(a instanceof THREE.Mesh){!0===g.groupsNeedUpdate&&G(a,g);for(var B=jb[g.id],v=0,K=B.length;v<K;v++){var F=B[v];k=c(a,F);!0===g.groupsNeedUpdate&&b(F,a);h=k.attributes&&H(k);if(g.verticesNeedUpdate||g.morphTargetsNeedUpdate||g.elementsNeedUpdate||g.uvsNeedUpdate||g.normalsNeedUpdate||g.colorsNeedUpdate||
g.tangentsNeedUpdate||h){var ca=F,ea=a,A=r.DYNAMIC_DRAW,R=!g.dynamic,ha=k;if(ca.__inittedArrays){var ma=f(ha),D=ha.vertexColors?ha.vertexColors:!1,T=d(ha),ga=ma===THREE.SmoothShading,Q=void 0,C=void 0,E=void 0,Z=void 0,ja=void 0,Y=void 0,ba=void 0,J=void 0,X=void 0,O=void 0,La=void 0,L=void 0,M=void 0,W=void 0,Fa=void 0,U=void 0,Wa=void 0,V=void 0,da=void 0,Ia=void 0,aa=void 0,ua=void 0,la=void 0,Da=void 0,Aa=void 0,ta=0,fa=0,Na=0,ia=0,Ja=0,oa=0,ka=0,qa=0,ya=0,S=0,na=void 0,Ca=ca.__vertexArray,Oa=
ca.__uvArray,xa=ca.__uv2Array,za=ca.__normalArray,wa=ca.__tangentArray,Ba=ca.__colorArray,Ga=ca.__webglCustomAttributesList,P=void 0,Ka=ca.__faceArray,Ha=ca.__lineArray,$a=ea.geometry,Va=$a.elementsNeedUpdate,Pa=$a.uvsNeedUpdate,Xa=$a.normalsNeedUpdate,ab=$a.tangentsNeedUpdate,db=$a.colorsNeedUpdate,Ta=$a.vertices,pa=ca.faces3,hb=$a.faces,bb=$a.faceVertexUvs[0],cb=$a.faceVertexUvs[1];if($a.verticesNeedUpdate){Q=0;for(C=pa.length;Q<C;Q++)Z=hb[pa[Q]],L=Ta[Z.a],M=Ta[Z.b],W=Ta[Z.c],Ca[fa]=L.x,Ca[fa+1]=
L.y,Ca[fa+2]=L.z,Ca[fa+3]=M.x,Ca[fa+4]=M.y,Ca[fa+5]=M.z,Ca[fa+6]=W.x,Ca[fa+7]=W.y,Ca[fa+8]=W.z,fa+=9;r.bindBuffer(r.ARRAY_BUFFER,ca.__webglVertexBuffer);r.bufferData(r.ARRAY_BUFFER,Ca,A)}if(db&&D){Q=0;for(C=pa.length;Q<C;Q++)Z=hb[pa[Q]],ba=Z.vertexColors,J=Z.color,3===ba.length&&D===THREE.VertexColors?(V=ba[0],da=ba[1],Ia=ba[2]):Ia=da=V=J,Ba[ya]=V.r,Ba[ya+1]=V.g,Ba[ya+2]=V.b,Ba[ya+3]=da.r,Ba[ya+4]=da.g,Ba[ya+5]=da.b,Ba[ya+6]=Ia.r,Ba[ya+7]=Ia.g,Ba[ya+8]=Ia.b,ya+=9;0<ya&&(r.bindBuffer(r.ARRAY_BUFFER,
ca.__webglColorBuffer),r.bufferData(r.ARRAY_BUFFER,Ba,A))}if(ab&&$a.hasTangents){Q=0;for(C=pa.length;Q<C;Q++)Z=hb[pa[Q]],X=Z.vertexTangents,Fa=X[0],U=X[1],Wa=X[2],wa[ka]=Fa.x,wa[ka+1]=Fa.y,wa[ka+2]=Fa.z,wa[ka+3]=Fa.w,wa[ka+4]=U.x,wa[ka+5]=U.y,wa[ka+6]=U.z,wa[ka+7]=U.w,wa[ka+8]=Wa.x,wa[ka+9]=Wa.y,wa[ka+10]=Wa.z,wa[ka+11]=Wa.w,ka+=12;r.bindBuffer(r.ARRAY_BUFFER,ca.__webglTangentBuffer);r.bufferData(r.ARRAY_BUFFER,wa,A)}if(Xa&&ma){Q=0;for(C=pa.length;Q<C;Q++)if(Z=hb[pa[Q]],ja=Z.vertexNormals,Y=Z.normal,
3===ja.length&&ga)for(aa=0;3>aa;aa++)la=ja[aa],za[oa]=la.x,za[oa+1]=la.y,za[oa+2]=la.z,oa+=3;else for(aa=0;3>aa;aa++)za[oa]=Y.x,za[oa+1]=Y.y,za[oa+2]=Y.z,oa+=3;r.bindBuffer(r.ARRAY_BUFFER,ca.__webglNormalBuffer);r.bufferData(r.ARRAY_BUFFER,za,A)}if(Pa&&bb&&T){Q=0;for(C=pa.length;Q<C;Q++)if(E=pa[Q],O=bb[E],void 0!==O)for(aa=0;3>aa;aa++)Da=O[aa],Oa[Na]=Da.x,Oa[Na+1]=Da.y,Na+=2;0<Na&&(r.bindBuffer(r.ARRAY_BUFFER,ca.__webglUVBuffer),r.bufferData(r.ARRAY_BUFFER,Oa,A))}if(Pa&&cb&&T){Q=0;for(C=pa.length;Q<
C;Q++)if(E=pa[Q],La=cb[E],void 0!==La)for(aa=0;3>aa;aa++)Aa=La[aa],xa[ia]=Aa.x,xa[ia+1]=Aa.y,ia+=2;0<ia&&(r.bindBuffer(r.ARRAY_BUFFER,ca.__webglUV2Buffer),r.bufferData(r.ARRAY_BUFFER,xa,A))}if(Va){Q=0;for(C=pa.length;Q<C;Q++)Ka[Ja]=ta,Ka[Ja+1]=ta+1,Ka[Ja+2]=ta+2,Ja+=3,Ha[qa]=ta,Ha[qa+1]=ta+1,Ha[qa+2]=ta,Ha[qa+3]=ta+2,Ha[qa+4]=ta+1,Ha[qa+5]=ta+2,qa+=6,ta+=3;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,ca.__webglFaceBuffer);r.bufferData(r.ELEMENT_ARRAY_BUFFER,Ka,A);r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,ca.__webglLineBuffer);
r.bufferData(r.ELEMENT_ARRAY_BUFFER,Ha,A)}if(Ga)for(aa=0,ua=Ga.length;aa<ua;aa++)if(P=Ga[aa],P.__original.needsUpdate){S=0;if(1===P.size)if(void 0===P.boundTo||"vertices"===P.boundTo)for(Q=0,C=pa.length;Q<C;Q++)Z=hb[pa[Q]],P.array[S]=P.value[Z.a],P.array[S+1]=P.value[Z.b],P.array[S+2]=P.value[Z.c],S+=3;else{if("faces"===P.boundTo)for(Q=0,C=pa.length;Q<C;Q++)na=P.value[pa[Q]],P.array[S]=na,P.array[S+1]=na,P.array[S+2]=na,S+=3}else if(2===P.size)if(void 0===P.boundTo||"vertices"===P.boundTo)for(Q=0,
C=pa.length;Q<C;Q++)Z=hb[pa[Q]],L=P.value[Z.a],M=P.value[Z.b],W=P.value[Z.c],P.array[S]=L.x,P.array[S+1]=L.y,P.array[S+2]=M.x,P.array[S+3]=M.y,P.array[S+4]=W.x,P.array[S+5]=W.y,S+=6;else{if("faces"===P.boundTo)for(Q=0,C=pa.length;Q<C;Q++)W=M=L=na=P.value[pa[Q]],P.array[S]=L.x,P.array[S+1]=L.y,P.array[S+2]=M.x,P.array[S+3]=M.y,P.array[S+4]=W.x,P.array[S+5]=W.y,S+=6}else if(3===P.size){var va;va="c"===P.type?["r","g","b"]:["x","y","z"];if(void 0===P.boundTo||"vertices"===P.boundTo)for(Q=0,C=pa.length;Q<
C;Q++)Z=hb[pa[Q]],L=P.value[Z.a],M=P.value[Z.b],W=P.value[Z.c],P.array[S]=L[va[0]],P.array[S+1]=L[va[1]],P.array[S+2]=L[va[2]],P.array[S+3]=M[va[0]],P.array[S+4]=M[va[1]],P.array[S+5]=M[va[2]],P.array[S+6]=W[va[0]],P.array[S+7]=W[va[1]],P.array[S+8]=W[va[2]],S+=9;else if("faces"===P.boundTo)for(Q=0,C=pa.length;Q<C;Q++)W=M=L=na=P.value[pa[Q]],P.array[S]=L[va[0]],P.array[S+1]=L[va[1]],P.array[S+2]=L[va[2]],P.array[S+3]=M[va[0]],P.array[S+4]=M[va[1]],P.array[S+5]=M[va[2]],P.array[S+6]=W[va[0]],P.array[S+
7]=W[va[1]],P.array[S+8]=W[va[2]],S+=9;else if("faceVertices"===P.boundTo)for(Q=0,C=pa.length;Q<C;Q++)na=P.value[pa[Q]],L=na[0],M=na[1],W=na[2],P.array[S]=L[va[0]],P.array[S+1]=L[va[1]],P.array[S+2]=L[va[2]],P.array[S+3]=M[va[0]],P.array[S+4]=M[va[1]],P.array[S+5]=M[va[2]],P.array[S+6]=W[va[0]],P.array[S+7]=W[va[1]],P.array[S+8]=W[va[2]],S+=9}else if(4===P.size)if(void 0===P.boundTo||"vertices"===P.boundTo)for(Q=0,C=pa.length;Q<C;Q++)Z=hb[pa[Q]],L=P.value[Z.a],M=P.value[Z.b],W=P.value[Z.c],P.array[S]=
L.x,P.array[S+1]=L.y,P.array[S+2]=L.z,P.array[S+3]=L.w,P.array[S+4]=M.x,P.array[S+5]=M.y,P.array[S+6]=M.z,P.array[S+7]=M.w,P.array[S+8]=W.x,P.array[S+9]=W.y,P.array[S+10]=W.z,P.array[S+11]=W.w,S+=12;else if("faces"===P.boundTo)for(Q=0,C=pa.length;Q<C;Q++)W=M=L=na=P.value[pa[Q]],P.array[S]=L.x,P.array[S+1]=L.y,P.array[S+2]=L.z,P.array[S+3]=L.w,P.array[S+4]=M.x,P.array[S+5]=M.y,P.array[S+6]=M.z,P.array[S+7]=M.w,P.array[S+8]=W.x,P.array[S+9]=W.y,P.array[S+10]=W.z,P.array[S+11]=W.w,S+=12;else if("faceVertices"===
P.boundTo)for(Q=0,C=pa.length;Q<C;Q++)na=P.value[pa[Q]],L=na[0],M=na[1],W=na[2],P.array[S]=L.x,P.array[S+1]=L.y,P.array[S+2]=L.z,P.array[S+3]=L.w,P.array[S+4]=M.x,P.array[S+5]=M.y,P.array[S+6]=M.z,P.array[S+7]=M.w,P.array[S+8]=W.x,P.array[S+9]=W.y,P.array[S+10]=W.z,P.array[S+11]=W.w,S+=12;r.bindBuffer(r.ARRAY_BUFFER,P.buffer);r.bufferData(r.ARRAY_BUFFER,P.array,A)}R&&(delete ca.__inittedArrays,delete ca.__colorArray,delete ca.__normalArray,delete ca.__tangentArray,delete ca.__uvArray,delete ca.__uv2Array,
delete ca.__faceArray,delete ca.__vertexArray,delete ca.__lineArray,delete ca.__skinIndexArray,delete ca.__skinWeightArray)}}}g.verticesNeedUpdate=!1;g.morphTargetsNeedUpdate=!1;g.elementsNeedUpdate=!1;g.uvsNeedUpdate=!1;g.normalsNeedUpdate=!1;g.colorsNeedUpdate=!1;g.tangentsNeedUpdate=!1;k.attributes&&I(k)}else if(a instanceof THREE.Line){k=c(a,g);h=k.attributes&&H(k);if(g.verticesNeedUpdate||g.colorsNeedUpdate||g.lineDistancesNeedUpdate||h){var Ua=r.DYNAMIC_DRAW,Qa,Ra,Sa,Ya,sa,Za,eb=g.vertices,
fb=g.colors,gb=g.lineDistances,ib=eb.length,lb=fb.length,pb=gb.length,sb=g.__vertexArray,tb=g.__colorArray,mb=g.__lineDistanceArray,qb=g.colorsNeedUpdate,rb=g.lineDistancesNeedUpdate,kb=g.__webglCustomAttributesList,ub,ob,Ea,nb,Ma,ra;if(g.verticesNeedUpdate){for(Qa=0;Qa<ib;Qa++)Ya=eb[Qa],sa=3*Qa,sb[sa]=Ya.x,sb[sa+1]=Ya.y,sb[sa+2]=Ya.z;r.bindBuffer(r.ARRAY_BUFFER,g.__webglVertexBuffer);r.bufferData(r.ARRAY_BUFFER,sb,Ua)}if(qb){for(Ra=0;Ra<lb;Ra++)Za=fb[Ra],sa=3*Ra,tb[sa]=Za.r,tb[sa+1]=Za.g,tb[sa+2]=
Za.b;r.bindBuffer(r.ARRAY_BUFFER,g.__webglColorBuffer);r.bufferData(r.ARRAY_BUFFER,tb,Ua)}if(rb){for(Sa=0;Sa<pb;Sa++)mb[Sa]=gb[Sa];r.bindBuffer(r.ARRAY_BUFFER,g.__webglLineDistanceBuffer);r.bufferData(r.ARRAY_BUFFER,mb,Ua)}if(kb)for(ub=0,ob=kb.length;ub<ob;ub++)if(ra=kb[ub],ra.needsUpdate&&(void 0===ra.boundTo||"vertices"===ra.boundTo)){sa=0;nb=ra.value.length;if(1===ra.size)for(Ea=0;Ea<nb;Ea++)ra.array[Ea]=ra.value[Ea];else if(2===ra.size)for(Ea=0;Ea<nb;Ea++)Ma=ra.value[Ea],ra.array[sa]=Ma.x,ra.array[sa+
1]=Ma.y,sa+=2;else if(3===ra.size)if("c"===ra.type)for(Ea=0;Ea<nb;Ea++)Ma=ra.value[Ea],ra.array[sa]=Ma.r,ra.array[sa+1]=Ma.g,ra.array[sa+2]=Ma.b,sa+=3;else for(Ea=0;Ea<nb;Ea++)Ma=ra.value[Ea],ra.array[sa]=Ma.x,ra.array[sa+1]=Ma.y,ra.array[sa+2]=Ma.z,sa+=3;else if(4===ra.size)for(Ea=0;Ea<nb;Ea++)Ma=ra.value[Ea],ra.array[sa]=Ma.x,ra.array[sa+1]=Ma.y,ra.array[sa+2]=Ma.z,ra.array[sa+3]=Ma.w,sa+=4;r.bindBuffer(r.ARRAY_BUFFER,ra.buffer);r.bufferData(r.ARRAY_BUFFER,ra.array,Ua)}}g.verticesNeedUpdate=!1;
g.colorsNeedUpdate=!1;g.lineDistancesNeedUpdate=!1;k.attributes&&I(k)}}function H(a){for(var b in a.attributes)if(a.attributes[b].needsUpdate)return!0;return!1}function I(a){for(var b in a.attributes)a.attributes[b].needsUpdate=!1}function J(a,b,c,d,f){var g,h,k,m;Ba=0;if(d.needsUpdate){d.program&&Ab(d);d.addEventListener("dispose",Bb);var l=Mb[d.type];l?(g=THREE.ShaderLib[l],d.__webglShader={uniforms:THREE.UniformsUtils.clone(g.uniforms),vertexShader:g.vertexShader,fragmentShader:g.fragmentShader}):
d.__webglShader={uniforms:d.uniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader};for(var n=m=k=h=g=0,q=b.length;n<q;n++){var t=b[n];t.onlyShadow||(t instanceof THREE.DirectionalLight&&g++,t instanceof THREE.PointLight&&h++,t instanceof THREE.SpotLight&&k++,t instanceof THREE.HemisphereLight&&m++)}q=n=0;for(t=b.length;q<t;q++){var w=b[q];w.castShadow&&(w instanceof THREE.SpotLight&&n++,w instanceof THREE.DirectionalLight&&!w.shadowCascade&&n++)}g={precision:V,supportsVertexTextures:pb,
haveTextureLod:!!ia.get("EXT_shader_texture_lod"),map:!!d.map,envMap:!!d.envMap,irradianceMap:!!d.irradianceMap,envIsSpherical:d.envMap&&d.envMap.mapping==THREE.SphericalReflectionMapping,envGammaEncoded:d.envMap&&d.envMap.GammaEncoded,irrGammaEncoded:d.irradianceMap&&d.irradianceMap.GammaEncoded,envRGBM:d.envMap&&d.envMap.RGBM,irrRGBM:d.irradianceMap&&d.irradianceMap.RGBM,lightMap:!!d.lightMap,bumpMap:ia.get("OES_standard_derivatives")&&!!d.bumpMap,normalMap:ia.get("OES_standard_derivatives")&&!!d.normalMap,
specularMap:!!d.specularMap,alphaMap:!!d.alphaMap,vertexColors:d.vertexColors,fog:c,useFog:d.fog,fogExp:c instanceof THREE.FogExp2,sizeAttenuation:d.sizeAttenuation,logarithmicDepthBuffer:ea,maxDirLights:g,maxPointLights:h,maxSpotLights:k,maxHemiLights:m,maxShadows:n,shadowMapEnabled:aa.shadowMapEnabled&&f.receiveShadow,shadowMapType:aa.shadowMapType,shadowMapDebug:aa.shadowMapDebug,shadowMapCascade:aa.shadowMapCascade,alphaTest:d.alphaTest,metal:d.metal,clearcoat:d.clearcoat,wrapAround:d.wrapAround,
doubleSided:d.side===THREE.DoubleSide,flipSided:d.side===THREE.BackSide,mrtNormals:d.mrtNormals,mrtIdBuffer:d.mrtIdBuffer,tonemapOutput:d.tonemapOutput,packedNormals:d.packedNormals,numCutplanes:d.cutplanes?d.cutplanes.length:0};h=[];l?h.push(l):(h.push(d.fragmentShader),h.push(d.vertexShader));for(var p in d.defines)h.push(p),h.push(d.defines[p]);for(var z in g)h.push(z),h.push(g[z]);var l=h.join(),B;z=0;for(p=Aa.length;z<p;z++)if(h=Aa[z],h.code===l){B=h;B.usedTimes++;break}void 0===B&&(B=new FireflyWebGLProgram(aa,
l,d,g),Aa.push(B),aa.info.memory.programs=Aa.length);d.program=B;d.uniformsList=[];for(u in d.__webglShader.uniforms)(z=d.program.uniforms[u])&&d.uniformsList.push([d.__webglShader.uniforms[u],z]);d.needsUpdate=!1}h=g=p=!1;z=d.program;B=z.uniforms;l=d.__webglShader.uniforms;z.id!==Na&&(r.useProgram(z.program),Na=z.id,h=g=p=!0);d.id!==ta&&(-1===ta&&(h=!0),ta=d.id,g=!0);if(p||a!==Ja)if(r.uniformMatrix4fv(B.projectionMatrix,!1,a.projectionMatrix.elements),ea&&r.uniform1f(B.logDepthBufFC,2/(Math.log(a.far+
1)/Math.LN2)),a!==Ja&&(Ja=a),(d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&null!==B.cameraPosition&&(na.setFromMatrixPosition(a.matrixWorld),r.uniform3f(B.cameraPosition,na.x,na.y,na.z)),d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.ShaderMaterial||d.skinning)null!==B.viewMatrix&&r.uniformMatrix4fv(B.viewMatrix,!1,a.matrixWorldInverse.elements),null!==B.viewMatrixInverse&&r.uniformMatrix4fv(B.viewMatrixInverse,
!1,gb.elements),B.mvpMatrix&&r.uniformMatrix4fv(B.mvpMatrix,!1,eb.elements),h?(L(l,d),C(l,!0)):C(l,!1);if(g){c&&d.fog&&(l.fogColor.value=c.color,c instanceof THREE.Fog?(l.fogNear.value=c.near,l.fogFar.value=c.far):c instanceof THREE.FogExp2&&(l.fogDensity.value=c.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights)db&&(h=!0,ba(b),db=!1),h?(c=ib,l.ambientLightColor.value=c.ambient,l.directionalLightColor.value=c.directional.colors,l.directionalLightDirection.value=
c.directional.positions,l.pointLightColor.value=c.point.colors,l.pointLightPosition.value=c.point.positions,l.pointLightDistance.value=c.point.distances,l.spotLightColor.value=c.spot.colors,l.spotLightPosition.value=c.spot.positions,l.spotLightDistance.value=c.spot.distances,l.spotLightDirection.value=c.spot.directions,l.spotLightAngleCos.value=c.spot.anglesCos,l.spotLightExponent.value=c.spot.exponents,l.hemisphereLightSkyColor.value=c.hemi.skyColors,l.hemisphereLightGroundColor.value=c.hemi.groundColors,
l.hemisphereLightDirection.value=c.hemi.positions,N(l,!0)):N(l,!1);if(d instanceof THREE.MeshBasicMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial){l.opacity.value=d.opacity;aa.gammaInput?l.diffuse.value.copyGammaToLinear(d.color):l.diffuse.value.copy(d.color);l.map.value=d.map;l.lightMap.value=d.lightMap;l.specularMap.value=d.specularMap;l.alphaMap.value=d.alphaMap;d.bumpMap&&(l.bumpMap.value=d.bumpMap,l.bumpScale.value=d.bumpScale);d.normalMap&&(l.normalMap.value=
d.normalMap,l.normalScale.value.copy(d.normalScale));var v;d.map?v=d.map:d.specularMap?v=d.specularMap:d.alphaMap&&(v=d.alphaMap);void 0!==v&&(c=v.offset,v=v.repeat,l.offsetRepeat.value.set(c.x,c.y,v.x,v.y));var F;d.normalMap?F=d.normalMap:d.bumpMap&&(F=d.bumpMap);void 0!==F&&(c=F.offset,v=F.repeat,l.offsetRepeatBump.value.set(c.x,c.y,v.x,v.y));d.alphaMap&&(c=d.alphaMap.offset,v=d.alphaMap.repeat,l.offsetRepeatAlpha.value.set(c.x,c.y,v.x,v.y));l.envMap.value=d.envMap;l.irradianceMap&&(l.irradianceMap.value=
d.irradianceMap);l.reflectivity.value=aa.gammaInput?d.reflectivity*d.reflectivity:d.reflectivity;l.refractionRatio.value=d.refractionRatio;L(l,d)}d instanceof THREE.LineBasicMaterial?(l.diffuse.value=d.color,l.opacity.value=d.opacity):d instanceof THREE.LineDashedMaterial?(l.diffuse.value=d.color,l.opacity.value=d.opacity,l.dashSize.value=d.dashSize,l.totalSize.value=d.dashSize+d.gapSize,l.scale.value=d.scale):d instanceof THREE.MeshPhongMaterial?(l.shininess.value=d.shininess,F=Math.log(Math.max(1+
1E-10,d.shininess)),l.reflMipIndex.value=Math.max(0,-.72134752*F+5.5),aa.gammaInput?(l.ambient.value.copyGammaToLinear(d.ambient),l.emissive.value.copyGammaToLinear(d.emissive),l.specular.value.copyGammaToLinear(d.specular)):(l.ambient.value.copy(d.ambient),l.emissive.value.copy(d.emissive),l.specular.value.copy(d.specular)),d.wrapAround&&l.wrapRGB.value.copy(d.wrapRGB),l.exposureBias.value=d.exposureBias):d instanceof THREE.MeshLambertMaterial?(aa.gammaInput?(l.ambient.value.copyGammaToLinear(d.ambient),
l.emissive.value.copyGammaToLinear(d.emissive)):(l.ambient.value.copy(d.ambient),l.emissive.value.copy(d.emissive)),d.wrapAround&&l.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(l.mNear.value=a.near,l.mFar.value=a.far,l.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&(l.opacity.value=d.opacity);if(f.receiveShadow&&!d._shadowPass&&l.shadowMatrix)for(v=F=0,c=b.length;v<c;v++)p=b[v],p.castShadow&&(p instanceof THREE.SpotLight||p instanceof THREE.DirectionalLight&&
!p.shadowCascade)&&(l.shadowMap.value[F]=p.shadowMap,l.shadowMapSize.value[F]=p.shadowMapSize,l.shadowMatrix.value[F]=p.shadowMatrix,l.shadowDarkness.value[F]=p.shadowDarkness,l.shadowBias.value[F]=p.shadowBias,F++);d.cutplanes&&0<d.cutplanes.length&&(l.cutplanes.value=d.cutplanes,l.cutplanesOutlineColor&&d.cutplanesOutlineColor&&(l.cutplanesOutlineColor.value=d.cutplanesOutlineColor),l.cutplanesOutlineThickness&&d.cutplanesOutlineThickness&&(l.cutplanesOutlineThickness.value=d.cutplanesOutlineThickness));
b=d.uniformsList;d=0;for(F=b.length;d<F;d++)if(v=b[d][0],!1!==v.needsUpdate)switch(p=v.type,l=v.value,c=b[d][1],p){case "1i":r.uniform1i(c,l);break;case "1f":r.uniform1f(c,l);break;case "2f":r.uniform2f(c,l[0],l[1]);break;case "3f":r.uniform3f(c,l[0],l[1],l[2]);break;case "4f":r.uniform4f(c,l[0],l[1],l[2],l[3]);break;case "1iv":r.uniform1iv(c,l);break;case "3iv":r.uniform3iv(c,l);break;case "1fv":r.uniform1fv(c,l);break;case "2fv":r.uniform2fv(c,l);break;case "3fv":r.uniform3fv(c,l);break;case "4fv":r.uniform4fv(c,
l);break;case "Matrix3fv":r.uniformMatrix3fv(c,!1,l);break;case "Matrix4fv":r.uniformMatrix4fv(c,!1,l);break;case "i":r.uniform1i(c,l);break;case "f":r.uniform1f(c,l);break;case "v2":r.uniform2f(c,l.x,l.y);break;case "v3":r.uniform3f(c,l.x,l.y,l.z);break;case "v4":r.uniform4f(c,l.x,l.y,l.z,l.w);break;case "c":r.uniform3f(c,l.r,l.g,l.b);break;case "iv1":r.uniform1iv(c,l);break;case "iv":r.uniform3iv(c,l);break;case "fv1":r.uniform1fv(c,l);break;case "fv":r.uniform3fv(c,l);break;case "v2v":void 0===
v._array&&(v._array=new Float32Array(2*l.length));p=0;for(g=l.length;p<g;p++)h=2*p,v._array[h]=l[p].x,v._array[h+1]=l[p].y;r.uniform2fv(c,v._array);break;case "v3v":void 0===v._array&&(v._array=new Float32Array(3*l.length));p=0;for(g=l.length;p<g;p++)h=3*p,v._array[h]=l[p].x,v._array[h+1]=l[p].y,v._array[h+2]=l[p].z;r.uniform3fv(c,v._array);break;case "v4v":void 0===v._array&&(v._array=new Float32Array(4*l.length));p=0;for(g=l.length;p<g;p++)h=4*p,v._array[h]=l[p].x,v._array[h+1]=l[p].y,v._array[h+
2]=l[p].z,v._array[h+3]=l[p].w;r.uniform4fv(c,v._array);break;case "m3":r.uniformMatrix3fv(c,!1,l.elements);break;case "m3v":void 0===v._array&&(v._array=new Float32Array(9*l.length));p=0;for(g=l.length;p<g;p++)l[p].flattenToArrayOffset(v._array,9*p);r.uniformMatrix3fv(c,!1,v._array);break;case "m4":r.uniformMatrix4fv(c,!1,l.elements);break;case "m4v":void 0===v._array&&(v._array=new Float32Array(16*l.length));p=0;for(g=l.length;p<g;p++)l[p].flattenToArrayOffset(v._array,16*p);r.uniformMatrix4fv(c,
!1,v._array);break;case "t":h=l;l=K();r.uniform1i(c,l);if(!h)continue;if(h instanceof THREE.CubeTexture||h.image instanceof Array&&6===h.image.length){if(v=h,c=l,6===v.image.length)if(v.needsUpdate){v.image.__webglTextureCube||(v.addEventListener("dispose",kb),v.image.__webglTextureCube=r.createTexture(),aa.info.memory.textures++);r.activeTexture(r.TEXTURE0+c);r.bindTexture(r.TEXTURE_CUBE_MAP,v.image.__webglTextureCube);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,v.flipY);c=v instanceof THREE.CompressedTexture;
l=v.image[0]instanceof THREE.DataTexture;p=[];for(g=0;6>g;g++)p[g]=!aa.autoScaleCubemaps||c||l?l?v.image[g].image:v.image[g]:W(v.image[g],Ib);g=p[0];h=THREE.Math.isPowerOfTwo(g.width)&&THREE.Math.isPowerOfTwo(g.height);k=O(v.format);m=O(v.type);Y(r.TEXTURE_CUBE_MAP,v,h);for(g=0;6>g;g++)if(c)for(q=p[g].mipmaps,t=0,w=q.length;t<w;t++)n=q[t],v.format!==THREE.RGBAFormat&&v.format!==THREE.RGBFormat?-1<Cb().indexOf(k)?r.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+g,t,k,n.width,n.height,0,n.data):
console.warn("Attempt to load unsupported compressed texture format"):r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+g,t,k,n.width,n.height,0,k,m,n.data);else l?r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,k,p[g].width,p[g].height,0,k,m,p[g].data):r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,k,k,m,p[g]);v.generateMipmaps&&h&&r.generateMipmap(r.TEXTURE_CUBE_MAP);v.needsUpdate=!1;if(v.onUpdate)v.onUpdate()}else r.activeTexture(r.TEXTURE0+c),r.bindTexture(r.TEXTURE_CUBE_MAP,v.image.__webglTextureCube)}else h instanceof
THREE.WebGLRenderTargetCube?(v=h,r.activeTexture(r.TEXTURE0+l),r.bindTexture(r.TEXTURE_CUBE_MAP,v.__webglTexture)):aa.setTexture(h,l);break;case "tv":void 0===v._array&&(v._array=[]);p=0;for(g=v.value.length;p<g;p++)v._array[p]=K();r.uniform1iv(c,v._array);p=0;for(g=v.value.length;p<g;p++)h=v.value[p],l=v._array[p],h&&aa.setTexture(h,l);break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+p)}}Fa.multiplyMatrices(a.matrixWorldInverse,f.matrixWorld);r.uniformMatrix4fv(B.modelViewMatrix,
!1,Fa.elements);B.normalMatrix&&(Wa.getNormalMatrix(Fa),r.uniformMatrix3fv(B.normalMatrix,!1,Wa.elements));null!==B.modelMatrix&&r.uniformMatrix4fv(B.modelMatrix,!1,f.matrixWorld.elements);null!==B.dbId&&(a=f.dbId||f.fragId||0,r.uniform4f(B.dbId,(a&255)/255,(a>>8&255)/255,(a>>16&255)/255,(a>>24&255)/255));return z}function L(a,b){a.envMap&&(a.envMap.value=b.envMap);a.irradianceMap&&(a.irradianceMap.value=b.irradianceMap);a.envMapExposure&&(a.envMapExposure.value=b.envMapExposure)}function C(a,b){a.envMap&&
(a.envMap.needsUpdate=b);a.irradianceMap&&(a.irradianceMap.needsUpdate=b);a.envMapExposure&&(a.envMapExposure.needsUpdate=b)}function N(a,b){a.ambientLightColor.needsUpdate=b;a.directionalLightColor.needsUpdate=b;a.directionalLightDirection.needsUpdate=b;a.pointLightColor.needsUpdate=b;a.pointLightPosition.needsUpdate=b;a.pointLightDistance.needsUpdate=b;a.spotLightColor.needsUpdate=b;a.spotLightPosition.needsUpdate=b;a.spotLightDistance.needsUpdate=b;a.spotLightDirection.needsUpdate=b;a.spotLightAngleCos.needsUpdate=
b;a.spotLightExponent.needsUpdate=b;a.hemisphereLightSkyColor.needsUpdate=b;a.hemisphereLightGroundColor.needsUpdate=b;a.hemisphereLightDirection.needsUpdate=b}function K(){var a=Ba;a>=wb&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+wb);Ba+=1;return a}function R(a,b,c,d){a[b]=c.r*c.r*d;a[b+1]=c.g*c.g*d;a[b+2]=c.b*c.b*d}function T(a,b,c,d){a[b]=c.r*d;a[b+1]=c.g*d;a[b+2]=c.b*d}function ba(a){var b,c,d,f=0,g=0,h=0,k,l,m,n=ib,q=n.directional.colors,p=
n.directional.positions,t=n.point.colors,N=n.point.positions,w=n.point.distances,v=n.spot.colors,z=n.spot.positions,B=n.spot.distances,K=n.spot.directions,F=n.spot.anglesCos,r=n.spot.exponents,ca=n.hemi.skyColors,A=n.hemi.groundColors,ea=n.hemi.positions,Q=0,ha=0,G=0,C=0,ma=0,D=0,ga=0,H=0,E=d=0;b=m=E=0;for(c=a.length;b<c;b++)d=a[b],d.onlyShadow||(k=d.color,l=d.intensity,m=d.distance,d instanceof THREE.AmbientLight?d.visible&&(aa.gammaInput?(f+=k.r*k.r,g+=k.g*k.g,h+=k.b*k.b):(f+=k.r,g+=k.g,h+=k.b)):
d instanceof THREE.DirectionalLight?(ma+=1,d.visible&&(xa.setFromMatrixPosition(d.matrixWorld),na.setFromMatrixPosition(d.target.matrixWorld),xa.sub(na),xa.normalize(),d=3*Q,p[d]=xa.x,p[d+1]=xa.y,p[d+2]=xa.z,aa.gammaInput?R(q,d,k,l*l):T(q,d,k,l),Q+=1)):d instanceof THREE.PointLight?(D+=1,d.visible&&(E=3*ha,aa.gammaInput?R(t,E,k,l*l):T(t,E,k,l),na.setFromMatrixPosition(d.matrixWorld),N[E]=na.x,N[E+1]=na.y,N[E+2]=na.z,w[ha]=m,ha+=1)):d instanceof THREE.SpotLight?(ga+=1,d.visible&&(E=3*G,aa.gammaInput?
R(v,E,k,l*l):T(v,E,k,l),na.setFromMatrixPosition(d.matrixWorld),z[E]=na.x,z[E+1]=na.y,z[E+2]=na.z,B[G]=m,xa.copy(na),na.setFromMatrixPosition(d.target.matrixWorld),xa.sub(na),xa.normalize(),K[E]=xa.x,K[E+1]=xa.y,K[E+2]=xa.z,F[G]=Math.cos(d.angle),r[G]=d.exponent,G+=1)):d instanceof THREE.HemisphereLight&&(H+=1,d.visible&&(xa.setFromMatrixPosition(d.matrixWorld),xa.normalize(),m=3*C,ea[m]=xa.x,ea[m+1]=xa.y,ea[m+2]=xa.z,k=d.color,d=d.groundColor,aa.gammaInput?(l*=l,R(ca,m,k,l),R(A,m,d,l)):(T(ca,m,k,
l),T(A,m,d,l)),C+=1)));b=3*Q;for(c=Math.max(q.length,3*ma);b<c;b++)q[b]=0;b=3*ha;for(c=Math.max(t.length,3*D);b<c;b++)t[b]=0;b=3*G;for(c=Math.max(v.length,3*ga);b<c;b++)v[b]=0;b=3*C;for(c=Math.max(ca.length,3*H);b<c;b++)ca[b]=0;b=3*C;for(c=Math.max(A.length,3*H);b<c;b++)A[b]=0;n.directional.length=Q;n.point.length=ha;n.spot.length=G;n.hemi.length=C;n.ambient[0]=f;n.ambient[1]=g;n.ambient[2]=h}function X(a,b,c){ab!==a&&(a?r.enable(r.POLYGON_OFFSET_FILL):r.disable(r.POLYGON_OFFSET_FILL),ab=a);!a||Ka===
b&&Pa===c||(r.polygonOffset(b,c),Ka=b,Pa=c)}function Y(a,b,c){c?(r.texParameteri(a,r.TEXTURE_WRAP_S,O(b.wrapS)),r.texParameteri(a,r.TEXTURE_WRAP_T,O(b.wrapT)),r.texParameteri(a,r.TEXTURE_MAG_FILTER,O(b.magFilter)),r.texParameteri(a,r.TEXTURE_MIN_FILTER,O(b.minFilter))):(r.texParameteri(a,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(a,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(a,r.TEXTURE_MAG_FILTER,U(b.magFilter)),r.texParameteri(a,r.TEXTURE_MIN_FILTER,U(b.minFilter)));(c=ia.get("EXT_texture_filter_anisotropic"))&&
b.type!==THREE.FloatType&&(1<b.anisotropy||b.__oldAnisotropy)&&(r.texParameterf(a,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.anisotropy,aa.getMaxAnisotropy())),b.__oldAnisotropy=b.anisotropy)}function W(a,b){if(a.width<=b&&a.height<=b)return a;var c=Math.max(a.width,a.height),d=Math.floor(a.width*b/c),c=Math.floor(a.height*b/c),f=document.createElement("canvas");f.width=d;f.height=c;f.getContext("2d").drawImage(a,0,0,a.width,a.height,0,0,d,c);return f}function U(a){return a===THREE.NearestFilter||a===
THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?r.NEAREST:r.LINEAR}function O(a){var b;if(a===THREE.RepeatWrapping)return r.REPEAT;if(a===THREE.ClampToEdgeWrapping)return r.CLAMP_TO_EDGE;if(a===THREE.MirroredRepeatWrapping)return r.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return r.NEAREST;if(a===THREE.NearestMipMapNearestFilter)return r.NEAREST_MIPMAP_NEAREST;if(a===THREE.NearestMipMapLinearFilter)return r.NEAREST_MIPMAP_LINEAR;if(a===THREE.LinearFilter)return r.LINEAR;if(a===
THREE.LinearMipMapNearestFilter)return r.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return r.LINEAR_MIPMAP_LINEAR;if(a===THREE.UnsignedByteType)return r.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return r.UNSIGNED_SHORT_4_4_4_4;if(a===THREE.UnsignedShort5551Type)return r.UNSIGNED_SHORT_5_5_5_1;if(a===THREE.UnsignedShort565Type)return r.UNSIGNED_SHORT_5_6_5;if(a===THREE.ByteType)return r.BYTE;if(a===THREE.ShortType)return r.SHORT;if(a===THREE.UnsignedShortType)return r.UNSIGNED_SHORT;
if(a===THREE.IntType)return r.INT;if(a===THREE.UnsignedIntType)return r.UNSIGNED_INT;if(a===THREE.FloatType)return r.FLOAT;if(a===THREE.HalfFloatType)return 36193;if(a===THREE.AlphaFormat)return r.ALPHA;if(a===THREE.RGBFormat)return r.RGB;if(a===THREE.RGBAFormat)return r.RGBA;if(a===THREE.LuminanceFormat)return r.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return r.LUMINANCE_ALPHA;if(a===THREE.AddEquation)return r.FUNC_ADD;if(a===THREE.SubtractEquation)return r.FUNC_SUBTRACT;if(a===THREE.ReverseSubtractEquation)return r.FUNC_REVERSE_SUBTRACT;
if(a===THREE.ZeroFactor)return r.ZERO;if(a===THREE.OneFactor)return r.ONE;if(a===THREE.SrcColorFactor)return r.SRC_COLOR;if(a===THREE.OneMinusSrcColorFactor)return r.ONE_MINUS_SRC_COLOR;if(a===THREE.SrcAlphaFactor)return r.SRC_ALPHA;if(a===THREE.OneMinusSrcAlphaFactor)return r.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return r.DST_ALPHA;if(a===THREE.OneMinusDstAlphaFactor)return r.ONE_MINUS_DST_ALPHA;if(a===THREE.DstColorFactor)return r.DST_COLOR;if(a===THREE.OneMinusDstColorFactor)return r.ONE_MINUS_DST_COLOR;
if(a===THREE.SrcAlphaSaturateFactor)return r.SRC_ALPHA_SATURATE;b=ia.get("WEBGL_compressed_texture_s3tc");if(null!==b){if(a===THREE.RGB_S3TC_DXT1_Format)return b.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT1_Format)return b.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT3_Format)return b.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return b.COMPRESSED_RGBA_S3TC_DXT5_EXT}b=ia.get("WEBGL_compressed_texture_pvrtc");if(null!==b){if(a===THREE.RGB_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
if(a===THREE.RGB_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===THREE.RGBA_PVRTC_4BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===THREE.RGBA_PVRTC_2BPPV1_Format)return b.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}b=ia.get("EXT_blend_minmax");if(null!==b){if(a===THREE.MinEquation)return b.MIN_EXT;if(a===THREE.MaxEquation)return b.MAX_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);a=a||{};var da=void 0!==a.canvas?a.canvas:document.createElement("canvas"),V=void 0!==
a.precision?a.precision:"highp",M=void 0!==a.alpha?a.alpha:!1,la=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,ga=void 0!==a.antialias?a.antialias:!1,ja=void 0!==a.stencil?a.stencil:!0,Z=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!0,ea=void 0!==a.logarithmicDepthBuffer?a.logarithmicDepthBuffer:!1,ca=new THREE.Color(0),Q=0,ha=[],ma={},La=[],Fa=new THREE.Matrix4,Wa=new THREE.Matrix3,Ia=[],ua=[];this.domElement=da;this.context=null;this.devicePixelRatio=void 0!==self.devicePixelRatio?
self.devicePixelRatio:1;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.gammaOutput=this.gammaInput=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};
var aa=this,Aa=[],Na=null,Da=null,ta=-1,Ja=null,za="";new THREE.Frustum;new THREE.Matrix4;new THREE.Matrix4;var Ba=0,ka=-1,oa=-1,fa=-1,qa=-1,wa=-1,ya=-1,Oa=-1,Ca=-1,ab=null,Ka=null,Pa=null,bb=null,Xa=0,Ya=0,Ra=da.width,Sa=da.height,Za=new Uint8Array(16),Qa=new Uint8Array(16),cb={},fb=new THREE.Frustum,eb=new THREE.Matrix4,gb=new THREE.Matrix4,na=new THREE.Vector3,xa=new THREE.Vector3,db=!0,ib={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},
spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},r,Va,Ha,Ga;try{var Ta={alpha:M,premultipliedAlpha:la,antialias:ga,stencil:ja,preserveDrawingBuffer:Z};r=da.getContext("webgl",Ta)||da.getContext("experimental-webgl",Ta);if(null===r){if(null!==da.getContext("webgl"))throw"Error creating WebGL context with your selected attributes.";throw"Error creating WebGL context.";}da.addEventListener("webglcontextlost",
function(a){a.preventDefault();vb();ob();ma={}},!1)}catch(Ua){console.error(Ua)}void 0===r.getShaderPrecisionFormat&&(r.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});var ia=new THREE.WebGLExtensions(r);ia.get("OES_texture_float");ia.get("OES_texture_float_linear");ia.get("OES_texture_half_float");ia.get("OES_texture_half_float_linear");ia.get("OES_standard_derivatives");ia.get("EXT_shader_texture_lod");ia.get("EXT_texture_filter_anisotropic");ia.get("WEBGL_compressed_texture_s3tc");
Va=ia.get("WEBGL_draw_buffers");Ha=null;Ga=ia.get("OES_vertex_array_object");ea&&ia.get("EXT_frag_depth");var ob=function(){r.clearColor(0,0,0,1);r.clearDepth(1);r.clearStencil(0);r.enable(r.DEPTH_TEST);r.depthFunc(r.LEQUAL);r.frontFace(r.CCW);r.cullFace(r.BACK);r.enable(r.CULL_FACE);r.enable(r.BLEND);r.blendEquation(r.FUNC_ADD);r.blendFunc(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA);r.viewport(Xa,Ya,Ra,Sa);r.clearColor(ca.r,ca.g,ca.b,Q)},vb=function(){Ja=Na=null;oa=ka=Ca=Oa=fa=-1;za="";ta=-1;db=!0};ob();
this.context=r;var wb=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),Gb=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Hb=r.getParameter(r.MAX_TEXTURE_SIZE),Ib=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),pb=0<Gb;pb&&ia.get("OES_texture_float");var Jb=r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_FLOAT),Kb=r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_FLOAT);r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.LOW_FLOAT);var Nb=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT),Ob=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,
r.MEDIUM_FLOAT);r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.LOW_FLOAT);var Cb=function(){var a;return function(){if(void 0!==a)return a;a=[];if(ia.get("WEBGL_compressed_texture_pvrtc")||ia.get("WEBGL_compressed_texture_s3tc"))for(var b=r.getParameter(r.COMPRESSED_TEXTURE_FORMATS),c=0;c<b.length;c++)a.push(b[c]);return a}}(),Pb=0<Jb.precision&&0<Nb.precision,Db=0<Kb.precision&&0<Ob.precision;"highp"!==V||Pb||(Db?(V="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(V=
"lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"!==V||Db||(V="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return r};this.forceContextLoss=function(){ia.get("WEBGL_lose_context").loseContext()};this.supportsVertexTextures=function(){return pb};this.supportsFloatTextures=function(){return ia.get("OES_texture_float")};this.supportsHalfFloatTextures=function(){return ia.get("OES_texture_half_float_linear")};
this.supportsStandardDerivatives=function(){return ia.get("OES_standard_derivatives")};this.supportsCompressedTextureS3TC=function(){return ia.get("WEBGL_compressed_texture_s3tc")};this.supportsMRT=function(){return Va};this.supportsBlendMinMax=function(){return ia.get("EXT_blend_minmax")};this.getMaxAnisotropy=function(){var a;return function(){if(void 0!==a)return a;var b=ia.get("EXT_texture_filter_anisotropic");return a=null!==b?r.getParameter(b.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}}();this.getPrecision=
function(){return V};this.setSize=function(a,b,c){da.width=a*this.devicePixelRatio;da.height=b*this.devicePixelRatio;!1!==c&&(da.style.width=a+"px",da.style.height=b+"px");this.setViewport(0,0,a,b)};this.setViewport=function(a,b,c,d){Xa=a*this.devicePixelRatio;Ya=b*this.devicePixelRatio;Ra=c*this.devicePixelRatio;Sa=d*this.devicePixelRatio;r.viewport(Xa,Ya,Ra,Sa)};this.setScissor=function(a,b,c,d){r.scissor(a,b,c,d)};this.enableScissorTest=function(a){a?r.enable(r.SCISSOR_TEST):r.disable(r.SCISSOR_TEST)};
this.getClearColor=function(){return ca};this.setClearColor=function(a,b){ca.set(a);Q=void 0!==b?b:1;r.clearColor(ca.r,ca.g,ca.b,Q)};this.getClearAlpha=function(){return Q};this.setClearAlpha=function(a){Q=a;r.clearColor(ca.r,ca.g,ca.b,Q)};this.clear=function(a,b,c){var d=0;if(void 0===a||a)d|=r.COLOR_BUFFER_BIT;if(void 0===b||b)d|=r.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=r.STENCIL_BUFFER_BIT;r.clear(d)};this.clearColor=function(){r.clear(r.COLOR_BUFFER_BIT)};this.clearDepth=function(){r.clear(r.DEPTH_BUFFER_BIT)};
this.clearStencil=function(){r.clear(r.STENCIL_BUFFER_BIT)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.resetGLState=vb;this.updateShadowMap=function(a,b){Na=null;Ca=Oa=fa=-1;za="";ta=-1;db=!0;oa=ka=-1;initObjects(a)};var xb=function(a){a.target.traverse(function(a){a.removeEventListener("remove",xb);if(a instanceof THREE.Mesh||a instanceof THREE.PointCloud||a instanceof THREE.Line)delete ma[a.id];else if(a instanceof THREE.ImmediateRenderObject||a.immediateRenderCallback)for(var b=
La,c=b.length-1;0<=c;c--)b[c].object===a&&b.splice(c,1);delete a.__webglInit;delete a.__webglActive})},yb=function(a){a=a.target;a.removeEventListener("dispose",yb);a.__webglInit=void 0;if(a instanceof THREE.BufferGeometry){void 0!==a.vbbuffer&&r.deleteBuffer(a.vbbuffer);if(a.vaos)for(var b=0;b<a.vaos.length;b++)Ga.deleteVertexArrayOES(a.vaos[b].vao);a=a.attributes;for(var c in a)void 0!==a[c].buffer&&r.deleteBuffer(a[c].buffer);aa.info.memory.geometries--}else if(c=jb[a.id],void 0!==c){for(var b=
0,d=c.length;b<d;b++){var f=c[b];if(void 0!==f.numMorphTargets){for(var g=0,h=f.numMorphTargets;g<h;g++)r.deleteBuffer(f.__webglMorphTargetsBuffers[g]);delete f.__webglMorphTargetsBuffers}if(void 0!==f.numMorphNormals){g=0;for(h=f.numMorphNormals;g<h;g++)r.deleteBuffer(f.__webglMorphNormalsBuffers[g]);delete f.__webglMorphNormalsBuffers}Eb(f)}delete jb[a.id]}else Eb(a)},kb=function(a){a=a.target;a.removeEventListener("dispose",kb);a.image&&a.image.__webglTextureCube?r.deleteTexture(a.image.__webglTextureCube):
a.__webglInit&&(a.__webglInit=!1,r.deleteTexture(a.__webglTexture));aa.info.memory.textures--},Fb=function(a){a=a.target;a.removeEventListener("dispose",Fb);a&&a.__webglTexture&&(r.deleteTexture(a.__webglTexture),r.deleteFramebuffer(a.__webglFramebuffer),r.deleteRenderbuffer(a.__webglRenderbuffer));aa.info.memory.textures--},Bb=function(a){a=a.target;a.removeEventListener("dispose",Bb);Ab(a)},Eb=function(a){void 0!==a.__webglVertexBuffer&&r.deleteBuffer(a.__webglVertexBuffer);void 0!==a.__webglNormalBuffer&&
r.deleteBuffer(a.__webglNormalBuffer);void 0!==a.__webglTangentBuffer&&r.deleteBuffer(a.__webglTangentBuffer);void 0!==a.__webglColorBuffer&&r.deleteBuffer(a.__webglColorBuffer);void 0!==a.__webglUVBuffer&&r.deleteBuffer(a.__webglUVBuffer);void 0!==a.__webglUV2Buffer&&r.deleteBuffer(a.__webglUV2Buffer);void 0!==a.__webglSkinIndicesBuffer&&r.deleteBuffer(a.__webglSkinIndicesBuffer);void 0!==a.__webglSkinWeightsBuffer&&r.deleteBuffer(a.__webglSkinWeightsBuffer);void 0!==a.__webglFaceBuffer&&r.deleteBuffer(a.__webglFaceBuffer);
void 0!==a.__webglLineBuffer&&r.deleteBuffer(a.__webglLineBuffer);void 0!==a.__webglLineDistanceBuffer&&r.deleteBuffer(a.__webglLineDistanceBuffer);if(void 0!==a.__webglCustomAttributesList)for(var b in a.__webglCustomAttributesList)r.deleteBuffer(a.__webglCustomAttributesList[b].buffer);aa.info.memory.geometries--},Ab=function(a){var b=a.program.program;if(void 0!==b){a.program=void 0;var c,d,f=!1;a=0;for(c=Aa.length;a<c;a++)if(d=Aa[a],d.program===b){d.usedTimes--;0===d.usedTimes&&(f=!0);break}if(!0===
f){f=[];a=0;for(c=Aa.length;a<c;a++)d=Aa[a],d.program!==b&&f.push(d);Aa=f;r.deleteProgram(b);aa.info.memory.programs--}}};this.renderBufferDirect=function(a,b,c,d,f,h,m){if(!1!==d.visible){E(h);var n=J(a,b,c,d,h);a=n.attributes;c=f.attributes;b=!1;n="direct_"+f.id+"_"+n.id+"_"+(d.wireframe?1:0);n!==za&&(za=n,b=!0);if(m)m=!1;else a:{if(m=f.vaos)for(var q=0;q<m.length;q++)if(m[q].geomhash===n){Ga.bindVertexArrayOES(m[q].vao);m=!0;break a}m=null===m?!1:g(n,d,a,f)}(b=b&&!m)&&l();if(h instanceof THREE.Mesh)if(h=
c.index){q=h.array?h.array:f.ib;q instanceof Uint32Array&&ia.get("OES_element_index_uint")?(c=r.UNSIGNED_INT,n=4):(c=r.UNSIGNED_SHORT,n=2);var p=f.offsets;p&&1<p.length&&(b=!0);var t=0;do{var N,w,v;p&&p.length?(N=p[t].index,w=p[t].start,v=p[t].count):(w=N=0,v=q.length);b&&k(d,a,f,N,h);f.numInstances?Ha.drawElementsInstancedANGLE(f.isLines?r.LINES:r.TRIANGLES,v,c,w*n,f.numInstances):r.drawElements(f.isLines?r.LINES:r.TRIANGLES,v,c,w*n)}while(p&&++t<p.length)}else b&&k(d,a,f,N),d=f.attributes.position,
f.numInstances?Ha.drawArraysInstancedANGLE(f.isLines?r.LINE_STRIP:r.TRIANGLES,0,d.array.length/3,f.numInstances):r.drawArrays(f.isLines?r.LINE_STRIP:r.TRIANGLES,0,d.array.length/3);else console.log("Only THREE.Mesh can be rendered by the Firefly renderer. Use THREE.Mesh to draw lines.");m&&Ga.bindVertexArrayOES(null)}};this.renderBuffer=function(a,b,c,d,f,g){if(!1!==d.visible){E(g);c=J(a,b,c,d,g);b=c.attributes;a=!1;c=f.id+"_"+c.id+"_"+(d.wireframe?1:0);c!==za&&(za=c,a=!0);a&&l();!d.morphTargets&&
0<=b.position&&a&&(r.bindBuffer(r.ARRAY_BUFFER,f.__webglVertexBuffer),n(b.position),r.vertexAttribPointer(b.position,3,r.FLOAT,!1,0,0));if(a){if(f.__webglCustomAttributesList){c=0;for(var h=f.__webglCustomAttributesList.length;c<h;c++){var k=f.__webglCustomAttributesList[c];0<=b[k.buffer.belongsToAttribute]&&(r.bindBuffer(r.ARRAY_BUFFER,k.buffer),n(b[k.buffer.belongsToAttribute]),r.vertexAttribPointer(b[k.buffer.belongsToAttribute],k.size,r.FLOAT,!1,0,0))}}0<=b.color&&(0<g.geometry.colors.length||
0<g.geometry.faces.length?(r.bindBuffer(r.ARRAY_BUFFER,f.__webglColorBuffer),n(b.color),r.vertexAttribPointer(b.color,3,r.FLOAT,!1,0,0)):d.defaultAttributeValues&&r.vertexAttrib3fv(b.color,d.defaultAttributeValues.color));0<=b.normal&&(r.bindBuffer(r.ARRAY_BUFFER,f.__webglNormalBuffer),n(b.normal),r.vertexAttribPointer(b.normal,3,r.FLOAT,!1,0,0));0<=b.tangent&&(r.bindBuffer(r.ARRAY_BUFFER,f.__webglTangentBuffer),n(b.tangent),r.vertexAttribPointer(b.tangent,4,r.FLOAT,!1,0,0));0<=b.uv&&(g.geometry.faceVertexUvs[0]?
(r.bindBuffer(r.ARRAY_BUFFER,f.__webglUVBuffer),n(b.uv),r.vertexAttribPointer(b.uv,2,r.FLOAT,!1,0,0)):d.defaultAttributeValues&&r.vertexAttrib2fv(b.uv,d.defaultAttributeValues.uv));0<=b.uv2&&(g.geometry.faceVertexUvs[1]?(r.bindBuffer(r.ARRAY_BUFFER,f.__webglUV2Buffer),n(b.uv2),r.vertexAttribPointer(b.uv2,2,r.FLOAT,!1,0,0)):d.defaultAttributeValues&&r.vertexAttrib2fv(b.uv2,d.defaultAttributeValues.uv2));0<=b.lineDistance&&(r.bindBuffer(r.ARRAY_BUFFER,f.__webglLineDistanceBuffer),n(b.lineDistance),
r.vertexAttribPointer(b.lineDistance,1,r.FLOAT,!1,0,0))}q();g instanceof THREE.Mesh?(g=f.__typeArray===Uint32Array?r.UNSIGNED_INT:r.UNSIGNED_SHORT,d.wireframe?(d=d.wireframeLinewidth,d!==bb&&(r.lineWidth(d),bb=d),a&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,f.__webglLineBuffer),r.drawElements(r.LINES,f.__webglLineCount,g,0)):(a&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,f.__webglFaceBuffer),r.drawElements(r.TRIANGLES,f.__webglFaceCount,g,0))):g instanceof THREE.Line&&(g=g.mode===THREE.LineStrip?r.LINE_STRIP:
r.LINES,d=d.linewidth,d!==bb&&(r.lineWidth(d),bb=d),r.drawArrays(g,0,f.__webglLineCount))}};this.render=function(a,b,c,d,f){if(!1===b instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{za="";ta=-1;Ja=null;void 0!==f&&(ha.length=0,db=!0);var g=a.fog;!0===a.autoUpdate&&a.updateMatrixWorld();void 0===b.parent&&b.updateMatrixWorld();b.matrixWorldInverse.getInverse(b.matrixWorld);b.worldUpTransform?gb.multiplyMatrices(b.worldUpTransform,
b.matrixWorld):gb.copy(b.matrixWorld);eb.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);fb.setFromMatrix(eb);var h=a instanceof RenderBatch&&a.renderImmediate;h||(Ia.length=0,ua.length=0,F(a,!0===aa.sortObjects,!0===a.forceVisible),!0===aa.sortObjects&&(Ia.sort(p),ua.sort(m)));db&&(f&&f.length&&(ha=f.slice()),ba(ha));this.resetGLState();this.setRenderTarget(c);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);a.overrideMaterial?(d=a.overrideMaterial,
this.setBlending(d.blending,d.blendEquation,d.blendSrc,d.blendDst),this.setDepthTest(d.depthTest),this.setDepthWrite(d.depthWrite),X(d.polygonOffset,d.polygonOffsetFactor,d.polygonOffsetUnits),h?(g=ha,qb=b,rb=g,mb=!0,lb=d,a.forEach(z,128,!1)):(B(Ia,b,ha,g,!0,d),B(ua,b,ha,g,!0,d))):(d=null,this.setBlending(THREE.NoBlending),h?(g=ha,h=a.sortObjects,qb=b,rb=g,mb=h,lb=d,a.forEach(z,128,!1)):(B(Ia,b,ha,g,!1,d),B(ua,b,ha,g,!0,d)));this.resetGLState();c&&c.generateMipmaps&&c.minFilter!==THREE.NearestFilter&&
c.minFilter!==THREE.LinearFilter&&(r.bindTexture(r.TEXTURE_2D,c.__webglTexture),r.generateMipmap(r.TEXTURE_2D),r.bindTexture(r.TEXTURE_2D,null));this.setDepthTest(!0);this.setDepthWrite(!0)}};var qb,rb,Lb,mb,lb,jb={},zb=0,Mb={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"firefly_phong",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointCloudMaterial:"particle_basic"};this.setFaceCulling=function(a,b){a===THREE.CullFaceNone?
r.disable(r.CULL_FACE):(b===THREE.FrontFaceDirectionCW?r.frontFace(r.CW):r.frontFace(r.CCW),a===THREE.CullFaceBack?r.cullFace(r.BACK):a===THREE.CullFaceFront?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK),r.enable(r.CULL_FACE))};this.setMaterialFaces=function(a){var b=a.side===THREE.DoubleSide;a=a.side===THREE.BackSide;ka!==b&&(b?r.disable(r.CULL_FACE):r.enable(r.CULL_FACE),ka=b);oa!==a&&(a?r.frontFace(r.CW):r.frontFace(r.CCW),oa=a)};this.setDepthTest=function(a){Oa!==a&&(a?r.enable(r.DEPTH_TEST):
r.disable(r.DEPTH_TEST),Oa=a)};this.setDepthWrite=function(a){Ca!==a&&(r.depthMask(a),Ca=a)};this.setBlending=function(a,b,c,d){a!==fa&&(a===THREE.NoBlending?r.disable(r.BLEND):a===THREE.AdditiveBlending?(r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.SRC_ALPHA,r.ONE)):a===THREE.SubtractiveBlending?(r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ZERO,r.ONE_MINUS_SRC_COLOR)):a===THREE.MultiplyBlending?(r.enable(r.BLEND),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ZERO,r.SRC_COLOR)):
a===THREE.CustomBlending?r.enable(r.BLEND):(r.enable(r.BLEND),r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD),r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA)),fa=a);if(a===THREE.CustomBlending){if(b!==qa&&(r.blendEquation(O(b)),qa=b),c!==wa||d!==ya)r.blendFunc(O(c),O(d)),wa=c,ya=d}else ya=wa=qa=null};this.uploadTexture=function(a){void 0===a.__webglInit&&(a.__webglInit=!0,a.addEventListener("dispose",kb),a.__webglTexture=r.createTexture(),aa.info.memory.textures++);
r.bindTexture(r.TEXTURE_2D,a.__webglTexture);r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,a.flipY);r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);r.pixelStorei(r.UNPACK_ALIGNMENT,a.unpackAlignment);a.image=W(a.image,Hb);var b=a.image,c=THREE.Math.isPowerOfTwo(b.width)&&THREE.Math.isPowerOfTwo(b.height),d=O(a.format),f=O(a.type);Y(r.TEXTURE_2D,a,c);var g=a.mipmaps;if(a instanceof THREE.DataTexture)if(0<g.length&&c){for(var h=0,k=g.length;h<k;h++)b=g[h],r.texImage2D(r.TEXTURE_2D,h,d,b.width,
b.height,0,d,f,b.data);a.generateMipmaps=!1}else r.texImage2D(r.TEXTURE_2D,0,d,b.width,b.height,0,d,f,b.data);else if(a instanceof THREE.CompressedTexture)for(h=0,k=g.length;h<k;h++)b=g[h],a.format!==THREE.RGBAFormat&&a.format!==THREE.RGBFormat?-1<Cb().indexOf(d)?r.compressedTexImage2D(r.TEXTURE_2D,h,d,b.width,b.height,0,b.data):console.warn("Attempt to load unsupported compressed texture format"):r.texImage2D(r.TEXTURE_2D,h,d,b.width,b.height,0,d,f,b.data);else if(0<g.length&&c){h=0;for(k=g.length;h<
k;h++)b=g[h],r.texImage2D(r.TEXTURE_2D,h,d,d,f,b);a.generateMipmaps=!1}else r.texImage2D(r.TEXTURE_2D,0,d,d,f,a.image);a.generateMipmaps&&c&&r.generateMipmap(r.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()};this.setTexture=function(a,b){r.activeTexture(r.TEXTURE0+b);a.needsUpdate?aa.uploadTexture(a):r.bindTexture(r.TEXTURE_2D,a.__webglTexture)};this.initFrameBufferMRT=function(a,b){var c=a[0],d=!1;if(c&&!c.__webglFramebuffer){void 0===c.depthBuffer&&(c.depthBuffer=!0);void 0===c.stencilBuffer&&
(c.stencilBuffer=!0);c.__webglFramebuffer=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,c.__webglFramebuffer);var f;c.shareDepthFrom?f=c.__webglRenderbuffer=c.shareDepthFrom.__webglRenderbuffer:c.depthBuffer&&!c.stencilBuffer?(f=c.__webglRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,f),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_COMPONENT16,c.width,c.height)):c.depthBuffer&&c.stencilBuffer&&(f=c.__webglRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,
f),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,c.width,c.height));c.depthBuffer&&!c.stencilBuffer?r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.RENDERBUFFER,f):c.depthBuffer&&c.stencilBuffer&&r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,f);d=!0}f=Da;r.bindFramebuffer(r.FRAMEBUFFER,c.__webglFramebuffer);for(var g=0;g<a.length;g++){var h=a[g];if(!h.__webglTexture){var k=THREE.Math.isPowerOfTwo(h.width)&&THREE.Math.isPowerOfTwo(h.height),l=
O(h.format),m=O(h.type);h.addEventListener("dispose",Fb);h.__webglTexture=r.createTexture();aa.info.memory.textures++;r.bindTexture(r.TEXTURE_2D,h.__webglTexture);Y(r.TEXTURE_2D,h,k);r.texImage2D(r.TEXTURE_2D,0,l,h.width,h.height,0,l,m,null);k&&h.generateMipmaps&&r.generateMipmap(r.TEXTURE_2D)}r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+g,r.TEXTURE_2D,h.__webglTexture,0)}if(Va){h=[Va.COLOR_ATTACHMENT0_WEBGL];for(g=1;g<a.length;g++)h.push(Va.COLOR_ATTACHMENT0_WEBGL+g);Va.drawBuffersWEBGL(h)}b&&
(g=r.checkFramebufferStatus(r.FRAMEBUFFER),g!==r.FRAMEBUFFER_COMPLETE&&(console.log("Can't use multiple render targets. Falling back to two passes. "+g),delete c.__webglFramebuffer,b=!1));r.bindFramebuffer(r.FRAMEBUFFER,f);d&&(r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindFramebuffer(r.FRAMEBUFFER,null));return b};this.setRenderTarget=function(a){var b;Array.isArray(a)?(this.initFrameBufferMRT(a),b=a[0]):a&&(this.initFrameBufferMRT([a]),b=a);var c,d,f;b?(a=b.__webglFramebuffer,
c=b.width,b=b.height,f=d=0):(a=null,c=Ra,b=Sa,d=Xa,f=Ya);a!==Da&&(r.bindFramebuffer(r.FRAMEBUFFER,a),r.viewport(d,f,c,b),Da=a)};this.readPixels=function(a,b,c,d,f,g){this.setRenderTarget(a);r.readPixels(b,c,d,f,r.RGBA,r.UNSIGNED_BYTE,g)};this.verifyMRTWorks=function(a){return Va?this.initFrameBufferMRT(a,!0):!1}};AutodeskNamespace("Autodesk.Viewing.Private");
(function(){function a(a){d[0]=a;var b=g[0];a=0;if(0==(b&2147483647))k[a++]=b>>16;else{var c=b&2147483648,f=b&2139095040,b=b&8388607;if(0==f)k[a++]=c>>16;else if(2139095040==f)0==b?k[a++]=c>>16|31744:k[a++]=65024;else{var l=c>>16,f=(0|f>>23)-127+15;31<=f?k[a++]=c>>16|31744:0>=f?(24<14-f?c=0:(b|=8388608,h[0]=b>>14-f,c=h[0],b>>13-f&1&&(c+=1)),k[a++]=l|c):(h[0]=f<<10,f=h[0],h[0]=b>>13,c=h[0],b&4096?k[a++]=(l|f|c)+1:k[a++]=l|f|c)}}return k[0]}var b=Autodesk.Viewing.Private;b.BackgroundPresets={"Fusion Grey":[230,
230,230,150,150,150],"Sky Blue":[226,244,255,156,172,180],Midnight:[41,76,120,1,2,3],White:[255,255,255,255,255,255],AutoCADModel:[30,40,48,30,40,48],"Dark Grey":[51,51,51,51,51,51],"Infinity Pool":[164,175,179,164,175,179],Tranquility:[0,84,166,0,84,166],"Grey Room":[129,129,129,129,129,129],"Photo Booth":[237,237,237,237,237,237],"RaaS SBS":[1,1,1,90,90,90],Plaza:[79,102,130,79,102,130],Custom:[230,230,230,150,150,150]};var c=b.BackgroundPresets;b.LightPresets=[{name:"Simple Grey",path:null,tonemap:0,
E_bias:0,directLightColor:[1,.84,.67],ambientColor:[.8,.9,1],lightMultiplier:1,bgColorGradient:c["Fusion Grey"],darkerFade:!1},{name:"Sharp Highlights",path:"SharpHighlights",type:"logluv",tonemap:1,E_bias:-7.145705069544681,directLightColor:[.5,.5,.5],ambientColor:[.03125,.03125,.03125],lightMultiplier:0,bgColorGradient:c["Photo Booth"],darkerFade:!0},{name:"Dark Sky",path:"DarkSky",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.03125,.03125,.03125],lightMultiplier:1,lightDirection:[.1,
-.55,-1],bgColorGradient:c["Dark Grey"],darkerFade:!1},{name:"Grey Room",path:"GreyRoom",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.03125,.03125,.03125],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c["Grey Room"],darkerFade:!0},{name:"Photo Booth",path:"PhotoBooth",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],ambientColor:[.03125,.03125,.03125],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c["Photo Booth"],darkerFade:!0},
{name:"Tranquility",path:"TranquilityBlue",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,1,1],ambientColor:[.03125,.03125,.03125],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c.Tranquility,darkerFade:!1},{name:"Infinity Pool",path:"InfinityPool",type:"logluv",tonemap:1,E_bias:-1,directLightColor:[1,.84,.67],ambientColor:[.03125,.03125,.03125],lightMultiplier:.5,lightDirection:[.1,-.55,-1],bgColorGradient:c["Infinity Pool"],darkerFade:!1},{name:"Simple White",path:null,tonemap:0,
E_bias:0,directLightColor:[1,1,1],ambientColor:[.9,.9,.9],lightMultiplier:1,bgColorGradient:c.White,saoRadius:.06,saoIntensity:.15,darkerFade:!0},{name:"Riverbank",path:"riverbank",type:"logluv",tonemap:1,E_bias:-5.7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],darkerFade:!1},{name:"Contrast",path:"IDViz",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Midnight,darkerFade:!1},{name:"Rim Highlights",path:"RimHighlights",type:"logluv",
tonemap:1,E_bias:-8.133084111281999,directLightColor:[.5,.5,.5],ambientColor:[.03125,.03125,.03125],lightMultiplier:0,bgColorGradient:c["Photo Booth"],darkerFade:!0},{name:"Cool Light",path:"CoolLight",type:"logluv",tonemap:1,E_bias:-8.152868970258611,directLightColor:[1,1,1],ambientColor:[.03125,.03125,.03125],lightMultiplier:0,bgColorGradient:c["Fusion Grey"],darkerFade:!0},{name:"Warm Light",path:"WarmLight",type:"logluv",tonemap:1,E_bias:-8.152965210880433,directLightColor:[1,1,1],ambientColor:[.03125,
.03125,.03125],lightMultiplier:0,bgColorGradient:c["Fusion Grey"],darkerFade:!0},{name:"Soft Light",path:"SoftLight",type:"logluv",tonemap:1,E_bias:-8.092194064376047,directLightColor:[1,1,1],ambientColor:[.03125,.03125,.03125],lightMultiplier:0,bgColorGradient:c["Fusion Grey"],darkerFade:!0},{name:"Grid Light",path:"GridLight",type:"logluv",tonemap:1,E_bias:-7.8601965561109175,directLightColor:[1,1,1],ambientColor:[.03125,.03125,.03125],lightMultiplier:0,bgColorGradient:c["Fusion Grey"],darkerFade:!0},
{name:"Plaza",path:"Plaza",type:"logluv",tonemap:1,E_bias:-13,directLightColor:[.9,.9,1],ambientColor:[.03125,.03125,.03125],lightMultiplier:0,bgColorGradient:c.Plaza,darkerFade:!1},{name:"Snow Field",path:"SnowField",type:"logluv",tonemap:1,E_bias:-11.5,directLightColor:[1,1,1],ambientColor:[.03125,.03125,.03125],lightMultiplier:0,bgColorGradient:c["Sky Blue"],darkerFade:!1}];b.DebugEnvironments=[{name:"Field",path:"field",type:"logluv",tonemap:1,E_bias:-2.9,directLightColor:[1,1,1],lightMultiplier:0,
bgColorGradient:c["Sky Blue"],darkerFade:!1},{name:"Crossroads",path:"crossroads",type:"logluv",tonemap:1,E_bias:-5.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],darkerFade:!1},{name:"Seaport",path:"seaport",type:"logluv",tonemap:1,E_bias:-6.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],darkerFade:!1},{name:"Glacier",path:"glacier",type:"logluv",tonemap:1,E_bias:0,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c.Midnight,darkerFade:!1},
{name:"Boardwalk",path:"boardwalk",type:"logluv",tonemap:1,E_bias:-7,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["Sky Blue"],darkerFade:!1},{name:"RaaS Test Env",path:"Reflection",type:"logluv",tonemap:2,E_bias:-1.5,directLightColor:[1,1,1],lightMultiplier:0,bgColorGradient:c["RaaS SBS"],darkerFade:!1}];ENABLE_DEBUG&&(b.LightPresets=b.LightPresets.concat(b.DebugEnvironments));b.CreateCubeMapFromColors=function(a,b){for(var c=255*a.x,d=255*a.y,f=255*a.z,g=255*b.x,h=255*b.y,k=255*b.z,
l=new Uint8Array(16),n=new Uint8Array(16),G=new Uint8Array(16),A=0;4>A;A++)l[4*A]=c,l[4*A+1]=d,l[4*A+2]=f,l[4*A+3]=255,n[4*A]=g,n[4*A+1]=h,n[4*A+2]=k,n[4*A+3]=255,0|A/2?(G[4*A]=c,G[4*A+1]=d,G[4*A+2]=f):(G[4*A]=g,G[4*A+1]=h,G[4*A+2]=k),G[4*A+3]=255;c=new THREE.DataTexture(G,2,2,THREE.RGBAFormat);d=new THREE.DataTexture(G,2,2,THREE.RGBAFormat);n=new THREE.DataTexture(n,2,2,THREE.RGBAFormat);l=new THREE.DataTexture(l,2,2,THREE.RGBAFormat);f=new THREE.DataTexture(G,2,2,THREE.RGBAFormat);G=new THREE.DataTexture(G,
2,2,THREE.RGBAFormat);g=new THREE.Texture(null,THREE.CubeReflectionMapping,THREE.RepeatWrapping,THREE.RepeatWrapping,THREE.LinearFilter,THREE.LinearFilter,THREE.RGBAFormat);g.image=[d,c,l,n,G,f];g.needsUpdate=!0;return g};var f=[6.0014,-2.7008,-1.7996,-1.332,3.1029,-5.7721,.3008,-1.0882,5.6268],d=new Float32Array(1),g=new Uint32Array(d.buffer),h=new Uint16Array(1),k=new Uint16Array(1),l=new Float32Array(4),n=new Float32Array(4);b.DecodeEnvMap=function(b,c,d){if(b.LogLuv){c=Math.pow(2,c);for(var g=
Array.isArray(b.image)?b.image:[k],h=0;h<g.length;h++)for(var k=g[h],w=0;w<k.mipmaps.length;w++){var F=k.mipmaps[w],B=F.data,z;d?(z=new Uint16Array(B.length/4*3),F.data=z):z=B.buffer;for(var G=F=0;G<B.length;G+=4){l[0]=B[G]/255;l[1]=B[G+1]/255;l[2]=B[G+2]/255;l[3]=B[G+3]/255;var A=n,E=l,H=Math.pow(2,(255*E[2]+E[3]-127)/2),I=H/E[1],J=E[0]*I,E=f[0]*J+f[3]*H+f[6]*I,L=f[1]*J+f[4]*H+f[7]*I,H=f[2]*J+f[5]*H+f[8]*I;0>E&&(E=0);0>L&&(L=0);0>H&&(H=0);A[0]=E;A[1]=L;A[2]=H;d?(A=l,E=n,L=c,H=Math.sqrt(E[0]*L),I=
Math.sqrt(E[1]*L),E=Math.sqrt(E[2]*L),65504<H&&(H=65504),65504<I&&(I=65504),65504<E&&(E=65504),A[0]=H,A[1]=I,A[2]=E,z[F++]=a(l[0]),z[F++]=a(l[1]),z[F++]=a(l[2])):(A=l,E=n,L=c,H=.0625*Math.sqrt(E[0]*L),I=.0625*Math.sqrt(E[1]*L),E=.0625*Math.sqrt(E[2]*L),L=Math.max(Math.max(H,I),Math.max(E,1E-6)),1<L&&(L=1),L=Math.ceil(255*L)/255,1<H&&(H=1),1<I&&(I=1),1<E&&(E=1),A[3]=L,L=1/L,A[0]=H*L,A[1]=I*L,A[2]=E*L,B[G]=Math.round(255*l[0]),B[G+1]=Math.round(255*l[1]),B[G+2]=Math.round(255*l[2]),B[G+3]=Math.round(255*
l[3]))}}b.LogLuv=!1;d?(b.type=THREE.HalfFloatType,b.format=THREE.RGBFormat,b.RGBM=!1,b.GammaEncoded=!0):b.RGBM=!0}else stderr("Environment map expected to be in LogLuv format.")};b.DefaultLightPreset=8;b.DefaultLightPreset2d=0})();AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.MaterialManager=function(a){function b(a){if("http://"==a.substr(0,7)||"https://"==a.substr(0,8)||"file:///"==a.substr(0,8)||"urn:"==a.substr(0,4))return a;var b=window.location.pathname,c=b.lastIndexOf("/"),b=b.substr(0,c+1);return window.location.protocol+"//"+window.location.host+b+a}function c(a){return-1!=a.indexOf("__lineMaterial__")}function f(a,b){return c(b)?b:a.basePath+"|mat|"+b}function d(a,b,c){auth&&(-1!=a.indexOf("/items/")?THREE.ImageUtils.crossOrigin="use-credentials":
THREE.ImageUtils.crossOrigin="");return THREE.ImageUtils.loadTexture(a,b,c)}var g=Autodesk.Viewing.Private,h=this,k=this.materials={},l=this.materialsNonHDR={};this.textures={};this.irradianceMap=this.reflectionCube=this.layerMaskTex=null;var n=1,q=[];this.hasPrism=!1;var m=[],p=new THREE.Vector3(0,1,0);this.defaultMaterial=new THREE.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:THREE.SmoothShading,reflectivity:0});this.findMaterial=function(a,b){var c=k[f(a,
b)];c||(stderr("Unknown material "+b+". Using default."),c=this.defaultMaterial);return c};this.convertMaterials=function(a){if(a.materials){var b=a.materials.materials,c;for(c in b){var d=a.simplemats[c],g=f(a,c);if(d){var h=d.color=(new THREE.Color).copy(d.color),k=d.specular=(new THREE.Color).copy(d.specular),l=d.ambient=(new THREE.Color).copy(d.ambient),m=d.emissive=(new THREE.Color).copy(d.emissive);0==h.r&&0==h.g&&0==h.b&&0==k.r&&0==k.g&&0==k.b&&0==l.r&&0==l.g&&0==l.b&&0==m.r&&0==m.g&&0==m.b&&
(h.r=h.g=h.b=.4);h=new THREE.MeshPhongMaterial(d);h.proteinType=d.proteinType;h.proteinMat=b[c];h.tag=d.tag;h.metal=d.metal;h.packedNormals=!0;_isIE11||!d.doubleSided&&!a.doubleSided||(h.side=THREE.DoubleSide);for(var n in d)0===n.indexOf("uri_")&&(h[n]=d[n]),0===n.indexOf("uscale_")&&(h[n]=d[n]),0===n.indexOf("vscale_")&&(h[n]=d[n])}else h=new THREE.MeshPhongMaterial({ambient:197379,color:7829367,specular:3355443,shininess:30,shading:THREE.SmoothShading}),h.proteinMat=b[c];this.addMaterial(g,h)}}};
this.updateMaterials=function(){for(;q.length;)for(var b=q.pop(),c=0;c<b.mats.length;c++)b.mats[c][b.slot]=b.tex,b.mats[c].needsUpdate=!0,a.invalidate(!0,!1,!1)};this.resizeImage=function(a){var b=a.width,c=a.height;if(0===(b&b-1)&&0===(c&c-1))return a;for(var d=1;2*d<b;)d*=2;for(b=1;2*b<c;)b*=2;var c=document.createElement("canvas"),f=c.getContext("2d");c.width=d;c.height=b;f.drawImage(a,0,0,d,b);return c};this.loadTextures=function(c){var f=function(a){a.image=h.resizeImage(a.image);var b=h.textures[a.name];
if(b){for(var c=0;c<b.mats.length;c++)b.mats[c][b.slots[c]]=a;q.push(b)}},g;for(g in k){var l=k[g];if(l){var m=["map","bumpMap","specularMap","normalMap","alphaMap"];l.bumpScale&&1<=l.bumpScale&&(l.bumpScale=.03);for(var n=0;n<m.length;n++){var p=l["uri_"+m[n]];if(p){var p=p.replace(/\\/g,"/"),G=l.proteinType&&l.proteinType.length,A=G&&0===l.proteinType.indexOf("Prism"),E=(A&&PRISM_ROOT||G&&PROTEIN_ROOT)&&(0===p.indexOf("1/Mats")||0===p.indexOf("2/Mats")||0===p.indexOf("3/Mats")),G=c.basePath+p;if(h.textures[G])h.textures[G].mats.push(l),
h.textures[G].slots.push(m[n]);else{var H="envMap"==m[n],I=null;if(E)I=A?PRISM_ROOT+p:PROTEIN_ROOT+p;else{for(A=0;A<c.manifest.assets.length;++A)if(E=c.manifest.assets[A],E.id==p){I=b(c.basePath+E.URI);break}I||(I=b(G))}p=I.indexOf("urn:");-1!=p&&(I=I.substr(0,p)+encodeURIComponent(I.substr(p)),I+="?domain="+encodeURIComponent(window.location.origin),Autodesk.Viewing.ACM_SESSION_ID&&(I+="&acmsession="+Autodesk.Viewing.ACM_SESSION_ID));p=l["uscale_"+m[n]];A=l["vscale_"+m[n]];p||(p=1);A||(A=1);I=H?
d(I,THREE.SphericalReflectionMapping,f):d(I,THREE.UVMapping,f);I.name=G;h.textures[I.name]={mats:[l],slots:[m[n]],tex:I};"alphaMap"==m[n]&&(l.transparent=!0);I.anisotropy="bumpMap"==m[n]||"normalMap"==m[n]?0:a.renderer().getMaxAnisotropy();I.repeat.set(p,A);I.wrapS=THREE.RepeatWrapping;I.wrapT=THREE.RepeatWrapping;I.flipY=!H;H&&(c.envMap=I)}}}}}};this.create2DMaterial=function(b,c,g,l){var m="__lineMaterial__";c.image&&(m+="|image:"+c.image.name);c.clip&&(m+="|clip:"+JSON.stringify(c.clip));g&&(m+=
"|id");l&&(m+="|selection");c.skipEllipticals&&(m+="|skipEllipticals");c.skipCircles&&(m+="|skipCircles");c.skipTriangleGeoms&&(m+="|skipTriangleGeoms");c.useInstancing&&(m+="|useInstancing");b&&(m+="|"+b.basePath);m=f(null,m);if(!k.hasOwnProperty(m)){var n=new THREE.ShaderMaterial({fragmentShader:LineShader.fragmentShader,vertexShader:LineShader.vertexShader,uniforms:THREE.UniformsUtils.clone(LineShader.uniforms),attributes:LineShader.attributes,defines:THREE.UniformsUtils.clone(LineShader.defines),
transparent:!0});n.depthWrite=!1;n.depthTest=!1;n.side=THREE.DoubleSide;n.blending=THREE.NormalBlending;g?(n.defines.ID_COLOR=1,n.blending=THREE.NoBlending):l?n.defines.SELECTION_RENDERER=1:a.renderer().hasMRT()&&(n.defines.MRT_ID_BUFFER=1);c.skipEllipticals||(n.defines.HAS_ELLIPTICALS=1);c.skipCircles||(n.defines.HAS_CIRCLES=1);c.skipTriangleGeoms||(n.defines.HAS_TRIANGLE_GEOMS=1);c.useInstancing&&(n.defines.USE_INSTANCING=1);n.uniforms.tLayerMask.value=h.layerMaskTex;if(c.image){n.defines.HAS_RASTER_QUADS=
1;var q=this;d(c.image.dataURI,THREE.UVMapping,function(b){b.image=q.resizeImage(b.image);b.wrapS=THREE.ClampToEdgeWrapping;b.wrapT=THREE.ClampToEdgeWrapping;b.minFilter=THREE.LinearMipMapLinearFilter;b.magFilter=THREE.LinearFilter;b.anisotropy=1;b.flipY=!0;b.generateMipmaps=!0;b.needsUpdate=!0;n.uniforms.tRaster.value=b;-1!=c.image.dataURI.indexOf("png")&&(n.transparent=!0);n.needsUpdate=!0;a.invalidate(!1,!0,!1)})}k[m]=n}return m};this.addMaterial=function(b,c,d){function f(a){return.299*a.r+.587*
a.g+.114*a.b}var g=c.proteinMat?c.proteinMat:null,l=c.proteinType&&-1!=c.proteinType.indexOf("Prism");this.hasPrism=l||this.hasPrism;if(!d){if(c.metal){if(c.reflectivity||(c.reflectivity=f(c.specular)),g&&(1===c.reflectivity&&(c.reflectivity=f(c.specular)),0!==c.color.r||0!==c.color.g||0!==c.color.b))c.color.r*=.1,c.color.g*=.1,c.color.b*=.1}else g?l?(d=!1,"PrismLayered"==c.proteinType&&(c.clearcoat=!0,c.reflectivity=.06,g&&(g=g.materials[g.userassets[0]].categories)&&g.length&&-1!=g[0].indexOf("Metal")&&
(d=!0)),c.reflectivity=Math.sqrt(c.reflectivity),d?c.specular.copy(c.color):(c.specular.r=c.reflectivity,c.specular.g=c.reflectivity,c.specular.b=c.reflectivity)):(c.reflectivity||(c.reflectivity=.01+.06*f(c.specular)),c.specular.r*=c.reflectivity,c.specular.g*=c.reflectivity,c.specular.b*=c.reflectivity,1>c.opacity&&(c.reflectivity=1)):c.reflectivity?(c.metal=!0,c.specular.r=c.color.r*c.reflectivity,c.specular.g=c.color.g*c.reflectivity,c.specular.b=c.color.b*c.reflectivity,c.color.r*=.1,c.color.g*=
.1,c.color.b*=.1):1!==c.color.r||1!==c.color.g||1!==c.color.b||1!==c.specular.r||1!==c.specular.g||1!==c.specular.b||c.uri_map||c.uri_specularMap||(c.metal=!0,c.reflectivity=.7,c.specular.r=c.specular.g=c.specular.b=c.reflectivity,c.color.r*=.1,c.color.g*=.1,c.color.b*=.1);c.ambient.copy(c.color);if(c.transparent||c.uri_map&&-1!=c.uri_map.toLowerCase().indexOf(".png")||c.uri_opacityMap)c.alphaTest=.01}if(c.uri_normalMap){g=c.bumpScale;if(void 0===g||1<=g)g=1;c.normalScale=new THREE.Vector2(g,g)}else void 0===
c.bumpScale&&(c.uri_map||c.uri_bumpMap)?c.bumpScale=.03:1<=c.bumpScale&&(c.bumpScale=.03);c.shininess*=.25;h.reflectionCube&&(c.envMap=h.reflectionCube);h.irradianceMap&&(c.irradianceMap=h.irradianceMap);c.exposureBias=Math.pow(2,a.renderer().getExposureBias());c.tonemapOutput=a.renderer().getToneMapMethod();c.envMapExposure=n;a.renderer().applyMRTFlags(c);c.side==THREE.DoubleSide&&a.renderer().toggleTwoSided(!0);c.cutplanes=m;c.cutplanesOutlineColor=p;k[b]=c};this.addMaterialNonHDR=function(a,b){b.cutplanes=
m;b.cutplanesOutlineColor=p;l[a]=b};this.togglePolygonOffset=function(a){for(var b in k){var c=k[b];c instanceof THREE.MeshPhongMaterial&&(c.polygonOffset=!0,c.polygonOffsetFactor=a?1:0,c.polygonOffsetUnits=a?1:0,c.needsUpdate=!0)}};this.applyGeometryFlagsToMaterial=function(a,b){b.attributes.color&&(a.vertexColors=THREE.VertexColors,a.needsUpdate=!0);!a.proteinType&&b.attributes.uv&&b.attributes.uv.isPattern&&(a.map&&!a.bumpMap&&(a.bumpMap=a.map,a.needsUpdate=!0),a.uri_map&&!a.uri_bumpMap&&(a.uri_bumpMap=
a.uri_map,a.needsUpdate=!0))};this.toggleMRTSetting=function(){for(var b in k){var c=k[b];a.renderer().applyMRTFlags(c)}};this.updatePixelScale=function(a){var b=k,d;for(d in b)c(d)&&(b[d].uniforms.unitsPerPixel.value=1/a,b[d].uniforms.pixelsPerUnit.value=a)};this.setCubeMapFromColors=function(b,c){var d=g.CreateCubeMapFromColors(b,c);h.reflectionCube=d;h.reflectionCube.isBgColor=!0;for(var f in k){var l=k[f];l.envMap=d;l.needsUpdate=!0}a.invalidate(!0)};this.setCubeMap=function(b,c){var d=function(b){b&&
g.DecodeEnvMap(b,c);h.reflectionCube=b;if(h.reflectionCube)for(var d in k)b=k[d],b.envMap=h.reflectionCube,b.needsUpdate=!0;else h.setCubeMapFromColors(a.clearColorTop,a.clearColorBottom);a.invalidate(!0)};Array.isArray(b)?(h.reflectionCube=THREE.ImageUtils.loadTextureCube(b,THREE.CubeReflectionMapping,d),h.reflectionCube.format=THREE.RGBFormat):"string"==typeof b?-1!=b.toLowerCase().indexOf(".dds")?(h.reflectionCube=(new THREE.DDSLoader).load(b,d),h.reflectionCube.mapping=THREE.CubeReflectionMapping,
h.reflectionCube.LogLuv=-1!=b.indexOf("logluv"),h.reflectionCube.RGBM=-1!=b.indexOf("rgbm")):(h.reflectionCube=THREE.ImageUtils.loadTexture(b,THREE.SphericalReflectionMapping,d),h.reflectionCube.format=THREE.RGBFormat):b?d(b):d(null)};this.setIrradianceMap=function(b,c){var d=function(b){if(b){g.DecodeEnvMap(b,c);for(var d in k){var f=k[d];f.irradianceMap=b;f.needsUpdate=!0}h.irradianceMap=b}else if(h.irradianceMap){for(d in k)f=k[d],f.irradianceMap=null,f.needsUpdate=!0;h.irradianceMap=null}a.invalidate(!0)};
THREE.ImageUtils.crossOrigin="";Array.isArray(b)?(h.irradianceMap=THREE.ImageUtils.loadTextureCube(b,THREE.CubeReflectionMapping,d),h.irradianceMap.format=THREE.RGBFormat):"string"==typeof b?-1!=b.toLowerCase().indexOf(".dds")&&(h.irradianceMap=(new THREE.DDSLoader).load(b,d),h.irradianceMap.mapping=THREE.CubeReflectionMapping,h.irradianceMap.LogLuv=-1!=b.indexOf("logluv"),h.irradianceMap.RGBM=-1!=b.indexOf("rgbm")):b?d(b):d(null)};this.setTonemapMethod=function(a){for(var b in k){var c=k[b];c.tonemapOutput=
a;c.needsUpdate=!0}};this.setEnvExposure=function(a){n=a=Math.pow(2,a);for(var b in k){var c=k[b];c.envMapExposure=a;c.needsUpdate=!0}};this.setTonemapExposureBias=function(a){a=Math.pow(2,a);for(var b in k){var c=k[b];c.exposureBias=a;c.needsUpdate=!0}};this.initLayersTexture=function(a){for(var b=a.getData().layerCount,c=new Uint8Array(65536),d=0;d<b;d++)c[d]=255;b=new THREE.DataTexture(c,256,256,THREE.LuminanceFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,
THREE.NearestFilter,THREE.NearestFilter,0);b.generateMipmaps=!1;b.flipY=!1;b.needsUpdate=!0;this.layerMaskTex=b;this.layersMap=a.getData().layersMap};this.init2DSelectionMaterial=function(a){for(var b=a.myData.maxObjectNumber||1,c=0|Math.ceil(b/4096),d=1;d<c;)d*=2;for(var c=d,d=new Uint8Array(4096*c),f=0;f<b;f++)d[f]=0;b=new THREE.DataTexture(d,4096,c,THREE.LuminanceFormat,THREE.UnsignedByteType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter,
0);b.generateMipmaps=!1;b.flipY=!1;b.needsUpdate=!0;this.selectionTex=b;a=this.create2DMaterial(a.getData(),{},!1,!0);a=k[a];a.uniforms.tSelectionTexture.value=this.selectionTex;a.uniforms.vSelTexSize.value.set(4096,c);a.needsUpdate=!0;return a};this.setLayerVisible=function(b,d){for(var f=this.layerMaskTex,g=f.image.data,h=this.layersMap,l=d?255:0,m=0;m<b.length;++m)g[h[b[m]]]=l;f.needsUpdate=!0;for(var n in k)c(n)&&(k[n].needsUpdate=!0);a.invalidate(!0)};this.isLayerVisible=function(a){return!!this.layerMaskTex.image.data[this.layersMap[a]]};
this.highlightObject2D=function(b,c){this.selectionTex.image.data[b]=c?255:0;this.selectionTex.needsUpdate=!0;a.invalidate(!1,!1,!0)};this.cloneMaterial=function(a){var b=a.clone();b instanceof THREE.MeshPhongMaterial&&(b.exposureBias=a.exposureBias,b.irradianceMap=a.irradianceMap,b.envMapExposure=a.envMapExposure,b.proteinMat=a.proteinMat,b.proteinType=a.proteinType,b.tag=a.tag,b.tonemapOutput=a.tonemapOutput,b.uri_bumpMap=a.uri_bumpMap,b.uscale_bumpMap=a.uscale_bumpMap,b.vscale_bumpMap=a.vscale_bumpMap,
b.cutplanes=a.cutplanes,b.cutplanesOutlineColor=a.cutplanesOutlineColor,b.cutplanesOutlineThickness=a.cutplanesOutlineThickness);return b};this.getCutPlanes=function(){return m.slice()};this.setCutPlanes=function(a){if(m.length!==(a?a.length||0:0)){for(var b in k)k[b].needsUpdate=!0,a&&0<a.length&&(k[b].side=THREE.DoubleSide);for(b in l)l[b].needsUpdate=!0}for(;0<m.length;)m.pop();if(a)for(b=0;b<a.length;b++)m.push(a[b].clone())};this.setCutPlanesOutlineColor=function(a){p.set(a.r,a.g,a.b)};this.setCutPlanesOutlineThickness=
function(a){for(var b in k)k[b].cutplanesOutlineThickness=a;for(b in l)l[b].cutplanesOutlineThickness=a};this.cleanup=function(a){var b={},c;for(c in this.textures){var d=this.textures[c];-1===c.indexOf(a.basePath)?b[c]=d:d.tex.dispose()}this.textures=b;var b={},f;for(f in k)-1===f.indexOf(a.basePath)&&(b[f]=k[f]);k=this.materials=b};this.addMaterial("__defaultMaterial__",this.defaultMaterial)};
function init_GroundShader(){"undefined"===typeof GroundDepthShader&&(GroundDepthShader={uniforms:{cutplanes:{type:"v4v",value:[]}},vertexShader:"#ifdef USE_LOGDEPTHBUF\n    #ifdef USE_LOGDEPTHBUF_EXT\n        varying float vFragDepth;\n    #endif\n    uniform float logDepthBufFC;\n#endif\n#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );;\n#if NUM_CUTPLANES > 0\n    vec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n    vWorldPosition = worldPosition.xyz;\n#endif\n#ifdef USE_LOGDEPTHBUF\n    gl_Position.z = log2(max(1e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n    #ifdef USE_LOGDEPTHBUF_EXT\n        vFragDepth = 1.0 + gl_Position.w;\n    #else\n        gl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n    #endif\n#endif\n}",
fragmentShader:["#ifdef USE_LOGDEPTHBUF\n    uniform float logDepthBufFC;\n    #ifdef USE_LOGDEPTHBUF_EXT\n        #extension GL_EXT_frag_depth : enable\n        varying float vFragDepth;\n    #endif\n#endif",PackDepthShaderChunk,"#if NUM_CUTPLANES > 0\nvarying vec3 vWorldPosition;\n#endif",CutPlanesShaderChunk,"void main() {\n#if NUM_CUTPLANES > 0\nif (checkCutPlanes()) return;\n#endif\n#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\ngl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif\n#ifdef USE_LOGDEPTHBUF_EXT\nfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n#else\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#endif\ndepth = 1.0 - depth;\ngl_FragColor = packDepth(depth);\n}"].join("\n")},
GroundShadowAOShader={uniforms:{tDepth:{type:"t",value:null},worldSize:{type:"v3",value:new THREE.Vector3(1,1,1)}},defines:{},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2(uv.x, uv.y);\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:["#define NUM_SAMPLES 29.0\n#define NUM_SPIRAL_TURNS 7.0\nuniform sampler2D tDepth;\nuniform vec3 worldSize;\nvarying vec2 vUv;\n#ifdef PRESET_2\n#define SAMPLE_RADIUS 0.3\n#define AO_GAMMA 1.0\n#define AO_INTENSITY 1.0\n#else\n#define SAMPLE_RADIUS 0.2\n#define AO_GAMMA 3.0\n#define AO_INTENSITY 0.8\n#endif",
PackDepthShaderChunk,"#define PI 3.14159265358979\nfloat rand(vec2 co) {\nreturn fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\nfloat getRandomAngle(vec2 pos) {\nreturn rand(pos) * (2.0 * PI);\n}\nvec2 tapLocation(float sampleNumber, float spinAngle, out float ssR){\nfloat alpha = float(sampleNumber + 0.5) * (1.0 / NUM_SAMPLES);\nfloat angle = alpha * (NUM_SPIRAL_TURNS * PI * 2.0) + spinAngle;\nssR = alpha;\nreturn vec2(cos(angle), sin(angle));\n}\nvec2 sampleAO(vec2 unitDirection, float radius) {\nvec2 sampleOffset = unitDirection * radius;\nfloat idepth = unpackDepth(texture2D(tDepth, vUv + sampleOffset));\nfloat depth = 1.0 - idepth;\nif (depth < 1e-6) {\nif (radius == 0.0)\nreturn vec2(1.0, 1.0);\nelse\nreturn vec2(0.0, 1.0);\n}\nvec3 dir = vec3(sampleOffset.x, depth, sampleOffset.y) * worldSize;\nfloat distance2 = dot(dir,dir);\nfloat idistance = 1.0 / sqrt(distance2);\nvec3 ndir = dir * idistance;\n#ifdef PRESET_2\nfloat importance = ndir.y * idistance;\n#else\nfloat importance = ndir.y / distance2;\n#endif\nvec2 ret;\nret.x = (idepth == 0.0) ? 0.0 : importance;\nret.y = importance;\nreturn ret;\n}\nvoid main() {\nvec2 sum = vec2(0.0);\nfloat angle = getRandomAngle(vUv);\nfor (float i = 0.0; i<NUM_SAMPLES; i+= 1.0) {\nfloat ssR;\nvec2 uv = tapLocation(i, angle, ssR);\nsum += sampleAO(uv, ssR * SAMPLE_RADIUS);\n}\nfloat ao = sum.x / sum.y;\ngl_FragColor = packDepth(AO_INTENSITY * clamp(pow(ao, AO_GAMMA), 0.0, 0.9999));\n}"].join("\n")},
GroundShadowBlurShader={uniforms:{tDepth:{type:"t",value:null}},defines:{},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2(uv.x, uv.y);\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:["uniform sampler2D tDepth;\nvarying vec2 vUv;\n#ifdef HORIZONTAL\n#define GET_UV(X) vec2(vUv.x + KERNEL_SCALE*(X), vUv.y)\n#else\n#define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE*(Y))\n#endif",PackDepthShaderChunk,"#define PI 3.14159265358979\n#define SIGMA ((2.0 * KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#ifdef BOX\n#define KERNEL_VAL(X) 1.0\n#else\n#define KERNEL_VAL(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\n#endif\nvoid main() {\nfloat depthVal = 0.0;\nfloat sum = 0.0;\nfor (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\ndepthVal += unpackDepth(texture2D(tDepth, GET_UV(x))) * KERNEL_VAL(x);\nsum += KERNEL_VAL(x);\n}\ngl_FragColor = packDepth(depthVal/sum);\n}"].join("\n")},
GroundShadowColorShader={uniforms:{tDepth:{type:"t",value:null},uShadowColor:{type:"v4",value:new THREE.Vector4(0,0,0,1)}},vertexShader:"varying vec2 vUv;\nvoid main() {\n    vUv = vec2(uv.x, uv.y);\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:["uniform sampler2D tDepth;\nuniform vec4 uShadowColor;\nvarying vec2 vUv;",PackDepthShaderChunk,"void main() {\nfloat depthVal = unpackDepth(texture2D(tDepth, vUv));\ngl_FragColor = vec4(uShadowColor.rgb, uShadowColor.a * depthVal);\n}"].join("\n")})}
var GroundShadow=function(a,b){function c(a){return new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:THREE.UniformsUtils.clone(a.defines)})}init_GroundShader();var f,d,g,h,k,l,n,q,m,p,t,v,D=!1,w={texSize:64,pixScale:1,blurRadius:7,debug:!1};this.setTransform=function(a,b,c,d){f.left=-b.z/2;f.right=b.z/2;f.top=b.x/2;f.bottom=-b.x/2;f.near=1;f.far=b.y+f.near;f.updateProjectionMatrix();f.position.addVectors(a,
c.clone().multiplyScalar(-b.y/2-f.near));d&&f.up.set(d.x,d.y,d.z);f.lookAt(a);g.position.set(a.x,a.y,a.z);g.rotation.set(f.rotation.x,f.rotation.y,f.rotation.z);g.scale.set(b.z,b.x,b.y);w.debug&&(v.position.set(a.x,a.y,a.z),v.rotation.set(f.rotation.x,f.rotation.y,f.rotation.z),v.scale.set(b.z,b.x,b.y));t.uniforms.worldSize.value.copy(b)};this.renderIntoShadow=function(b){if(!b.overrideMaterial||!b.overrideMaterial.transparent){var c=b.overrideMaterial;b.overrideMaterial=n;a.render(b,f,k,!1);b.overrideMaterial=
c}};this.renderShadow=function(b,c){D&&(c?a.render(d,b,c,!1):a.render(d,b))};this.postprocess=function(){p.render(a,l,k);m.render(a,k,l);D=!0};this.clear=function(){var b=a.getClearColor().getHex(),c=a.getClearAlpha();a.setClearColor(0,0);a.clearTarget(k,!0,!0,!1);a.setClearColor(b,c);D=!1};this.setColor=function(a){q.uniforms.uShadowColor.value.x=a.r;q.uniforms.uShadowColor.value.y=a.g;q.uniforms.uShadowColor.value.z=a.b};this.getColor=function(){return new THREE.Color(q.uniforms.uShadowColor.value.x,
q.uniforms.uShadowColor.value.y,q.uniforms.uShadowColor.value.z)};this.setAlpha=function(a){q.uniforms.uShadowColor.value.w=a};this.getAlpha=function(){return q.uniforms.uShadowColor.value.w};this.isValid=function(){return D};this.getDepthMaterial=function(){return n};if(b)for(h in w)w[h]=b[h]||w[h];d=new THREE.Scene;f=new THREE.OrthographicCamera;k=new THREE.WebGLRenderTarget(w.texSize,w.texSize,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1});
k.generateMipmaps=!1;l=new THREE.WebGLRenderTarget(w.texSize,w.texSize,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1});l.generateMipmaps=!1;n=c(GroundDepthShader);n.side=THREE.DoubleSide;n.blending=THREE.NoBlending;m=new LmvShaderPass(GroundShadowBlurShader,"tDepth");p=new LmvShaderPass(GroundShadowBlurShader,"tDepth");t=new LmvShaderPass(GroundShadowAOShader,"tDepth");m.material.defines.KERNEL_SCALE=p.material.defines.KERNEL_SCALE=(w.pixScale/
w.texSize).toFixed(4);m.material.defines.KERNEL_RADIUS=p.material.defines.KERNEL_RADIUS=w.blurRadius.toFixed(2);t.material.blending=m.material.blending=p.material.blending=THREE.NoBlending;t.material.depthWrite=m.material.depthWrite=p.material.depthWrite=!1;t.material.depthTest=m.material.depthTest=p.material.depthTest=!1;m.material.defines.HORIZONTAL=1;q=c(GroundShadowColorShader);q.uniforms.tDepth.value=k;q.depthWrite=!1;q.transparent=!0;h=new THREE.BufferGeometry;h.addAttribute("position",new THREE.BufferAttribute(new Float32Array([-.5,
-.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5]),3));h.addAttribute("uv",new THREE.BufferAttribute(new Float32Array([0,0,0,1,1,1,1,0]),2));h.addAttribute("index",new THREE.BufferAttribute(new Uint16Array([0,1,2,2,3,0]),1));g=new THREE.Mesh(h,q);d.add(g);w.debug&&(v=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:65280,wireframe:!0})),d.add(v));this.setTransform(new THREE.Vector3(0,0,0),new THREE.Vector3(1,1,1),new THREE.Vector3(0,1,0))};GroundShadow.prototype.constructor=GroundShadow;
function init_GroundReflectionShader(){"undefined"===typeof GroundReflectionCompShader&&(GroundReflectionCompShader={uniforms:{tDiffuse:{type:"t",value:null},tBackground:{type:"t",value:null},uColor:{type:"v4",value:new THREE.Vector4(1,1,1,1)}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform sampler2D tBackground;\nuniform vec4 uColor;\nvarying vec2 vUv;\nvoid main() {\nvec4 bgCol = texture2D( tBackground, vUv );\nvec4 diffCol = uColor * texture2D( tDiffuse, vUv );\ngl_FragColor = mix(bgCol, diffCol, diffCol.a);\n}"},
GroundReflectionDrawShader={uniforms:{tDiffuse:{type:"t",value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\ngl_FragColor = texel;\n}"})}
var createShaderMaterial=function(a){return new THREE.ShaderMaterial({uniforms:THREE.UniformsUtils.clone(a.uniforms),vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,defines:THREE.UniformsUtils.clone(a.defines)})},GroundReflection=function(a,b,c,f){init_GroundReflectionShader();var d=a.getContext(),g=b||512,h=c||512,k,l,n,q,m,p=!1,t=new THREE.Color(0,0,0),v,D=!1;this.outTarget=this.inTarget=void 0;var w={color:new THREE.Color(1,1,1),alpha:.3,texScale:.5,blurRadius:2,blurTexScale:.5,fadeAngle:Math.PI/
18};this.setTransform=function(a,b,c){q=a;n.normal=b;n.constant=-a.dot(b)};this.cleanup=function(){k&&k.cleanup();this.inTarget&&this.inTarget.dispose();this.outTarget&&this.outTarget.dispose()};this.setSize=function(a,b){g=a;h=b;this.cleanup();this.inTarget=new THREE.WebGLRenderTarget(g*w.texScale,h*w.texScale,{magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1});this.inTarget.generateMipmaps=!1;this.outTarget=new THREE.WebGLRenderTarget(g*w.texScale,
h*w.texScale,{magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1});this.outTarget.generateMipmaps=!1;k?k.setSize(g*w.texScale*w.blurTexScale,h*w.texScale*w.blurTexScale):k=new GaussianPass(g*w.texScale*w.blurTexScale,h*w.texScale*w.blurTexScale,w.blurRadius,1,{hasAlpha:!0,blending:!0,flipUV:!0})};this.updateCamera=function(a){var b=a.position.clone().sub(q).normalize(),b=Math.PI/2-b.angleTo(n.normal);p=0>b;if(!p){0<w.fadeAngle&&(b=Math.min(w.fadeAngle,
b)/w.fadeAngle,k.setAlpha(b*w.alpha));var b=n.normal,c=n.constant,b=(new THREE.Matrix4).set(1-2*b.x*b.x,-2*b.y*b.x,-2*b.x*b.z,-2*c*b.x,-2*b.x*b.y,1-2*b.y*b.y,-2*b.y*b.z,-2*c*b.y,-2*b.x*b.z,-2*b.y*b.z,1-2*b.z*b.z,-2*c*b.z,0,0,0,1);m=a.clone();m.applyMatrix(b);m.projectionMatrix.elements[5]*=-1;m.matrixWorldNeedsUpdate=!0;m.worldUpTransform=a.worldUpTransform?a.worldUpTransform.clone():new THREE.Matrix4}};this.renderIntoReflection=function(b){p||a.render(b,m,this.inTarget)};this.renderReflection=function(b,
c){p||(d.depthRange(.9999,1),l.render(a,c,this.outTarget),d.depthRange(0,1))};this.postprocess=function(){p||(D?(v.render(a,this.outTarget),a.clearTarget(this.outTarget,!1,!0,!1)):(a.setClearColor(t,1),a.clearTarget(this.outTarget,!0,!0,!1)),k.render(a,this.outTarget,this.inTarget))};this.clear=function(){a.setClearColor(t,0);a.clearTarget(this.inTarget,!0,!0,!1)};this.setClearColors=function(a,b){b?(t.setRGB(.5*(a.x+b.x),.5*(a.y+b.y),.5*(a.z+b.z)),D=!a.equals(b)&&!isAndroidDevice()&&!isIOSDevice()):
(t.copy(a),D=!1);D&&(v.uniforms.color1.value.copy(a),v.uniforms.color2.value.copy(b))};this.isGroundCulled=function(){return p};this.setColor=function(a){k.setColor(w.color);w.color.set(a)};this.setAlpha=function(a){k.setAlpha(w.alpha);w.alpha=a};if(f)for(var F in w)w[F]=void 0!==f[F]?f[F]:w[F];l=new LmvShaderPass(GroundReflectionDrawShader);l.material.blending=THREE.NoBlending;l.material.depthTest=!0;l.material.depthWrite=!1;v=new LmvShaderPass(BackgroundShader);v.material.blending=THREE.NoBlending;
v.material.depthWrite=!1;v.material.depthTest=!1;this.setSize(g,h);k.setAlpha(w.color);k.setAlpha(w.alpha);n=new THREE.Plane(new THREE.Vector3(0,1,0),0);q=new THREE.Vector3(0,0,0)};GroundReflection.prototype.constructor=GroundReflection;
function init_GaussianShader(){"undefined"===typeof GaussianShader&&(GaussianShader={uniforms:{tDiffuse:{type:"t",value:null},uColor:{type:"v4",value:new THREE.Vector4(1,1,1,1)}},vertexShader:"varying vec2 vUv;\nvoid main() {\n#if defined(HORIZONTAL) && defined(FLIP_UV)\n    vUv = vec2(uv.x, 1.0-uv.y);\n#else\n    vUv = vec2(uv.x, uv.y);\n#endif\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec4 uColor;\nvarying vec2 vUv;\n#ifdef HORIZONTAL\n    #define GET_UV(X) vec2(vUv.x + KERNEL_SCALE_H*(X), vUv.y)\n#else\n    #define GET_UV(Y) vec2(vUv.x, vUv.y + KERNEL_SCALE_V*(Y))\n#endif\n#define PI 3.14159265358979\n#define SIGMA ((KERNEL_RADIUS+KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#define GAUSSIAN(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\nvoid main() {\n    vec4 texColSum = vec4(0.0);\n    float gaussSum = 0.0;\n    for (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\n        float gauss = GAUSSIAN(x);\n        vec4 texCol = texture2D(tDiffuse, GET_UV(x));\n        #ifdef HAS_ALPHA\n            texCol.rgb *= texCol.a;\n        #endif\n        texColSum += texCol * gauss;\n        gaussSum += gauss;\n    }\n    #ifdef HAS_ALPHA\n        texColSum.rgb /= texColSum.a;\n    #endif\n#ifdef HORIZONTAL\n    gl_FragColor = texColSum/gaussSum;\n#else\n    gl_FragColor = texColSum/gaussSum * uColor;\n#endif\n}"})}
var GaussianPass=function(a,b,c,f,d){init_GaussianShader();var g=a,h=b;c=c||3;var k=f||1,l,n,q;f=d.hasAlpha||!1;var m=d.blending||!1;d=d.flipUV||!1;this.render=function(a,b,c){l.render(a,q,c);n.render(a,b,q)};this.setSize=function(a,b){this.cleanup();g=a;h=b;q=new THREE.WebGLRenderTarget(a,b,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1});q.generateMipmaps=!1;l.material.defines.KERNEL_SCALE_H=n.material.defines.KERNEL_SCALE_H=(k/g).toFixed(4);
l.material.defines.KERNEL_SCALE_V=n.material.defines.KERNEL_SCALE_V=(k/h).toFixed(4);l.material.needsUpdate=n.material.needsUpdate=!0};this.cleanup=function(){q&&q.dispose()};this.setColor=function(a){n.material.uniforms.uColor.value.x=a.r;n.material.uniforms.uColor.value.y=a.g;n.material.uniforms.uColor.value.z=a.b};this.setAlpha=function(a){n.material.uniforms.uColor.value.w=a};l=new LmvShaderPass(GaussianShader);n=new LmvShaderPass(GaussianShader);this.setSize(a,b);l.material.blending=n.material.blending=
THREE.NoBlending;l.material.depthWrite=n.material.depthWrite=!1;l.material.depthTest=n.material.depthTest=!1;l.material.defines.HORIZONTAL=1;l.material.defines.KERNEL_RADIUS=n.material.defines.KERNEL_RADIUS=c.toFixed(1);m&&(n.material.transparent=!0,n.material.blending=THREE.NormalBlending);f&&(l.material.defines.HAS_ALPHA=n.material.defines.HAS_ALPHA="");d&&(l.material.defines.FLIP_UV="")};AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.AnimationHandler=function(){this.animations=[]};a.AnimationHandler.prototype.init=function(a){if(!0===a.initialized)return a;for(var c=0;c<a.hierarchy.length;c++){for(var f=0;f<a.hierarchy[c].keys.length;f++)if(0>a.hierarchy[c].keys[f].time&&(a.hierarchy[c].keys[f].time=0),void 0!==a.hierarchy[c].keys[f].rot&&!(a.hierarchy[c].keys[f].rot instanceof THREE.Quaternion)){var d=a.hierarchy[c].keys[f].rot;Array.isArray(d)||(d=[d._x,d._y,d._z,d._w]);a.hierarchy[c].keys[f].rot=
(new THREE.Quaternion).fromArray(d)}for(f=1;f<a.hierarchy[c].keys.length;f++)a.hierarchy[c].keys[f].time===a.hierarchy[c].keys[f-1].time&&(a.hierarchy[c].keys.splice(f,1),f--);for(f=0;f<a.hierarchy[c].keys.length;f++)a.hierarchy[c].keys[f].index=f}a.initialized=!0;return a};a.AnimationHandler.prototype.parse=function(a){function c(a,b){b.push(a);if(a.children&&!(a instanceof THREE.Camera))for(var f=0;f<a.children.length;f++)c(a.children[f],b)}var f=[];c(a,f);return f};a.AnimationHandler.prototype.play=
function(a){-1===this.animations.indexOf(a)&&this.animations.push(a)};a.AnimationHandler.prototype.stop=function(a){a=this.animations.indexOf(a);-1!==a&&this.animations.splice(a,1)};a.AnimationHandler.prototype.update=function(a){for(var c=0;c<this.animations.length;c++)this.animations[c].update(a)};a.Animation=function(a,c,f){this.root=a;this.handler=f.animationHandler;this.data=this.handler.init(c);this.hierarchy=this.handler.parse(a);this.viewer=f.viewer;this.animator=f;this.currentTime=0;this.timeScale=
1;this.isPlaying=!1;this.isPaused=!0;this.loop=!1;this.delta=.5;this.interpolationType=0;this.setStartAndEndKeyTime()};a.Animation.prototype.setStartAndEndKeyTime=function(){if(0<this.data.hierarchy.length){var a=this.data.hierarchy[0].keys;this.startKeyTime=a[0].time;this.endKeyTime=a[a.length-1].time}else this.startKeyTime=this.endKeyTime=0};a.Animation.prototype.keyTypes=[];a.Animation.prototype.defaultKey={};a.Animation.prototype.play=function(a){this.currentTime=void 0!==a?a:0;this.isPlaying=
!0;this.isPaused=!1;this.reset();this.handler.play(this)};a.Animation.prototype.pause=function(){!0===this.isPaused?this.handler.play(this):this.handler.stop(this);this.isPaused=!this.isPaused};a.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;this.handler.stop(this)};a.Animation.prototype.goto=function(a){this.isPlaying||this.play();this.isPaused||this.pause();this.update(a-this.currentTime)};a.Animation.prototype.reset=function(){for(var a=0,c=this.hierarchy.length;a<c;a++){var f=
this.hierarchy[a];void 0===f.animationCache&&(f.animationCache={});void 0===f.animationCache[this.data.name]&&(f.animationCache[this.data.name]={prevKey:this.defaultKey,nextKey:this.defaultKey,originalMatrix:f.matrix});for(var f=f.animationCache[this.data.name],d=0;d<this.keyTypes.length;d++){for(var g=this.keyTypes[d],h=this.data.hierarchy[a].keys[0],k=this.getNextKeyWith(g,a,1);k.time<this.currentTime&&k.index>h.index;)h=k,k=this.getNextKeyWith(g,a,k.index+1);f.prevKey[g]=h;f.nextKey[g]=k}}this.setStartAndEndKeyTime()};
a.Animation.prototype.getNextKeyWith=function(a,c,f){var d=this.data.hierarchy[c].keys;for(f=1===this.interpolationType||2===this.interpolationType?f<d.length-1?f:d.length-1:f%d.length;f<d.length;f++)if(void 0!==d[f][a])return d[f];return this.data.hierarchy[c].keys[0]};a.Animation.prototype.getPrevKeyWith=function(a,c,f){var d=this.data.hierarchy[c].keys;for(f=1===this.interpolationType||2===this.interpolationType?0<f?f:0:0<=f?f:f+d.length;0<=f;f--)if(void 0!==d[f][a])return d[f];return this.data.hierarchy[c].keys[d.length-
1]};a.Animation.prototype.isPlayingOutOfRange=function(){return!1===this.isPaused&&(this.currentTime<this.startKeyTime-this.delta||this.currentTime>this.endKeyTime+this.delta)};a.Animation.prototype.resetIfLooped=function(){!0===this.loop&&this.currentTime>this.endKeyTime&&(this.currentTime%=this.endKeyTime,this.reset())};a.MeshAnimation=function(b,c,f){a.Animation.call(this,b,c,f);this.originalMatrix=b.matrix.clone();this.localMatrix=new THREE.Matrix4;(this.relativeTransform=c.custom&&c.custom.transform&&
"abs"===c.custom.transform?!1:!0)?this.root.updateMatrixWorld():this.root.matrix.decompose(this.root.position,this.root.quaternion,this.root.scale)};a.MeshAnimation.prototype=Object.create(a.Animation.prototype);a.MeshAnimation.prototype.constructor=a.MeshAnimation;a.MeshAnimation.prototype.keyTypes=["pos","rot","scl"];a.MeshAnimation.prototype.defaultKey={pos:0,rot:0,scl:0};a.MeshAnimation.prototype.update=function(){var a=[],c,f,d;return function(g){if(!1!==this.isPlaying&&(this.currentTime+=g*
this.timeScale,c||(c=new THREE.Vector3,f=new THREE.Vector3,d=new THREE.Quaternion),this.resetIfLooped(),!this.isPlayingOutOfRange())){g=0;for(var h=this.hierarchy.length;g<h;g++){for(var k=this.hierarchy[g],l=k.animationCache[this.data.name],n=0;n<this.keyTypes.length;n++){var q=this.keyTypes[n],m=l.prevKey[q],p=l.nextKey[q];if(p.time<=this.currentTime||m.time>=this.currentTime){m=this.data.hierarchy[g].keys[0];for(p=this.getNextKeyWith(q,g,1);p.time<this.currentTime&&p.index>m.index;)m=p,p=this.getNextKeyWith(q,
g,p.index+1);l.prevKey[q]=m;l.nextKey[q]=p}var t=m[q],v=p[q];if(p.time!==m.time&&void 0!==t&&void 0!==v){var D=(this.currentTime-m.time)/(p.time-m.time);0>D&&(D=0);1<D&&(D=1);"pos"===q?0===this.interpolationType?(f.x=t[0]+(v[0]-t[0])*D,f.y=t[1]+(v[1]-t[1])*D,f.z=t[2]+(v[2]-t[2])*D,k.position.copy(f)):(a[0]=this.getPrevKeyWith("pos",g,m.index-1).pos,a[1]=t,a[2]=v,a[3]=this.getNextKeyWith("pos",g,p.index+1).pos,D=.33*D+.33,q=interpolateCatmullRom(a,D),f.x=q[0],f.y=q[1],f.z=q[2],k.position.copy(f),2===
this.interpolationType&&(D=interpolateCatmullRom(a,1.01*D),c.set(D[0],D[1],D[2]),c.sub(vector),c.y=0,c.normalize(),D=Math.atan2(c.x,c.z),k.rotation.set(0,D,0))):"rot"===q?(THREE.Quaternion.slerp(t,v,d,D),k.quaternion.copy(d)):"scl"===q&&(f.x=t[0]+(v[0]-t[0])*D,f.y=t[1]+(v[1]-t[1])*D,f.z=t[2]+(v[2]-t[2])*D,k.scale.copy(f))}}this.relativeTransform?(this.localMatrix.compose(k.position,k.quaternion,k.scale),k.matrix.multiplyMatrices(this.localMatrix,this.originalMatrix),k.matrixAutoUpdate=!1):k.matrixAutoUpdate=
!0;k.matrixWorldNeedsUpdate=!0;k.updateMatrixWorld()}}}}();a.CameraAnimation=function(b,c,f){a.Animation.call(this,b,c,f)};a.CameraAnimation.prototype=Object.create(a.Animation.prototype);a.CameraAnimation.prototype.constructor=a.CameraAnimation;a.CameraAnimation.prototype.keyTypes=["pos","up","target","fov","perspective"];a.CameraAnimation.prototype.defaultKey={pos:0,up:0,target:0,fov:0,perspective:0};a.CameraAnimation.prototype.update=function(){var a=[],c,f;return function(d){if(!1!==this.isPlaying&&
(this.currentTime+=d*this.timeScale,c||(c=new THREE.Vector3,f=new THREE.Vector3),this.resetIfLooped(),!this.isPlayingOutOfRange())){d=0;for(var g=this.hierarchy.length;d<g;d++){for(var h=this.hierarchy[d],k=h.animationCache[this.data.name],l=0;l<this.keyTypes.length;l++){var n=this.keyTypes[l],q=k.prevKey[n],m=k.nextKey[n];if(m.time<=this.currentTime||q.time>=this.currentTime){q=this.data.hierarchy[d].keys[0];for(m=this.getNextKeyWith(n,d,1);m.time<this.currentTime&&m.index>q.index;)q=m,m=this.getNextKeyWith(n,
d,m.index+1);k.prevKey[n]=q;k.nextKey[n]=m}var p=q[n],t=m[n];if(m.time!==q.time&&void 0!==p&&void 0!==t){var v=(this.currentTime-q.time)/(m.time-q.time);0>v&&(v=0);1<v&&(v=1);var D;if("pos"===n)D=h.position;else if("up"===n)D=h.up;else if("target"===n)D=h.target;else if("fov"===n){h.setFov(p+(t-p)*v);continue}else if("perspective"===n){(.5<v?t:p)?h.toPerspective():h.toOrthographic();continue}0===this.interpolationType?(f.x=p[0]+(t[0]-p[0])*v,f.y=p[1]+(t[1]-p[1])*v,f.z=p[2]+(t[2]-p[2])*v,D.copy(f)):
(a[0]=this.getPrevKeyWith(n,d,q.index-1)[n],a[1]=p,a[2]=t,a[3]=this.getNextKeyWith(n,d,m.index+1)[n],v=.33*v+.33,n=interpolateCatmullRom(a,v),f.x=n[0],f.y=n[1],f.z=n[2],D.copy(f),2===this.interpolationType&&(v=interpolateCatmullRom(a,1.01*v),c.set(v[0],v[1],v[2]),c.sub(D),c.y=0,c.normalize(),v=Math.atan2(c.x,c.z),h.rotation.set(0,v,0)))}}h.matrixAutoUpdate=!0;h.matrixWorldNeedsUpdate=!0}h.lookAt(h.target);this.animator.updateFlag|=this.animator.UPDATE_CAMERA}}}();a.VisibilityAnimation=function(b,
c,f,d){a.Animation.call(this,b,c,d);this.node=f;this.epsilon=.1;this.root.material=this.viewer.matman().cloneMaterial(b.material)};a.VisibilityAnimation.prototype=Object.create(a.Animation.prototype);a.VisibilityAnimation.prototype.constructor=a.VisibilityAnimation;a.VisibilityAnimation.prototype.keyTypes=["vis","opa"];a.VisibilityAnimation.prototype.defaultKey={viz:1,opa:1};a.VisibilityAnimation.prototype.update=function(){return function(a){if(!1!==this.isPlaying&&(this.currentTime+=a*this.timeScale,
this.resetIfLooped(),!this.isPlayingOutOfRange())){a=0;for(var c=this.hierarchy.length;a<c;a++)for(var f=this.hierarchy[a],d=f.animationCache[this.data.name],g=0;g<this.keyTypes.length;g++){var h=this.keyTypes[g],k=d.prevKey[h],l=d.nextKey[h];if(l.time<=this.currentTime||k.time>=this.currentTime){k=this.data.hierarchy[a].keys[0];for(l=this.getNextKeyWith(h,a,1);l.time<this.currentTime&&l.index>k.index;)k=l,l=this.getNextKeyWith(h,a,l.index+1);d.prevKey[h]=k;d.nextKey[h]=l}var n=k[h],q=l[h];l.time!==
k.time&&void 0!==n&&void 0!==q&&("vis"===h?(k=(h=Math.abs(this.currentTime-l.time)<this.epsilon)?l:k,n=h?q:n,1===n&&void 0===k.opa&&(f.material.transparent=!1,f.material.opacity=1),this.viewer.visibilityManager.setVisibilityOnNode(this.node,n)):"opa"===h&&(k=(this.currentTime-k.time)/(l.time-k.time),0>k&&(k=0),1<k&&(k=1),n+=(q-n)*k,f.material.transparent=1!==n,f.material.opacity=n,0<n&&this.viewer.visibilityManager.setVisibilityOnNode(this.node,1)))}}}}();a.AnnotationAnimation=function(b,c,f){function d(a,
b,c){var d=g.container=document.createElement("div"),f=a.name;d.id=f;d.style.cursor="pointer";d.style.visibility=c;var m=document.createElement("div");m.id=f+"-txt";m.style.cssText="display: none;position: absolute;z-index: 1;";d.appendChild(m);c=document.createElement("img");c.src=a.custom&&a.custom.att&&1===a.custom.att?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABv1BMVEUAAAAAAAAAAAAAAAABAwEAAAAAAAAjSRkAAAAFDASJqnZhg1IqTyAjSRkpTx8hRxggRRcAAAAhRRcKFwgAAACau4R9mnFmiFUhSBgbOhMZNhIAAAAECQMgQxcAAAAAAAAAAAAHDwXB2q2jw4yfvoivyJ6fuI6mv5eSr4KAoWu2trZpiV3Nzc0wVSUhRxhNT01vb28AAAAgRBcAAAAAAAAAAAAhRxgeQBYAAAAAAAAAAAAfQRbP5MC0zqCqyJKpyJJBYje3z6WxyKOFpXF9nmkrTiG+wb5xkGVcf0xYfEg1WSpNTU0hRhgfQhYfQhZVVVVAQEAXMREcOhQcHBwSJw0AAAAAAAAWLxAVLQ8AAAAAAAAfQhYIEgYAAACbvn+DsGCGsmSUunaItGXc6dStypelxY2ZvX2Ntm2JtGnS48fB17G40aWNuWucxH6ny4mUvnPF27aPuHCEsGHV5czI3Lq52KGvzJqz1JmqyJOqzY6ew4OYwHiGs2OEsWHb29vL4LvM5bnD3q2+3KWkyoaLtWuKtmfOzs7IyMi21pyawXqPuG/g4ODX68fI4rTG4LCu0ZKszJKlx4qZwHuBnXR2iXENcZskAAAAXnRSTlMAEAIBCAsF6BUn+vPu7erjsZyBEwP99/TRk3JgRUQ1IxwO/v79/Pv6+fn09PPq08q7sqWDe2xrY01AMBj+/v7+/v37+fn59fXz8u/c1cbFxLWonZiIcm1lYVdSQT8de/EoFwAAAgVJREFUOMutklVz21AQRiNFlswYs+M6DTdN0kCDZWZmuAKDZFtgiO2YYm6TlOEHV53ptGs5j93Xc+a7e3d36P/W9prdZ/PZ17aPxphz3mR0x91G07wTG8TDo5R3HLGH3S6fGPdSo8Na/to6W2HZBEqwPCNULlu1BkFdQSyKx4qxOMoyDDJSRB/HnTcqWbSbTmVS6V3E57hvXicOBZd1gmfj6Z1kPrmTjrMMfRizumDA+k3UTcRSyWg0mkzFEgLNlU3rIIJcns0KqJjJq0I+U0SqUJlZJv8JugU3J/QnHEwu6MCMqPN1pq+H3sFxCgOC7RyT48Ev6qLUL/gmeJrJ/p0DzSnyxTtAGLMbv9dohv8zSbomSqUpOxB0AdNXsUbnGEEQmJzKq3JrLgCaJAzms5LI1enfVefEamc/YzYQYFB6/1xBUsQex3E9UZHkUvO6X48PwQjLTKEjVRVFqUqd8v6naQsMUCNcL8xTrVJZluXyl1K7OW1+7sL71x15cvVH43O7UGi3mmc8lkCE0ByMbvXazwueycbHxiXPrUdv3hLDGiF8au/d4sO7Novtnj9k0BO45uRGTp98f2JlK/RqYzN8TK8bGTjZLTXgfvDp6rMNA0ZADAOWHI6VTYwE4WAZjz/s3V5yvIxADosIPlh0BNXHSdA8LFIfDgE8WDg5hmmx9h/40fgXth2SDk3yjP4AAAAASUVORK5CYII=":
"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABvFBMVEUAAAAAAAADAAAAAAAAAAACAAAAAAAAAAC5PznHVE8BAAAAAADbc27NXVeUDQaZDQaRBwAAAAAAAACHBgDuhoHVa2W9RD2QCAKYCAGPBgB0BQAAAAAAAACMBgAAAAADAAD2jonWb2n2jYjYbWfmeXPNzc3RYFqzODKfFA1RUVGKBgCVBwBvb2+WBwCBBgCFBgCWBwCLBgAAAAAAAACMBgCTBwByBQCTBwBbBACEBgAAAAAAAAAoAgBSBADgeHOoOzXmfnnofnjieHPGvr63t7e0tLTidW/ebmnba2XWZWDAT0qRHBfBSkRNTU2aFxGOBgBYTEsAAACNBgBAQEAAAABbBQAcHBxyBQBKBAAAAABfBAAAAAAAAAAsAgAkAgCJBgDZRT3MOTHQPDTVQjrlUkrjUEjRPjbOOjP/bGTvXFTqV0/fTETNOjL5Zl7eS0PzYFjxXlbiT0fUQTn0e3T7aGDWXFXbSEDTRj/PQTrOPjbb29vgamTxY1zoVE3STETTQjvSPzfOzs7IyMj5g3zzaWLXY13XYVrsXlbbU0zg4OD8lZD4gXq0eHXqd3HscWv2b2jrZmDQZWDdWVLkV1C5y9+5AAAAYHRSTlMAAgUBDggMEeDsIBj+8NHJxpxAEP754tDDtIFsYDkvI/78+/j08/DfycfHxbuvr5mTjYN0bWxkWVZTTDUjEfz8+/n59fT08vHw8PDw5NzV0Mq5uLWrm5iLfX1hV0g/ODZEwKduAAACAklEQVQ4y62SVXPbQBzEa1mWZYaY49ihBhtmKjMzw92JLLBsyxxT2mCZvnCVmU59VpO37Ms97G929nb+p05WXUvTE5GJ6aWuY+yFEdoVdAZd9MjCEYi5J0L3FZutSqVZdIYiPWaj/85j2yszAACGVyq7Lo+RIMZtxRaQOZaTwZZSLbrGLR2+aX54twVykpgVpRzgYbVGz5twYMPTV2ZkKZMupDOSzAiwfNazgQesDO9VASemU6lUWuQAgnyNXsEiiBlbEwE2W9CBQpbVAfRraIZoA5ZosII6EpB6MYrVpLxOQejowKsBL9UGSK+zCnnsF4omB7wkBkQHylDZ+rcDROD3hYcYQE0NHQhQ4f8uCQVG/XF9isJKLtI1TYBQQAgdPlqJzYcWMYBYd58/YJACD6UgpsTVA+51AhvKGgt9zQGN1xN4Dajs/vbtmBXf2mIP3/jGqiW9Q0nlGtn8tXBSnwGPWHYP5PcbLMs2JHFn+6p7WQ/ARTie3/rZm9+pZ+rfP/fawi8dhOFgqLlLX87dHOz/1D9ou/vsrcNiNgBrZzbf338yOXZvbDL2xm4ljCdn6j794cpswr/62p+wWy2m/042oQeMxudedK8mSdzGAy4/9vlm/STRtjGRTz9u3nnge2U3+O2h4o9GfXG7lcLKGWZY8ycduG3sQJCk0Tb+w3S0/Qemc4+eJchuZgAAAABJRU5ErkJggg==";
c.id=f+"-img";c.style.cssText="display: block;position: absolute;z-index: 1;";d.appendChild(c);b.api.container.appendChild(d);d.addEventListener("click",function(){m.style.display="none"===m.style.display?"block":"none"});a=new THREE.SphereGeometry(.01);d=new THREE.MeshPhongMaterial({color:32512,ambient:32512,opacity:.6,transparent:!0});a=new THREE.Mesh(a,d);a.visible=!1;void 0===b.overlayScenes.annotation&&b.createOverlayScene("annotation");b.addOverlay("annotation",a);return a}var g=this;null===
b&&(b=d(c,f.viewer,"hidden"));a.Animation.call(this,b,c,f);this.id=c.name;this.text="";this.state="hidden";this.epsilon=.1;this.viewer.api.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(a){g.updateText(b.position,g.text)})};a.AnnotationAnimation.prototype=Object.create(a.Animation.prototype);a.AnnotationAnimation.prototype.constructor=a.AnnotationAnimation;a.AnnotationAnimation.prototype.keyTypes=["pos","text","vis"];a.AnnotationAnimation.prototype.defaultKey={pos:0,text:"",vis:1};
a.AnnotationAnimation.prototype.stop=function(){a.Animation.prototype.stop.call(this);this.container.parentNode.removeChild(this.container);this.viewer.removeOverlay("annotation",this.root);this.root=null};a.AnnotationAnimation.prototype.updateText=function(a,c){var f,d;f=this.viewer.camera;d=this.viewer.canvas;var g=a.clone(),h=new THREE.Matrix4;f.updateMatrixWorld();f.matrixWorldInverse.getInverse(f.matrixWorld);h.multiplyMatrices(f.projectionMatrix,f.matrixWorldInverse);g.applyProjection(h);f=
(g.x+1)*d.width/2+d.offsetLeft;d=(-g.y+1)*d.height/2+d.offsetTop;if(g=document.getElementById(this.id+"-txt"))g.innerHTML=c,g.style.left=f+"px",g.style.top=d+"px",this.text=c;if(g=document.getElementById(this.id+"-img"))g.style.left=f+"px",g.style.top=d-24+"px"};a.AnnotationAnimation.prototype.update=function(){var a=[],c,f;return function(d){if(!1!==this.isPlaying&&(this.currentTime+=d*this.timeScale,c||(c=new THREE.Vector3,f=new THREE.Vector3),this.resetIfLooped(),!this.isPlayingOutOfRange()))if(this.isPaused&&
this.currentTime<this.startKeyTime){var g=document.getElementById(this.id);g&&(g.style.visibility=this.state)}else{d=0;for(var h=this.hierarchy.length;d<h;d++){for(var k=this.hierarchy[d],l=k.animationCache[this.data.name],n=0;n<this.keyTypes.length;n++){var q=this.keyTypes[n],m=l.prevKey[q],p=l.nextKey[q];if(p.time<=this.currentTime||m.time>=this.currentTime){m=this.data.hierarchy[d].keys[0];for(p=this.getNextKeyWith(q,d,1);p.time<this.currentTime&&p.index>m.index;)m=p,p=this.getNextKeyWith(q,d,
p.index+1);l.prevKey[q]=m;l.nextKey[q]=p}var t=m[q],v=p[q];if(p.time!==m.time&&void 0!==t&&void 0!==v)if(g=(this.currentTime-m.time)/(p.time-m.time),0>g&&(g=0),1<g&&(g=1),"pos"===q)if(0===this.interpolationType)f.x=t[0]+(v[0]-t[0])*g,f.y=t[1]+(v[1]-t[1])*g,f.z=t[2]+(v[2]-t[2])*g,k.position.copy(f);else{if(1===this.interpolationType||2===this.interpolationType)a[0]=this.getPrevKeyWith("pos",d,m.index-1).pos,a[1]=t,a[2]=v,a[3]=this.getNextKeyWith("pos",d,p.index+1).pos,g=.33*g+.33,p=interpolateCatmullRom(a,
g),f.x=p[0],f.y=p[1],f.z=p[2],k.position.copy(f),2===this.interpolationType&&(p=interpolateCatmullRom(a,1.01*g),c.set(p[0],p[1],p[2]),c.sub(vector),c.y=0,c.normalize(),p=Math.atan2(c.x,c.z),k.rotation.set(0,p,0))}else"text"===q?(p=Math.abs(this.currentTime-p.time)<this.epsilon?v:t,this.updateText(k.position,p)):"vis"===q&&(g=document.getElementById(this.id))&&(p=Math.abs(this.currentTime-p.time)<this.epsilon?v:t,g.style.visibility=p?"visible":"hidden")}k.matrixAutoUpdate=!0;k.matrixWorldNeedsUpdate=
!0}}}}();a.PolylineAnimation=function(b,c,f){this.viewer=f.viewer;null===b&&(b=this.createPolyline([]));a.Animation.call(this,b,c,f);this.epsilon=.1};a.PolylineAnimation.prototype=Object.create(a.Animation.prototype);a.PolylineAnimation.prototype.constructor=a.PolylineAnimation;a.PolylineAnimation.prototype.keyTypes=["points","vis"];a.PolylineAnimation.prototype.defaultKey={points:[],vis:1};a.PolylineAnimation.prototype.stop=function(){a.Animation.prototype.stop.call(this);this.viewer.removeOverlay("polyline",
this.root);this.root=null};a.PolylineAnimation.prototype.update=function(){function a(b){b.root&&(b.viewer.removeOverlay("polyline",b.root),b.root=null)}return function(c){if(!1!==this.isPlaying&&(this.currentTime+=c*this.timeScale,this.resetIfLooped(),!this.isPlayingOutOfRange()))if(this.isPaused&&this.currentTime<this.startKeyTime)a(this);else{c=0;for(var f=this.hierarchy.length;c<f;c++)for(var d=this.hierarchy[c].animationCache[this.data.name],g=0;g<this.keyTypes.length;g++){var h=this.keyTypes[g],
k=d.prevKey[h],l=d.nextKey[h];if(l.time<=this.currentTime||k.time>=this.currentTime){k=this.data.hierarchy[c].keys[0];for(l=this.getNextKeyWith(h,c,1);l.time<this.currentTime&&l.index>k.index;)k=l,l=this.getNextKeyWith(h,c,l.index+1);d.prevKey[h]=k;d.nextKey[h]=l}var n=k[h],q=l[h];if(l.time!==k.time&&void 0!==n&&void 0!==q)if(k=(this.currentTime-k.time)/(l.time-k.time),0>k&&(k=0),1<k&&(k=1),"points"===h){h=.5>k?n:q;this.viewer.removeOverlay("polyline",this.root);this.root=null;for(var l=[],m=0;m<
h.length;m++){var p=h[m].slice();if(0===m)p[0]=n[m][0]+(q[m][0]-n[m][0])*k,p[1]=n[m][1]+(q[m][1]-n[m][1])*k,p[2]=n[m][2]+(q[m][2]-n[m][2])*k;else if(m===h.length-1){var t=n.length-1,v=q.length-1;p[0]=n[t][0]+(q[v][0]-n[t][0])*k;p[1]=n[t][1]+(q[v][1]-n[t][1])*k;p[2]=n[t][2]+(q[v][2]-n[t][2])*k}p=new THREE.Vector3(p[0],p[1],p[2]);l.push(p)}this.root=this.createPolyline(l)}else"vis"===h&&(n=Math.abs(this.currentTime-l.time)<this.epsilon?q:n,(this.root.visible=n)||a(this))}}}}();a.PolylineAnimation.prototype.createPolyline=
function(a){for(var c=new THREE.Geometry,f=0;f<a.length;f++)c.vertices.push(a[f]);c.computeLineDistances();a=new THREE.LineDashedMaterial({color:0,dashSize:1,gapSize:.5,linewidth:1});c=new THREE.Line(c,a,THREE.LineStrip);void 0===this.viewer.overlayScenes.polyline&&this.viewer.createOverlayScene("polyline");this.viewer.addOverlay("polyline",c);return c};a.interpolateCatmullRom=function(a,c){function f(a,b,c,d,f,g,h){a=.5*(c-a);d=.5*(d-b);return(2*(b-c)+a+d)*h+(-3*(b-c)-2*a-d)*g+a*f+b}var d=[],g=[],
h,k,l,n,q,m;h=(a.length-1)*c;k=Math.floor(h);h-=k;d[0]=0===k?k:k-1;d[1]=k;d[2]=k>a.length-2?k:k+1;d[3]=k>a.length-3?k:k+2;k=a[d[0]];n=a[d[1]];q=a[d[2]];m=a[d[3]];d=h*h;l=h*d;g[0]=f(k[0],n[0],q[0],m[0],h,d,l);g[1]=f(k[1],n[1],q[1],m[1],h,d,l);g[2]=f(k[2],n[2],q[2],m[2],h,d,l);return g}})();AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.KeyFrameAnimator=function(a,b){this.animations=[];this.viewer=a;this.keys=[];this.isPlaying=!1;this.isPaused=!0;this.updateFlag=0;this.duration=b;this.currentTime=0;this.onPlayCallback=null;this.animationHandler=new Autodesk.Viewing.Private.AnimationHandler;this.areCameraAnimationsPaused=!1;this.UPDATE_SCENE=1;this.UPDATE_CAMERA=2};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.add=function(a){if(!(!a.hierarchy||1>a.hierarchy.length||!a.hierarchy[0].keys||2>a.hierarchy[0].keys.length)){var b=null,c=this;"camera"===a.type?(b=new Autodesk.Viewing.Private.CameraAnimation(c.viewer.camera,a,c),c.animations.push(b)):"annotation"===a.type?(b=new Autodesk.Viewing.Private.AnnotationAnimation(null,a,c),c.animations.push(b)):"polyline"===a.type?(b=new Autodesk.Viewing.Private.PolylineAnimation(null,a,c),c.animations.push(b)):"mesh"!==
a.type&&"visibility"!==a.type||function l(d){var f=d.fragIds;if(void 0!==f){Array.isArray(f)||(f=[f]);for(var g=0;g<f.length;g++){var h=c.viewer.getRenderProxy(c.viewer.model,f[g]);h&&(b="mesh"===a.type?new Autodesk.Viewing.Private.MeshAnimation(h,a,c):new Autodesk.Viewing.Private.VisibilityAnimation(h,a,d,c),c.animations.push(b))}}if(d.children)for(f=0;f<d.children.length;f++)l(d.children[f])}(c.viewer.model.getNodeById(a.id));if(b){for(var f=0,d=a.hierarchy.length;f<d;f++)for(var g=a.hierarchy[f].keys,
h=0;h<g.length;h++)void 0===g[h].xk&&c.keys.push(g[h].time);(function(a){a.sort(function(a,b){return a-b});(function(a,b,c){for(b=a.length;c=--b;)for(;c--;)a[b]!==a[c]||a.splice(c,1)})(a)})(c.keys)}this.updateFlag|=this.UPDATE_SCENE}};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.update=function(a){this.animationHandler.update(a);var b=this.updateFlag;if(this.isPlaying&&!this.isPaused){this.currentTime+=a;this.currentTime=Math.min(this.currentTime,this.duration);if(this.onPlayCallback)this.onPlayCallback(0<this.duration?this.currentTime/this.duration*100:0);this.currentTime>=this.duration&&this.pause();b|=this.UPDATE_SCENE}this.updateFlag=0;return b};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.play=function(a,b){this.onPlayCallback=b;this.currentTime>=this.duration&&this.goto(0);if(this.isPlaying)this.pause();else{for(var c=0;c<this.animations.length;c++)this.animations[c].play(a);this.isPlaying=!0;this.isPaused=!1}};Autodesk.Viewing.Private.KeyFrameAnimator.prototype.pause=function(){for(var a=0;a<this.animations.length;a++){var b=this.animations[a];b.isPaused===this.isPaused&&b.pause()}this.areCameraAnimationsPaused=this.isPaused=!this.isPaused};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.pauseCameraAnimations=function(){for(var a=0;a<this.animations.length;a++){var b=this.animations[a];b instanceof Autodesk.Viewing.Private.CameraAnimation&&b.pause()}this.areCameraAnimationsPaused=!this.areCameraAnimationsPaused};Autodesk.Viewing.Private.KeyFrameAnimator.prototype.stop=function(){for(var a=0;a<this.animations.length;a++)this.animations[a].stop();this.isPaused=this.isPlaying=!1};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.goto=function(a){if(void 0!==a){for(var b=0;b<this.animations.length;b++)this.animations[b].goto(a);this.isPaused=this.isPlaying=!0;this.currentTime=a;this.updateFlag|=this.UPDATE_SCENE}};Autodesk.Viewing.Private.KeyFrameAnimator.prototype.next=function(){for(var a=this.keys,b=-1,c=0;c<a.length;c++)if(a[c]>this.currentTime){b=a[c];break}this.goto(0>b?a[a.length-1]:b)};
Autodesk.Viewing.Private.KeyFrameAnimator.prototype.prev=function(){for(var a=this.keys,b=-1,c=a.length-1;-1<c;c--)if(a[c]<this.currentTime){b=a[c];break}this.goto(0>b?a[0]:b)};AutodeskNamespace("Autodesk.Viewing.Private");void 0===ENABLE_DEBUG&&(ENABLE_DEBUG=!0);void 0===ENABLE_TRACE&&(ENABLE_TRACE=!0);var RENDER_NORMAL=0,RENDER_HIGHLIGHTED=1,RENDER_HIDDEN=2,RENDER_FINISHED=3;
Autodesk.Viewing.Private.Viewer3DImpl=function(a,b){function c(a){var b=m,c=b==RENDER_NORMAL,d=I.settings.idbuffer&&b!=RENDER_HIDDEN;b==RENDER_HIDDEN?a.overrideMaterial=h.fadeMaterial:b==RENDER_HIGHLIGHTED&&(a.overrideMaterial=h.highlightMaterial);I.renderScenePart(a,!0,c,d);a.overrideMaterial=null}function f(){if((U.enabled||O)&&!h.is2d){var a;if(a=h.model&&!h.model.isLoadDone()?h.model.getData().bbox:h.getVisibleBounds(!0,!1)){U.needClear=!0;var b=h.camera,c=a.clone(),d=new THREE.Vector3(1,0,0),
f=c.center();a=c.size();b.worldUpTransform&&(d.applyMatrix4(b.worldUpTransform),c.applyMatrix4(b.worldUpTransform),a=c.size());a.multiply(new THREE.Vector3(1.25,1.01,1.25));a.x=a.z=Math.max(a.x,a.z);U.setTransform(f,a,b.worldup,d);O&&(c=(new THREE.Vector3).subVectors(f,b.worldup.clone().multiplyScalar(a.y/2)),O.setTransform(c,b.worldup,a))}}}function d(a,b){b.updateMatrixWorld(!0);b.traverse(function(b){var c=b.geometry;void 0!==c&&(c.boundingBox||c.computeBoundingBox(),M.copy(c.boundingBox),M.applyMatrix4(b.matrixWorld),
a.union(M))})}function g(a){if(-1==a.indexOf(";base64,")){var b=a.split(",");a=b[0].split(":")[1];b=decodeURIComponent(b[1]);return new Blob([b],{type:a})}b=a.split(";base64,");a=b[0].split(":")[1];for(var b=window.atob(b[1]),c=b.length,d=new Uint8Array(c),f=0;f<c;++f)d[f]=b.charCodeAt(f);return new Blob([d],{type:a})}var h=this,k=Autodesk.Viewing.Private,l=1E3/15,n=1E3/30,q=1E3/120,m=RENDER_NORMAL,p=-1,t=-1,v=!1,D=new THREE.Vector3(0,1,0),w="y",F,B,z,G,A,E,H,I,J=!1,L=!1,C=!1,N=!1,K,R=0,T=0,ba=0,
X=0,Y=1E3/60,W=!0,U,O,da=function(){var a,b=0,c=0,d=0;return function(f){if(U.enabled&&!h.is2d&&A&&!W)if(f&&(U.rendered=!1),a!=A.getGeomScenes()&&(U.needClear=!0),U.needClear&&(U.clear(),U.needClear=!1,a=A.getGeomScenes(),b=a.length,c=0,d=Math.max(Math.ceil(b/10),10)),U.isValid())U.rendered||O&&O.progressive||(U.renderShadow(h.camera,I.getColorTarget()),U.rendered=!0);else{for(f=0;f<d&&c<b;){var g=a[c];g&&(g.forceVisible=!0,U.renderIntoShadow(g),g.forceVisible=!1);f++;c++}c>=b&&(U.postprocess(),U.rendered||
O&&O.progressive||(U.renderShadow(h.camera,I.getColorTarget()),U.rendered=!0,A.isDone()&&I.presentBuffer()))}}}(),V=function(){var a,b=0,c=0,d=0;return function(f){if(O&&(!O.finished||f)&&!h.is2d&&A&&!W){if(f){O.clear();O.updateCamera(h.camera);O.rendered=!1;O.finished=!1;if(O.isGroundCulled())return;a=A.getGeomScenes();b=a.length;c=0;d=Math.max(Math.ceil(b/20),1)}if(!O.isGroundCulled()){for(f=0;f<d&&c<b;){var g=a[c];g.forceVisible=!0;O.renderIntoReflection(g);g.forceVisible=!1;f++;c++}c<b?O.rendered=
!1:O.finished=!0;O.rendered||O.isGroundCulled()||!(O.finished||O.progressive&&!A.isDone())||(O.postprocess(),U.enabled&&U.isValid()&&(U.renderShadow(h.camera,O.outTarget),U.rendered=!0),O.renderReflection(h.camera,I.getColorTarget()),O.rendered=!0,A.isDone()&&(h.showGhosting&&!A.areAllVisible()?(m=RENDER_HIDDEN,A.reset(h.camera,m)):I.presentBuffer()))}}}}();this.run=function(){F=0;(function ja(a){F=window.requestAnimationFrame(ja);B&&B&&(h.camera.aspect=z/G,I.setSize(z,G),h.controls.handleResize(),
O&&O.setSize(z,G),h.invalidate(!0,!0,!0),B=!1,h.api.fireEvent({type:Autodesk.Viewing.VIEWER_RESIZE_EVENT}));E.updateMaterials();var b;if(h.keyFrameAnimator)a:{if(h.keyFrameAnimator&&(b=h.keyFrameAnimator.update(0<X?(a-X)/1E3:0))&&(h.sceneUpdated(!0),b&h.keyFrameAnimator.UPDATE_CAMERA)){b=!0;break a}b=!1}else b=!1;b=h.controls.update(a)||b||K;J=J||b;C=(C=C||b)||I.overlayUpdate(a);var d=h.model&&h.model.isLoadDone(),g=h.progressiveRender?h.targetFrameTime:1E10,k=g,p=A;N&&N&&(f(),N=!1);J||L?(d&&h.signalProgress(0,
null),0<T&&(ba=.75*ba+.25*(a-T)),T=a,ba<n&&g<l?h.targetFrameTime+=1:ba>n&&g>q&&--h.targetFrameTime,h.updateCameraMatrices(),I.beginScene(h.scene,h.camera,h.lights,J),b&&h.api.fireEvent(h.cameraChangedEvent),p&&(m=p.hasHighlighted()?RENDER_HIGHLIGHTED:RENDER_NORMAL,p.reset(h.camera,m))):T=-1;da(J);V(J);if(p&&!p.isDone())if(k=p.renderSome(c,k),p.isDone()&&m===RENDER_HIGHLIGHTED&&(m=RENDER_NORMAL,p.reset(h.camera,m),p.renderSome(c,k)),b||C||(0<X&&(Y=.8*Y+.2*(a-X)),I.composeFinalFrame()),p.isDone()){if(m===
RENDER_NORMAL&&!p.areAllVisible()&&h.showGhosting){if(!O||O.finished)m=RENDER_HIDDEN,p.reset(h.camera,m)}else m=RENDER_FINISHED,I.composeFinalFrame(b&&h.skipAOWhenMoving,!0);d&&h.signalProgress(100,null)}else d&&h.signalProgress(100*p.getRenderProgress(),null);C&&(p&&p.isDone()||h.showOverlaysWhileMoving?(h.renderOverlays(),p&&!p.isDone()&&(C=!0)):I.clearAllOverlays(),I.composeFinalFrame(b&&h.skipAOWhenMoving,p&&p.isDone()),0<X&&(Y=.8*Y+.2*(a-X)));v&&!b&&h.skipAOWhenMoving&&I.composeFinalFrame();
v=b;X=a;K=J=L=!1})()};this.toggleProgressive=function(a){this.progressiveRender=a;J=!0};this.toggleGhosting=function(a){this.showGhosting=a;J=!0};this.toggleOverlaysWhileMoving=function(a){this.showOverlaysWhileMoving=a};this.togglePostProcess=function(a,b){I.initPostPipeline(a,b);this.fireRenderOptionChanged();J=!0};this.toggleCelShading=function(a){I.toggleCelShading(a);this.fireRenderOptionChanged();J=!0};this.toggleGroundShadow=function(a){U.enabled!==a&&(U.enabled=a,U.needClear=!0,f(),this.fireRenderOptionChanged(),
this.invalidate(!0,!1,!1))};this.setGroundShadowColor=function(a){U.enabled&&(U.setColor(a),this.invalidate(!0,!1,!1))};this.setGroundShadowAlpha=function(a){U.enabled&&(U.setAlpha(a),this.invalidate(!0,!1,!1))};this.toggleGroundReflection=function(a){a&&O||!a&&!O||(a?(O=new GroundReflection(H,this.canvas.clientWidth,this.canvas.clientHeight),O.setClearColors(this.clearColorTop,this.clearColorBottom),O.progressive=!0,f()):(O.cleanup(),O=void 0),this.fireRenderOptionChanged(),this.invalidate(!0,!1,
!1))};this.setGroundReflectionColor=function(a){O&&(O.setColor(a),this.invalidate(!0,!1,!1))};this.setGroundReflectionAlpha=function(a){O&&(O.setAlpha(a),this.invalidate(!0,!1,!1))};this.setOptimizeNavigation=function(a){this.skipAOWhenMoving=a};this.renderOverlays=function(){var a=this.lightsOn;a||this.toggleLights(!0,!0);var b;this.dir_light1&&(b=this.dir_light1.intensity,this.dir_light1.intensity=1);I.renderOverlays(this.overlayScenes,this.lights);a||this.toggleLights(!1,!0);this.dir_light1&&(this.dir_light1.intensity=
b);C=!1};this.setLayerVisible=function(a,b){this.matman().setLayerVisible(a,b)};this.isLayerVisible=function(a){return this.matman().isLayerVisible(a)};this.updateCameraMatrices=function(){var a=new THREE.Matrix4,b=new THREE.Matrix4,c=new THREE.Box3;return function(){var d=this.camera;a.compose(d.position,d.quaternion,d.scale);b.getInverse(a);d.worldup&&this.setWorldUp(d.worldup);if(this.model){var f=this.getVisibleBounds(!0,!1);c.copy(f);c.applyMatrix4(b);var g=1E-5*(c.max.z-c.min.z),h=.5*(c.max.y-
c.min.y),k=-(c.max.z+g)-h,g=-(c.min.z-g)+h;d.isPerspective&&(k=Math.max(k,Math.min(1,1E-4*Math.abs(g-k))));g=Math.max(g,k);d.near=k;d.far=g;d.updateProjectionMatrix();this.model.is2d()&&(f=(k=this.intersectGroundViewport(new THREE.Vector3(0,0,1)))?d.position.distanceTo(k):d.position.distanceTo(f.center()),d=I.settings.deviceHeight/(2*f*Math.tan(THREE.Math.degToRad(.5*d.fov))),E.updatePixelScale(.5*d))}}}();this.initLights=function(a){var b=k.LightPresets[p].lightMultiplier;this.lightNode=new THREE.Object3D;
this.dir_light1=new THREE.DirectionalLight((new THREE.Color).setRGB(1,1,1),b);this.dir_light1.position.set(-1,0,1);this.dir_light1.position.multiplyScalar(1E3*a);this.lightNode.add(this.dir_light1);this.amb_light=new THREE.AmbientLight((new THREE.Color).setRGB(1,1,1));this.camera.add(this.lightNode);this.toggleLights(0!==b)};this.toggleLights=function(a,b){if(this.amb_light&&this.lightNode){a&&!this.lightsOn?(this.lights=[this.dir_light1,this.amb_light],this.lightsOn=!0):!a&&this.lightsOn&&(this.lightsOn=
!1,this.lights=[]);var c=k.LightPresets[p],d=c.ambientLightColor,c=c.directLightColor;this.lightsOn?(b&&this.amb_light?this.amb_light.color.setRGB(.5*c[0],.5*c[1],.5*c[2]):d&&this.amb_light&&this.amb_light.color.setRGB(d[0],d[1],d[2]),c&&this.dir_light1&&this.dir_light1.color.setRGB(c[0],c[1],c[2])):d&&this.amb_light&&b&&this.amb_light.color.setRGB(d[0],d[1],d[2])}};this.syncCamera=function(a){this.camera.updateProjectionMatrix();a&&this.setWorldUp(this.api.navigation.getWorldUpVector());K=!0};this.setViewFromFile=
function(a,b){var c;c=a.getDefaultCamera();if(!c){c={};var d=a.getBoundingBox(),f=d.size();c.target=d.center();a.is2d()?(c.isPerspective=!1,d=this.camera.aspect,c.orthoScale=d>f.x/f.y?f.y:f.x/d,c.up=new THREE.Vector3(0,0,1),c.position=c.target.clone(),c.position.z+=c.orthoScale,c.target.y+=1E-6*f.y):(c.isPerspective=!0,c.fov=this.camera.fov,c.up=this.camera.up.clone(),c.position=c.target.clone(),c.position.z+=1.5*Math.max(f.x,f.y,f.z))}this.setViewFromCamera(c,b)};this.setViewFromCamera=function(a,
b){if(!a.isPerspective&&this.model){var c=this.model.getBoundingBox(),d=c.size(),f=a.target.clone().sub(a.position);f.length()>1E3*d.length()?(c=a.position.distanceTo(c.center()),a.target.copy(a.position).add(f.normalize().multiplyScalar(c))):a.position.copy(a.target).add(f.normalize().multiplyScalar(-a.orthoScale))}f=this.model?this.model.getUpVector():null;this.model&&-1!=this.model.getData().basePath.indexOf("SaRang")&&(f=[0,0,1]);c=f?(new THREE.Vector3).fromArray(f):Autodesk.Viewing.Navigation.snapToAxis(a.up.clone());
a.up=c;f=this.api.navigation;b?(c=this.camera,c.up.copy(a.up),c.position.copy(a.position),c.target.copy(a.target),a.isPerspective?c.fov=a.fov:(c.saveFov=a.fov,c.fov=Autodesk.Viewing.UnifiedCamera.ORTHO_FOV),c.isPerspective=a.isPerspective,c.orthoScale=a.orthoScale,c.dirty=!0,f.setWorldUpVector(c.up),f.setView(c.position,c.target),f.setPivotPoint(c.target),this.syncCamera(!0)):(this.camera.isPerspective=a.isPerspective,c=f.computeOrthogonalUp(a.position,a.target),f.setRequestTransitionWithUp(!0,a.position,
a.target,a.fov,c,a.up));K=!0};this.setViewFromViewBox=function(a,b,c,d){if(a.is2d()){c={};a=a.getBoundingBox();var f=b[2]-b[0],g=b[3]-b[1],h;h=b[0]+f/2;b=b[1]+g/2;var k=this.camera.aspect;c.orthoScale=k>f/g?g:f/k;c.isPerspective=!1;c.position=new THREE.Vector3(h,b,a.center().z+c.orthoScale);c.target=new THREE.Vector3(h,b,a.center().z);c.target.y+=1E-6*g;c.up=new THREE.Vector3(0,0,1);this.setViewFromCamera(c,d)}};this.setWorldUp=function(a){if(!D.equals(a)){D.copy(a);var b=Math.abs(a.x);w="x";Math.abs(a.y)>
b&&(w="y",b=Math.abs(a.y));Math.abs(a.z)>b&&(w="z");var c=new THREE.Vector3(0,1,0),b=h.camera,d=(new THREE.Vector3).crossVectors(a,c).normalize();a=Math.acos(c.dot(a));a=(new THREE.Matrix4).makeRotationAxis(d,a);b.worldUpTransform=a;this.sceneUpdated(!1)}};this.setModel=function(a){a&&(this.model=a,this.selector.model=this.model,this.visibilityManager.model=this.model,this.model.setLoader(this.loader),this.initScene())};this.initScene=function(){if(this.model){var a=this.model,b=a.getBoundingBox();
I.setUnitScale(a.getUnitScale());var c=a.is2d();c&&this.enter2DMode();this.api.navigation.setIs2D(c);this.api.setActiveNavigationTool();A=new RenderQueue(a);this.setViewFromFile(a,!0);this.controls.recordHomeView();a=.5*b.size().length();this.initLights(a);c||this.setLightPresetFromFile()||this.setLightPreset(p,!0);this.invalidate(!0)}};this.addGeometry=function(a,b){return A.getGeometryList().addGeometry(a,b)};this.addMeshInstance=function(a,b,c,d){var f=this.model.getData();a=A.getGeometryList().getGeometry(a);
if(0!==b||-1==f.basePath.indexOf("SaRang")){var g;if(a.isLines){var h=!!a.attributes.color;g=new THREE.LineBasicMaterial({vertexColors:h});h||(c=E.findMaterial(f,c),g.color=c.color);g=new THREE.Mesh(a,g,!f.animations);g.isLine=!0;f.hasLines=!0}else g=E.findMaterial(f,c),E.applyGeometryFlagsToMaterial(g,a),g=new THREE.Mesh(a,g,!f.animations),g.materialId=parseInt(c),a.is2d&&(g.is2d=!0);d&&(g.matrix&&g.matrix.copy(d),g.matrixWorld.copy(d));g.matrixAutoUpdate=!1;A.addMeshInstance(b,g)}};this.onLoadComplete=
function(){W=!1;this.signalProgress(100,"");this.sceneUpdated(!1);this.is2d&&(this.selectionMaterial2d=E.init2DSelectionMaterial(this.model),this.createOverlayScene("selection2d",this.selectionMaterial2d));var a=this.model.getData();A.getGeometryList().printStats();a.hasLines&&E.togglePolygonOffset(!0);if(a.animations){this.keyFrameAnimator=new Autodesk.Viewing.Private.KeyFrameAnimator(this,a.animations.duration);for(var b in a.animations.animations)this.keyFrameAnimator.add(a.animations.animations[b]);
this.keyFrameAnimator.goto(0)}this.api.fireEvent({type:Autodesk.Viewing.GEOMETRY_LOADED_EVENT})};this.setBVH=function(a,b){A.setBVH(a,b)};this.signalProgress=function(a,b){this.api.fireEvent({type:Autodesk.Viewing.PROGRESS_UPDATE_EVENT,percent:a,message:b})};this.resize=function(a,b){B=!0;z=a;G=b};this.enter2DMode=function(){this.is2d=!0;E.initLayersTexture(this.model);var a=E.create2DMaterial(this.model.getData(),{},!0),a=E.findMaterial(this.model.getData(),a);I.enter2DMode(a);t=p;this.setLightPreset(k.DefaultLightPreset2d);
a=this.model.getData();if(a.hidePaper){var b=a.bgColor,a=b>>16&255,c=b>>8&255,b=b&255;this.setClearColors(a,c,b,a,c,b)}this.fireRenderOptionChanged();J=!0};this.unloadCurrentModel=function(){this.is2d&&(this.is2d=void 0,this.selectionMaterial2d=null,this.removeOverlay("selection2d"),I.exit2DMode());I.beginScene(this.scene,this.camera,this.lights,!0);I.composeFinalFrame();A&&(A.cleanup(),A=null);this.model&&(E.cleanup(this.model.getData()),this.model=null);0<=t&&(p=t)};this.createOverlayScene=function(a,
b,c,d){b&&E.addMaterialNonHDR(a+"_pre",b);c&&E.addMaterialNonHDR(a+"_post",c);var f=new THREE.Scene;f.__lights=this.scene.__lights;this.overlayScenes[a]={scene:f,camera:d,materialPre:b,materialPost:c}};this.removeOverlayScene=function(a){this.overlayScenes[a]&&(delete this.overlayScenes[a],this.invalidate(!1,!1,!0))};this.addOverlay=function(a,b){this.overlayScenes[a].scene.add(b);this.invalidate(!1,!1,!0)};this.removeOverlay=function(a,b){this.overlayScenes[a].scene.remove(b);this.invalidate(!1,
!1,!0)};this.clearOverlay=function(a){a=this.overlayScenes[a].scene;var b,c;for(c=a.children.length-1;0<=c;--c)(b=a.children[c])&&a.remove(b);this.invalidate(!1,!1,!0)};this.setClearColors=function(a,b,c,d,f,g){this.clearColorTop=new THREE.Vector3(a/255,b/255,c/255);this.clearColorBottom=new THREE.Vector3(d/255,f/255,g/255);E.reflectionCube&&!E.reflectionCube.isBgColor||E.setCubeMapFromColors(this.clearColorTop,this.clearColorBottom);I.setClearColors(this.clearColorTop,this.clearColorBottom);O&&O.setClearColors(this.clearColorTop,
this.clearColorBottom);J=!0;this.fireRenderOptionChanged()};var M=new THREE.Box3;this.getVisibleBounds=function(a,b){var c=null;if(A&&(c=A.getVisibleBounds(a),b)){var f=new THREE.Box3,g=h.overlayScenes,k;for(k in g)g.hasOwnProperty(k)&&d(f,g[k].scene);d(f,h.scene);c=f.union(c)}return c};this.getFitBounds=function(a){var b;this.is2d&&(a=!0);a||null===this.selector||(b=this.selector.getSelectionBounds());if(!b||b.empty())b=this.getVisibleBounds();return b};this.getRenderProxy=function(a,b){return A?
A.getFragmentList().getVizmesh(b):null};this.getRenderProxyCount=function(a){return A?A.getFragmentList().getCount():0};this.getRenderProxyDbIds=function(a,b){return A?A.getFragmentList().getDbIds(b):null};this.setFragmentVisibility=function(a,b,c){A&&(A.setVisibility(b,c),this.sceneUpdated(!0))};this.setModelVisibility=function(a,b){A&&(A.setAllVisibility(b),this.sceneUpdated(!0))};this.isWholeModelVisible=function(a){return A?A.areAllVisible():!0};this.resetIsolation=function(a){A&&(this.needGhostedPass=
!1,this.invalidate(!0))};this.highlightObjectNode=function(a,b,c,d){a.is2d()&&E.highlightObject2D(b.dbId,c);b=b.fragIds;if("undefined"!=typeof b){Array.isArray(b)||(b=[b]);for(var f=0;f<b.length;++f)this.highlightFragment(a,b[f],c,d)}};this.highlightFragment=function(a,b,c,d){var f=this.getRenderProxy(a,b);if(d=!d||f.is2d)if(a=a.is2d()?"selection2d":"selection",c){var g=new THREE.Mesh(f.geometry,f.material,!0);g.matrixWorld=f.matrixWorld;this.addOverlay(a,g);this.selectionMeshes[b]=g}else this.selectionMeshes[b]&&
(this.removeOverlay(a,this.selectionMeshes[b]),this.selectionMeshes[b]=null);d&&c||A.setHighlighted(b,c)&&this.invalidate(!0)};this.explode=function(a){if(a!=R&&this.model){R=a;var b=this.model,c=b.getData();if(c.instanceTree){var d=this.getVisibleBounds(!0).center(),f=c.fragments,g=f.transforms,k=a*(c.instanceTree.maxDepth-1)+1,l=0|k,m=k-l;a*=2;if(c.instanceTree&&c.instanceTree.boxes&&0!==a){var n=c.instanceTree.boxes;(function Da(c,d,f,k,q,p,N,w){var z=2*a;d==l&&(z*=m);var K=6*c.dbId,t=.5*(n[K]+
n[K+3]),B=.5*(n[K+1]+n[K+4]),K=.5*(n[K+2]+n[K+5]);0<d&&d<=l&&(p+=(t-f)*z,N+=(B-k)*z,w+=(K-q)*z);if(f=c.children)for(k=0,q=f.length;k<q;k++)Da(f[k],d+1,t,B,K,p,N,w);c=c.fragIds;if(void 0!==c)if(Array.isArray(c))for(d=0;d<c.length;d++)t=0|c[d],K=12*t,B=h.getRenderProxy(b,t).matrixWorld.elements,B[12]=g[K+9]+p,B[13]=g[K+10]+N,B[14]=g[K+11]+w;else t=c|0,B=h.getRenderProxy(b,t).matrixWorld.elements,K=12*t,B[12]=g[K+9]+p,B[13]=g[K+10]+N,B[14]=g[K+11]+w})(c.instanceTree.root,0,d.x,d.y,d.x,0,0,0)}else for(c=
f.boxes,k=0,f=f.length;k<f;k++){var q=6*k,p=12*k,N=.5*(c[q]+c[q+3]),w=.5*(c[q+1]+c[q+4]),q=.5*(c[q+2]+c[q+5]),N=a*(N-d.x),w=a*(w-d.y),q=a*(q-d.z),z=h.getRenderProxy(b,k).matrixWorld.elements;z[12]=g[p+9]+N;z[13]=g[p+10]+w;z[14]=g[p+11]+q}this.sceneUpdated(!0);this.api.fireEvent({type:Autodesk.Viewing.EXPLODE_CHANGE_EVENT})}}};this.getExplodeScale=function(){return R};this.setGhostingBrightness=function(a){this.fadeMaterial.color=a?new THREE.Color(1052688):new THREE.Color(16777215);this.fadeMaterial.needsUpdate=
!0};this.setLightPreset=function(a,b){if(p!=a||b){if(0>a||k.LightPresets.length<=a)a=k.DefaultLightPreset;p=a;var c=k.LightPresets[a];if(c&&c.path){var d="res/environments/"+c.path,f=k.getResourceUrl(d+"_mipdrop."+(c.type||"")+".dds"),d=k.getResourceUrl(d+"_irr."+(c.type||"")+".dds");E.setIrradianceMap(d,c.E_bias);E.setCubeMap(f,c.E_bias);E.setEnvExposure(-c.E_bias);this.setTonemapExposureBias(c.E_bias);this.setTonemapMethod(c.tonemap);this.setGhostingBrightness(c.darkerFade)}else E.setIrradianceMap(null),
E.setCubeMap(null),E.setEnvExposure(0),this.setTonemapExposureBias(0),this.setTonemapMethod(0),this.setGhostingBrightness(!1);f=SAOShader.uniforms.radius.value;d=SAOShader.uniforms.intensity.value;c.hasOwnProperty("saoRadius")&&(f=c.saoRadius);c.hasOwnProperty("saoIntensity")&&(d=c.saoIntensity);I.setAOOptions(f,d);(f=c.bgColorGradient)||(f=k.BackgroundPresets.Custom);this.setClearColors(f[0],f[1],f[2],f[3],f[4],f[5]);f=1;null!==c.lightMultiplier&&void 0!==c.lightMultiplier&&(f=c.lightMultiplier);
this.dir_light1&&(this.toggleLights(0!==f),this.dir_light1.intensity=f,c.lightDirection&&(this.dir_light1.position.set(-c.lightDirection[0],-c.lightDirection[1],-c.lightDirection[2]),this.dir_light1.position.multiplyScalar(1E3*this.model.getData().bbox.size().length())));this.invalidate(!0,!1,!0);this.fireRenderOptionChanged()}};this.setLightPresetFromFile=function(){var a=this.model.getMetadata("renderEnvironmentStyle","value",null);if(null===a||""===a)return!1;for(var b=this.model.getMetadata("renderEnvironmentExposureBias",
"value",null),c=this.model.getMetadata("renderEnvironmentExposureBase","value",null),d=0;d<k.LightPresets.length;d++)if(a===k.LightPresets[d].name)return null!==b&&null!==c&&(k.LightPresets[d].E_bias=b+c),this.setLightPreset(d),!0;return!1};this.setTonemapMethod=function(a){a!=I.getToneMapMethod()&&(I.setTonemapMethod(a),E.setTonemapMethod(a),this.fireRenderOptionChanged(),this.invalidate(!0))};this.setTonemapExposureBias=function(a){a!=I.getExposureBias()&&(I.setTonemapExposureBias(a),E.setTonemapExposureBias(a),
this.fireRenderOptionChanged(),this.invalidate(!0))};this.uninitialize=function(){window.cancelAnimationFrame(F);this.controls.uninitialize();this.canvas=this.controls=null;this.loader.uninitialize();this.loader=null;this.selector.uninitialize();E=I=A=this.visibilityManager=this.model=this.selector=null};this.hideLines=function(a){return A?(A.hideLines(a),this.sceneUpdated(!0),!0):!1};this.getCutPlanes=function(){return E.getCutPlanes()};this.setCutPlanes=function(a){E.setCutPlanes(a);this.sceneUpdated();
this.api.fireEvent({type:Autodesk.Viewing.CUTPLANES_CHANGE_EVENT})};this.setCutPlanesOutlineColor=function(a){E.setCutPlanesOutlineColor(a);this.invalidate(!0,!1,!1);this.api.fireEvent({type:Autodesk.Viewing.CUTPLANES_CHANGE_EVENT})};this.setCutPlanesOutlineThickness=function(a){E.setCutPlanesOutlineThickness(a);this.invalidate(!0,!1,!1);this.api.fireEvent({type:Autodesk.Viewing.CUTPLANES_CHANGE_EVENT})};this.fireRenderOptionChanged=function(){E.toggleMRTSetting();this.api.fireEvent({type:Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT})};
this.viewportToRay=function(a,b){var c=this.camera;a.z=-1;var d=new THREE.Vector3(a.x,a.y,1);a=a.unproject(c);d=d.unproject(c);d.sub(a).normalize();b||(b=new THREE.Ray);b.set(c.isPerspective?c.position:a,d);return b};this.rayIntersect=function(a,b,c){c=A.rayIntersect(a.origin,a.direction,b,c);if(!c)return null;a=c[0];b=c[1];c=c[2];var d=null;if(void 0!==a){var f=A.getFragmentList().getDbIds(a),g=this.model.getData().instanceTree;g&&(d=g.getNodeById(f));d||(d={dbId:a,fragIds:a})}return{node:d,intersectPoint:b,
face:c}};this.castRayViewport=function(){var a=new THREE.Ray;return function(b,c,d){if(!A)return{};this.viewportToRay(b,a);return this.rayIntersect(a,c,d)}}();this.clientToViewport=function(a,b){var c=h.canvas.getBoundingClientRect();return new THREE.Vector3((a+.5)/c.width*2-1,2*-((b+.5)/c.height)+1,1)};this.viewportToClient=function(a,b){var c=h.canvas.getBoundingClientRect();return new THREE.Vector3(.5*(a+1)*c.width-.5,-.5*(b-1)*c.height-.5,0)};this.castRay=function(a,b,c){return this.castRayViewport(this.clientToViewport(a,
b),c)};this.intersectGroundViewport=function(a){var b=this.camera,c="z";this.is2d||(c=w);var d=a;d.z=-1;a=new THREE.Vector3(d.x,d.y,1);d=d.unproject(b);a=a.unproject(b);a.sub(d).normalize();if(1E-6>Math.abs(a[c]))return null;b=b.isPerspective?b.position:d;c=((this.model?this.model.getBoundingBox().min[c]:0)-b[c])/a[c];a.multiplyScalar(c);a.add(b);return a};this.intersectGround=function(a,b){return this.intersectGroundViewport(this.clientToViewport(a,b))};this.hitTestViewport=function(a,b){var c;if(h.is2d){var d=
I.idAtPixel(a.x,a.y);c=this.intersectGroundViewport(a);d={dbId:d,fragIds:h.model.getData().fragments.dbId2fragId[d]};c={intersectPoint:c,node:d}}else c=this.castRayViewport(a,b);return c};this.hitTest=function(a,b,c){return h.hitTestViewport(this.clientToViewport(a,b),c)};this.snappingHitTestViewport=function(a,b){var c;if(h.is2d){c=I.idAtPixel(a.x,a.y);var d=this.intersectGroundViewport(a);c={dbId:c,fragIds:h.model.getData().fragments.dbId2fragId[c]};c={intersectPoint:d,node:c}}else c=I.idAtPixel(a.x,
a.y),(c=this.model.getNodeById(c))&&(d=void 0===c.fragIds.length?[c.fragIds]:c.fragIds),c=this.castRayViewport(a,b,d);return c};this.snappingHitTest=function(a,b,c){return this.snappingHitTestViewport(this.clientToViewport(a,b),c)};this.rolloverObjectViewport=function(a){I.rolloverObjectViewport(a.x,a.y)&&this.invalidate(!1,!1,!0)};this.rolloverObject=function(a,b){this.rolloverObjectViewport(this.clientToViewport(a,b))};this.getScreenShot=function(a,b,c){I.presentBuffer();var d=window.URL.createObjectURL(g(h.canvas.toDataURL("image/png")));
if(!a||!b)return d;var f,k,l=0,m=0;a>b||z/G<a/b?(f=a,k=G/z*a,m=b/2-k/2):(k=b,f=z/G*b,l=a/2-f/2);var n=new Image;n.src=d;var q=document.createElement("canvas"),p=q.getContext("2d");q.width=a;q.height=b;n.onload=function(){p.drawImage(n,l,m,f,k);var a=window.URL.createObjectURL(g(q.toDataURL("image/png")));c?c(a):window.open(a)}};this.modelQueue=function(){return A};this.glrenderer=function(){return H};this.renderer=function(){return I};this.worldUp=function(){return D};this.worldUpName=function(){return w};
this.setUserRenderContext=function(a){I=a?a:new RenderContext;I.init(H,this.canvas.clientWidth,this.canvas.clientHeight);I.setClearColors(this.clearColorTop,this.clearColorBottom);this.invalidate(!0);this.sceneUpdated(!1)};this.invalidate=function(a,b,c){J=J||a;L=L||b;C=C||c};this.sceneUpdated=function(a){this.invalidate(!0,!1,!0);A&&a&&(A.visibleBoundsDirty=!0);N=!0};this.currentLightPreset=function(){return p};this.matman=function(){return E};this.fps=function(){return 1E3/Y};this.api=b;this.canvas=
a;this.loader=this.svfloader=new k.SvfLoader(this);H=function(a){var b=window.devicePixelRatio;b||(b=1);a=new FireflyWebGLRenderer({canvas:a,antialias:!1,alpha:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,stencil:!1,depth:!1,devicePixelRatio:b});a.autoClear=!1;a.sortObjects=!1;return a}(a);I=new RenderContext;I.init(H,a.clientWidth,a.clientHeight);E=new k.MaterialManager(this);init_UnifiedCamera();this.camera=new Autodesk.Viewing.UnifiedCamera(a.clientWidth,a.clientHeight);this.lights=[];this.cameraChangedEvent=
this.camera.getCameraChangedEvent();this.scene=new THREE.Scene;this.overlayScenes={};this.selectionMaterial2d=null;this.selectionMaterialBase=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:1,transparent:!1});this.selectionMaterialTop=new THREE.MeshPhongMaterial({color:6724095,specular:526344,emissive:3361911,ambient:0,opacity:.15,transparent:!0});this.selectionMaterialTop.packedNormals=!0;this.selectionMaterialBase.packedNormals=!0;(function(a,b,c){b.depthWrite=
!1;b.depthTest=!0;b.side=THREE.DoubleSide;c.depthWrite=!1;c.depthTest=!0;c.side=THREE.DoubleSide;h.createOverlayScene(a,b,c)})("selection",this.selectionMaterialBase,this.selectionMaterialTop);this.selectionMeshes={};this.fadeMaterial=new THREE.MeshPhongMaterial({color:16777215,opacity:.1,reflectivity:0,transparent:!0,depthWrite:!1});this.fadeMaterial.packedNormals=!0;E.addMaterial("__fadeMaterial__",this.fadeMaterial,!0);this.highlightMaterial=new THREE.MeshPhongMaterial({color:6724095,specular:526344,
emissive:3361911,ambient:0,opacity:1,transparent:!1});this.highlightMaterial.packedNormals=!0;E.addMaterial("__highlightMaterial__",this.highlightMaterial,!0);this.progressiveRender=!0;if(isAndroidDevice()||isIOSDevice())l*=2,q*=2,n*=2;this.targetFrameTime=n;this.controls={update:function(a){},handleResize:function(){},recordHomeView:function(){},uninitialize:function(){}};this.selector=new k.Selector(this);this.visibilityManager=new k.VisibilityManager(this);this.showOverlaysWhileMoving=this.showGhosting=
!0;this.skipAOWhenMoving=!1;this.keyFrameAnimator=null;var la=k.LightPresets[k.DefaultLightPreset].bgColorGradient;this.setClearColors(la[0],la[1],la[2],la[3],la[4],la[5]);U=new GroundShadow(H);U.enabled=!0;E.addMaterialNonHDR("groundShadowDepthMaterial",U.getDepthMaterial());E.addMaterialNonHDR("normalsMaterial",I.getDepthMaterial());I.beginScene(this.scene,this.camera,this.lights,!0);I.composeFinalFrame()};Autodesk.Viewing.Private.Viewer3DImpl.prototype.constructor=Autodesk.Viewing.Private.Viewer3DImpl;
AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.ViewerState=function(a){this.getState=function(b){var c=a.navigation,f=Autodesk.Viewing.Private,d={},g;g=Math.round(4294967295*Math.random());var h=Date.now();g=g.toString(16)+h.toString(16);d.guid=g;d.seedURN=a.impl.loader.svfUrn;d.overrides=this.getTransformsOverrides();g=d.objectSet;Array.isArray(g)||(d.objectSet=g=[]);a.model&&!a.model.is2d()&&(g[0]={id:this.getSelectedNodes(),isolated:this.getIsolatedNodes(),hidden:this.getHiddenNodes(),explodeScale:a.getExplodeScale(),
idType:"lmv"});a.model&&a.model.is2d()&&(g[0]={id:this.getSelectedNodes(),isolated:this.getVisibleLayers2d(),hidden:[],idType:"lmv"});(g=d.viewport)||(g=d.viewport={});h=c.getCamera().isPerspective;g.name="";g.eye=c.getPosition().toArray();g.target=c.getTarget().toArray();g.up=c.getCameraUpVector().toArray();g.worldUpVector=c.getWorldUpVector().toArray();g.pivotPoint=c.getPivotPoint().toArray();g.distanceToOrbit=c.getPivotPlaneDistance();g.aspectRatio=this.getAspectRatio();g.projection=h?"perspective":
"orthographic";g.isOrthographic=!h;h?g.fieldOfView=c.getVerticalFov():g.orthographicHeight=this.getOrthographicHeight();(c=d.renderOptions)||(c=d.renderOptions={});c.environment=f.LightPresets[a.impl.currentLightPreset()].name;c.ambientOcclusion={enabled:a.impl.renderer().settings.sao,radius:a.impl.renderer().getAORadius(),intensity:a.impl.renderer().getAOIntensity()};c.toneMap={method:a.impl.renderer().getToneMapMethod(),exposure:a.impl.renderer().getExposureBias(),lightMultiplier:this.getToneMapIntensity()};
c.appearance={ghostHidden:a.impl.showGhosting,ambientShadow:a.prefs.ambientShadows,antiAliasing:a.impl.renderer().settings.antialias,progressiveDisplay:a.prefs.progressiveRendering,displayLines:a.prefs.lineRendering};if(a.model&&!a.model.is2d())for(f=d.cutplanes=[],c=a.getCutPlanes(),g=0;g<c.length;g++)f.push(c[g].toArray());for(var k in a.loadedExtensions)a.loadedExtensions[k].getState(d);b&&!0!==b&&this.applyFilter(d,b);return d};this.restoreState=function(b,c,f){if(!b)return stderr("restoreState has no viewer state to restore from."),
!1;if(!a||!a.model)return stderr("restoreState has no viewer or model to restore."),!1;c&&!0!==c&&(b=JSON.parse(JSON.stringify(b)),this.applyFilter(b,c));c=a.navigation;if(c.getTransitionActive())return stderr("Abort restoreState, animation in progress..."),!1;if(a.model&&Array.isArray(b.objectSet)&&0<b.objectSet.length){var d=b.objectSet[0],g=a.impl?a.impl.selector:null;if(!a.model.is2d()&&a.model.getRoot()){var h=d.id;h&&g&&(h=this.toIntArray(h),g.setSelectionIds(h));h=d.isolated||[];h=this.toIntArray(h);
a.isolateById(h);0===h.length&&(h=d.hidden||null)&&0<h.length&&(h=this.toIntArray(h),a.hideById(h));"explodeScale"in d&&(h=parseFloat(d.explodeScale),a.explode&&(a.explode(h),a.explodeSlider&&(a.explodeSlider.value=h)))}a.model.is2d()&&(h=d.id||[],g&&(h=h.map(function(a){return{dbId:a,fragIds:0}}),g.setSelection(h)),d=d.isolated,Array.isArray(d)&&0<d.length?(a.setLayerVisible(null,!1),a.impl.setLayerVisible(d,!0)):a.setLayerVisible(null,!0))}if(d=b.viewport){var g=this.getVector3FromArray(d.eye,c.getPosition()),
h=this.getVector3FromArray(d.up,c.getCamera().up),k=this.getVector3FromArray(d.target,c.getTarget()),l="fieldOfView"in d?parseFloat(d.fieldOfView):c.getVerticalFov(),n=this.getVector3FromArray(d.pivotPoint,c.getPivotPoint());c.setCameraUpVector(h);"isOrthographic"in d&&(d.isOrthographic?c.toOrthographic():c.toPerspective());f?(c.setVerticalFov(l,!1),c.setView(g,k)):c.setRequestTransition(!0,g,k,l,!1);c.setPivotPoint(n);c.setPivotSetFlag(!0)}if(g=b.renderOptions){c=a.prefs.ambientShadows;d=a.prefs.antialiasing;
if(k=g.ambientOcclusion)"enabled"in k&&(c=k.enabled),h="radius"in k?k.radius:null,k="intensity"in k?k.intensity:null,null!==h&&null!==k&&(a.impl.renderer().setAOOptions(h,k),a.impl.renderer().composeFinalFrame(!1));"environment"in g&&(h=this.getLightPresetIndex(g.environment),-1!==h&&a.setLightPreset(h));if(k=g.toneMap)h="lightMultiplier"in k?k.lightMultiplier:null,k="exposure"in k?k.exposure:null,null!==h&&null!==k&&(a.impl.dir_light1&&(a.impl.dir_light1.intensity=Math.pow(2,h)),a.impl.renderer().setTonemapExposureBias(k,
h),a.impl.invalidate(!0));if(g=g.appearance)"antiAliasing"in g&&(d=g.antiAliasing),"progressiveDisplay"in g&&a.setProgressiveRendering(g.progressiveDisplay),"ghostHidden"in g&&a.setGhosting(g.ghostHidden),"displayLines"in g&&a.hideLines(!g.displayLines);a.setQualityLevel(c,d)}if(Array.isArray(b.cutplanes)&&a.model&&!a.model.is2d()){c=[];for(d=0;d<b.cutplanes.length;d++)g=b.cutplanes[d],Array.isArray(g)&&4<=g.length&&c.push(new THREE.Vector4(g[0],g[1],g[2],g[3]));a.setCutPlanes(c)}for(var q in a.loadedExtensions)a.loadedExtensions[q].restoreState(b,
f);return!0};this.toIntArray=function(a){var c=[];if(Array.isArray(a))for(var f=0,d=a.length;f<d;++f)c.push(parseInt(a[f]));return c};this.extractSelectedNodeIds=function(a){return a&&Array.isArray(a.objectSet)&&0<a.objectSet.length?this.toIntArray(a.objectSet[0].id):[]};this.extractIsolatedNodeIds=function(a){return a&&Array.isArray(a.objectSet)&&0<a.objectSet.length?this.toIntArray(a.objectSet[0].isolated):[]};this.getVector3FromArray=function(a,c){return a instanceof Array&&2<a.length?(a[0]=parseFloat(a[0]),
a[1]=parseFloat(a[1]),a[2]=parseFloat(a[2]),(new THREE.Vector3).fromArray(a)):c};this.getSelectedNodes=function(){for(var b=a.impl&&a.impl.selector?a.impl.selector.getSelection():[],c=b.length,f=[],d=0;d<c;++d)f.push(b[d].dbId);return f};this.getIsolatedNodes=function(){for(var b=a.getIsolatedNodes(),c=0,f=b.length;c<f;++c)b[c]=b[c].dbId;return b};this.getVisibleLayers2d=function(){var b=[],c=a.impl.matman(),f=c.layersMap,d;for(d in f)f.hasOwnProperty(d)&&c.isLayerVisible(d)&&b.push(d);return b};
this.getHiddenNodes=function(){for(var b=a.getHiddenNodes(),c=0,f=b.length;c<f;++c)b[c]=b[c].dbId;return b};this.getAspectRatio=function(){var b=a.navigation.getScreenViewport();return b.width/b.height};this.getOrthographicHeight=function(){var b=a.navigation.getCamera();return b.isPerspective?0:Math.abs(2*b.orthographicCamera.top)};this.getTransformsOverrides=function(){return{transformations:[]}};this.getToneMapIntensity=function(){var b=0;a.impl.dir_light1&&(b=0!=a.impl.dir_light1.intensity?Math.log(a.impl.dir_light1.intensity)/
Math.log(2):-1E-20);return b};this.getLightPresetIndex=function(a){for(var c=Autodesk.Viewing.Private,f=0;f<c.LightPresets.length;f++)if(c.LightPresets[f].name===a)return f;return-1};this.applyFilter=function(a,c){if(!0!==c)for(var f in a)if(a.hasOwnProperty(f)){var d=c[f];void 0===d?(delete a[f],stderr("[applyFilter] C - skipping key ["+f+"] from viewerState; unspecified in filter.")):"boolean"===typeof d?!1===d&&(delete a[f],stderr("[applyFilter] D - skipping key ["+f+"] from viewerState; explicit filtering.")):
d instanceof Object?a[f]instanceof Object?this.applyFilter(a[f],c[f]):stderr("[applyFilter] A - Invalid filter Object for key ["+f+"]"):stderr("[applyFilter] B - Invalid filter value for key ["+f+"]")}}};Autodesk.Viewing.Private.ViewerState.prototype.constructor=Autodesk.Viewing.Private.ViewerState;AutodeskNamespace("Autodesk.Viewing.i18n");
(function(){function a(a,b){if(!b||"function"===typeof b)return a;for(var c in b)a[c]=b[c];return a}function b(a,b,c){var d,f=0,g=a.length,h=void 0===g||"[object Array]"!==Object.prototype.toString.apply(a)||"function"===typeof a;if(c)if(h)for(d in a){if(!1===b.apply(a[d],c))break}else for(;f<g&&!1!==b.apply(a[f++],c););else if(h)for(d in a){if(!1===b.call(a[d],d,a[d]))break}else for(;f<g&&!1!==b.call(a[f],f,a[f++]););return a}function c(a){var b=function(a){if(window.XMLHttpRequest)return a(null,
new XMLHttpRequest);if(window.ActiveXObject)try{return a(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(b){return a(null,new ActiveXObject("Microsoft.XMLHTTP"))}return a(Error())},c=function(a){if("string"===typeof a)return a;var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},d=function(){for(var a=arguments[0],b=1;b<arguments.length;b++){var c=arguments[b],d;for(d in c)c.hasOwnProperty(d)&&(a[d]=c[d])}return a},f=function(a,
g,h,k){"function"===typeof h&&(k=h,h={});h.doNotCache=h.doNotCache||!1;h.data=h.data||{};h.headers=h.headers||{};h.jsonp=h.jsonp||!1;h.async=void 0===h.async?!0:h.async;var l=d({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},f.headers,h.headers),m;m="application/json"===l["content-type"]?JSON.stringify(h.data):c(h.data);if("GET"===a){var n=[];m&&(n.push(m),m=null);h.doNotCache&&n.push("_="+(new Date).getTime());h.jsonp&&(n.push("callback="+h.jsonp),n.push("jsonp="+
h.jsonp));n=n.join("&");1<n.length&&(g=-1<g.indexOf("?")?g+("&"+n):g+("?"+n));if(h.jsonp){var n=document.getElementsByTagName("head")[0],q=document.createElement("script");q.type="text/javascript";q.src=g;n.appendChild(q);return}}b(function(b,c){if(b)return k(b);c.open(a,g,h.async);for(var d in l)l.hasOwnProperty(d)&&c.setRequestHeader(d,l[d]);c.onreadystatechange=function(){if(4===c.readyState){var a=c.responseText||"";k&&k(c.status,a)}};c.send(m)})};({authBasic:function(a,b){var c=f.headers,d;d=
a+":"+b;d=d.replace(/\r\n/g,"\n");for(var g="",h=0;h<d.length;h++){var k=d.charCodeAt(h);128>k?g+=String.fromCharCode(k):(127<k&&2048>k?g+=String.fromCharCode(k>>6|192):(g+=String.fromCharCode(k>>12|224),g+=String.fromCharCode(k>>6&63|128)),g+=String.fromCharCode(k&63|128))}d=g;var g="",l,m,n,q,p=0;do l=d.charCodeAt(p++),h=d.charCodeAt(p++),k=d.charCodeAt(p++),m=l>>2,l=(l&3)<<4|h>>4,n=(h&15)<<2|k>>6,q=k&63,isNaN(h)?n=q=64:isNaN(k)&&(q=64),g+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(m)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(n)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(q);while(p<d.length);c.Authorization="Basic "+g},connect:function(a,b,c){return f("CONNECT",a,b,c)},del:function(a,b,c){return f("DELETE",a,b,c)},get:function(a,b,c){return f("GET",a,b,c)},head:function(a,b,c){return f("HEAD",a,b,c)},headers:function(a){f.headers=a||{}},
isAllowed:function(a,b,c){this.options(a,function(a,d){c(-1!==d.text().indexOf(b))})},options:function(a,b,c){return f("OPTIONS",a,b,c)},patch:function(a,b,c){return f("PATCH",a,b,c)},post:function(a,b,c){return f("POST",a,b,c)},put:function(a,b,c){return f("PUT",a,b,c)},trace:function(a,b,c){return f("TRACE",a,b,c)}})[a.type?a.type.toLowerCase():"get"](a.url,a,function(b,c){200===b?a.success(c,b,null):a.error(c,b,null)})}function f(a,b){"function"===typeof a&&(b=a,a={});a=a||{};H.extend(z,a);delete z.fixLng;
"string"==typeof z.ns&&(z.ns={namespaces:[z.ns],defaultNs:z.ns});"string"==typeof z.fallbackNS&&(z.fallbackNS=[z.fallbackNS]);if("string"==typeof z.fallbackLng||"boolean"==typeof z.fallbackLng)z.fallbackLng=[z.fallbackLng];z.interpolationPrefixEscaped=H.regexEscape(z.interpolationPrefix);z.interpolationSuffixEscaped=H.regexEscape(z.interpolationSuffix);z.lng||(z.lng=H.detectLanguage());z.lng?z.useCookie&&H.cookie.create(z.cookieName,z.lng,z.cookieExpirationTime,z.cookieDomain):(z.lng=z.fallbackLng[0],
z.useCookie&&H.cookie.remove(z.cookieName));F=H.toLanguages(z.lng);D=F[0];H.log("currentLng set to: "+D);var c=l;a.fixLng&&(c=function(a,b){b=b||{};b.lng=b.lng||c.lng;return l(a,b)},c.lng=D);J.setCurrentLng(D);if(z.resStore)v=z.resStore,B=!0,b&&b(c);else{var d=H.toLanguages(z.lng);"string"===typeof z.preload&&(z.preload=[z.preload]);for(var f=0,g=z.preload.length;f<g;f++)for(var h=H.toLanguages(z.preload[f]),k=0,m=h.length;k<m;k++)0>d.indexOf(h[k])&&d.push(h[k]);Autodesk.Viewing.i18n.sync.load(d,
z,function(a,d){v=d;B=!0;b&&b(c)})}}function d(a,b){var c={dynamicLoad:z.dynamicLoad,resGetPath:z.resGetPath,getAsync:z.getAsync,customLoad:z.customLoad,ns:{namespaces:a,defaultNs:""}},d=H.toLanguages(z.lng);"string"===typeof z.preload&&(z.preload=[z.preload]);for(var f=0,g=z.preload.length;f<g;f++)for(var h=H.toLanguages(z.preload[f]),k=0,l=h.length;k<l;k++)0>d.indexOf(h[k])&&d.push(h[k]);for(var m=[],f=0,g=d.length;f<g;f++){h=!1;if(k=v[d[f]])for(var l=0,n=a.length;l<n;l++)k[a[l]]||(h=!0);else h=
!0;h&&m.push(d[f])}m.length?t.sync._fetch(m,c,function(c,d){var f=a.length*m.length;H.each(a,function(a,c){0>z.ns.namespaces.indexOf(c)&&z.ns.namespaces.push(c);H.each(m,function(a,g){v[g]=v[g]||{};v[g][c]=d[g][c];f--;0===f&&b&&(z.useLocalStorage&&t.sync._storeLocal(v),b())})})}):b&&b()}function g(a,b,c,d){if(!a)return a;d=d||b;if(0>a.indexOf(d.interpolationPrefix||z.interpolationPrefix))return a;var f=d.interpolationPrefix?H.regexEscape(d.interpolationPrefix):z.interpolationPrefixEscaped,h=d.interpolationSuffix?
H.regexEscape(d.interpolationSuffix):z.interpolationSuffixEscaped,k="HTML"+h;H.each(b,function(b,l){var m=c?c+z.keyseparator+b:b;"object"===typeof l&&null!==l?a=g(a,l,m,d):d.escapeInterpolation||z.escapeInterpolation?(a=a.replace(new RegExp([f,m,k].join(""),"g"),l),a=a.replace(new RegExp([f,m,h].join(""),"g"),H.escape(l))):a=a.replace(new RegExp([f,m,h].join(""),"g"),l)});return a}function h(a,b){var c=H.extend({},b);for(delete c.postProcess;-1!=a.indexOf(z.reusePrefix);){w++;if(w>z.maxRecursion)break;
var d=a.lastIndexOf(z.reusePrefix),f=a.indexOf(z.reuseSuffix,d)+z.reuseSuffix.length,d=a.substring(d,f),f=d.replace(z.reusePrefix,"").replace(z.reuseSuffix,"");if(-1!=f.indexOf(",")){var g=f.indexOf(",");if(-1!=f.indexOf("{",g)&&-1!=f.indexOf("}",g)){var h=f.indexOf("{",g),k=f.indexOf("}",h)+1;try{c=H.extend(c,JSON.parse(f.substring(h,k))),f=f.substring(0,g)}catch(l){}}}f=q(f,c);a=a.replace(d,f)}return a}function k(a,b){b=b||{};var c=void 0!==b.defaultValue?b.defaultValue:a,d=m(a,b);return void 0!==
d||d===c}function l(a,b){b=b||{};if(!B){H.log("i18next not finished initialization. you might have called t function before loading resources finished.");var c=a.indexOf(":");0>c?c=0:c++;(c=b.defaultValue||a.substr(c))&&(c=g(c,b));return c}w=0;return q.apply(null,arguments)}function n(){for(var a=[],b=1;b<arguments.length;b++)a.push(arguments[b]);return{postProcess:"sprintf",sprintf:a}}function q(a,b){b&&"object"!==typeof b?"sprintf"===z.shortcutFunction?b=n.apply(null,arguments):"defaultValue"===
z.shortcutFunction&&(b={defaultValue:b}):b=b||{};if(void 0===a||null===a)return"";"string"==typeof a&&(a=[a]);var c=a[0];if(1<a.length)for(var d=0;d<a.length&&(c=a[d],!k(c,b));d++);var d=void 0!==b.defaultValue?b.defaultValue:c,f=m(c,b),l=b.lng?H.toLanguages(b.lng):F,q=b.ns||z.ns.defaultNs,p;-1<c.indexOf(z.nsseparator)&&(p=c.split(z.nsseparator),q=p[0],c=p[1]);void 0===f&&z.sendMissing&&(b.lng?I.postMissing(l[0],q,c,d,l):I.postMissing(z.lng,q,c,d,l));l=b.postProcess||z.postProcess;void 0!==f&&l&&
L[l]&&(f=L[l](f,c,b));p=d;-1<d.indexOf(z.nsseparator)&&(p=d.split(z.nsseparator),p=p[1]);p===c&&z.parseMissingKey&&(d=z.parseMissingKey(d));void 0===f&&(d=g(d,b),d=h(d,b),l&&L[l]&&(f=L[l](void 0!==b.defaultValue?b.defaultValue:c,c,b)));return void 0!==f?f:d}function m(a,b){b=b||{};var c,d=void 0!==b.defaultValue?b.defaultValue:a,f=F;if(!v||"cimode"===f[0].toLowerCase())return d;if(b.lng&&(f=H.toLanguages(b.lng),!v[f[0]])){var k=z.getAsync;z.getAsync=!1;Autodesk.Viewing.i18n.sync.load(f,z,function(a,
b){H.extend(v,b);z.getAsync=k})}var n=b.ns||z.ns.defaultNs;-1<a.indexOf(z.nsseparator)&&(c=a.split(z.nsseparator),n=c[0],a=c[1]);if(b.context&&("string"==typeof b.context||"number"==typeof b.context)&&(c=H.extend({},b),delete c.context,c.defaultValue=z.contextNotFound,c=l(n+z.nsseparator+a+"_"+b.context,c),c!=z.contextNotFound))return g(c,{context:b.context});if(void 0!==b.count&&"string"!=typeof b.count&&1!==b.count){c=H.extend({},b);delete c.count;c.defaultValue=z.pluralNotFound;var p=n+z.nsseparator+
a+z.pluralSuffix,w=J.get(f[0],b.count);0<=w?p=p+"_"+w:1===w&&(p=n+z.nsseparator+a);c=l(p,c);if(c!=z.pluralNotFound)return g(c,{count:b.count,interpolationPrefix:b.interpolationPrefix,interpolationSuffix:b.interpolationSuffix})}var t;c=a.split(z.keyseparator);p=0;for(w=f.length;p<w&&void 0===t;p++){for(var B=f[p],A=0,C=v[B]&&v[B][n];c[A];)C=C&&C[c[A]],A++;if(void 0!==C){t=Object.prototype.toString.apply(C);if("string"===typeof C)C=g(C,b),C=h(C,b);else if("[object Array]"===t&&!z.returnObjectTrees&&
!b.returnObjectTrees)C=C.join("\n"),C=g(C,b),C=h(C,b);else if(null===C&&!0===z.fallbackOnNull)C=void 0;else if(null!==C)if(!z.returnObjectTrees&&!b.returnObjectTrees)z.objectTreeKeyHandler&&"function"==typeof z.objectTreeKeyHandler?C=z.objectTreeKeyHandler(a,C,B,n,b):(C="key '"+n+":"+a+" ("+B+")' returned an object instead of string.",H.log(C));else if("[object Number]"!==t&&"[object Function]"!==t&&"[object RegExp]"!==t){var G="[object Array]"===t?[]:{};H.each(C,function(c){G[c]=q(n+z.nsseparator+
a+z.keyseparator+c,b)});C=G}"string"===typeof C&&""===C.trim()&&!0===z.fallbackOnEmpty&&(C=void 0);t=C}}if(void 0===t&&!b.isFallbackLookup&&(!0===z.fallbackToDefaultNS||z.fallbackNS&&0<z.fallbackNS.length))if(b.isFallbackLookup=!0,z.fallbackNS.length)for(f=0,c=z.fallbackNS.length;f<c;f++){if(t=m(z.fallbackNS[f]+z.nsseparator+a,b))if(p=-1<t.indexOf(z.nsseparator)?t.split(z.nsseparator)[1]:t,w=-1<d.indexOf(z.nsseparator)?d.split(z.nsseparator)[1]:d,p!==w)break}else t=m(a,b);return t}Array.prototype.indexOf||
(Array.prototype.indexOf=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;0<arguments.length&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&Infinity!=d&&-Infinity!=d&&(d=(0<d||-1)*Math.floor(Math.abs(d))));if(d>=c)return-1;for(d=0<=d?d:Math.max(c-Math.abs(d),0);d<c;d++)if(d in b&&b[d]===a)return d;return-1});Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===
c)return-1;var d=c;1<arguments.length&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&d!=1/0&&d!=-(1/0)&&(d=(0<d||-1)*Math.floor(Math.abs(d))));for(c=0<=d?Math.min(d,c-1):c-Math.abs(d);0<=c;c--)if(c in b&&b[c]===a)return c;return-1});"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var p=this.jQuery||this.Zepto,t={},v={},D,w=0,F=[],B=!1;"undefined"!==typeof module&&module.exports?module.exports=t:(p&&(p.i18n=p.i18n||t),this.i18n=this.i18n||
t);var z={lng:void 0,load:"all",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",ns:"translation",fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"res/locales/__lng__/__ns__.json",resPostPath:"res/locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048E5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",
sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,shortcutFunction:"sprintf"},G={"&":"&amp;",
"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},A={create:function(a,b,c,d){if(c){var f=new Date;f.setTime(f.getTime()+6E4*c);c="; expires="+f.toGMTString()}else c="";document.cookie=a+"="+b+c+";"+(d?"domain="+d+";":"")+"path=/"},read:function(a){a+="=";for(var b=document.cookie.split(";"),c=0;c<b.length;c++){for(var d=b[c];" "==d.charAt(0);)d=d.substring(1,d.length);if(0===d.indexOf(a))return d.substring(a.length,d.length)}return null},remove:function(a){this.create(a,"",-1)}},E={create:function(a,
b,c,d){},read:function(a){return null},remove:function(a){}},H={extend:p?p.extend:a,each:p?p.each:b,ajax:p?p.ajax:"undefined"!==typeof document?c:function(){},cookie:"undefined"!==typeof document?A:E,detectLanguage:function(){var a,b=[];if("undefined"!==typeof window){for(var c=window.location.search.substring(1).split("&"),d=0;d<c.length;d++){var f=c[d].indexOf("=");if(0<f){var g=c[d].substring(0,f),f=c[d].substring(f+1);b[g]=f}}b[z.detectLngQS]&&(a=b[z.detectLngQS])}!a&&"undefined"!==typeof document&&
z.useCookie&&(b=H.cookie.read(z.cookieName))&&(a=b);a||"undefined"===typeof navigator||(a=navigator.language?navigator.language:navigator.userLanguage);return a},escape:function(a){return"string"===typeof a?a.replace(/[&<>"'\/]/g,function(a){return G[a]}):a},log:function(a){z.debug&&"undefined"!==typeof console&&console.log(a)},toLanguages:function(a){var b=[];if("string"===typeof a&&-1<a.indexOf("-")){var c=a.split("-");a=z.lowerCaseLng?c[0].toLowerCase()+"-"+c[1].toLowerCase():c[0].toLowerCase()+
"-"+c[1].toUpperCase();"unspecific"!==z.load&&b.push(a);"current"!==z.load&&b.push(c[0])}else b.push(a);for(a=0;a<z.fallbackLng.length;a++)-1===b.indexOf(z.fallbackLng[a])&&z.fallbackLng[a]&&b.push(z.fallbackLng[a]);return b},regexEscape:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}};H.applyReplacement=g;var I={load:function(a,b,c){b.useLocalStorage?I._loadLocal(a,b,function(d,f){for(var g=[],h=0,k=a.length;h<k;h++)f[a[h]]||g.push(a[h]);0<g.length?I._fetch(g,b,function(a,
b){H.extend(f,b);I._storeLocal(b);c(null,f)}):c(null,f)}):I._fetch(a,b,function(a,b){c(null,b)})},_loadLocal:function(a,b,c){var d={},f=(new Date).getTime();if(window.localStorage){var g=a.length;H.each(a,function(a,h){var k=window.localStorage.getItem("res_"+h);k&&(k=JSON.parse(k),k.i18nStamp&&k.i18nStamp+b.localStorageExpirationTime>f&&(d[h]=k));g--;0===g&&c(null,d)})}},_storeLocal:function(a){if(window.localStorage)for(var b in a)a[b].i18nStamp=(new Date).getTime(),window.localStorage.setItem("res_"+
b,JSON.stringify(a[b]))},_fetch:function(a,b,c){var d=b.ns,f={};if(b.dynamicLoad){var h=function(a,b){c(null,b)};if("function"==typeof b.customLoad)b.customLoad(a,d.namespaces,b,h);else{var k=g(b.resGetPath,{lng:a.join("+"),ns:d.namespaces.join("+")}),k=Autodesk.Viewing.Private.getResourceUrl(k);H.ajax({url:k,success:function(a,b,d){H.log("loaded: "+k);a=a.json();c(null,a)},error:function(a,b,d){H.log("failed loading: "+k);c(null,void 0)},dataType:"text",async:b.getAsync})}}else{var l=d.namespaces.length*
a.length,m;H.each(d.namespaces,function(d,g){H.each(a,function(a,d){var h=function(a,b){a&&(m=m||[],m.push(a));f[d]=f[d]||{};f[d][g]=b;l--;0===l&&c(m,f)};"function"==typeof b.customLoad?b.customLoad(d,g,b,h):I._fetchOne(d,g,b,h)})})}},_fetchOne:function(a,b,c,d){var f=g(c.resGetPath,{lng:a,ns:b}),f=Autodesk.Viewing.Private.getResourceUrl(f);H.ajax({url:f,success:function(a,b,c){H.log("loaded: "+f);for(var g=!1,h=!1,k="",l=0;l<a.length;l++)if(b=a[l],c=a[l+1],h||"\\"===a[l-1]||'"'!==b||(g=!g),g)k+=
b;else{if(!h&&"//"===b+c)h="single",l++;else if("single"===h&&"\r\n"===b+c)h=!1,l++;else if("single"===h&&"\n"===b)h=!1;else if(!h&&"/*"===b+c){h="multi";l++;continue}else if("multi"===h&&"*/"===b+c){h=!1;l++;continue}h||(k+=b)}d(null,JSON.parse(k))},error:function(a,b,c){b&&200==b||a&&a.status&&200==a.status?H.log("There is a typo in: "+f):b&&404==b||a&&a.status&&404==a.status?H.log("Does not exist: "+f):H.log((b?b:a&&a.status?a.status:null)+" when loading "+f);d(c,{})},dataType:"text",async:c.getAsync})},
postMissing:function(a,b,c,d,f){var h={};h[c]=d;var k=[];if("fallback"===z.sendMissingTo&&!1!==z.fallbackLng[0])for(a=0;a<z.fallbackLng.length;a++)k.push({lng:z.fallbackLng[a],url:g(z.resPostPath,{lng:z.fallbackLng[a],ns:b})});else if("current"===z.sendMissingTo||"fallback"===z.sendMissingTo&&!1===z.fallbackLng[0])k.push({lng:a,url:g(z.resPostPath,{lng:a,ns:b})});else if("all"===z.sendMissingTo){a=0;for(var l=f.length;a<l;a++)k.push({lng:f[a],url:g(z.resPostPath,{lng:f[a],ns:b})})}f=0;for(a=k.length;f<
a;f++){var m=k[f];H.ajax({url:m.url,type:z.sendType,data:h,success:function(a,f,g){H.log("posted missing key '"+c+"' to: "+m.url);a=c.split(".");f=0;for(g=v[m.lng][b];a[f];)g=f===a.length-1?g[a[f]]=d:g[a[f]]=g[a[f]]||{},f++},error:function(a,b,d){H.log("failed posting missing key '"+c+"' to: "+m.url)},dataType:"json",async:z.postAsync})}}},J={rules:{ach:{name:"Acholi",numbers:[1,2],plurals:function(a){return Number(1<a)}},af:{name:"Afrikaans",numbers:[1,2],plurals:function(a){return Number(1!=a)}},
ak:{name:"Akan",numbers:[1,2],plurals:function(a){return Number(1<a)}},am:{name:"Amharic",numbers:[1,2],plurals:function(a){return Number(1<a)}},an:{name:"Aragonese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ar:{name:"Arabic",numbers:[0,1,2,3,11,100],plurals:function(a){return Number(0===a?0:1==a?1:2==a?2:3<=a%100&&10>=a%100?3:11<=a%100?4:5)}},arn:{name:"Mapudungun",numbers:[1,2],plurals:function(a){return Number(1<a)}},ast:{name:"Asturian",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},ay:{name:"Aymar\u00e1",numbers:[1],plurals:function(a){return 0}},az:{name:"Azerbaijani",numbers:[1,2],plurals:function(a){return Number(1!=a)}},be:{name:"Belarusian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},bg:{name:"Bulgarian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},bn:{name:"Bengali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},bo:{name:"Tibetan",numbers:[1],plurals:function(a){return 0}},
br:{name:"Breton",numbers:[1,2],plurals:function(a){return Number(1<a)}},bs:{name:"Bosnian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},ca:{name:"Catalan",numbers:[1,2],plurals:function(a){return Number(1!=a)}},cgg:{name:"Chiga",numbers:[1],plurals:function(a){return 0}},cs:{name:"Czech",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:2<=a&&4>=a?1:2)}},csb:{name:"Kashubian",numbers:[1,2,5],plurals:function(a){return Number(1==
a?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},cy:{name:"Welsh",numbers:[1,2,3,8],plurals:function(a){return Number(1==a?0:2==a?1:8!=a&&11!=a?2:3)}},da:{name:"Danish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},de:{name:"German",numbers:[1,2],plurals:function(a){return Number(1!=a)}},dz:{name:"Dzongkha",numbers:[1],plurals:function(a){return 0}},el:{name:"Greek",numbers:[1,2],plurals:function(a){return Number(1!=a)}},en:{name:"English",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},eo:{name:"Esperanto",numbers:[1,2],plurals:function(a){return Number(1!=a)}},es:{name:"Spanish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},es_ar:{name:"Argentinean Spanish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},et:{name:"Estonian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},eu:{name:"Basque",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fa:{name:"Persian",numbers:[1],plurals:function(a){return 0}},fi:{name:"Finnish",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},fil:{name:"Filipino",numbers:[1,2],plurals:function(a){return Number(1<a)}},fo:{name:"Faroese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fr:{name:"French",numbers:[1,2],plurals:function(a){return Number(1<a)}},fur:{name:"Friulian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},fy:{name:"Frisian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ga:{name:"Irish",numbers:[1,2,3,7,11],plurals:function(a){return Number(1==a?0:2==a?1:7>a?2:11>a?3:4)}},gd:{name:"Scottish Gaelic",
numbers:[1,2,3,20],plurals:function(a){return Number(1==a||11==a?0:2==a||12==a?1:2<a&&20>a?2:3)}},gl:{name:"Galician",numbers:[1,2],plurals:function(a){return Number(1!=a)}},gu:{name:"Gujarati",numbers:[1,2],plurals:function(a){return Number(1!=a)}},gun:{name:"Gun",numbers:[1,2],plurals:function(a){return Number(1<a)}},ha:{name:"Hausa",numbers:[1,2],plurals:function(a){return Number(1!=a)}},he:{name:"Hebrew",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hi:{name:"Hindi",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},hr:{name:"Croatian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},hu:{name:"Hungarian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},hy:{name:"Armenian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ia:{name:"Interlingua",numbers:[1,2],plurals:function(a){return Number(1!=a)}},id:{name:"Indonesian",numbers:[1],plurals:function(a){return 0}},is:{name:"Icelandic",numbers:[1,2],plurals:function(a){return Number(1!=
a%10||11==a%100)}},it:{name:"Italian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ja:{name:"Japanese",numbers:[1],plurals:function(a){return 0}},jbo:{name:"Lojban",numbers:[1],plurals:function(a){return 0}},jv:{name:"Javanese",numbers:[0,1],plurals:function(a){return Number(0!==a)}},ka:{name:"Georgian",numbers:[1],plurals:function(a){return 0}},kk:{name:"Kazakh",numbers:[1],plurals:function(a){return 0}},km:{name:"Khmer",numbers:[1],plurals:function(a){return 0}},kn:{name:"Kannada",numbers:[1,
2],plurals:function(a){return Number(1!=a)}},ko:{name:"Korean",numbers:[1],plurals:function(a){return 0}},ku:{name:"Kurdish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},kw:{name:"Cornish",numbers:[1,2,3,4],plurals:function(a){return Number(1==a?0:2==a?1:3==a?2:3)}},ky:{name:"Kyrgyz",numbers:[1],plurals:function(a){return 0}},lb:{name:"Letzeburgesch",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ln:{name:"Lingala",numbers:[1,2],plurals:function(a){return Number(1<a)}},lo:{name:"Lao",
numbers:[1],plurals:function(a){return 0}},lt:{name:"Lithuanian",numbers:[1,2,10],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2)}},lv:{name:"Latvian",numbers:[1,2,0],plurals:function(a){return Number(1==a%10&&11!=a%100?0:0!==a?1:2)}},mai:{name:"Maithili",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mfe:{name:"Mauritian Creole",numbers:[1,2],plurals:function(a){return Number(1<a)}},mg:{name:"Malagasy",numbers:[1,2],plurals:function(a){return Number(1<
a)}},mi:{name:"Maori",numbers:[1,2],plurals:function(a){return Number(1<a)}},mk:{name:"Macedonian",numbers:[1,2],plurals:function(a){return Number(1==a||1==a%10?0:1)}},ml:{name:"Malayalam",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mn:{name:"Mongolian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},mnk:{name:"Mandinka",numbers:[0,1,2],plurals:function(a){return Number(1==a?1:2)}},mr:{name:"Marathi",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ms:{name:"Malay",numbers:[1],
plurals:function(a){return 0}},mt:{name:"Maltese",numbers:[1,2,11,20],plurals:function(a){return Number(1==a?0:0===a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3)}},nah:{name:"Nahuatl",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nap:{name:"Neapolitan",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nb:{name:"Norwegian Bokmal",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ne:{name:"Nepali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nl:{name:"Dutch",numbers:[1,
2],plurals:function(a){return Number(1!=a)}},nn:{name:"Norwegian Nynorsk",numbers:[1,2],plurals:function(a){return Number(1!=a)}},no:{name:"Norwegian",numbers:[1,2],plurals:function(a){return Number(1!=a)}},nso:{name:"Northern Sotho",numbers:[1,2],plurals:function(a){return Number(1!=a)}},oc:{name:"Occitan",numbers:[1,2],plurals:function(a){return Number(1<a)}},or:{name:"Oriya",numbers:[2,1],plurals:function(a){return Number(1!=a)}},pa:{name:"Punjabi",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},pap:{name:"Papiamento",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pl:{name:"Polish",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},pms:{name:"Piemontese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ps:{name:"Pashto",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pt:{name:"Portuguese",numbers:[1,2],plurals:function(a){return Number(1!=a)}},pt_br:{name:"Brazilian Portuguese",numbers:[1,2],plurals:function(a){return Number(1!=
a)}},rm:{name:"Romansh",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ro:{name:"Romanian",numbers:[1,2,20],plurals:function(a){return Number(1==a?0:0===a||0<a%100&&20>a%100?1:2)}},ru:{name:"Russian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},sah:{name:"Yakut",numbers:[1],plurals:function(a){return 0}},sco:{name:"Scots",numbers:[1,2],plurals:function(a){return Number(1!=a)}},se:{name:"Northern Sami",numbers:[1,2],
plurals:function(a){return Number(1!=a)}},si:{name:"Sinhala",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sk:{name:"Slovak",numbers:[1,2,5],plurals:function(a){return Number(1==a?0:2<=a&&4>=a?1:2)}},sl:{name:"Slovenian",numbers:[5,1,2,3],plurals:function(a){return Number(1==a%100?1:2==a%100?2:3==a%100||4==a%100?3:0)}},so:{name:"Somali",numbers:[1,2],plurals:function(a){return Number(1!=a)}},son:{name:"Songhay",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sq:{name:"Albanian",
numbers:[1,2],plurals:function(a){return Number(1!=a)}},sr:{name:"Serbian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},su:{name:"Sundanese",numbers:[1],plurals:function(a){return 0}},sv:{name:"Swedish",numbers:[1,2],plurals:function(a){return Number(1!=a)}},sw:{name:"Swahili",numbers:[1,2],plurals:function(a){return Number(1!=a)}},ta:{name:"Tamil",numbers:[1,2],plurals:function(a){return Number(1!=a)}},te:{name:"Telugu",numbers:[1,
2],plurals:function(a){return Number(1!=a)}},tg:{name:"Tajik",numbers:[1,2],plurals:function(a){return Number(1<a)}},th:{name:"Thai",numbers:[1],plurals:function(a){return 0}},ti:{name:"Tigrinya",numbers:[1,2],plurals:function(a){return Number(1<a)}},tk:{name:"Turkmen",numbers:[1,2],plurals:function(a){return Number(1!=a)}},tr:{name:"Turkish",numbers:[1,2],plurals:function(a){return Number(1<a)}},tt:{name:"Tatar",numbers:[1],plurals:function(a){return 0}},ug:{name:"Uyghur",numbers:[1],plurals:function(a){return 0}},
uk:{name:"Ukrainian",numbers:[1,2,5],plurals:function(a){return Number(1==a%10&&11!=a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2)}},ur:{name:"Urdu",numbers:[1,2],plurals:function(a){return Number(1!=a)}},uz:{name:"Uzbek",numbers:[1,2],plurals:function(a){return Number(1<a)}},vi:{name:"Vietnamese",numbers:[1],plurals:function(a){return 0}},wa:{name:"Walloon",numbers:[1,2],plurals:function(a){return Number(1<a)}},wo:{name:"Wolof",numbers:[1],plurals:function(a){return 0}},yo:{name:"Yoruba",numbers:[1,
2],plurals:function(a){return Number(1!=a)}},zh:{name:"Chinese",numbers:[1],plurals:function(a){return 0}}},addRule:function(a,b){J.rules[a]=b},setCurrentLng:function(a){if(!J.currentRule||J.currentRule.lng!==a){var b=a.split("-");J.currentRule={lng:a,rule:J.rules[b[0]]}}},get:function(a,b){var c=a.split("-");if(c=J.currentRule&&J.currentRule.lng===a?J.currentRule.rule:J.rules[c[0]]){var d=c.plurals(b),d=c.numbers[d];2===c.numbers.length&&1===c.numbers[0]&&(2===d?d=-1:1===d&&(d=1));c=d}else c=1===
b?"1":"-1";return c}},L={},p=function(a,b){L[a]=b},C=function(){function a(b){return Object.prototype.toString.call(b).slice(8,-1).toLowerCase()}var b=function(){b.cache.hasOwnProperty(arguments[0])||(b.cache[arguments[0]]=b.parse(arguments[0]));return b.format.call(null,b.cache[arguments[0]],arguments)};b.format=function(b,c){var d=1,f=b.length,g="",h=[],k,l,m,n;for(k=0;k<f;k++)if(g=a(b[k]),"string"===g)h.push(b[k]);else if("array"===g){m=b[k];if(m[2])for(g=c[d],l=0;l<m[2].length;l++){if(!g.hasOwnProperty(m[2][l]))throw C('[sprintf] property "%s" does not exist',
m[2][l]);g=g[m[2][l]]}else g=m[1]?c[m[1]]:c[d++];if(/[^s]/.test(m[8])&&"number"!=a(g))throw C("[sprintf] expecting number but found %s",a(g));switch(m[8]){case "b":g=g.toString(2);break;case "c":g=String.fromCharCode(g);break;case "d":g=parseInt(g,10);break;case "e":g=m[7]?g.toExponential(m[7]):g.toExponential();break;case "f":g=m[7]?parseFloat(g).toFixed(m[7]):parseFloat(g);break;case "o":g=g.toString(8);break;case "s":g=(g=String(g))&&m[7]?g.substring(0,m[7]):g;break;case "u":g=Math.abs(g);break;
case "x":g=g.toString(16);break;case "X":g=g.toString(16).toUpperCase()}g=/[def]/.test(m[8])&&m[3]&&0<=g?"+"+g:g;l=m[4]?"0"==m[4]?"0":m[4].charAt(1):" ";n=m[6]-String(g).length;if(m[6]){for(var q=[];0<n;q[--n]=l);l=q.join("")}else l="";h.push(m[5]?g+l:l+g)}return h.join("")};b.cache={};b.parse=function(a){for(var b=[],c=[],d=0;a;){if(null!==(b=/^[^\x25]+/.exec(a)))c.push(b[0]);else if(null!==(b=/^\x25{2}/.exec(a)))c.push("%");else if(null!==(b=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(a))){if(b[2]){var d=
d|1,f=[],g=b[2],h=[];if(null!==(h=/^([a-z_][a-z_\d]*)/i.exec(g)))for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else if(null!==(h=/^\[(\d+)\]/.exec(g)))f.push(h[1]);else throw"[sprintf] huh?";else throw"[sprintf] huh?";b[2]=f}else d|=2;if(3===d)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";c.push(b)}else throw"[sprintf] huh?";a=a.substring(b[0].length)}return c};return b}();p("sprintf",function(a,b,
c){return c.sprintf?"[object Array]"===Object.prototype.toString.apply(c.sprintf)?(b=c.sprintf,b.unshift(a),C.apply(null,b)):"object"===typeof c.sprintf?C(a,c.sprintf):a:a});Autodesk.Viewing.i18n.init=f;Autodesk.Viewing.i18n.setLng=function(a,b,c){"function"===typeof b?(c=b,b={}):b||(b={});b.lng=a;return f(b,c)};Autodesk.Viewing.i18n.preload=function(a,b){"string"===typeof a&&(a=[a]);for(var c=0,d=a.length;c<d;c++)0>z.preload.indexOf(a[c])&&z.preload.push(a[c]);return f(b)};Autodesk.Viewing.i18n.addResourceBundle=
function(a,b,c){"string"!==typeof b?(c=b,b=z.ns.defaultNs):0>z.ns.namespaces.indexOf(b)&&z.ns.namespaces.push(b);v[a]=v[a]||{};v[a][b]=v[a][b]||{};H.extend(v[a][b],c)};Autodesk.Viewing.i18n.removeResourceBundle=function(a,b){"string"!==typeof b&&(b=z.ns.defaultNs);v[a]=v[a]||{};v[a][b]={}};Autodesk.Viewing.i18n.loadNamespace=function(a,b){d([a],b)};Autodesk.Viewing.i18n.loadNamespaces=d;Autodesk.Viewing.i18n.localize=function(){Array.prototype.forEach.call(document.querySelectorAll("[data-i18n]"),
function(a){var b,c,d=a.getAttribute("data-i18n").split(/\[|\]/);1===d.length?(c=null,b=d[0]):3===d.length&&(c=d[1],b=d[2]);b=[c,b];c=b[0];b=b[1];(d=Autodesk.Viewing.i18n.translate(b))?c?a.setAttribute(c,d):a.textContent=d:c?a.setAttribute(c,b):a.textContent=b})};Autodesk.Viewing.i18n.setDefaultNamespace=function(a){z.ns.defaultNs=a};Autodesk.Viewing.i18n.t=l;Autodesk.Viewing.i18n.translate=l;Autodesk.Viewing.i18n.exists=k;Autodesk.Viewing.i18n.detectLanguage=H.detectLanguage;Autodesk.Viewing.i18n.pluralExtensions=
J;Autodesk.Viewing.i18n.sync=I;Autodesk.Viewing.i18n.functions=H;Autodesk.Viewing.i18n.lng=function(){return D};Autodesk.Viewing.i18n.addPostProcessor=p;Autodesk.Viewing.i18n.options=z})();AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.DockingPanel=function(a,b,c,f){this.kMinHeight=this.kMinWdth=100;this.visibilityCallbacks=[];this.movedSinceLastClick=!1;this.parentContainer=a;this.container=document.createElement("div");this.container.id=b;this.container.lastWidth="";this.container.dockRight=!1;this.container.dockBottom=!1;this.titleLabel=c;f=f||{};f.hasOwnProperty("localizeTitle")||(f.localizeTitle=!0);this.options=f;this.container.classList.add("dockingPanel");a.appendChild(this.container);this.listeners=
[];this.initialize();this.setVisible(!1)};Autodesk.Viewing.UI.DockingPanel.prototype.initialize=function(){this.title=this.createTitleBar(this.titleLabel||this.container.id);this.container.appendChild(this.title);this.initializeMoveHandlers(this.title);this.setTitle(this.titleLabel||this.container.id,this.options);this.closer=this.createCloseButton();this.container.appendChild(this.closer)};
Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize=function(){for(var a=0;a<this.listeners.length;++a){var b=this.listeners[a];b.target.removeEventListener(b.eventId,b.callback)}this.listeners=[];this.visibilityCallbacks=[];this.parentContainer.removeChild(this.container);this.closer=this.title=this.container=this.parentContainer=null};Autodesk.Viewing.UI.DockingPanel.prototype.addVisibilityListener=function(a){this.visibilityCallbacks.push(a)};
Autodesk.Viewing.UI.DockingPanel.prototype.setVisible=function(a){if(a){var b=this.getContainerBoundingRect();if(this.container.dockRight){var c=b.width,f=300,d=this.container.lastWidth||this.container.style.width;d||(d=this.container.getBoundingClientRect().width);d&&(f=parseInt(d));this.container.style.left=c-f+"px"}this.container.dockBottom&&(c=b.height,f=300,d=this.container.lastHeight||this.container.style.height,d||(d=this.container.getBoundingClientRect().height),d&&(f=parseInt(d)),this.container.style.top=
c-f+"px");this.container.style.maxHeight=b.height+"px";this.container.style.maxWidth=b.width+"px";this.container.style.display="block"}else this.container.lastWidth=this.container.style.width,this.container.lastHeight=this.container.style.height,this.container.style.display="none";for(b=0;b<this.visibilityCallbacks.length;b++)this.visibilityCallbacks[b](a)};Autodesk.Viewing.UI.DockingPanel.prototype.isVisible=function(){return Boolean("block"===this.container.style.display)};
Autodesk.Viewing.UI.DockingPanel.prototype.visibilityChanged=function(){};
Autodesk.Viewing.UI.DockingPanel.prototype.initializeMoveHandlers=function(a){function b(a){var b=p.style.minWidth?parseInt(p.style.minWidth):t.kMinWdth,c=p.style.minHeight?parseInt(p.style.minHeight):t.kMinHeight,f=t.getContainerBoundingRect();p.style.maxWidth&&parseInt(p.style.width)>parseInt(p.style.maxWidth)&&(p.style.width=p.style.maxWidth);p.style.maxHeight&&parseInt(p.style.height)>parseInt(p.style.maxHeight)&&(p.style.height=p.style.maxHeight);parseInt(p.style.width)<b&&(p.style.width=b+"px");
parseInt(p.style.height)<c&&(p.style.height=c+"px");"touchmove"===a.type&&(a.screenX=a.touches[0].screenX,a.screenY=a.touches[0].screenY);q+=a.screenX-h;m+=a.screenY-k;d=l+q;g=n+m;b=parseInt(p.style.width);c=parseInt(p.style.height);isNaN(b)&&(b=t.container.getBoundingClientRect().width);isNaN(c)&&(c=t.container.getBoundingClientRect().height);5>d&&(d=0);5>g&&(g=0);p.dockRight=!1;p.dockBottom=!1;f.width-5<d+b&&(d=f.width-b,p.dockRight=!0);f.height-5<g+c&&(g=f.height-c,p.dockBottom=!0);p.style.left=
d+"px";p.style.top=g+"px";p.style.maxWidth=f.width-d+"px";p.style.maxHeight=f.height-g+"px";h=a.screenX;k=a.screenY;t.onMove(a,d,g)}function c(a){window.removeEventListener("mousemove",b);window.removeEventListener("mouseup",c);window.removeEventListener("touchmove",b);window.removeEventListener("touchend",c);t.onEndMove(a,d,g)}function f(a){"touchstart"===a.type&&(a.screenX=a.touches[0].screenX,a.screenY=a.touches[0].screenY);h=a.screenX;k=a.screenY;m=q=0;l=t.container.offsetLeft;n=t.container.offsetTop;
window.addEventListener("mousemove",b,!1);window.addEventListener("mouseup",c,!1);window.addEventListener("touchmove",b,!1);window.addEventListener("touchend",c,!1);a.preventDefault();t.onStartMove(a,l,n)}var d,g,h,k,l,n,q,m,p=this.container,t=this;t.addEventListener(a,"mousedown",f);t.addEventListener(a,"touchstart",f)};Autodesk.Viewing.UI.DockingPanel.prototype.initializeCloseHandler=function(a){var b=this;b.addEventListener(a,"click",function(a){b.setVisible(!1)},!1)};
Autodesk.Viewing.UI.DockingPanel.prototype.createScrollContainer=function(a){var b=document.createElement("div"),c=b.classList;c.add("dockingPanelScroll");c.add(a&&a.left?"left":"right");a&&a.heightAdjustment&&(b.style.height="calc(100% - "+a.heightAdjustment+"px)");a.marginTop&&(b.style.marginTop=a.marginTop+"px");b.id=this.container.id+"-scroll-container";this.container.appendChild(b);return this.scrollContainer=b};
Autodesk.Viewing.UI.DockingPanel.prototype.createTitleBar=function(a){var b=document.createElement("div");b.className="dockingPanelTitle";b.textContent=a;var c=this;c.addEventListener(b,"click",function(a){if(!c.movedSinceLastClick)c.onTitleClick(a);c.movedSinceLastClick=!1});c.addEventListener(b,"dblclick",function(a){c.onTitleDoubleClick(a)});return b};
Autodesk.Viewing.UI.DockingPanel.prototype.setTitle=function(a,b){b&&b.localizeTitle?(this.title.setAttribute("data-i18n",a),a=Autodesk.Viewing.i18n.translate(a)):this.title.removeAttribute("data-i18n");this.title.textContent=a};Autodesk.Viewing.UI.DockingPanel.prototype.createCloseButton=function(){var a=document.createElement("div");a.className="dockingPanelClose";a.innerHTML="&times;";this.initializeCloseHandler(a);return a};Autodesk.Viewing.UI.DockingPanel.prototype.onStartMove=function(a,b,c){};
Autodesk.Viewing.UI.DockingPanel.prototype.onEndMove=function(a,b,c){};Autodesk.Viewing.UI.DockingPanel.prototype.onMove=function(a,b,c){this.movedSinceLastClick=!0};Autodesk.Viewing.UI.DockingPanel.prototype.onTitleClick=function(a){};Autodesk.Viewing.UI.DockingPanel.prototype.onTitleDoubleClick=function(a){};Autodesk.Viewing.UI.DockingPanel.prototype.addEventListener=function(a,b,c){a.addEventListener(b,c);this.listeners.push({target:a,eventId:b,callback:c})};
Autodesk.Viewing.UI.DockingPanel.prototype.removeEventListener=function(a,b,c){for(var f=0;f<this.listeners.length;++f){var d=this.listeners[f];if(d.target===a&&d.eventId===b&&d.callback===c)return a.removeEventListener(b,c),this.listeners.splice(f,1),!0}return!1};Autodesk.Viewing.UI.DockingPanel.prototype.getContentSize=function(){return{height:this.container.clientHeight,width:this.container.clientWidth}};
Autodesk.Viewing.UI.DockingPanel.prototype.resizeToContent=function(a){if(this.isVisible()){var b=this.getContentSize().height,c=this.container.getBoundingClientRect(),f=this.getContainerBoundingRect();a=a&&a.maxHeight?a.maxHeight-c.top:f.height-c.top;a-=75;b>a&&(b=a);this.container.style.height=b.toString()+"px"}};Autodesk.Viewing.UI.DockingPanel.prototype.getContainerBoundingRect=function(){return this.parentContainer.getBoundingClientRect()};AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.ModelStructurePanel=function(a,b,c,f){Autodesk.Viewing.UI.DockingPanel.call(this,a,b,c,f);this.container.classList.add("modelStructurePanel");f=f||{};f.heightAdjustment||(f.heightAdjustment=40);f.marginTop||(f.marginTop=0);f.left=!0;this.createScrollContainer(f);this.options=f;this.tree=this.modelRoot=null;this.selectedNodes=[];var d=this;this.addVisibilityListener(function(a){a&&d.resizeToContent()})};Autodesk.Viewing.UI.ModelStructurePanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);
Autodesk.Viewing.UI.ModelStructurePanel.prototype.constructor=Autodesk.Viewing.UI.ModelStructurePanel;
Autodesk.Viewing.UI.ModelStructurePanel.prototype.setModel=function(a,b){var c=this,f=function(){var a=new Autodesk.Viewing.UI.TreeDelegate;a.getTreeNodeId=function(a){return a.dbId};a.getTreeNodeLabel=function(a){return c.getNodeLabel(a)};a.getTreeNodeClass=function(a){return c.getNodeClass(a)};a.isTreeNodeGroup=function(a){return c.isGroupNode(a)};a.shouldCreateTreeNode=function(a){return c.shouldInclude(a)};a.onTreeNodeClick=function(a,b,d){c.onClick(b,d)};a.onTreeNodeRightClick=function(a,b,d){c.onRightClick(b,
d)};a.onTreeNodeDoubleClick=function(a,b,d){c.onDoubleClick(b,d)};a.onTreeNodeIconClick=function(a,b,d){c.onIconClick(b,d)};return a};c.selectedNodes=[];var d=b;!d&&c.options&&c.options.defaultTitle&&(d=c.options.defaultTitle);var g={};d||(d="Browser",g.localizeTitle=!0);c.setTitle(d,g);if(c.tree){for(;c.scrollContainer.hasChildNodes();)c.scrollContainer.removeChild(c.scrollContainer.lastChild);c.title.removeEventListener("click",c.onTitleClick);c.title.removeEventListener("dblclick",c.onTitleDoubleClick)}if(c.modelRoot=
a)f=f(),d=a.children&&1===a.children.length&&a.name===a.children[0].name,c.tree=new Autodesk.Viewing.UI.Tree(f,a,c.scrollContainer,{excludeRoot:d}),c.options&&c.options.hasOwnProperty("startCollapsed")&&!c.options.startCollapsed||(c.tree.setAllCollapsed(!0),c.tree.setCollapsed(a.dbId,!1),d&&c.tree.setCollapsed(a.children[0].dbId,!1)),c.resizeToContent()};Autodesk.Viewing.UI.ModelStructurePanel.prototype.getNodeLabel=function(a){return a.name&&""!==a.name?a.name:"Object "+a.dbId};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.getNodeClass=function(a){return""};Autodesk.Viewing.UI.ModelStructurePanel.prototype.isGroupNode=function(a){return a.children&&Array.isArray(a.children)&&0<a.children.length};Autodesk.Viewing.UI.ModelStructurePanel.prototype.shouldInclude=function(a){return!0};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onClick=function(a,b){this.setSelection([a])};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onDoubleClick=function(a,b){};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.onIconClick=function(a,b){this.setGroupCollapsed(a,!this.isGroupCollapsed(a))};Autodesk.Viewing.UI.ModelStructurePanel.prototype.setGroupCollapsed=function(a,b){this.tree.delegate().isTreeNodeGroup(a)&&(this.tree.setCollapsed(a,b),this.resizeToContent())};Autodesk.Viewing.UI.ModelStructurePanel.prototype.isGroupCollapsed=function(a){return this.tree.delegate().isTreeNodeGroup(a)?this.tree.isCollapsed(a):!1};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.onRightClick=function(a,b){};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onTitleClick=function(a){this.onClick(this.modelRoot,a)};Autodesk.Viewing.UI.ModelStructurePanel.prototype.onTitleDoubleClick=function(a){this.onDoubleClick(this.modelRoot,a)};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.setSelection=function(a){if(this.tree){var b,c;for(b=0;b<this.selectedNodes.length;++b)for(c=this.selectedNodes[b].parent;c;)this.tree.removeClass(c,"ancestor-selected"),c=c.parent;var f=[];for(b=0;b<a.length;++b)for(f.push(a[b]),c=a[b].parent;c;)this.tree.addClass(c,"ancestor-selected"),c=c.parent;this.selectedNodes=a;this.tree.setSelection(f)}};
Autodesk.Viewing.UI.ModelStructurePanel.prototype.getContentSize=function(){var a=this.tree;return a&&(a=a.getRootContainer())?{height:a.clientHeight+this.options.heightAdjustment+35,width:a.clientWidth}:{height:0,width:0}};Autodesk.Viewing.UI.ModelStructurePanel.prototype.addClass=function(a,b){return null!==this.tree&&this.tree.addClass(a,b)};Autodesk.Viewing.UI.ModelStructurePanel.prototype.removeClass=function(a,b){return null!==this.tree&&this.tree.removeClass(a,b)};AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.PropertyPanel=function(a,b,c,f){Autodesk.Viewing.UI.DockingPanel.call(this,a,b,c,f);this.container.classList.add("propertyPanel");this.container.dockRight=!0;this.createScrollContainer({left:!1,heightAdjustment:45,marginTop:0});this.highlightableElements={};var d=this;a=function(){function a(b){return"category"===b.type}var b=new Autodesk.Viewing.UI.TreeDelegate;b.getTreeNodeId=function(a){return a.name+(a.hasOwnProperty("value")?a.value:"")+(a.hasOwnProperty("category")?a.category:
"")};b.getTreeNodeClass=function(b){return a(b)?d.getCategoryClass(b):d.getPropertyClass(b)};b.isTreeNodeGroup=function(b){return a(b)};b.onTreeNodeClick=function(b,c,f){if(a(c))d.onCategoryClick(c,f);else d.onPropertyClick(c,f)};b.onTreeNodeRightClick=function(b,c,f){if(a(c))d.onCategoryRightClick(c,f);else d.onPropertyRightClick(c,f)};b.onTreeNodeDoubleClick=function(b,c,f){if(a(c))d.onCategoryDoubleClick(c,f);else d.onPropertyDoubleClick(c,f)};b.onTreeNodeIconClick=function(b,c,f){if(a(c))d.onCategoryIconClick(c,
f);else d.onPropertyIconClick(c,f)};b.createTreeNode=function(b,c,f){var h=null;(h=a(b)?d.displayCategory(b,c,f):d.displayProperty(b,c,f))&&(d.highlightableElements[this.getTreeNodeId(b)]=h)};return b}();this.tree=new Autodesk.Viewing.UI.Tree(a,null,this.scrollContainer,{})};Autodesk.Viewing.UI.PropertyPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.UI.PropertyPanel.prototype.constructor=Autodesk.Viewing.UI.PropertyPanel;
Autodesk.Viewing.UI.PropertyPanel.prototype.setProperties=function(a,b){this.removeAllProperties();for(var c=[],f=[],d=0;d<a.length;d++){var g=a[d];if(!g.hidden){var h=a[d].displayCategory;h&&"string"===typeof h&&""!==h?c.push(g):f.push(g)}}if(0===c.length+f.length)this.showNoProperties();else{for(d=0;d<c.length;d++)g=c[d],h=Autodesk.Viewing.Private.formatValueWithUnits(g.displayValue,g.units,g.type),this.addProperty(g.displayName,h,g.displayCategory);c=0<c.length;for(d=0;d<f.length;d++)g=f[d],h=
Autodesk.Viewing.Private.formatValueWithUnits(g.displayValue,g.units,g.type),this.addProperty(g.displayName,h,c?"Other":"",c?{localizeCategory:!0}:{})}};Autodesk.Viewing.UI.PropertyPanel.prototype.showNoProperties=function(){this.removeAllProperties();var a=this.tree.myRootContainer,b=document.createElement("div");b.className="noProperties";b.setAttribute("data-i18n","No properties to display");b.textContent=Autodesk.Viewing.i18n.translate("No properties to display");a.appendChild(b)};
Autodesk.Viewing.UI.PropertyPanel.prototype.showDefaultProperties=function(){this.showNoProperties();this.resizeToContent()};Autodesk.Viewing.UI.PropertyPanel.prototype.areDefaultPropertiesShown=function(){return!this.hasProperties()};
Autodesk.Viewing.UI.PropertyPanel.prototype.addProperty=function(a,b,c,f){if(this.tree.getElementForNode({name:a,value:b,category:c}))return!1;var d=null;a={name:a,value:b,type:"property"};c?((d=this.tree.getElementForNode({name:c}))||(d=this.tree.createElement_({name:c,type:"category"},this.tree.myRootContainer,f&&f.localizeCategory?{localize:!0}:null)),a.category=c):d=this.tree.myRootContainer;this.tree.createElement_(a,d,f&&f.localizeProperty?{localize:!0}:null);return!0};
Autodesk.Viewing.UI.PropertyPanel.prototype.hasProperties=function(){for(var a in this.highlightableElements)return!0;return!1};Autodesk.Viewing.UI.PropertyPanel.prototype.removeProperty=function(a,b,c,f){a={name:a,value:b,category:c};return(b=this.tree.getElementForNode(a))?(delete this.highlightableElements[this.tree.delegate().getTreeNodeId(a)],b.parentNode.removeChild(b),!0):!1};Autodesk.Viewing.UI.PropertyPanel.prototype.removeAllProperties=function(){this.highlightableElements={};this.tree.clear()};
Autodesk.Viewing.UI.PropertyPanel.prototype.setCategoryCollapsed=function(a,b){var c=this.tree.delegate().getTreeNodeId(a);this.tree.setCollapsed(c,b)};Autodesk.Viewing.UI.PropertyPanel.prototype.isCategoryCollapsed=function(a){a=this.tree.delegate().getTreeNodeId(a);return this.tree.isCollapsed(a)};Autodesk.Viewing.UI.PropertyPanel.prototype.getContentSize=function(){var a=this.tree.myRootContainer;return{height:a.clientHeight+55,width:a.clientWidth}};
Autodesk.Viewing.UI.PropertyPanel.prototype.highlight=function(a,b){for(var c in this.highlightableElements)for(var f=this.highlightableElements[c],d=0;d<f.length;++d){var g=f[d],h=g.innerHTML,k=h.replace(/(<highlight>|<\/highlight>)/igm,"");h!==k&&(g.innerHTML=k);a&&""!==a&&(h=k.replace(new RegExp("(\\b"+a+"\\b)","gim"),"<highlight>$1</highlight>"),g.innerHTML=h)}};
Autodesk.Viewing.UI.PropertyPanel.prototype.displayCategory=function(a,b,c){var f=document.createElement("div");a=a.name;c&&c.localize&&(f.setAttribute("data-i18n",a),a=Autodesk.Viewing.i18n.translate(a));f.textContent=a;f.title=a;f.className="categoryName";b.appendChild(f);return[f]};
Autodesk.Viewing.UI.PropertyPanel.prototype.displayProperty=function(a,b,c){var f=document.createElement("div"),d=a.name;c&&c.localize&&(f.setAttribute("data-i18n",d),d=Autodesk.Viewing.i18n.translate(d));f.textContent=d;f.title=d;f.className="propertyName";c=document.createElement("div");c.className="separator";d=document.createElement("div");d.textContent=a.value;d.title=a.value;d.className="propertyValue";b.appendChild(f);b.appendChild(c);b.appendChild(d);return[f,d]};
Autodesk.Viewing.UI.PropertyPanel.prototype.getCategoryClass=function(a){return"category"};Autodesk.Viewing.UI.PropertyPanel.prototype.getPropertyClass=function(a){return"property"};Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryClick=function(a,b){this.setCategoryCollapsed(a,!this.isCategoryCollapsed(a))};Autodesk.Viewing.UI.PropertyPanel.prototype.onPropertyClick=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryIconClick=function(a,b){this.setCategoryCollapsed(a,!this.isCategoryCollapsed(a))};
Autodesk.Viewing.UI.PropertyPanel.prototype.onPropertyIconClick=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryDoubleClick=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onPropertyDoubleClick=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryRightClick=function(a,b){};Autodesk.Viewing.UI.PropertyPanel.prototype.onPropertyRightClick=function(a,b){};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.ContextMenu=function(a){this.viewer=a;this.menus=[];this.open=!1};Autodesk.Viewing.Private.ContextMenu.prototype.constructor=Autodesk.Viewing.Private.ContextMenu;
Autodesk.Viewing.Private.ContextMenu.prototype.show=function(a,b){var c=this.viewer.container.getBoundingClientRect(),f=a.clientX-c.left,c=a.clientY-c.top;if(!this.open){var d=this;this.showMenu(b,f,c);this.open=!0;this.hideEventListener=function(a){"menuItem"!==a.target.className&&d.hide(a)};this.isTouch="press"===a.type;document.body.addEventListener(this.isTouch?"touchstart":"mousedown",this.hideEventListener,!0)}};
Autodesk.Viewing.Private.ContextMenu.prototype.showMenu=function(a,b,c){var f=document.createElement("div"),d,g=[];f.className="menu";this.viewer.container.appendChild(f);this.menus.push(f);for(var h=0;h<a.length;++h){d=a[h];var k=d.title,l=d.target;d=this.createMenuItem(f,k);"function"===typeof l?this.addCallbackToMenuItem(d,l):Array.isArray(l)?g.push({menuItem:d,target:l}):console.warn("Invalid context menu option:",k,l)}l=f.getBoundingClientRect();h=l.width;d=l.height;a=this.viewer.container.getBoundingClientRect();
var l=a.width,n=a.height;(k=isTouchDevice()&&!this.viewer.navigation.getUseLeftHandedInput())&&(b-=h);0>b&&(b=0);l<b+h&&(b=l-h,0>b&&(b=0));0>c&&(c=0);n<c+d&&(c=n-d,0>c&&(c=0));f.style.top=Math.round(c)+"px";f.style.left=Math.round(b)+"px";for(h=0;h<g.length;++h)f=g[h],d=f.menuItem,l=d.getBoundingClientRect(),b=Math.round((k?l.left:l.right)-a.left),c=Math.round(l.top-a.top),this.addSubmenuCallbackToMenuItem(d,f.target,b,c)};
Autodesk.Viewing.Private.ContextMenu.prototype.createMenuItem=function(a,b){var c=document.createElement("div");c.className="menuItem";c.setAttribute("data-i18n",b);c.textContent=Autodesk.Viewing.i18n.translate(b);a.appendChild(c);return c};Autodesk.Viewing.Private.ContextMenu.prototype.addCallbackToMenuItem=function(a,b){var c=this;a.addEventListener("click",function(a){c.hide();b();a.preventDefault();return!1},!1)};
Autodesk.Viewing.Private.ContextMenu.prototype.addSubmenuCallbackToMenuItem=function(a,b,c,f){var d=this;a.addEventListener("click",function(){d.showMenu(b,c,f)},!1)};Autodesk.Viewing.Private.ContextMenu.prototype.hide=function(){if(this.open){for(var a=0;a<this.menus.length;++a)this.menus[a]&&this.menus[a].parentNode.removeChild(this.menus[a]);this.menus=[];this.open=!1;document.body.removeEventListener(this.isTouch?"touchstart":"mousedown",this.hideEventListener);this.isTouch=!1;return!0}return!1};
AutodeskNamespace("Autodesk.Viewing.UI");Autodesk.Viewing.UI.ObjectContextMenu=function(a){this.viewer=a;this.contextMenu=new Autodesk.Viewing.Private.ContextMenu(a)};Autodesk.Viewing.UI.ObjectContextMenu.prototype.constructor=Autodesk.Viewing.UI.ObjectContextMenu;
Autodesk.Viewing.UI.ObjectContextMenu.prototype.show=function(a){var b=this.viewer.getSelectionCount(),c=this.viewer.getSelectionVisibility(),b={numSelected:b,hasSelected:0<b,hasVisible:c.hasVisible,hasHidden:c.hasHidden},c=this.buildMenu(a,b);this.viewer.runContextMenuCallbacks(c,b);c&&0<c.length&&this.contextMenu.show(a,c)};Autodesk.Viewing.UI.ObjectContextMenu.prototype.hide=function(){return this.contextMenu.hide()};Autodesk.Viewing.UI.ObjectContextMenu.prototype.buildMenu=function(a,b){return null};
AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.Preferences=function(a,b){function c(a,c){if(k)return a=b+a,"undefined"!==typeof c?localStorage[a]=c:c=localStorage[a],c}function f(a,b){if("string"!==typeof a||"function"===typeof l[a])stderr("Preferences: invalid name="+a);else{var d=c(a);ok=!1;if(void 0!==d)try{d=JSON.parse(d),ok=!0}catch(f){}l[a]=ok?d:b;h[a]={}}}b||(b="Autodesk.Viewing.Preferences.");var d={},g={},h={},k=function(){var a=b+"test",c=window.localStorage;try{return c.setItem(a,"1"),c.removeItem(a),!0}catch(d){return!1}}(),
l=this;a.addEventListener("PrefChanged",function(a){var b=g[a.name];b&&(b=b.changed)&&b(a.value)});a.addEventListener("PrefReset",function(a){for(var b in g)g.hasOwnProperty(b)&&(a=g[b].reset)&&a(l[b])});this.load=function(a){d=a;for(var b in d)d.hasOwnProperty(b)&&f(b,d[b])};this.tag=function(a,b){if(a){b?Array.isArray(b)||(b=[b]):b=Object.keys(d);for(var c=0;c<b.length;++c)h[b[c]][a]=!0}};this.untag=function(a,b){if(a){b?Array.isArray(b)||(b=[b]):b=Object.keys(d);for(var c=0;c<b.length;++c)h[b[c]][a]=
!1}};this.add=function(a,b,c){if(d.hasOwnProperty(a))stderr("Preferences: "+a+" already exists");else{d[a]=b;f(a,b);if(c)for(Array.isArray(c)||(c=[c]),b=0;b<c.length;++b)this.tag(c[b],a);return!0}return!1};this.remove=function(a,c){return d.hasOwnProperty(a)?(delete d[a],delete h[a],delete this[a],c&&k&&(a=b+a,delete localStorage[a]),!0):!1};this.reset=function(b,c){b&&void 0===c&&(c=!0);for(var f in d)if(d.hasOwnProperty(f)){if(b){var g=!!h[f][b];if(c&&!g||!c&&g)continue}this.set(f,d[f],!1)&&a.fireEvent({type:"PrefReset",
name:f,value:this[f]})}};this.get=function(a){return this[a]};this.set=function(b,d,f){return this[b]!==d?(this[b]=d,c(b,d),(void 0===f||f)&&a.fireEvent({type:"PrefChanged",name:b,value:d}),(f=Autodesk.Viewing.Private.logger)&&f.log({category:"pref_changed",name:b,value:d}),!0):!1};this.addListeners=function(a,b,c){g[a]={changed:b,reset:c}};this.removeListeners=function(a){void 0!==g[a]&&delete g[a]}};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.formatValueWithUnits=function(a,b,c,f){function d(a){var b=0<=a?Math.floor(a):Math.ceil(a);return{intPart:b,fracPart:a-b}}function g(a,b,c){var f="";c&&0===a&&(f+="-");0===d(a).fracPart?f+=a:0<b?(a=a.toFixed(b),b=/^\-?([0-9]+)\.0+$/.exec(a),f=null!==b?f+b[1]:f+a):f+=a.toFixed(0);return f}function h(a,b,c){for(var f="",h=1,k=0>a,v=0;v<b;++v)h*=2;a=0<a?a+.5/h:a-.5/h;c?k=a:(b=d(a/12).intPart,f+=g(b,0,k)+"' ",k=a-12*b,0>k&&(k=-k));a=d(k).intPart;k=d((k-a)*h).intPart;if(0===k||
0!==a)f+=g(a,0);if(0!==k){for(0>a&&0>k&&(k=-k);0===k%2;)k/=2,h/=2;0!==a&&(f+="-");f+=g(k,0)+"/"+g(h,0)}return f+'"'}function k(a,b){var c="";0>a&&(c="-",a=Math.abs(a));var f=d(a),h=100*f.fracPart;return c+g(f.intPart,0)+" m "+g(h,b)+" cm"}void 0===f&&(f=3);1===c?a=Autodesk.Viewing.i18n.translate(a?"Yes":"No"):2!==c&&3!==c||!isNaN(a)?"ft"===b||"feet"===b||"foot"===b?a=h(12*a,f):"ft^2"===b||"feet^2"===b||"foot^2"===b?a=h(12*a,f)+" "+String.fromCharCode(178):"in"===b||"inch"===b?a=h(a,f):"in^2"===b||
"inch^2"===b?a=h(a,f)+" "+String.fromCharCode(178):"decimal-in"===b?a=g(a,f)+'"':"decimal-in^2"===b?a=g(a,f)+'" '+String.fromCharCode(178):"decimal-ft"===b?a=g(a,f)+"'":"decimal-ft^2"===b?a=g(a,f)+"' "+String.fromCharCode(178):"fractional-in"===b?a=h(a,f,!0):"fractional-in^2"===b?a=h(a,f,!0)+" "+String.fromCharCode(178):"m-and-cm"===b?a=k(a,f):"m-and-cm^2"===b?a=k(a,f)+" "+String.fromCharCode(178):3===c&&b?(b=b.replace("^2",String.fromCharCode(178)),b=b.replace("^3",String.fromCharCode(179)),a=g(a,
f)+" "+b):a=b?a+" "+b:3===c?g(a,f):a:a="NaN";return a};
Autodesk.Viewing.Private.convertUnits=function(a,b,c,f){if(a===b)return c;var d=1;switch(b){case "mm":d=1E3;break;case "cm":d=100;break;case "m":d=1;break;case "in":d=39.37007874;break;case "ft":d=3.280839895;break;case "decimal-in":d=39.37007874;break;case "decimal-ft":d=3.280839895;break;case "fractional-in":d=39.37007874;break;case "m-and-cm":d=1}b=1;switch(a){case "mm":b=.001;break;case "cm":b=.01;break;case "m":b=1;break;case "in":b=.0254;break;case "ft":b=.3048;break;case "decimal-in":b=.0254;
break;case "decimal-ft":b=.3048;break;case "fractional-in":b=.0254;break;case "m-and-cm":b=1}return"square"===f?c*Math.pow(d*b,2):c*d*b};AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing,b=Autodesk.Viewing.Private;b.OptionSlider=function(b,f,d,g,h){function k(a){a.target!=l.stepperElement&&(l.stepperElement.value=l.sliderElement.value);l.fireChangeEvent()}var l=this;this.tbody=g;this.sliderRow=this.tbody.insertRow(h&&h.insertAtIndex?h.insertAtIndex:-1);g=this.sliderRow.insertCell(0);this.caption=document.createElement("div");this.caption.setAttribute("data-i18n",b);this.caption.textContent=a.i18n.translate(b);this.sliderElement=document.createElement("input");
this.sliderElement.type="range";this.sliderElement.id=b+"_slider";this.sliderElement.min=f;this.sliderElement.max=d;g.appendChild(this.caption);g.appendChild(this.sliderElement);g=this.sliderRow.insertCell(1);this.stepperElement=document.createElement("input");this.stepperElement.type="number";this.stepperElement.id=b+"_stepper";this.stepperElement.min=f;this.stepperElement.max=d;this.stepperElement.step=1;this.stepperElement.style.width="64px";g.appendChild(this.stepperElement);this.blockEvent=!1;
this.stepperElement.addEventListener("change",function(a){a.target!=l.sliderElement&&(l.sliderElement.value=l.stepperElement.value);l.fireChangeEvent()},!1);this.sliderElement.addEventListener("change",k,!1);this.sliderElement.addEventListener("input",k,!1)};b.OptionSlider.prototype.constructor=b.OptionSlider;a.EventDispatcher.prototype.apply(b.OptionSlider.prototype);b.OptionSlider.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.value=this.sliderElement.value;var a=new CustomEvent("change",
{detail:{target:this,value:this.sliderElement.value}});this.dispatchEvent(a)}};b.OptionSlider.prototype.setValue=function(a){this.blockEvent=!0;this.value=a;this.sliderElement.value=a;this.stepperElement.value=a;this.blockEvent=!1};b.OptionSlider.prototype.setDisabled=function(a){this.sliderElement.disabled=a;this.stepperElement.disabled=a;this.caption.disabled=a};b.OptionCheckbox=function(b,f,d,g){var h=this;this.tbody=f;this.sliderRow=this.tbody.insertRow(g&&g.insertAtIndex?g.insertAtIndex:-1);
f=this.sliderRow.insertCell(0);this.caption=document.createElement("div");this.caption.setAttribute("data-i18n",b);this.caption.textContent=a.i18n.translate(b);f.appendChild(this.caption);f=this.sliderRow.insertCell(1);this.checkElement=document.createElement("input");this.checkElement.type="checkbox";this.checkElement.id=b+"_check";this.checkElement.checked=d;f.appendChild(this.checkElement);this.blockEvent=!1;this.checked=d;this.checkElement.addEventListener("change",function(a){h.fireChangeEvent()},
!1);isTouchDevice()&&(this.sliderRowHammer=new Hammer.Manager(this.sliderRow,{recognizers:[[Hammer.Tap]],inputClass:Hammer.TouchInput}),this.sliderRowHammer.on("tap",function(a){a.preventDefault();a.target.click()}));this.checkElement.addEventListener("click",function(a){a.stopPropagation()},!1);this.sliderRow.addEventListener("click",function(a){h.checkElement.disabled||(h.checkElement.checked=!h.checkElement.checked,h.fireChangeEvent())},!1)};b.OptionCheckbox.prototype.constructor=b.OptionCheckbox;
a.EventDispatcher.prototype.apply(b.OptionCheckbox.prototype);b.OptionCheckbox.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.checked=this.checkElement.checked;var a=new CustomEvent("change",{detail:{target:this,value:this.checkElement.checked}});this.dispatchEvent(a)}};b.OptionCheckbox.prototype.setValue=function(a){this.blockEvent=!0;this.checked=a;this.checkElement.checked=a;this.blockEvent=!1};b.OptionCheckbox.prototype.setDisabled=function(a){this.checkElement.disabled=a;this.caption.disabled=
a};b.OptionCheckbox.prototype.setVisibility=function(a){this.sliderRow.style.display=a?"table-row":"none"};b.OptionDropDown=function(b,f,d,g,h){var k=this;this.tbody=f;this.sliderRow=this.tbody.insertRow(h&&h.insertAtIndex?h.insertAtIndex:-1);f=this.sliderRow.insertCell(0);this.caption=document.createElement("div");this.caption.setAttribute("data-i18n",b);this.caption.textContent=a.i18n.translate(b);f.appendChild(this.caption);f=this.sliderRow.insertCell(1);this.dropdownElement=document.createElement("select");
this.dropdownElement.id=b+"_dropdown";this.dropdownElement.className="optionDropDown";for(b=0;b<d.length;b++)h=document.createElement("option"),h.value=b,h.setAttribute("data-i18n",d[b]),h.textContent=a.i18n.translate(d[b]),this.dropdownElement.add(h);this.selectedIndex=this.dropdownElement.selectedIndex=g;f.appendChild(this.dropdownElement);f.style.paddingLeft="5px";f.style.paddingRight="5px";this.blockEvent=!1;this.dropdownElement.addEventListener("change",function(a){k.fireChangeEvent()},!1)};
b.OptionDropDown.prototype.constructor=b.OptionDropDown;a.EventDispatcher.prototype.apply(b.OptionDropDown.prototype);b.OptionDropDown.prototype.setSelectedIndex=function(a){this.blockEvent=!0;this.selectedIndex=this.dropdownElement.selectedIndex=a;this.blockEvent=!1};b.OptionDropDown.prototype.setSelectedValue=function(a){this.blockEvent=!0;this.dropdownElement.selectedValue=a;this.selectedIndex=this.dropdownElement.selectedIndex;this.blockEvent=!1};b.OptionDropDown.prototype.fireChangeEvent=function(){if(!this.blockEvent){this.selectedIndex=
this.dropdownElement.selectedIndex;var a=new CustomEvent("change",{detail:{target:this,value:this.selectedIndex}});this.dispatchEvent(a)}};b.OptionDropDown.prototype.setDisabled=function(a){this.dropdownElement.disabled=a;this.caption.disabled=a}})();AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.ProgressBar=function(a){this.bg=document.createElement("div");this.bg.className="progressbg";this.fg=document.createElement("div");this.fg.className="progressfg";this.bg.appendChild(this.fg);this.lastValue=-1;a.appendChild(this.bg);this.widthScale=this.fg.clientWidth};
Autodesk.Viewing.Private.ProgressBar.prototype.setPercent=function(a){a!=this.lastValue&&(this.lastValue=a,99<=a?this.bg.style.visibility="hidden":(this.bg.style.visibility="visible",this.fg.style.width=this.widthScale*a*.01+"px"))};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.RenderOptionsPanel=function(a){var b=this,c=Autodesk.Viewing.Private;this.viewer=a;Autodesk.Viewing.UI.DockingPanel.call(this,a.container,"RenderOptionsPanel","Rendering Options");this.table=document.createElement("table");this.table.className="tftable";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.createScrollContainer({heightAdjustment:70,marginTop:20});this.scrollContainer.appendChild(this.table);this.container.style.width="320px";this.container.style.top=
"260px";this.container.style.left="220px";this.container.style.height="460px";this.container.dockRight=!0;var f=[],d;for(d in a.impl.BackgroundPresets)f.push(d);this.bgSelect=new c.OptionDropDown("Background Color",this.tbody,f,-1);this.updateBgColorIndex();this.addEventListener(this.bgSelect,"change",function(c){c=a.BackgroundPresets[b.bgSelect.value];a.prefs.set("backgroundColorPreset",JSON.stringify(c));a.impl.setClearColors(c[0],c[1],c[2],c[3],c[4],c[5])});this.celToggle=new c.OptionCheckbox("Cel Shaded",
this.tbody,!0);this.addEventListener(this.celToggle,"change",function(c){c=b.celToggle.checked;a.prefs.set("celShaded",c);a.impl.toggleCelShading(c)});this.saoToggle=new c.OptionCheckbox("AO Enabled",this.tbody,!0);this.addEventListener(this.saoToggle,"change",function(c){c=b.saoToggle.checked;a.prefs.set("ambientShadows",c);a.setQualityLevel(c,a.impl.renderer().settings.antialias)});this.saoRadius=new c.OptionSlider("AO Radius",0,100,this.tbody);this.saoRadius.setValue(10);this.saoRadius.sliderElement.step=
this.saoRadius.stepperElement.step=1;this.addEventListener(this.saoRadius,"change",function(c){a.impl.renderer().setAOOptions(parseInt(b.saoRadius.value),parseFloat(b.saoIntensity.value));a.impl.renderer().composeFinalFrame(!1)});this.saoIntensity=new c.OptionSlider("AO Intensity",0,3,this.tbody);this.saoIntensity.setValue(.75);this.saoIntensity.sliderElement.step=this.saoIntensity.stepperElement.step=.1;this.addEventListener(this.saoIntensity,"change",function(c){a.impl.renderer().setAOOptions(parseInt(b.saoRadius.value),
parseFloat(b.saoIntensity.value));a.impl.renderer().composeFinalFrame(!1)});this.groundShadowAlpha=new c.OptionSlider("Shadow Alpha",0,2,this.tbody);this.groundShadowAlpha.setValue(1);this.groundShadowAlpha.sliderElement.step=this.groundShadowAlpha.stepperElement.step=.1;this.addEventListener(this.groundShadowAlpha,"change",function(c){a.setGroundShadowAlpha(parseFloat(b.groundShadowAlpha.value))});this.groundShadowColor=new c.OptionCheckbox("Shadow Color",this.tbody);_isIE11||(this.groundShadowColor.checkElement.type=
"color");this.addEventListener(this.groundShadowColor,"change",function(c){a.setGroundShadowColor(new THREE.Color(parseInt(b.groundShadowColor.checkElement.value.substr(1,7),16)))});this.groundReflectionAlpha=new c.OptionSlider("Reflection Alpha",0,2,this.tbody);this.groundReflectionAlpha.setValue(1);this.groundReflectionAlpha.sliderElement.step=this.groundReflectionAlpha.stepperElement.step=.1;this.addEventListener(this.groundReflectionAlpha,"change",function(c){a.setGroundReflectionAlpha(parseFloat(b.groundReflectionAlpha.value))});
this.groundReflectionColor=new c.OptionCheckbox("Reflection Color",this.tbody);_isIE11||(this.groundReflectionColor.checkElement.type="color");this.addEventListener(this.groundReflectionColor,"change",function(c){a.setGroundReflectionColor(new THREE.Color(parseInt(b.groundReflectionColor.checkElement.value.substr(1,7),16)))});f=[];for(d=0;d<c.LightPresets.length;d++)f.push(c.LightPresets[d].name);this.envSelect=new c.OptionDropDown("Environment",this.tbody,f,a.impl.currentLightPreset());this.addEventListener(this.envSelect,
"change",function(c){a.setLightPreset(b.envSelect.selectedIndex)});f=a.impl.renderer().getToneMapMethod();this.toneMapMethod=new c.OptionDropDown("Tonemap Method",this.tbody,["None","Canon-RGB","Canon-Lum"],f);this.addEventListener(this.toneMapMethod,"change",function(){a.impl.setTonemapMethod(b.toneMapMethod.selectedIndex)});this.exposureBias=new c.OptionSlider("Exposure Bias",-30,30,this.tbody);this.exposureBias.setValue(a.impl.renderer().getExposureBias());this.exposureBias.sliderElement.step=
this.exposureBias.stepperElement.step=.1;this.addEventListener(this.exposureBias,"change",function(c){a.impl.setTonemapExposureBias(b.exposureBias.value,b.whiteScale.value)});this.exposureBias.setDisabled(0==f);this.whiteScale=new c.OptionSlider("Light Intensity",-5,20,this.tbody);f=0;a.impl.dir_light1&&(f=0!=a.impl.dir_light1.intensity?Math.log(a.impl.dir_light1.intensity)/Math.log(2):-1E-20);this.whiteScale.setValue(f);this.whiteScale.sliderElement.step=this.whiteScale.stepperElement.step=.1;this.addEventListener(this.whiteScale,
"change",function(c){a.impl.dir_light1.intensity=Math.pow(2,b.whiteScale.value);a.impl.setTonemapExposureBias(b.exposureBias.value,b.whiteScale.value)});this.fovAngle=new c.OptionSlider("FOV-degrees",6.88,100,this.tbody);this.fovAngle.setValue(a.getFOV());this.addEventListener(this.fovAngle,"change",function(c){a.setFOV(parseFloat(b.fovAngle.value))});this.addEventListener(this.viewer,Autodesk.Viewing.CAMERA_CHANGE_EVENT,function(c){c=parseFloat(b.fovAngle.value);var d=a.getFOV();c!=d&&b.fovAngle.setValue(d)});
this.addEventListener(this.viewer,Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,function(a){b.syncUI()});this.addVisibilityListener(function(){b.resizeToContent()})};Autodesk.Viewing.Private.RenderOptionsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Private.RenderOptionsPanel.prototype.constructor=Autodesk.Viewing.Private.RenderOptionsPanel;
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.getContentSize=function(){return{height:this.table.clientHeight+75,width:this.table.clientWidth}};
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.updateBgColorIndex=function(){var a=this.viewer.impl,b=a.clearColorTop,a=a.clearColorBottom,b=[255*b.x|0,255*b.y|0,255*b.z|0,255*a.x|0,255*a.y|0,255*a.z|0],c,f;for(f in Autodesk.Viewing.Private.BackgroundPresets){var a=Autodesk.Viewing.Private.BackgroundPresets[f],d;for(d=0;6>d&&a[d]==b[d];d++);if(6==d){c=f;break}}if(!c)for(c="Custom",f=Autodesk.Viewing.Private.BackgroundPresets[c],a=0;6>a;a++)f[a]=b[a];this.bgSelect.setSelectedValue(c)};
Autodesk.Viewing.Private.RenderOptionsPanel.prototype.syncUI=function(){var a=this.viewer.impl,b=0;a.dir_light1&&(b=0!=a.dir_light1.intensity?Math.log(a.dir_light1.intensity)/Math.log(2):-1E-20);this.whiteScale.setValue(b);this.exposureBias.setValue(a.renderer().getExposureBias());this.updateBgColorIndex();b=a.renderer().getToneMapMethod();this.toneMapMethod.setSelectedIndex(b);this.envSelect.setSelectedIndex(a.currentLightPreset());this.exposureBias.setDisabled(0==b);this.saoToggle.setValue(a.renderer().settings.sao);
this.saoRadius.setDisabled(!a.renderer().settings.sao);this.saoIntensity.setDisabled(!a.renderer().settings.sao);this.saoRadius.setValue(a.renderer().getAORadius());this.saoIntensity.setValue(a.renderer().getAOIntensity());this.groundShadowAlpha.setDisabled(!this.viewer.prefs.get("groundShadow"));this.groundShadowColor.setDisabled(!this.viewer.prefs.get("groundShadow"));this.groundReflectionAlpha.setDisabled(!this.viewer.prefs.get("groundReflection"));this.groundReflectionColor.setDisabled(!this.viewer.prefs.get("groundReflection"));
this.fovAngle.setValue(this.viewer.getFOV());this.celToggle.setValue(a.renderer().settings.toonShaded)};Autodesk.Viewing.Private.RenderOptionsPanel.prototype.uninitialize=function(){Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this);this.viewer=this.fovAngle=this.whiteScale=this.exposureBias=this.toneMapMethod=this.envSelect=this.groundShadowAlpha=this.saoIntensity=this.saoRadius=this.saoToggle=this.bgSelect=this.tbody=this.table=null};AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.LayersPanel=function(a,b,c){this.viewer=a;this.layersRoot=this.tree=null;this.visibilityImages={};this.isMac=-1!==navigator.userAgent.search("Mac OS");b="Layer Manager";var f=a.config.viewableName;f&&"W2D"!==f&&(b=Autodesk.Viewing.i18n.translate(b)+": "+f);this.filterImageId=c+"-layerFilterImageId";Autodesk.Viewing.UI.DockingPanel.call(this,a.container,c,b,{localizeTitle:!1});this.container.classList.add("layersPanel");this.filterContainer=document.createElement("div");this.filterContainer.className=
"filterBox";this.filterContainer.id=this.container.id+"-search-container";this.container.appendChild(this.filterContainer);this.createScrollContainer({heightAdjustment:105,marginTop:5});var d=this;a.model?d.build():d.addEventListener(a,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,function(){d.build()});this.addVisibilityListener(function(){d.resizeToContent()})};Autodesk.Viewing.UI.LayersPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);
Autodesk.Viewing.UI.LayersPanel.prototype.constructor=Autodesk.Viewing.UI.LayersPanel;Autodesk.Viewing.UI.LayersPanel.prototype.uninitialize=function(){Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this);this.filterContainer=this.scrollContainer=this.visibilityImages=this.layersRoot=this.tree=this.viewer=null};
Autodesk.Viewing.UI.LayersPanel.prototype.build=function(){function a(){if(d.value){var a=function(c){var d=[];if(-1!==c.name.toLowerCase().indexOf(b))d.push(c);else if(!c.isLayer){c=c.children;for(var f=0;f<c.length;++f)d=d.concat(a(c[f]))}return d},b=d.value.toLowerCase();k&&0<k.childCount&&h.setLayerVisible(a(k),!0,!0)}else h.setLayerVisible(null,!0);g=null}var b=this,c=document.createElement("div");c.className="filterSearch";b.filterContainer.appendChild(c);var f=document.createElement("div");
f.className="filterImage";f.id=b.filterImageId;f.title=Autodesk.Viewing.i18n.translate("Show/hide all layers");c.appendChild(f);b.visibilityImages[b.filterImageId]=f;b.addEventListener(f,"click",function(a){b.onImageClick(null,a);a.stopPropagation()});var d=this.filterField=document.createElement("input");d.className="filterInput";d.placeholder=Autodesk.Viewing.i18n.translate("Enter filter term");d.setAttribute("data-i18n","[placeholder]Enter filter term");d.type="search";d.incremental="incremental";
c.appendChild(d);var g=null,h=b.viewer;d.addEventListener("keyup",function(b){g&&clearTimeout(g);g=setTimeout(a,500)});d.addEventListener("click",function(a){""===d.value?h.setLayerVisible(null,!0):setTimeout(function(){""===d.value&&(h.setLayerVisible(null,!0),a.preventDefault())},1)});var c=function(){var a=new Autodesk.Viewing.UI.TreeDelegate;a.getTreeNodeId=function(a){return a.id};a.getTreeNodeLabel=function(a){return b.getNodeLabel(a)};a.getTreeNodeClass=function(a){return b.getNodeClass(a)};
a.isTreeNodeGroup=function(a){return b.isGroupNode(a)};a.shouldCreateTreeNode=function(a){return b.shouldInclude(a)};a.onTreeNodeClick=function(a,c,d){b.onClick(c,d)};a.onTreeNodeRightClick=function(a,c,d){b.onRightClick(c,d)};a.onTreeNodeDoubleClick=function(a,c,d){b.onDoubleClick(c,d)};a.onTreeNodeIconClick=function(a,c,d){b.onIconClick(c,d)};a.createTreeNode=function(a,c){b.createNode(a,c)};return a}(),k=b.layersRoot=b.viewer.model.getLayersRoot();k&&(b.tree=new Autodesk.Viewing.UI.Tree(c,k,b.scrollContainer,
{excludeRoot:!0}),b.resizeToContent(),b.update(),b.addEventListener(b.viewer,Autodesk.Viewing.LAYER_VISIBILITY_CHANGED_EVENT,function(){b.update()}))};
Autodesk.Viewing.UI.LayersPanel.prototype.update=function(){function a(a,b){var c;c=1===b?"layerVisible":0===b?"layerHidden":"layerMixed";a.classList.remove("layerVisible","layerHidden","layerMixed");a.classList.add(c)}function b(a,b){0===b?d.tree.addClass(a.id,"dim"):d.tree.removeClass(a.id,"dim")}function c(a){var b;if(0<a.length)for(var c=0;c<a.length;++c){var d=a[c];void 0===b?b=d:0===d&&1===b?b=-1:1===d&&0===b&&(b=-1);if(-1===b)break}else b=0;return b}function f(g){var k=d.visibilityImages[g.id];
if(!g.isLayer){for(var l=g.children,n=[],q=0;q<l.length;++q)n=n.concat(f(l[q]));l=c(n);a(k,l);b(g,l);return n}n=d.viewer.isLayerVisible(g)?1:0;a(k,n);b(g,n);return[n]}var d=this,g=this.layersRoot&&0<this.layersRoot.childCount?f(d.layersRoot):[];a(d.visibilityImages[d.filterImageId],c(g))};Autodesk.Viewing.UI.LayersPanel.prototype.setLayerVisible=function(a,b){this.viewer.setLayerVisible(a,"layerVisible"!==this.visibilityImages[a?a.id:this.filterImageId].className,b);this.filterField.value=""};
Autodesk.Viewing.UI.LayersPanel.prototype.getNodeLabel=function(a){return a.isLayer||0===a.childCount?a.name:a.name+" ("+a.childCount+")"};Autodesk.Viewing.UI.LayersPanel.prototype.getNodeClass=function(a){return""};Autodesk.Viewing.UI.LayersPanel.prototype.isGroupNode=function(a){return!a.isLayer};Autodesk.Viewing.UI.LayersPanel.prototype.shouldInclude=function(a){return!0};Autodesk.Viewing.UI.LayersPanel.prototype.onIconClick=function(a,b){this.setGroupCollapsed(a,!this.isGroupCollapsed(a))};
Autodesk.Viewing.UI.LayersPanel.prototype.setGroupCollapsed=function(a,b){var c=this.tree.delegate();c.isTreeNodeGroup(a)&&(c=c.getTreeNodeId(a),this.tree.setCollapsed(c,b),this.resizeToContent())};Autodesk.Viewing.UI.LayersPanel.prototype.isGroupCollapsed=function(a){var b=this.tree.delegate();return b.isTreeNodeGroup(a)?(a=b.getTreeNodeId(a),this.tree.isCollapsed(a)):!1};Autodesk.Viewing.UI.LayersPanel.prototype.onClick=function(a,b){};
Autodesk.Viewing.UI.LayersPanel.prototype.onDoubleClick=function(a,b){};Autodesk.Viewing.UI.LayersPanel.prototype.onRightClick=function(a,b){};Autodesk.Viewing.UI.LayersPanel.prototype.onImageClick=function(a,b){};Autodesk.Viewing.UI.LayersPanel.prototype.getContentSize=function(){var a=this.filterContainer,b=a.clientHeight+80,a=a.clientWidth,c=this.tree;return c&&(c=c.getRootContainer())?{height:c.clientHeight+b,width:Math.max(c.clientWidth,a)}:{height:b,width:a}};
Autodesk.Viewing.UI.LayersPanel.prototype.createNode=function(a,b){var c=document.createElement("div");b.children&&0<b.children.length?b.insertBefore(c,b.children[0]):b.appendChild(c);c.title=Autodesk.Viewing.i18n.translate("Show/hide this layer");this.visibilityImages[a.id]=c;var f=document.createElement("label");f.textContent=this.getNodeLabel(a);b.appendChild(f);var d=this;this.addEventListener(c,"click",function(b){d.onImageClick(a,b);b.stopPropagation()})};AutodeskNamespace("Autodesk.Viewing.UI");
Autodesk.Viewing.UI.SettingsPanel=function(a,b,c,f){Autodesk.Viewing.UI.DockingPanel.call(this,a,b,c,f);this.panelTabs=[];this.tabIdToIndex={};this.controls={};this.controlIdCount=0;var d=this;this.container.style.maxWidth="800px";this.container.style.minWidth="340px";this.container.style.top="100px";this.container.style.left=a.offsetWidth/2-170+"px";this.container.style.position="absolute";this.tabContainer=document.createElement("div");this.tabContainer.className="settings-tabs";this.container.appendChild(this.tabContainer);
this.tabs=document.createElement("ul");this.tabContainer.appendChild(this.tabs);this.heightAdjustment=f&&f.heightAdjustment?f.heightAdjustment:110;this.createScrollContainer({left:!1,heightAdjustment:this.heightAdjustment,marginTop:0});this.mouseOver=!1;this.addEventListener(this.container,"mouseover",function(a){a=a.toElement||a.relatedTarget;if(d.mouseOver)return!0;for(var b=0;a&&a.parentNode&&a.parentNode!=window;){if(a.parentNode==this||a==this){a.preventDefault&&a.preventDefault();d.mouseOver=
!0;for(b=0;b<d.panelTabs.length;b++)d.panelTabs[b].classList.remove("selectedmouseout");return!0}a=a.parentNode}});this.addEventListener(this.container,"mouseout",function(a){a=a.toElement||a.relatedTarget;if(d.mouseOver){for(;a&&a.parentNode&&a.parentNode!=window;){if(a.parentNode==this||a==this)return a.preventDefault&&a.preventDefault(),!1;a=a.parentNode}d.mouseOver=!1;for(a=0;a<d.panelTabs.length;a++)d.panelTabs[a].classList.contains("tabselected")&&d.panelTabs[a].classList.add("selectedmouseout")}})};
Autodesk.Viewing.UI.SettingsPanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.UI.SettingsPanel.prototype.constructor=Autodesk.Viewing.UI.SettingsPanel;Autodesk.Viewing.UI.SettingsPanel.prototype.setVisible=function(a){a&&(this.container.style.display="block");Autodesk.Viewing.UI.DockingPanel.prototype.setVisible.call(this,a)};
Autodesk.Viewing.UI.SettingsPanel.prototype.addTab=function(a,b,c){var f=this;if(void 0!==this.tabIdToIndex[a])return!1;var d=c&&void 0!==c.className?c.className:null,g=c&&void 0!==c.width?c.width:200;c=c&&void 0!==c.index?c.index:this.panelTabs.length;var h=document.createElement("li");h.id=a;var k=document.createElement("a"),l=document.createElement("span");l.setAttribute("data-i18n",b);l.textContent=Autodesk.Viewing.i18n.translate(b);k.appendChild(l);h.appendChild(k);this.tabs.appendChild(h);b=
document.createElement("table");b.id=a+"-table";b.className="settings-table tftable "+d;d=document.createElement("tbody");b.appendChild(d);this.scrollContainer.appendChild(b);this.addEventListener(h,"touchstart",touchStartToClick);this.addEventListener(h,"click",function(b){f.selectTab(a)});this.panelTabs.push(h);this.tabIdToIndex[a]=c;d=this.container.style.minWidth?parseInt(this.container.style.minWidth):0;g>d&&(this.container.style.minWidth=g+"px");return!0};
Autodesk.Viewing.UI.SettingsPanel.prototype.removeTab=function(a){a=this.tabIdToIndex[a];if(!a)return!1;this.panelTabs.splice(a,1);this.tabs.removeChild(tabDom);this.tabIdToIndex={};a=this.panelTabs.length;for(var b=0;b<a;b++)this.tabIdToIndex[this.panelTabs[b].id]=b;return!0};Autodesk.Viewing.UI.SettingsPanel.prototype.hasTab=function(a){return void 0!==this.panelTabs[this.tabIdToIndex[a]]};
Autodesk.Viewing.UI.SettingsPanel.prototype.selectTab=function(a){if(this.isTabSelected(a))return!1;for(var b=this.panelTabs.length,c=0;c<b;c++){var f=this.panelTabs[c],d=document.getElementById(f.id+"-table");a===f.id?(f.classList.add("tabselected"),d.style.display="table",this.mouseOver||f.classList.add("selectedmouseout")):(f.classList.remove("tabselected"),d.style.display="none",this.mouseOver||this.panelTabs[c].classList.remove("selectedmouseout"))}this.resizeToContent();return!0};
Autodesk.Viewing.UI.SettingsPanel.prototype.isTabSelected=function(a){return(a=this.panelTabs[this.tabIdToIndex[a]])&&a.classList.contains("tabselected")};
Autodesk.Viewing.UI.SettingsPanel.prototype.addCheckbox=function(a,b,c,f,d){if(void 0===this.tabIdToIndex[a])return null;var g=document.getElementById(a+"-table");b=new Autodesk.Viewing.Private.OptionCheckbox(b,g.tBodies[0],c,d);b.changeListener=function(a){f(a.detail.target.checked)};this.addEventListener(b,"change",b.changeListener);return this.addControl(a,b)};
Autodesk.Viewing.UI.SettingsPanel.prototype.addSlider=function(a,b,c,f,d,g,h){if(void 0===this.tabIdToIndex[a])return null;var k=document.getElementById(a+"-table");b=new Autodesk.Viewing.Private.OptionSlider(b,c,f,k.tBodies[0],h);b.setValue(d);b.sliderElement.step=b.stepperElement.step=1;this.addEventListener(b,"change",function(a){g(a)});return this.addControl(a,b)};
Autodesk.Viewing.UI.SettingsPanel.prototype.addDropDownMenu=function(a,b,c,f,d,g){if(void 0===this.tabIdToIndex[a])return null;var h=document.getElementById(a+"-table");b=new Autodesk.Viewing.Private.OptionDropDown(b,h.tBodies[0],c,f,g);this.addEventListener(b,"change",function(a){d(a)});return this.addControl(a,b)};
Autodesk.Viewing.UI.SettingsPanel.prototype.addControl=function(a,b,c){if(void 0===this.tabIdToIndex[a])return null;if(!b.hasOwnProperty("sliderRow")){var f=c&&c.insertAtIndex?c.insertAtIndex:-1;c=c&&c.caption?c.caption:null;a=document.getElementById(a+"-table");f>a.length&&(f=-1);var f=a.tBodies[0].insertRow(f),d=f.insertCell(0);if(c){var g=document.createElement("div");g.setAttribute("data-i18n",c);g.textContent=Autodesk.Viewing.i18n.translate(c);d.appendChild(g);d=f.insertCell(1)}else d.colSpan=
2;d.appendChild(b);b.sliderRow=f;b.tbody=a.tBodies[0]}c="adsk_settings_control_id_"+this.controlIdCount.toString();this.controlIdCount+=1;this.controls[c]=b;this.resizeToContent();return c};Autodesk.Viewing.UI.SettingsPanel.prototype.removeCheckbox=function(a){return this.removeControl(a)};Autodesk.Viewing.UI.SettingsPanel.prototype.removeSlider=function(a){return this.removeControl(a)};Autodesk.Viewing.UI.SettingsPanel.prototype.removeCheckbox=function(a){return this.removeControl(a)};
Autodesk.Viewing.UI.SettingsPanel.prototype.removeControl=function(a){var b=this.controls[a];if(void 0===b)return!1;b.tbody.deleteRow(b.sliderRow.rowIndex);delete this.controls[a];this.resizeToContent();return!0};Autodesk.Viewing.UI.SettingsPanel.prototype.getControl=function(a){return void 0!==this.controls[a]?this.controls[a]:null};
Autodesk.Viewing.UI.SettingsPanel.prototype.getContentSize=function(){for(var a=this.heightAdjustment,b=this.panelTabs.length>this.panelTabs[0]?0:null,c=0;c<this.panelTabs.length;c++){var f=this.panelTabs[c];if(this.isTabSelected(f.id)){b=f;break}}b&&(b=document.getElementById(f.id+"-table"),a+=b.clientHeight);return{height:a,width:this.container.clientWidth}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.AlertBox=function(){};Autodesk.Viewing.Private.AlertBox.instances=[];
Autodesk.Viewing.Private.AlertBox.displayError=function(a,b,c,f,d){var g=document.createElement("div");g.className="alertBox error";a.appendChild(g);f||(f="img-item-not-found");var h=document.createElement("div");h.className="alertBoxImage "+f;g.appendChild(h);f=document.createElement("div");f.className="alertBoxMsg";g.appendChild(f);c||(c=Autodesk.Viewing.i18n.translate("Error Occurred",{defaultValue:"Error Occurred"}));h=document.createElement("div");h.className="alertBoxTitle";h.textContent=c;
f.appendChild(h);c=document.createElement("div");c.className="alertBoxText";c.textContent=b;f.appendChild(c);if(d){b=document.createElement("div");b.className="alertBoxContent";f.appendChild(b);f=document.createElement("ul");f.className="alertBoxContent";for(c=0;c<d.length;c++){var k=d[c];if(k){h=document.createElement("li");f.appendChild(h);k=this.extractList(k);if(k.list.length){var l=this.generateListElement(list);f.appendChild(l)}h.innerHTML=k.msg}}b.appendChild(f)}d=document.createElement("div");
d.className="alertBoxOK";d.textContent=Autodesk.Viewing.i18n.translate("OK",{defaultValue:"OK"});var n={alertBox:g,container:a};d.addEventListener("click",function(b){g.style.visibility="hidden";a.removeChild(g);Autodesk.Viewing.Private.AlertBox.instances.splice(Autodesk.Viewing.Private.AlertBox.instances.indexOf(n),1)});g.appendChild(d);g.style.visibility="visible";Autodesk.Viewing.Private.AlertBox.instances.push(n)};
Autodesk.Viewing.Private.AlertBox.displayErrors=function(a,b,c){var f=document.createElement("div");f.className="alertBox errors";a.appendChild(f);b||(b="img-item-not-found");var d=document.createElement("div");d.className="alertBoxImage "+b;f.appendChild(d);b=document.createElement("div");b.className="alertBoxMsg errors";f.appendChild(b);for(d=0;d<c.length;d++){var g=c[d].header;g||(g=Autodesk.Viewing.i18n.translate("Error",{defaultValue:"Error"}));var h=document.createElement("div");h.className=
"alertBoxTitle errors";h.textContent=g;b.appendChild(h);var k=document.createElement("div");k.className="alertBoxText errors";h=c[d].msg;g=this.extractList(h);if(g.list.length){var l=document.createElement("div"),h=this.generateListElement(g.list);l.appendChild(h);k.textContent=g.msg;k.appendChild(l)}else k.textContent=h;b.appendChild(k);if(c[d].hints){k=document.createElement("ul");k.className="alertBoxContent";for(var l=c[d].hints,n=0;n<l.length;n++)if(g=l[n]){var q=document.createElement("li");
k.appendChild(q);g=this.extractList(g);g.list.length&&(h=this.generateListElement(g.list),k.appendChild(h));q.innerHTML=g.msg}b.appendChild(k)}}c=document.createElement("div");c.className="alertBoxOK";c.textContent=Autodesk.Viewing.i18n.translate("OK",{defaultValue:"OK"});var m={alertBox:f,container:a};c.addEventListener("click",function(b){f.style.visibility="hidden";a.removeChild(f);Autodesk.Viewing.Private.AlertBox.instances.splice(Autodesk.Viewing.Private.AlertBox.instances.indexOf(m),1)});f.appendChild(c);
f.style.visibility="visible";Autodesk.Viewing.Private.AlertBox.instances.push(m)};Autodesk.Viewing.Private.AlertBox.extractList=function(a){var b={msg:a,list:[]};a&&-1!=a.indexOf("<ul>")&&(a=a.split("<ul>"),b.msg=a[0],a=a[1].split("</ul>"),b.list=a[0].split(", "),1===b.list.length&&(b.list=a[0].split(",")));return b};Autodesk.Viewing.Private.AlertBox.generateListElement=function(a){for(var b=document.createElement("ul"),c=0;c<a.length;c++){var f=document.createElement("li");f.textContent=a[c];b.appendChild(f)}return b};
Autodesk.Viewing.Private.AlertBox.dismiss=function(){if(0<Autodesk.Viewing.Private.AlertBox.instances.length){var a=Autodesk.Viewing.Private.AlertBox.instances.pop();a.alertBox.style.visibility="hidden";a.container.removeChild(a.alertBox);return!0}return!1};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.HudMessage=function(){};Autodesk.Viewing.Private.HudMessage.instances=[];
Autodesk.Viewing.Private.HudMessage.displayMessage=function(a,b,c,f,d){if(!(0<Autodesk.Viewing.Private.HudMessage.instances.length)){var g=b.msgTitleKey,h=b.msgTitleDefaultValue?b.msgTitleDefaultValue:g,k=b.messageKey,l=b.messageDefaultValue?b.messageDefaultValue:k;b=b.buttonText;var n=document.createElement("div");n.className="hud";a.appendChild(n);var q=document.createElement("div");q.className="hudTitle";q.textContent=Autodesk.Viewing.i18n.translate(g,{defaultValue:h});q.setAttribute("data-i18n",
g);n.appendChild(q);c&&(g=document.createElement("div"),g.className="hudClose",g.innerHTML="&times;",g.addEventListener("click",function(b){a.removeChild(n);c&&c(b)}),n.appendChild(g));g=document.createElement("div");g.className="hudMessage";g.textContent=Autodesk.Viewing.i18n.translate(k,{defaultValue:l});g.setAttribute("data-i18n",k);n.appendChild(g);f&&(k=document.createElement("div"),k.className="hudButton",k.textContent=Autodesk.Viewing.i18n.translate(b,{defaultValue:b}),k.setAttribute("data-i18n",
b),k.addEventListener("click",f),n.appendChild(k));d&&(f=document.createElement("div"),k=document.createElement("input"),k.className="hudCheckbox",k.type="checkbox",f.appendChild(k),l=document.createElement("label"),l.setAttribute("for","Do not show this message again"),l.setAttribute("data-i18n","Do not show this message again"),l.textContent=Autodesk.Viewing.i18n.translate("Do not show this message again",{defaultValue:"Do not show this message again"}),f.appendChild(l),k.addEventListener("change",
d),n.appendChild(f));Autodesk.Viewing.Private.HudMessage.instances.push({hudMessage:n,container:a})}};Autodesk.Viewing.Private.HudMessage.dismiss=function(){if(0<Autodesk.Viewing.Private.HudMessage.instances.length){var a=Autodesk.Viewing.Private.HudMessage.instances.pop();a.hudMessage.style.visibility="hidden";a.container.removeChild(a.hudMessage);return!0}return!1};"use strict";AutodeskNamespace("Autodesk.Viewing.UI");Autodesk.Viewing.UI.TreeDelegate=function(){};
Autodesk.Viewing.UI.TreeDelegate.prototype.constructor=Autodesk.Viewing.UI.TreeDelegate;Autodesk.Viewing.UI.TreeDelegate.prototype.isTreeNodeGroup=function(a){throw"isTreeNodeGroup is not implemented.";};Autodesk.Viewing.UI.TreeDelegate.prototype.getTreeNodeId=function(a){throw"getTreeNodeId is not implemented.";};Autodesk.Viewing.UI.TreeDelegate.prototype.getTreeNodeLabel=function(a){return a.name};Autodesk.Viewing.UI.TreeDelegate.prototype.shouldCreateTreeNode=function(a){return!0};
Autodesk.Viewing.UI.TreeDelegate.prototype.createTreeNode=function(a,b,c){var f=document.createElement("label");b.appendChild(f);a=this.getTreeNodeLabel(a);c&&c.localize&&(f.setAttribute("data-i18n",a),a=Autodesk.Viewing.i18n.translate(a));f.textContent=a};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeClick=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeIconClick=function(a,b,c){a.delegate().isTreeNodeGroup(b)&&a.setCollapsed(b,!a.isCollapsed(b))};
Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeDoubleClick=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.onTreeNodeRightClick=function(a,b,c){};Autodesk.Viewing.UI.TreeDelegate.prototype.getTreeNodeClass=function(a){return""};
Autodesk.Viewing.UI.Tree=function(a,b,c,f){this.myDelegate=a;this.mySelectedNodes=[];this.myOptions=f||{};this.myGroupNodes=[];this.nodeToElement=[];a=this.myRootContainer=this.createHtmlElement_(c,"div","treeview");b=this.rootElem=this.createElement_(b,a,null,0);f&&f.excludeRoot&&b.classList.add("exclude")};Autodesk.Viewing.UI.Tree.prototype.constructor=Autodesk.Viewing.UI.Tree;Autodesk.Viewing.UI.Tree.prototype.show=function(a){this.myRootContainer.style.display=a?"block":"none"};
Autodesk.Viewing.UI.Tree.prototype.getRootContainer=function(){return this.myRootContainer};Autodesk.Viewing.UI.Tree.prototype.getElementForNode=function(a){return this.nodeToElement["number"==typeof a?a:this.myDelegate.getTreeNodeId(a)]};Autodesk.Viewing.UI.Tree.prototype.delegate=function(){return this.myDelegate};Autodesk.Viewing.UI.Tree.prototype.isCollapsed=function(a){return this.hasClass(a,"collapsed")};
Autodesk.Viewing.UI.Tree.prototype.setCollapsed=function(a,b,c){b?(this.addClass(a,"collapsed",c),this.removeClass(a,"expanded",c)):(this.addClass(a,"expanded",c),this.removeClass(a,"collapsed",c))};
Autodesk.Viewing.UI.Tree.prototype.setAllCollapsed=function(a){var b;a?(a=function(a){return a.classList.contains("expanded")},b=function(a){a.classList.add("collapsed");a.classList.remove("expanded")}):(a=function(a){return a.classList.contains("collapsed")},b=function(a){a.classList.add("expanded");a.classList.remove("collapsed")});for(var c=0;c<this.myGroupNodes.length;++c){var f=this.myGroupNodes[c];a(f)&&b(f)}};
Autodesk.Viewing.UI.Tree.prototype.addToSelection=function(a){for(var b=a.length,c=0;c<b;++c){var f=a[c],d;d=f;-1===this.mySelectedNodes.indexOf(d)?(this.mySelectedNodes.push(d),d=!0):d=!1;d&&this.addClass(f,"selected")}};Autodesk.Viewing.UI.Tree.prototype.removeFromSelection=function(a){for(var b=a.length-1;0<=b;--b){var c=a[b],f;f=this.mySelectedNodes.indexOf(c);-1!==f?(this.mySelectedNodes.splice(f,1),f=!0):f=!1;f&&this.removeClass(c,"selected")}};
Autodesk.Viewing.UI.Tree.prototype.setSelection=function(a){this.removeFromSelection(this.mySelectedNodes);this.addToSelection(a);return this.mySelectedNodes};Autodesk.Viewing.UI.Tree.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedNodes)};Autodesk.Viewing.UI.Tree.prototype.isSelected=function(a){return this.hasClass(a,"selected")};
Autodesk.Viewing.UI.Tree.prototype.scrollTo=function(a){if(a=this.getElementForNode(a)){var b=a.offsetTop;for(a=a.parentNode;a&&a!=this.myRootContainer;)b+=a.offsetTop,a=a.parentNode;this.myRootContainer.parentNode.scrollTop=b}};Autodesk.Viewing.UI.Tree.prototype.addClass=function(a,b,c){if(a=this.getElementForNode(a)){if(c)for(a=a.parentNode,c=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;a&&a!==c;)a.classList.add(b),a=a.parentNode;else a.classList.add(b);return!0}return!1};
Autodesk.Viewing.UI.Tree.prototype.removeClass=function(a,b,c){if(a=this.getElementForNode(a)){if(c)for(a=a.parentNode,c=this.myOptions.excludeRoot?this.rootElem:this.myRootContainer;a&&a!==c;)a.classList.remove(b),a=a.parentNode;else a.classList.remove(b);return!0}return!1};Autodesk.Viewing.UI.Tree.prototype.hasClass=function(a,b){return this.getElementForNode(a).classList.contains(b)};
Autodesk.Viewing.UI.Tree.prototype.clear=function(){for(var a=this.myRootContainer;a.hasChildNodes();)a.removeChild(a.lastChild);this.nodeToElement={}};
Autodesk.Viewing.UI.Tree.prototype.createElement_=function(a,b,c,f){function d(b,d,f){b=g.createHtmlElement_(b,d,f);d=g.createHtmlElement_(b,"header");g.createHtmlElement_(d,"icon").addEventListener("click",function(b){g.myDelegate.onTreeNodeIconClick(g,a,b);b.stopPropagation();b.preventDefault()},!1);g.myDelegate.createTreeNode(a,d,c);return b}if(!a||!this.myDelegate.shouldCreateTreeNode(a))return null;var g=this;if(g.myDelegate.isTreeNodeGroup(a)){b=d(b,"group","expanded");g.nodeToElement[this.myDelegate.getTreeNodeId(a)]=
b;var h=g.myOptions.excludeRoot?1:0;f==h&&(b.style.left="0px");g.myGroupNodes.push(b);for(var h=a.children?a.children.length:0,k=0;k<h;++k)g.createElement_(a.children[k],b,c,f+1)}else b=d(b,"leaf","expanded"),g.nodeToElement[this.myDelegate.getTreeNodeId(a)]=b,h=g.myOptions.excludeRoot?1:0,f==h&&(b.style.marginLeft="0px");isTouchDevice()&&(b.hammer=new Hammer.Manager(b,{recognizers:[[Hammer.Tap,{event:"doubletap",taps:2,interval:400,threshold:6,posThreshold:30}],[Hammer.Tap]],inputClass:Hammer.TouchInput}),
b.hammer.on("doubletap",function(b){g.myDelegate.onTreeNodeDoubleClick(g,a,b);b.srcEvent.stopPropagation();b.preventDefault()}),b.hammer.on("tap",function(b){g.myDelegate.onTreeNodeClick(g,a,b);b.srcEvent.stopPropagation();b.preventDefault()}));b.addEventListener("click",function(b){g.myDelegate.onTreeNodeClick(g,a,b);b.stopPropagation();b.preventDefault()},!1);b.addEventListener("dblclick",function(b){g.myDelegate.onTreeNodeDoubleClick(g,a,b);b.stopPropagation();b.preventDefault()},!1);b.addEventListener("contextmenu",
function(b){g.myDelegate.onTreeNodeRightClick(g,a,b);b.stopPropagation();b.preventDefault()},!1);(f=g.myDelegate.getTreeNodeClass(a))&&b.classList.add(f);return b};Autodesk.Viewing.UI.Tree.prototype.createHtmlElement_=function(a,b,c){b=document.createElement(b);a.appendChild(b);c&&(b.className=c);return b};
Autodesk.Viewing.UI.Tree.prototype.iterate=function(a,b){if(a&&this.myDelegate.shouldCreateTreeNode(a)){var c=this.getElementForNode(a);if(c&&(b(a,c),this.myDelegate.isTreeNodeGroup(a)))for(var c=a.children,f=0;f<c.length;++f)this.iterate(a.children[f],b)}};AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.TreeDelegate=Autodesk.Viewing.UI.TreeDelegate;Autodesk.Viewing.Private.TreeDelegate.prototype=Autodesk.Viewing.UI.TreeDelegate.prototype;Autodesk.Viewing.Private.Tree=Autodesk.Viewing.UI.Tree;
Autodesk.Viewing.Private.Tree.prototype=Autodesk.Viewing.UI.Tree.prototype;"use strict";AutodeskNamespace("Autodesk.Viewing.Private");Autodesk.Viewing.Private.BrowserDelegate=function(){};Autodesk.Viewing.Private.BrowserDelegate.prototype.constructor=Autodesk.Viewing.Private.BrowserDelegate;Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeId=function(a){throw"getId is not implemented.";};Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeLabel=function(a){return a.name};
Autodesk.Viewing.Private.BrowserDelegate.prototype.getNodeClass=function(a){return""};Autodesk.Viewing.Private.BrowserDelegate.prototype.hasThumbnail=function(a){return!1};Autodesk.Viewing.Private.BrowserDelegate.prototype.getThumbnail=function(a){return null};Autodesk.Viewing.Private.BrowserDelegate.prototype.onNodeClick=function(a,b,c){};Autodesk.Viewing.Private.BrowserDelegate.prototype.onNodeHover=function(a,b,c){};Autodesk.Viewing.Private.BrowserDelegate.prototype.selectItem=function(a){};
Autodesk.Viewing.Private.BrowserDelegate.prototype.deselectItem=function(a){};Autodesk.Viewing.Private.BrowserDelegate.prototype.hasContent=function(a){return!1};Autodesk.Viewing.Private.BrowserDelegate.prototype.addContent=function(a,b){};
Autodesk.Viewing.Private.Browser=function(a,b,c){this.myDelegate=a;this.mySelectedIds=[];this.myRootContainerId=c+"-browserview";this.idToElement={};this.myRootContainer=document.createElement("div");this.myRootContainer.id=this.myRootContainerId;this.myRootContainer.classList.add("browserview");document.getElementById(c).appendChild(this.myRootContainer);this.createElements(b,this.myRootContainer)};Autodesk.Viewing.Private.Browser.prototype.constructor=Autodesk.Viewing.Private.Browser;
Autodesk.Viewing.Private.Browser.prototype.show=function(a){a?(this.myRootContainer.classList.remove("browserHidden"),this.myRootContainer.classList.add("browserVisible"),this.myRootContainer.style.display="block"):(this.myRootContainer.classList.remove("browserVisible"),this.myRootContainer.classList.add("browserHidden"),this.myRootContainer.style.display="none")};Autodesk.Viewing.Private.Browser.prototype.getRootContainer=function(){return this.myRootContainer};
Autodesk.Viewing.Private.Browser.prototype.delegate=function(){return this.myDelegate};Autodesk.Viewing.Private.Browser.prototype.addToSelection=function(a){for(var b=0,c=a.length;b<c;++b){var f=a[b],d;d=f;-1==this.mySelectedIds.indexOf(d)?(this.mySelectedIds.push(d),d=!0):d=!1;d&&(d=this.idToElement[f],void 0===d?this.myDelegate.selectItem(f):d.classList.add("selected"))}};
Autodesk.Viewing.Private.Browser.prototype.removeFromSelection=function(a){for(var b=a.length-1;0<=b;--b){var c=a[b],f;f=this.mySelectedIds.indexOf(c);-1!=f?(this.mySelectedIds.splice(f,1),f=!0):f=!1;f&&(f=this.idToElement[c],void 0===f?this.myDelegate.deselectItem(c):f.classList.remove("selected"))}};Autodesk.Viewing.Private.Browser.prototype.setSelection=function(a){this.removeFromSelection(this.mySelectedIds);this.addToSelection(a);return this.mySelectedIds};
Autodesk.Viewing.Private.Browser.prototype.clearSelection=function(){this.removeFromSelection(this.mySelectedIds)};Autodesk.Viewing.Private.Browser.prototype.createElements=function(a,b){if(a)for(var c=0;c<a.length;c++)this.createElement(a[c],b)};
Autodesk.Viewing.Private.Browser.prototype.createElement=function(a,b){var c=this,f=c.myDelegate.getNodeId(a),d=document.createElement("item");b.appendChild(d);this.idToElement[f]=d;d.onmouseover=function(){c.myDelegate.onNodeHover(c,a)};d.onclick=function(b){c.myRootContainer.querySelector(".flipped").removeClass("flipped");c.myDelegate.onNodeClick(c,a,b)};f=document.createElement("div");f.classList.add("card");d.appendChild(f);var g=document.createElement("div");g.classList.add("browserElement");
f.appendChild(g);var h=c.myDelegate.getNodeLabel(a),k=document.createElement("label");k.innerHTML=h;g.appendChild(k);k.onclick=function(b){c.myDelegate.onNodeClick(c,a,b)};if(h=c.myDelegate.getThumbnail(a))k=document.createElement("img"),k.classList.add("thumb"),k.src=h,g.appendChild(k),k.onclick=function(b){c.myDelegate.onNodeClick(c,a,b)};c.myDelegate.hasContent(a)&&c.myDelegate.addContent(a,f);d.classList.add(c.myDelegate.getNodeClass(a))};AutodeskNamespace("Autodesk.Viewing.Private");
(function(){var a=Autodesk.Viewing.Private;a.WEBGL_HELP_LINK=null;a.ErrorInfoData={1:{img:"img-reload","globalized-msg":"Viewer-UnknownFailure","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message> <hint>Try loading the item again. </hint><hint>Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},2:{img:"img-unsupported","globalized-msg":"Viewer-BadData","default-msg":"<title> Sorry </title><message>The item you are trying to view was not processed completely. </message><hint>Try loading the item again.</hint><hint>Please upload the file again to see if that fixes the issue.</hint>"},
3:{img:"img-reload","globalized-msg":"Viewer-NetworkError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},4:{img:"img-unloack","globalized-msg":"Viewer-AccessDenied","default-msg":"<title> No access </title><message>Sorry. You don\u2019t have the required privileges to access this item.</message><hint> Please contact the author</hint>"},
5:{img:"img-item-not-found","globalized-msg":"Viewer-FileNotFound","default-msg":'<title> Sorry </title><message>We can\u2019t display the item you are looking for. It may not have been processed yet. It may have been moved, deleted, or you may be using a corrupt file or unsupported file format.</message><hint> Try loading the item again.</hint><hint> Please upload the file again to see if that fixes the issue.</hint><hint> <a href="http://help.autodesk.com/view/ADSK360/ENU/?guid=GUID-488804D0-B0B0-4413-8741-4F5EE0FACC4A" target="_blank">See a list of supported formats.</a></hint>'},
6:{img:"img-reload","globalized-msg":"Viewer-ServerError","default-msg":"<title> Sorry </title><message>We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},7:{img:"img-reload","globalized-msg":"Viewer-UnhandledResponseCode","default-msg":"<title> Network problem </title><message>Sorry. We seem to have some technical difficulties and couldn't complete your request.</message><hint> Try loading the item again.</hint><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"},
8:{img:"img-unsupported","globalized-msg":"Viewer-WebGlNotSupported","default-msg":'<title> Sorry </title><message>We couldn\u2019t show the item because your browser doesn\u2019t support 3D viewing.</message><hint> Please use Google Chrome, Firefox or another browser that supports WebGL 3D graphics.</hint><hint> <a href="WEBGL_HELP" target="_blank">See a list of browsers supporting WebGL 3D graphics.</a></hint>'},9:{img:"img-item-not-found","globalized-msg":"Viewer-NoViewable","default-msg":"<title> No viewable content </title><message>There\u2019s nothing to display for this item. It may not have been processed or it may not have content we can display.</message><hint> Please contact the author.</hint><hint> Please upload the file again to see if that fixes the issue.</hint>"},
10:{img:"img-unsupported","globalized-msg":"Viewer-WebGlDisabled","default-msg":'<title> Sorry </title><message>We couldn\u2019t show the item because you haven\'t enabled 3D viewing in your browser.</message><hint> Please use Google Chrome, Firefox or enable WebGL 3D graphics in your browser.</hint><hint> <a href="WEBGL_HELP" target="_blank">See a list of browsers supporting WebGL 3D graphics.</a></hint>'},11:{img:"img-unsupported","globalized-msg":"Viewer-RTCError","default-msg":"<title> Sorry </title><message>We couldn\u2019t connect to the Collaboration server.</message><hint> Please verify your Internet connection, and refresh the browser to see if that fixes the problem.</hint>"}};
a.currentError=null;a.currentErrors=null;a.ErrorHandler=function(){};a.ErrorHandler.prototype.constructor=a.ErrorHandler;a.ErrorHandler.getErrorCode=function(a){return 403===a||401===a?Autodesk.Viewing.ErrorCodes.NETWORK_ACCESS_DENIED:404===a?Autodesk.Viewing.ErrorCodes.NETWORK_FILE_NOT_FOUND:500<=a?Autodesk.Viewing.ErrorCodes.NETWORK_SERVER_ERROR:Autodesk.Viewing.ErrorCodes.NETWORK_UNHANDLED_RESPONSE_CODE};a.ErrorHandler.reportError=function(b,c,f,d){a.ErrorHandler.currentError=null;a.ErrorHandler.currentErrors=
null;if(c){a.logger&&a.logger.log({category:"error",code:c,message:f},!0);a.ErrorHandler.currentError=[b,c,f,d];var g=a.ErrorInfoData[c];if(g){var h={defaultValue:""};h.defaultValue=g["default-msg"];var k=g.img;f=this.parseErrorString(g["globalized-msg"],h);if(c===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_DISABLED||c===Autodesk.Viewing.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED)for(c=a.WEBGL_HELP_LINK||a.getResourceUrl("webGLHelp.html"),d=0;d<f.hints.length;d++)-1!==f.hints[d].indexOf('href="WEBGL_HELP"')&&
(f.hints[d]=f.hints[d].replace('href="WEBGL_HELP"','href="'+c+'"'))}else k="img-unsupported",h={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"},this.parseArguments(f,h),f=this.parseErrorString(c,h),f.header||(f.header="warning"===d?Autodesk.Viewing.i18n.translate("header-warning"):"");a.AlertBox.displayError(b,f.msg,f.header,k,f.hints)}};a.ErrorHandler.reportErrors=function(b,c){a.ErrorHandler.currentError=null;a.ErrorHandler.currentErrors=null;if(c){a.ErrorHandler.currentErrors=
[b,c];for(var f={defaultValue:"",interpolationPrefix:"{",interpolationSuffix:"}"},d=[],g=0;g<c.length;g++)if(c[g].code){this.parseArguments(c[g].message,f);var h=this.parseErrorString(c[g].code,f);h.header||(h.header="warning"===c[0].type?Autodesk.Viewing.i18n.translate("header-warning",{defaultValue:"Warning"}):"");d.push(h);a.logger&&a.logger.log({category:"error",code:c[g].code,message:c[g].message},!0)}d.length&&a.AlertBox.displayErrors(b,"img-unsupported",d)}};a.ErrorHandler.parseArguments=function(a,
c){if(a)if("string"===typeof a)c.defaultValue=a;else{c.defaultValue=a[0];for(var f=1;f<a.length;f++)c[(f-1).toString()]=a[f]}};a.ErrorHandler.parseErrorString=function(a,c){var f={msg:null,msgList:null,header:null,hints:null};if(!a)return f;var d=Autodesk.Viewing.i18n.translate(a,c);if(!d)return f;-1!=d.indexOf("<title>")&&(d=d.split("<title>")[1].split("</title>"),f.header=d[0],d=d[1]);d&&-1!=d.indexOf("<message>")?(d=d.split("<message>")[1].split("</message>"),f.msg=d[0],d=d[1]):f.msg=d;if(d&&-1!=
d.indexOf("<hint>")){f.hints=[];for(var d=d.split("<hint>"),g=0;g<d.length;g++){var h=d[g].split("</hint")[0];f.hints.push(h)}}return f};a.ErrorHandler.localize=function(){if(0<a.AlertBox.instances.length)if(a.AlertBox.dismiss(),a.ErrorHandler.currentError){var b=a.ErrorHandler.currentError.shift(),c=a.ErrorHandler.currentError;a.ErrorHandler.reportError(b,c[0],c[1],c[2])}else b=a.ErrorHandler.currentErrors.shift(),a.ErrorHandler.reportErrors(b,a.ErrorHandler.currentErrors[0])}})();"use strict";
Autodesk.Viewing.Extension=function(a,b){this.viewer=a;this.options=b};Autodesk.Viewing.Extension.prototype.load=function(){return!0};Autodesk.Viewing.Extension.prototype.unload=function(){return!0};Autodesk.Viewing.Extension.prototype.getState=function(a){};Autodesk.Viewing.Extension.prototype.restoreState=function(a,b){return!0};"use strict";AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.ExtensionManager=function(){var a={};return{registerExtension:function(b,c){return a.hasOwnProperty(b)?!1:(a[b]=c,!0)},getExtension:function(b){return a.hasOwnProperty(b)?a[b]:null},unregisterExtension:function(b){return a.hasOwnProperty(b)?(delete a[b],!0):!1}}};Autodesk.Viewing.theExtensionManager=new Autodesk.Viewing.ExtensionManager;Autodesk.Viewing.ExtensionMixin=function(){};
Autodesk.Viewing.ExtensionMixin.prototype={loadExtension:function(a,b){this.loadedExtensions||(this.loadedExtensions={});var c=!1;if(this.getExtension(a))stderr("Extension already loaded: "+a);else{var f=Autodesk.Viewing.theExtensionManager.getExtension(a);if(f){if(f=new f(this,b),c=f.load())this.loadedExtensions[a]=f,stderr("Extension loaded: "+a)}else stderr("Extension not found: "+a)}return c},getExtension:function(a){return this.loadedExtensions&&a in this.loadedExtensions?this.loadedExtensions[a]:
null},unloadExtension:function(a){var b=!1,c=this.getExtension(a);c?(b=c.unload(),stderr("Extension unloaded: "+a),delete this.loadedExtensions[a]):stderr("Extension not found: "+a);return b},apply:function(a){var b=Autodesk.Viewing.ExtensionMixin.prototype;a.loadExtension=b.loadExtension;a.getExtension=b.getExtension;a.unloadExtension=b.unloadExtension}};AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.FileLoader=function(a){this.viewer=a};
Autodesk.Viewing.FileLoader.prototype.constructor=Autodesk.Viewing.FileLoader;Autodesk.Viewing.FileLoader.prototype.loadFile=function(a,b,c,f,d){return!1};Autodesk.Viewing.FileLoader.prototype.getObjectTree=function(a,b){};Autodesk.Viewing.FileLoader.prototype.getProperties=function(a,b,c){};"use strict";AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.FileLoaderManager=function(){var a={};return{registerFileLoader:function(b,c,f){return!a.hasOwnProperty(b)&&f instanceof Autodesk.Viewing.FileLoader?(a[b]={loader:f,extensions:c},!0):!1},getFileLoader:function(b){return a.hasOwnProperty(b)?a[b].loader:null},getFileLoaderForExtension:function(b){for(var c in a)if(a.hasOwnProperty(c))for(var f=a[c],d=0;d<f.extensions.length;d++)if(f.extensions[d]===b)return f.loader;return null},unregisterFileLoader:function(b){return a.hasOwnProperty(b)?
(delete a[b],!0):!1}}};Autodesk.Viewing.theFileLoaderManager=new Autodesk.Viewing.FileLoaderManager;
function init_UnifiedCamera(){"undefined"===typeof Autodesk.Viewing.UnifiedCamera&&(AutodeskNamespace("Autodesk.Viewing"),Autodesk.Viewing.UnifiedCamera=function(a,b){THREE.Camera.call(this);this.fov=45;this.near=.1;this.far=1E5;this.aspect=a/b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2;this.target=new THREE.Vector3(0,0,-1);this.worldup=new THREE.Vector3(0,1,0);this.orthographicCamera=new THREE.OrthographicCamera(this.left,this.right,this.top,this.bottom,this.near,this.far);this.perspectiveCamera=
new THREE.PerspectiveCamera(this.fov,this.aspect,this.near,this.far);this.zoom=1;this.toPerspective()},Autodesk.Viewing.UnifiedCamera.ORTHO_FOV=360*Math.atan(.5)/Math.PI,Autodesk.Viewing.UnifiedCamera.prototype=Object.create(THREE.Camera.prototype),Autodesk.Viewing.UnifiedCamera.prototype.clone=function(){var a=new Autodesk.Viewing.UnifiedCamera(2*this.right,2*this.top);THREE.Camera.prototype.clone.call(this,a);a.position.copy(this.position);a.up.copy(this.up);this.target&&(a.target=this.target.clone());
this.worldup&&(a.worldup=this.worldup.clone());a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.near=this.near;a.far=this.far;a.fov=this.fov;a.aspect=this.aspect;a.zoom=this.zoom;a.isPerspective=this.isPerspective;this.updateProjectionMatrix();return a},Autodesk.Viewing.UnifiedCamera.prototype.__computeFovPosition=function(a){if(1E-4>=Math.abs(this.fov-a))return this.position.clone();var b=this.target.clone().sub(this.position),c=THREE.Math.degToRad(this.fov);a=THREE.Math.degToRad(a);
c=b.length()*Math.tan(.5*c)/Math.tan(.5*a);b=b.normalize().multiplyScalar(-c);return this.target.clone().add(b)},Autodesk.Viewing.UnifiedCamera.prototype.toPerspective=function(){!this.isPerspective&&this.saveFov&&(this.position.copy(this.__computeFovPosition(this.saveFov)),this.fov=this.saveFov);this.perspectiveCamera.aspect=this.aspect;this.perspectiveCamera.near=this.near;this.perspectiveCamera.far=this.far;this.perspectiveCamera.fov=this.fov/this.zoom;this.perspectiveCamera.updateProjectionMatrix();
this.projectionMatrix=this.perspectiveCamera.projectionMatrix;this.isPerspective=!0},Autodesk.Viewing.UnifiedCamera.prototype.toOrthographic=function(){if(this.isPerspective){this.saveFov=this.fov;var a=Autodesk.Viewing.UnifiedCamera.ORTHO_FOV;this.position.copy(this.__computeFovPosition(a));this.fov=a}this.orthoScale=this.target.clone().sub(this.position).length();var a=.5*this.orthoScale,b=a*this.aspect;this.left=this.orthographicCamera.left=-b;this.right=this.orthographicCamera.right=b;this.top=
this.orthographicCamera.top=a;this.bottom=this.orthographicCamera.bottom=-a;this.orthographicCamera.near=this.near;this.orthographicCamera.far=this.far;this.orthographicCamera.updateProjectionMatrix();this.projectionMatrix=this.orthographicCamera.projectionMatrix;this.isPerspective=!1},Autodesk.Viewing.UnifiedCamera.prototype.updateProjectionMatrix=function(){this.isPerspective?this.toPerspective():this.toOrthographic()},Autodesk.Viewing.UnifiedCamera.prototype.setSize=function(a,b){this.aspect=a/
b;this.left=-a/2;this.right=a/2;this.top=b/2;this.bottom=-b/2},Autodesk.Viewing.UnifiedCamera.prototype.setFov=function(a){this.fov=a;this.updateProjectionMatrix()},Autodesk.Viewing.UnifiedCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);var c=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.setFov(c);return c},Autodesk.Viewing.UnifiedCamera.prototype.getCameraChangedEvent=function(){return{type:Autodesk.Viewing.CAMERA_CHANGE_EVENT,camera:this}})}AutodeskNamespace("Autodesk.Viewing");
(function(){var a=Autodesk.Viewing,b=Autodesk.Viewing.Private;a.ESCAPE_EVENT="escape";a.PROGRESS_UPDATE_EVENT="progress";a.FULLSCREEN_MODE_EVENT="fullScreenMode";a.NAVIGATION_MODE_CHANGED_EVENT="navmode";a.VIEWER_STATE_RESTORED_EVENT="viewerStateRestored";a.VIEWER_RESIZE_EVENT="viewerResize";a.VIEWER_UNINITIALIZED="viewerUninitialized";a.MODEL_ROOT_LOADED_EVENT="svfLoaded";a.GEOMETRY_LOADED_EVENT="geometryLoaded";a.OBJECT_TREE_CREATED_EVENT="propertyDbLoaded";a.OBJECT_TREE_UNAVAILABLE_EVENT="propertyDbUnavailable";
a.SELECTION_CHANGED_EVENT="selection";a.ISOLATE_EVENT="isolate";a.HIDE_EVENT="hide";a.SHOW_EVENT="show";a.HIGHLIGHT_EVENT="highlight";a.CAMERA_CHANGE_EVENT="cameraChanged";a.EXPLODE_CHANGE_EVENT="explodeChanged";a.CUTPLANES_CHANGE_EVENT="cutplanesChanged";a.TOOL_CHANGE_EVENT="toolChanged";a.RENDER_OPTION_CHANGED_EVENT="renderOptionChanged";a.LAYER_VISIBILITY_CHANGED_EVENT="layerVisibility";a.RESET_EVENT="reset";a.NAVIGATION_MODE={ORBIT:0,PAN:1,DOLLY:2,ROLL:3,FOV:4,TOUCH_PAN_DOLLY:5,TOUCH_ROLL:6,OTHER:7};
a.Viewer3D=function(a,f){this.clientContainer=a;this.container=document.createElement("div");this.container.className="adsk-viewing-viewer";this.container.style.height="100%";this.container.style.width="100%";this.container.style.overflow="hidden";this.container.classList.add(isTouchDevice()?"touch":"notouch");this.clientContainer.appendChild(this.container);this.config=f;this.contextMenu=null;this.contextMenuCallbacks={};this.started=this.__firefoxLMBfix=!1;if("CANVAS"===this.container.nodeName)throw"Viewer must be initialized on a div [temporary]";
this.canvasWrap=document.createElement("div");this.canvasWrap.classList.add("canvas-wrap");this.canvas=document.createElement("canvas");this.canvas.tabIndex=0;this.canvasWrap.appendChild(this.canvas);this.container.appendChild(this.canvasWrap);this.canvas.viewer=this;this.running=!1;this._defaultNavigationTool=this._pushedTool="";this.stats={category:"misc_stats",explode_count:0,get_props_count:0,isolate_count:0};var d=this;window.addEventListener("beforeunload",function(){d.__logStats(!0)});this.prefs=
new b.Preferences(this,"Autodesk.Viewing.Private.GuiViewer3D.SavedSettings.")};a.Viewer3D.prototype.constructor=a.Viewer3D;a.EventDispatcher.prototype.apply(a.Viewer3D.prototype);a.ScreenModeMixin.prototype.apply(a.Viewer3D.prototype);a.ExtensionMixin.prototype.apply(a.Viewer3D.prototype);a.Viewer3D.ScreenMode=a.ScreenMode;a.Viewer3D.kDefaultCanvasConfig={click:{onObject:["selectOnly"],offObject:["deselectAll"]},clickAlt:{onObject:["setCOI"],offObject:["setCOI"]},clickCtrl:{onObject:["selectToggle"],
offObject:["deselectAll"]},clickShift:{onObject:["selectToggle"],offObject:["deselectAll"]}};a.Viewer3D.prototype.start=function(){if(this.started)return 0;var a=this.initialize();if(0===a&&(this.started=!0,this.config&&this.config.hasOwnProperty("extensions")))for(var b=this.config.extensions,d=0;d<b.length;++d)this.loadExtension(b[d],this.config);return a};a.Viewer3D.prototype.registerUniversalHotkeys=function(){var b=this,f,d,g,h=a.theHotkeyManager.KEYCODES;a.theHotkeyManager.pushHotkeys("Autodesk.FitToView",
[{keycodes:[h.f],onPress:function(){b.navigation.setRequestFitToView(!0);return!0}}]);f=function(){b.navigation.setRequestHomeView(!0);return!0};a.theHotkeyManager.pushHotkeys("Autodesk.Home",[{keycodes:[h.h],onPress:f},{keycodes:[h.HOME],onPress:f}]);a.theHotkeyManager.pushHotkeys("Autodesk.Escape",[{keycodes:[h.ESCAPE],onRelease:function(){if(b.objectContextMenu&&b.objectContextMenu.hide())return!0;b.fireEvent({type:a.ESCAPE_EVENT});return!0}}]);f=function(){g=b.getActiveNavigationTool();return b.setActiveNavigationTool("pan")};
d=function(){return b.setActiveNavigationTool(g)};a.theHotkeyManager.pushHotkeys("Autodesk.Pan",[{keycodes:[h.SHIFT],onPress:f,onRelease:d},{keycodes:[h.SPACE],onPress:f,onRelease:d}],{tryUntilSuccess:!0})};a.Viewer3D.prototype.createControls=function(){var b=this.impl;this.navigation=new a.Navigation(b.camera);this.__initAutoCam(b);this.utilities=new a.ViewingUtilities(b,this.autocam,this.navigation);this.clickHandler=new a.DefaultHandler(b,this.navigation,this.utilities);this.toolController=new a.ToolController(b,
this,this.autocam,this.utilities,this.clickHandler);this.toolController.registerTool(new a.GestureHandler(this));this.toolController.registerTool(a.theHotkeyManager);this.toolController.activateTool(a.theHotkeyManager.getName());this.registerUniversalHotkeys();this.toolController.registerTool(new a.OrbitDollyPanTool(b,this));this.toolController.activateTool("gestures");return this.toolController};a.Viewer3D.prototype.initialize=function(){var c=detectWebGL();if(0>=c)return-1===c?a.ErrorCodes.BROWSER_WEBGL_NOT_SUPPORTED:
a.ErrorCodes.BROWSER_WEBGL_DISABLED;var f=this;this.onResizeCallback=function(a){f.resize()};window.addEventListener("resize",this.onResizeCallback,!1);this.setScreenModeDelegate(this.config?this.config.screenModeDelegate:void 0);this.initContextMenu();this.localize();c=this.getDimensions();this.canvas.width=c.width;this.canvas.height=c.height;isIOSDevice()&&window.devicePixelRatio&&(this.canvas.width/=window.devicePixelRatio,this.canvas.height/=window.devicePixelRatio);this.impl=new b.Viewer3DImpl(this.canvas,
this);this.impl.controls=this.createControls();this.setDefaultNavigationTool("orbit");this.defaultLoader=this.impl.loader;this.model=null;this.impl.controls&&this.impl.controls.setAutocam(this.autocam);c=this.config&&this.config.canvasConfig?this.config.canvasConfig:a.Viewer3D.kDefaultCanvasConfig;this.setCanvasClickBehavior(c);this.loader=document.createElement("div");this.loader.id="loader";this.loader.className="spinner";this.container.appendChild(this.loader);if(!c.disableSpinner)for(c=1;3>=c;c++){var d=
document.createElement("div");d.className="bounce"+c;this.loader.appendChild(d)}this.initSettings();this.viewerState=new b.ViewerState(this);this.config&&this.config.hasOwnProperty("startOnInitialize")&&!this.config.startOnInitialize||this.run();window.NOP_VIEWER=this;return 0};a.Viewer3D.prototype.setUp=function(b){if((this.config=b)&&this.config.hasOwnProperty("extensions")){b=this.config.extensions;for(var f=0;f<b.length;++f)this.loadExtension(b[f],this.config)}this.setCanvasClickBehavior(this.config&&
this.config.canvasConfig?this.config.canvasConfig:a.Viewer3D.kDefaultCanvasConfig)};a.Viewer3D.prototype.tearDown=function(){this.clearSelection();if(this.loadedExtensions)for(var a in this.loadedExtensions)try{this.unloadExtension(a)}catch(f){stderr("Failed to unload extension: "+a);console.log("  error: "+f.message);console.error("  stack:\n"+f.stack);var d=b.logger;d&&d.log({category:"error_unload_extension",extensionId:a})}this.__logStats();this.loader.style.display="block";this.model=null};a.Viewer3D.prototype.run=
function(){this.running||(this.resize(),this.running=!0,this.impl.run())};a.Viewer3D.prototype.localize=function(){a.i18n.localize()};a.Viewer3D.prototype.__logStats=function(a){var f=b.logger;f&&(this.stats.explode_count||this.stats.get_props_count||this.stats.isolate_count)&&(f.log(this.stats,a),this.stats.explode_count=0,this.stats.get_props_count=0,this.stats.isolate_count=0)};a.Viewer3D.prototype.__initAutoCam=function(a){var b=this,d=a.camera;d.pivot||(d.pivot=new THREE.Vector3(0,0,0));d.target||
(d.target=new THREE.Vector3(0,0,0));d.worldup||(d.worldup=d.up.clone());b.autocamCamera=d.clone();b.autocamCamera.target=d.target.clone();b.autocamCamera.pivot=d.pivot.clone();b.autocamCamera.worldup=d.worldup.clone();b.autocam=new Autocam(b.autocamCamera,b.navigation,b.canvas,function(a){b.autocamCamera.isPerspective!==d.isPerspective&&(b.autocamCamera.isPerspective?b.navigation.toPerspective():b.navigation.toOrthographic());b.navigation.setVerticalFov(b.autocamCamera.fov,!1);b.navigation.setView(b.autocamCamera.position,
b.autocamCamera.target);b.navigation.setPivotPoint(b.autocamCamera.pivot);b.navigation.setCameraUpVector(b.autocamCamera.up);a&&b.navigation.setWorldUpVector(b.autocamCamera.worldup);b.impl.syncCamera(a)},function(a){b.utilities?b.utilities.pivotActive(a,!1):b.impl.controls.pivotActive(a,!1)});b.addEventListener("cameraChanged",function(a){b.autocam.sync(a.camera)});b.autocam.sync(d)};a.Viewer3D.prototype.load=function(a,f,d,g){var h=this;return this.loadModel(a,null,f,function(){b.memoryOptimizedLoading||
h.modelstructure&&h.model.getObjectTree(function(a){h.modelstructure.setModel(a,h.config.defaultModelStructureTitle?h.config.defaultModelStructureTitle:"")},function(a){});d&&d()},g)};a.Viewer3D.prototype.uninitialize=function(c){window.removeEventListener("resize",this.onResizeCallback,!1);this.canvas.parentNode.removeChild(this.canvas);this.viewerState=this.canvas=this.canvas.viewer=null;this.__logStats();(c=b.logger)&&c.log({category:"viewer_destroy"},!0);this.toolController&&(this.toolController.uninitialize(),
this.utilities=this.clickHandler=this.toolController=null);this.navigation&&(this.navigation.uninitialize(),this.navigation=null);this.impl&&(this.impl.uninitialize(),this.impl=null);this.prefs=this.model=this.loader=null;a.theHotkeyManager.popHotkeys("Autodesk.FitToView");a.theHotkeyManager.popHotkeys("Autodesk.Home");a.theHotkeyManager.popHotkeys("Autodesk.Escape");a.theHotkeyManager.popHotkeys("Autodesk.Pan");a.theHotkeyManager.popHotkeys("Autodesk.Orbit");this.onDefaultContextMenu&&this.container.removeEventListener("contextmenu",
this.onDefaultContextMenu,!1);this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container);this.container=null;this.screenModeDelegate&&(this.screenModeDelegate.uninitialize(),this.screenModeDelegate=null);this.config=this.clientContainer=null;this.listeners={};this.contextMenuCallbacks=this.contextMenu=null;this.fireEvent(a.VIEWER_UNINITIALIZED)};a.Viewer3D.prototype.finish=function(){this.tearDown();this.uninitialize()};a.Viewer3D.prototype.loadModel=function(b,
f,d,g,h,k){function l(){if(n.model.is2d())a.theHotkeyManager.popHotkeys("Autodesk.Orbit");else{var b;a.theHotkeyManager.pushHotkeys("Autodesk.Orbit",[{keycodes:[a.theHotkeyManager.KEYCODES.ALT],onPress:function(){b=n.getActiveNavigationTool();return n.setActiveNavigationTool("orbit")},onRelease:function(){return n.setActiveNavigationTool(b)}}],{tryUntilSuccess:!0})}}var n=this;this.addEventListener(a.GEOMETRY_LOADED_EVENT,function(b){this.impl.needsRender=!0;n.removeEventListener(a.GEOMETRY_LOADED_EVENT)});
var q=b.toLowerCase().match(/\.([a-z0-9]+$)/),q=q?q[1]:null;this.impl.loader=k&&k.fileLoader?k.fileLoader:a.theFileLoaderManager.getFileLoaderForExtension(q)||this.defaultLoader;this.impl.unloadCurrentModel();return this.impl.loader.loadFile(b,f,d,function(b){n.model=new a.Model(b);n.impl.setModel(n.model);n.loader.style.display="None";n.model.is2d()&&n.activateLayerState("Initial");l();g&&g()},function(a,b){n.loader.style.display="None";h&&h(a,b)})};a.Viewer3D.prototype.getDimensions=function(){if(this.container){var b=
{};this.getScreenMode()===a.ScreenMode.kFullScreen?(b.width=screen.width,b.height=screen.height):b=this.container.getBoundingClientRect();return{width:b.width,height:b.height}}return null};a.Viewer3D.prototype.resize=function(){return this.impl.resize(this.container.clientWidth,this.container.clientHeight)};a.Viewer3D.prototype.getCamera=function(){return this.impl.camera};a.Viewer3D.prototype.getState=function(a){return this.viewerState.getState(a)};a.Viewer3D.prototype.restoreState=function(b,f,
d){(b=this.viewerState.restoreState(b,f,d))&&this.fireEvent({type:a.VIEWER_STATE_RESTORED_EVENT,value:b});return b};a.Viewer3D.prototype.setViewFromArray=function(a,b){this.setActiveNavigationTool("orbit");var d=this.model?this.model.getData().globalOffset:{x:0,y:0,z:0},d={position:new THREE.Vector3(a[0]-d.x,a[1]-d.y,a[2]-d.z),target:new THREE.Vector3(a[3]-d.x,a[4]-d.y,a[5]-d.z),up:new THREE.Vector3(a[6],a[7],a[8]),aspect:a[9],fov:THREE.Math.radToDeg(a[10]),orthoScale:a[11],isPerspective:!a[12]};
this.impl.setViewFromCamera(d)};a.Viewer3D.prototype.setViewFromViewBox=function(a,b){var d=this.model;if(d&&!d.is2d())console.warn("av.Viewer3D.setViewFromViewBox is not applicable to 3D");else{if(b&&b.length){var d=d.getData().metadata.views,g;for(g=0;g<d.length&&d[g].name!=b;g++);g<d.length&&(d=d[g].layer_state)&&this.activateLayerState(d)}this.impl.setViewFromViewBox(this.model,a,b,!1)}};a.Viewer3D.prototype.activateLayerState=function(b){if(b&&b.length){var f=this.model.getData().metadata,d=
f.layer_states;if(d){var g;for(g=0;g<d.length&&d[g].name!=b;g++);if(g<d.length){d=d[g].visible_layers;b={};if(d&&0<d.length)for(g=0;g<d.length;g++)b[d[g]]=1;d=[];g=[];for(var h in f.layers)1===b[f.layers[h].name]?d.push(h):g.push(h);this.impl.setLayerVisible(d,!0);this.impl.setLayerVisible(g,!1);this.fireEvent({type:a.LAYER_VISIBILITY_CHANGED_EVENT})}}}};a.Viewer3D.prototype.getLayerStates=function(){function a(b,c){var d=Object.getOwnPropertyNames(b),f=Object.getOwnPropertyNames(c);if(d.length!==
f.length)return!1;for(f=0;f<d.length;++f){var g=d[f];if(b[g]!==c[g])return!1}return!0}var b=this.model,d=(b=b?b.getData().metadata:null)?b.layers:null,b=b?b.layer_states:null;if(!d||!b)return null;var g,h={},k={},l;for(l in d)if(d.hasOwnProperty(l)){var n=parseInt(l);g=d[l];g="string"===typeof g?g:g.name;h[g]=!0;this.impl.isLayerVisible(n)&&(k[g]=!0)}l=[];for(d=0;d<b.length;++d){var q=b[d],m=q.visible_layers,p={};if(!q.hidden){if(m&&0<m.length)for(n=0;n<m.length;++n)g=m[n],h.hasOwnProperty(g)&&(p[g]=
!0);l.push({name:q.name,description:q.description,active:a(k,p)})}}return 0<l.length?l:null};a.Viewer3D.prototype.setViewFromFile=function(){this.setActiveNavigationTool();this.impl.setViewFromFile(this.model)};a.Viewer3D.prototype.getProperties=function(b,f,d){this.stats.get_props_count++;this.model?this.model.getProperties(b,f,d):d&&d(a.ErrorCodes.BAD_DATA,"Properties failed to load since model does not exist.")};a.Viewer3D.prototype.getObjectTree=function(b,f){this.model?this.model.getObjectTree(b,
f):f&&f(a.ErrorCodes.BAD_DATA,"ObjectTree failed to load since model does not exist.")};a.Viewer3D.prototype.setCanvasClickBehavior=function(a){this.impl.controls.hasOwnProperty("setClickBehavior")&&this.impl.controls.setClickBehavior(a);this.clickHandler&&this.clickHandler.setClickBehavior(a)};a.Viewer3D.prototype.search=function(b,f,d,g){this.searchText=b;this.model?this.model.search(b,f,d,g):d&&d(a.ErrorCodes.BAD_DATA,"Search failed since model does not exist.")};a.Viewer3D.prototype.getHiddenNodes=
function(){return this.impl.visibilityManager.getHiddenNodes()};a.Viewer3D.prototype.getIsolatedNodes=function(){return this.model&&this.model.is2d()?(console.warn("av.Viewer3D.getIsolatedNodes is not yet implemented for 2D"),[]):this.impl.visibilityManager.getIsolatedNodes()};a.Viewer3D.prototype.isolate=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.isolate is not yet implemented for 2D"):(this.stats.isolate_count++,Array.isArray(a)?this.impl.visibilityManager.isolateMultiple(a):
(a==this.model.getRoot()&&(a=null),this.impl.visibilityManager.isolate(a)))};a.Viewer3D.prototype.isolateById=function(b){function f(){(g=h.model.getNodesByIds(Array.isArray(b)?b:[b]))&&h.isolate(g)}function d(b){h.getObjectTree(f);h.removeEventListener(a.GEOMETRY_LOADED_EVENT,d)}if(this.model&&this.model.is2d())console.warn("av.Viewer3D.isolateById is not yet implemented for 2D");else{var g=[],h=this;this.model&&this.model.isLoadDone()?this.getObjectTree(f):this.addEventListener(a.GEOMETRY_LOADED_EVENT,
d)}};a.Viewer3D.prototype.setBackgroundColor=function(a,b,d,g,h,k){this.impl.setClearColors(a,b,d,g,h,k)};a.Viewer3D.prototype.toggleSelect=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.toggleSelect is not yet implemented for 2D"):this.impl.selector.toggleSelectionId(a)};a.Viewer3D.prototype.select=function(a){"number"===typeof a&&(a=[a]);this.impl.selector.setSelectionIds(a)};a.Viewer3D.prototype.clearSelection=function(){this.impl.selector.clearSelection()};a.Viewer3D.prototype.getSelectionVisibility=
function(){return this.impl.selector.getSelectionVisibility()};a.Viewer3D.prototype.getSelectionCount=function(){return this.impl.selector.getSelectionLength()};a.Viewer3D.prototype.getSelection=function(){return this.impl.selector.getSelection()};a.Viewer3D.prototype.hide=function(a){if(this.model&&this.model.is2d())console.warn("av.Viewer3D.hide is not yet implemented for 2D");else{var f=b.logger;f&&f.log({category:"hide"});Array.isArray(a)?this.impl.visibilityManager.hideMultiple(a):this.impl.visibilityManager.hide(a)}};
a.Viewer3D.prototype.hideById=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.hideById is not yet implemented for 2D"):(a=this.model?this.model.getNodesByIds(Array.isArray(a)?a:[a]):null)&&0<a.length&&this.hide(a)};a.Viewer3D.prototype.show=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.show is not yet implemented for 2D"):Array.isArray(a)?this.impl.visibilityManager.showMultiple(a):this.impl.visibilityManager.show(a)};a.Viewer3D.prototype.showAll=function(){this.impl.visibilityManager.isolateNone();
this.model.is2d()&&this.setLayerVisible(null,!0)};a.Viewer3D.prototype.toggleVisibility=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.toggleVisibility is not yet implemented for 2D"):this.impl.visibilityManager.toggleVisibility(a)};a.Viewer3D.prototype.areAllVisible=function(){return this.impl.visibilityManager.areAllVisible()};a.Viewer3D.prototype.explode=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.explode is not applicable to 2D"):(this.stats.explode_count++,
this.impl.explode(a))};a.Viewer3D.prototype.getExplodeScale=function(){return this.model&&this.model.is2d()?(console.warn("av.Viewer3D.getExplodeScale is not applicable to 2D"),0):this.impl.getExplodeScale()};a.Viewer3D.prototype.setQualityLevel=function(a,b){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setQualityLevel is not applicable to 2D"):(this.prefs.set("ambientShadows",a),this.prefs.set("antialiasing",b),this.impl.togglePostProcess(a,b))};a.Viewer3D.prototype.setGhosting=function(a){this.model&&
this.model.is2d()?console.warn("av.Viewer3D.setGhosting is not applicable to 2D"):(this.prefs.set("ghosting",a),this.impl.toggleGhosting(a))};a.Viewer3D.prototype.setGroundShadow=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setGroundShadow is not applicable to 2D"):(this.prefs.set("groundShadow",a),this.impl.toggleGroundShadow(a))};a.Viewer3D.prototype.setGroundReflection=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setGroundReflection is not applicable to 2D"):
(this.prefs.set("groundReflection",a),this.impl.toggleGroundReflection(a))};a.Viewer3D.prototype.setProgressiveRendering=function(a){this.prefs.set("progressiveRendering",a);this.impl.toggleProgressive(a)};a.Viewer3D.prototype.setOptimizeNavigation=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setOptimizeNaviation is not applicable to 2D"):(this.prefs.set("optimizeNavigation",a),this.impl.setOptimizeNavigation(a))};a.Viewer3D.prototype.setActiveNavigationTool=function(c){if(c===
this._pushedTool||!c&&!this._pushedTool)return!0;if(this._pushedTool){if(!this.impl.controls.deactivateTool(this._pushedTool))return!1;this._pushedTool=null;var f=b.logger;f&&f.log({category:"tool_changed",name:c})}return c&&c!==this.getDefaultNavigationToolName()||null!==this._pushedTool?this.impl.controls.activateTool(c)?(this._pushedTool=c,this.fireEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this._pushedTool}),!0):!1:(this.fireEvent({type:a.NAVIGATION_MODE_CHANGED_EVENT,id:this.getDefaultNavigationToolName()}),
!0)};a.Viewer3D.prototype.getActiveNavigationTool=function(){return this._pushedTool?this._pushedTool:this._defaultNavigationTool};a.Viewer3D.prototype.setDefaultNavigationTool=function(a){this._defaultNavigationTool&&this.impl.controls.deactivateTool(this._defaultNavigationTool);this._pushedTool&&this.impl.controls.deactivateTool(this._pushedTool);this.impl.controls.activateTool(a);this._defaultNavigationTool=a;this._pushedTool&&this.impl.controls.activateTool(this._pushedTool)};a.Viewer3D.prototype.getDefaultNavigationToolName=
function(){return this._defaultNavigationTool};a.Viewer3D.prototype.getFOV=function(){return this.navigation.getVerticalFov()};a.Viewer3D.prototype.setFOV=function(a){this.navigation.setVerticalFov(a,!0)};a.Viewer3D.prototype.getFocalLength=function(){return this.navigation.getFocalLength()};a.Viewer3D.prototype.setFocalLength=function(a){this.navigation.setFocalLength(a,!0)};a.Viewer3D.prototype.hideLines=function(b){this.prefs.set("lineRendering",!b);if(!this.impl.hideLines(b)){var f=function(){d.impl.hideLines(b);
d.removeEventListener(a.GEOMETRY_LOADED_EVENT,f)},d=this;this.addEventListener(a.GEOMETRY_LOADED_EVENT,f)}};a.Viewer3D.prototype.applyCamera=function(a,b){this.impl.applyCamera(a,b)};a.Viewer3D.prototype.fitToView=function(b){var f=this,d=!0,g=function(){var k=null;if(Array.isArray(b)&&0<b.length){for(var n=new THREE.Box3,q=new THREE.Box3,m=f.model.getData().instanceTree,p=f.impl.modelQueue().getFragmentList(),t=0;t<b.length;t++)m.enumNodeFragments(b[t],function(a){p.getWorldBounds(a,q);n.union(q)},
!0);n.empty()||(k=n)}if(!k||k.empty())k=f.impl.getFitBounds();f.navigation.fitBounds(!1,k);f.removeEventListener(a.OBJECT_TREE_CREATED_EVENT,h);f.removeEventListener(a.GEOMETRY_LOADED_EVENT,g);return d},h=function(){f.model&&f.model.isLoadDone()?g():(d=!1,f.addEventListener(a.GEOMETRY_LOADED_EVENT,g))},k=this.model.getData().propertydb,k=k&&0<k.attrs.length;!this.model.is2d()&&k&&null!==b&&void 0!==b?this.model&&this.model.isObjectTreeCreated()?h():(d=!1,this.addEventListener(a.OBJECT_TREE_CREATED_EVENT,
h)):this.navigation.fitBounds(!1,this.impl.getFitBounds(!0))};a.Viewer3D.prototype.setClickConfig=function(a,b,d){var g=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();return a in g&&(a=g[a],b in a)?(a[b]=d,!0):!1};a.Viewer3D.prototype.getClickConfig=function(a,b){var d=this.clickHandler?this.clickHandler.getClickBehavior():this.impl.controls.getClickBehavior();return a in d&&(d=d[a],b in d)?d[b]:null};a.Viewer3D.prototype.setClickToSetCOI=function(a,b){!1!==
b&&this.prefs.set("clickToSetCOI",a);var d=this.getClickConfig("click","onObject");a?-1===d.indexOf("setCOI")&&this.setClickConfig("click","onObject",["setCOI"]):0<=d.indexOf("setCOI")&&this.setClickConfig("click","onObject",["selectOnly"])};a.Viewer3D.prototype.initSettings=function(){var a=isIOSDevice()||isAndroidDevice();this.prefs.load({ambientShadows:!0,antialiasing:!a,groundShadow:!0,groundReflection:!1,progressiveRendering:!0,environmentMap:!1,openPropertiesOnSelect:!1,ghosting:!0,viewCube:!a,
lineRendering:!0,lightPreset:b.DefaultLightPreset,backgroundColorPreset:null,reverseMouseZoomDir:!1,reverseHorizontalLookDirection:!1,reverseVerticalLookDirection:!1,alwaysUsePivot:!1,zoomTowardsPivot:!1,orbitPastWorldPoles:!0,leftHandedMouseSetup:!1,clickToSetCOI:a,optimizeNavigation:!1,fusionOrbit:!0,fusionOrbitConstrained:!0,useFirstPersonNav:!1});this.prefs.tag("3d");this.prefs.tag("2d");this.prefs.untag("2d","viewCube alwaysUsePivot zoomTowardsPivot reverseHorizontalLookDirection reverseVerticalLookDirection orbitPastWorldPoles clickToSetCOI ghosting optimizeNavigation ambientShadows antialiasing groundShadow groundReflection lineRendering lightPreset".split(" "));
this.setQualityLevel(this.prefs.ambientShadows,this.prefs.antialiasing);this.setGroundShadow(this.prefs.groundShadow);this.setGroundReflection(this.prefs.groundReflection);this.setGhosting(this.prefs.ghosting);this.setProgressiveRendering(this.prefs.progressiveRendering);this.setClickToSetCOI(this.prefs.clickToSetCOI);this.setOptimizeNavigation(this.prefs.optimizeNavigation);this.hideLines(!this.prefs.lineRendering);this.navigation.setUsePivotAlways(this.prefs.alwaysUsePivot);this.navigation.setReverseZoomDirection(this.prefs.reverseMouseZoomDir);
this.navigation.setReverseHorizontalLookDirection(this.prefs.reverseHorizontalLookDirection);this.navigation.setReverseVerticalLookDirection(this.prefs.reverseVerticalLookDirection);this.navigation.setZoomTowardsPivot(this.prefs.zoomTowardsPivot);this.navigation.setOrbitPastWorldPoles(this.prefs.orbitPastWorldPoles);this.navigation.setUseLeftHandedInput(this.prefs.leftHandedMouseSetup);if(a=this.prefs.backgroundColorPreset)try{var f=JSON.parse(a);this.impl.setClearColors(f[0],f[1],f[2],f[3],f[4],
f[5])}catch(d){this.prefs.set("backgroundColorPreset",null)}this.impl.setLightPreset(this.prefs.lightPreset)};a.Viewer3D.prototype.setLightPreset=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setLightPreset is not applicable to 2D"):(this.prefs.set("lightPreset",a),this.impl.setLightPreset(a))};a.Viewer3D.prototype.setUsePivotAlways=function(a){this.prefs.set("alwaysUsePivot",a);this.navigation.setUsePivotAlways(a)};a.Viewer3D.prototype.setReverseZoomDirection=function(a){this.prefs.set("reverseMouseZoomDir",
a);this.navigation.setReverseZoomDirection(a)};a.Viewer3D.prototype.setReverseHorizontalLookDirection=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setReverseHorizontalLookDirection is not applicable to 2D"):(this.prefs.set("reverseHorizontalLookDirection",a),this.navigation.setReverseHorizontalLookDirection(a))};a.Viewer3D.prototype.setReverseVerticalLookDirection=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setReverseVerticalLookDirection is not applicable to 2D"):
(this.prefs.set("reverseVerticalLookDirection",a),this.navigation.setReverseVerticalLookDirection(a))};a.Viewer3D.prototype.setZoomTowardsPivot=function(a){this.prefs.set("zoomTowardsPivot",a);this.navigation.setZoomTowardsPivot(a)};a.Viewer3D.prototype.setOrbitPastWorldPoles=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setOrbitPastWorldPoles is not applicable to 2D"):(this.prefs.set("orbitPastWorldPoles",a),this.navigation.setOrbitPastWorldPoles(a))};a.Viewer3D.prototype.setUseLeftHandedInput=
function(a){this.prefs.set("leftHandedMouseSetup",a);this.navigation.setUseLeftHandedInput(a)};a.Viewer3D.prototype.preContextMenuShow=function(a){var b=this.impl.castRay(a.clientX,a.clientY).node,d;b?this.impl.selector.isSelectedOrParentIsSelected(b)||(a.ctrlKey||a.metaKey||a.shiftKey?(d=this.impl.selector.getSelection(),d.push(b)):d=[b]):d=[];d&&this.impl.selector.setSelection(d);return!0};a.Viewer3D.prototype.setLayerVisible=function(b,f,d){function g(a,b){var c=[];if(a.isLayer)c.push(a.index);
else for(var d=a.children,f=0;f<d.length;++f)c=c.concat(g(d[f]));return c}if(this.model&&!this.model.is2d())console.warn("av.Viewer3D.setLayerVisible is not yet implemented for 3D");else{var h=this.model.getLayersRoot();if(h&&0!==h.childCount){null===b&&(b=[h]);Array.isArray(b)||(b=[b]);d&&(this.impl.setLayerVisible(g(h),!1),f=!0);d=[];for(h=0;h<b.length;++h)d=d.concat(g(b[h]));this.impl.setLayerVisible(d,f);this.fireEvent({type:a.LAYER_VISIBILITY_CHANGED_EVENT})}}};a.Viewer3D.prototype.isLayerVisible=
function(a){return this.model&&!this.model.is2d()?(console.warn("av.Viewer3D.isLayerVisible is not yet implemented for 3D"),!1):!!(a&&a.isLayer&&this.impl.isLayerVisible(a.index))};a.Viewer3D.prototype.anyLayerHidden=function(){function a(d){if(d.isLayer)return!b.impl.isLayerVisible(d.index);d=d.children;for(var h=0;h<d.length;++h)if(a(d[h]))return!0;return!1}if(this.model&&!this.model.is2d())return console.warn("av.Viewer3D.anyLayerHidden is not yet implemented for 3D"),0;var b=this,d=b.model.getLayersRoot();
return!(!d||!a(d))};a.Viewer3D.prototype.setGroundShadowColor=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setGroundShadowColor is not applicable to 2D"):this.impl.setGroundShadowColor(a)};a.Viewer3D.prototype.setGroundShadowAlpha=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setGroundShadowAlpha is not applicable to 2D"):this.impl.setGroundShadowAlpha(a)};a.Viewer3D.prototype.setGroundReflectionColor=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setGroundReflectionColor is not applicable to 2D"):
this.impl.setGroundReflectionColor(a)};a.Viewer3D.prototype.setGroundReflectionAlpha=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setGroundReflectionAlpha is not applicable to 2D"):this.impl.setGroundReflectionAlpha(a)};a.Viewer3D.prototype.getCutPlanes=function(){return this.model&&this.model.is2d()?(console.warn("av.Viewer3D.getCutPlanes is not applicable to 2D"),[]):this.impl.getCutPlanes()};a.Viewer3D.prototype.setCutPlanes=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.getCutPlanes is not applicable to 2D"):
this.impl.setCutPlanes(a)};a.Viewer3D.prototype.setCutPlanesOutlineColor=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setCutPlanesOutlineColor is not applicable to 2D"):this.impl.setCutPlanesOutlineColor(a)};a.Viewer3D.prototype.setCutPlanesOutlineThickness=function(a){this.model&&this.model.is2d()?console.warn("av.Viewer3D.setCutPlanesOutlineThickness is not applicable to 2D"):this.impl.setCutPlanesOutlineThickness(a)};a.Viewer3D.prototype.getScreenShot=function(a,b,d){return this.impl.getScreenShot(a,
b,d)};a.Viewer3D.prototype.setContextMenu=function(a){this.contextMenu&&this.contextMenu.hide();this.contextMenu=a};a.Viewer3D.prototype.triggerContextMenu=function(a){if(this.config&&this.config.onTriggerContextMenuCallback)this.config.onTriggerContextMenuCallback(a);return this.contextMenu&&this.preContextMenuShow(a)?(this.contextMenu.show(a),!0):!1};a.Viewer3D.prototype.initContextMenu=function(){function a(c){var d=c.button;"buttons"in c&&(!b.__firefoxLMBfix||c.buttons&1?2===d&&c.buttons&1&&(d=
0,b.__firefoxLMBfix=!0):(b.__firefoxLMBfix=!1,d=0));c=b.navigation&&b.navigation.getUseLeftHandedInput()?0:2;return d===c?!0:!1}if(!this.config||(this.config.hasOwnProperty("disableBrowserContextMenu")?this.config.disableBrowserContextMenu:1))this.onDefaultContextMenu=function(a){a.preventDefault()},this.container.addEventListener("contextmenu",this.onDefaultContextMenu,!1);var b=this,d=this.canvas||this.container;d.addEventListener("mousedown",function(d){a(d)&&(b.startX=d.clientX,b.startY=d.clientY)});
d.addEventListener("mouseup",function(d){a(d)&&d.clientX===b.startX&&d.clientY===b.startY&&b.triggerContextMenu(d);return!0},!1)};a.Viewer3D.prototype.preContextMenuShow=function(a){return!0};a.Viewer3D.prototype.registerContextMenuCallback=function(a,b){this.contextMenuCallbacks[a]=b};a.Viewer3D.prototype.unregisterContextMenuCallback=function(a){return a in this.contextMenuCallbacks?(delete this.contextMenuCallbacks[a],!0):!1};a.Viewer3D.prototype.runContextMenuCallbacks=function(a,b){for(var d in this.contextMenuCallbacks)if(this.contextMenuCallbacks.hasOwnProperty(d))this.contextMenuCallbacks[d](a,
b)}})();AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ErrorCodes={UNKNOWN_FAILURE:1,BAD_DATA:2,NETWORK_FAILURE:3,NETWORK_ACCESS_DENIED:4,NETWORK_FILE_NOT_FOUND:5,NETWORK_SERVER_ERROR:6,NETWORK_UNHANDLED_RESPONSE_CODE:7,BROWSER_WEBGL_NOT_SUPPORTED:8,BAD_DATA_NO_VIEWABLE_CONTENT:9,BROWSER_WEBGL_DISABLED:10,RTC_ERROR:11};AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.HTTP_REQUEST_HEADERS={};Autodesk.Viewing.ACM_SESSION_ID;
Autodesk.Viewing.Document=function(a,b){function c(a){if(a){var b=a.children?a.children.length:0;if("geometry"===a.type&&b){for(var f=0,l=0;l<b;l++){var n=a.children[l];n&&"view"===n.type&&(d.myViewGeometry[n.guid]=a,f++)}d.myNumViews[a.guid]=f}else if("application/autodesk-db"==a.mime&&a.urn)d.myPropertyDb=a.urn.substr(0,a.urn.lastIndexOf("/")+1);else if(0<b)for(l=0;l<b;l++)c(a.children[l])}}function f(a,b,c){if(a){var d=a.guid;if(d){c.apply(this,[d,b]);b=a.children?a.children.length:0;for(var n=
0;n<b;n++)f(a.children[n],d,c)}}}this.myPath=b;this.myData=a;this.myViewGeometry={};this.myNumViews={};this.myPropertyDb=null;var d=this;c(a);this.parents={};f(this.myData,null,function(a,b){d.parents[a]=b})};Autodesk.Viewing.Document.prototype.constructor=Autodesk.Viewing.Document;
Autodesk.Viewing.Document.load=function(a,b,c,f){function d(a){var b={},c;for(c in a)-1!=c.indexOf("x-ads-acm")&&(b[c]=a[c]);return b}function g(a){for(var b in a)if("oauth2AccessToken"===b)return a[b];return null}function h(a,b){a.application="autodesk";var d=new XMLHttpRequest;d.open("POST",ACM_SESSION_URL,!0);d.setRequestHeader("Content-Type","application/json");d.setRequestHeader("Authorization","Bearer "+b);d.onload=function(){200===d.status&&(Autodesk.Viewing.ACM_SESSION_ID=JSON.parse(d.responseText).acmsession);
n()};d.onerror=c;d.ontimeout=c;d.send(JSON.stringify(a));delete a.application}function k(a){if(-1===a.indexOf("urn:")){if(0===a.indexOf("http"))return a;0!==a.indexOf("/")&&(a="/"+a);return window.location.protocol+"//"+window.location.host+a}return a}function l(a){var b=[],c=null;if(!a||!a.children)return b;if(a=1===a.children.length?a.children[0]:null)c=a.messages;a=c?c.length:0;for(var d=0;d<a;d++)b.push(c[d]);return b}function n(){var d=k(a);try{Autodesk.Viewing.Private.ViewingService.get(VIEWING_URL,
"bubbles",d,function(a){if(/<[^>]*script/.test(a))c&&c(Autodesk.Viewing.ErrorCodes.BAD_DATA,"Malicious document content detected. Abort loading.");else{a="string"===typeof a?JSON.parse(a):a;a=new Autodesk.Viewing.Document(a,d);var f=Autodesk.Viewing.Document.getSubItemsWithProperties(a.getRootItem(),{type:"folder",role:"viewable"},!0)[0];0<Autodesk.Viewing.Document.getSubItemsWithProperties(f,{type:"geometry"},!0).length?(f=l(a.getRootItem()),b&&b(a,f)):c&&(f=l(a.getRootItem()),c(Autodesk.Viewing.ErrorCodes.BAD_DATA_NO_VIEWABLE_CONTENT,
"No viewable content.",f))}},function(a,b,d){d=l(d);c&&(b="Error: "+a+" ("+b+")",a=Autodesk.Viewing.Private.ErrorHandler.getErrorCode(a),c(a,b,d))},{headers:Autodesk.Viewing.HTTP_REQUEST_HEADERS,withCredentials:!!auth})}catch(f){c&&c(Autodesk.Viewing.ErrorCodes.UNKNOWN_FAILURE,"An exception occurred while loading the document: "+f.toString(),null)}}"function"!==typeof b&&(console.log("Autodesk.Viewing.Document.load called with deprecated (auth) parameter"),"function"===typeof c&&(b=c),"function"===
typeof f&&(c=f));if(f){var q=d(f);f=g(f);Autodesk.Viewing.HTTP_REQUEST_HEADERS=q;h(q,f)}else n()};
Autodesk.Viewing.Document.prototype.getFullPath=function(a){if(!a)return a;var b=a;Autodesk.Viewing.Private.offline?b=decodeURIComponent(Autodesk.Viewing.Private.offlineResourcePrefix)+b.substr(b.indexOf("/")):0===a.indexOf("urn")?b=VIEWING_URL+"/items/"+a:0===a.indexOf("$file$")&&-1!==this.myPath.indexOf("/output/bubble.json")&&(b=this.myPath.replace("/output/bubble.json","")+a.replace("$file$",""));return b};
Autodesk.Viewing.Document.prototype.getThumbnailPath=function(a,b,c){b=b?b:200;c=c?c:200;a=VIEWING_URL+"/thumbnails/"+this.myData.urn+"?guid="+encodeURIComponent(a.guid)+"&width="+b+"&height="+c;Autodesk.Viewing.ACM_SESSION_ID&&(a+="&acmsession="+Autodesk.Viewing.ACM_SESSION_ID);return a};
Autodesk.Viewing.Document.prototype.getViewablePath=function(a){if("geometry"===a.type){var b=[];"3d"===a.role?b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{mime:"application/autodesk-svf"},!1):"2d"===a.role&&(b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{mime:"application/autodesk-f2d"},!1),0==b.length&&(b=Autodesk.Viewing.Document.getSubItemsWithProperties(a,{role:"tileRoot"},!0)));if(0<b.length)return this.getFullPath(b[0].urn)}else if("view"===a.type&&(a=this.getViewGeometry(a)))return this.getViewablePath(a);
return""};Autodesk.Viewing.Document.prototype.getPropertyDbPath=function(){return this.myPropertyDb};Autodesk.Viewing.Document.prototype.getRootItem=function(){return this.myData};Autodesk.Viewing.Document.prototype.getPath=function(){return this.myPath};Autodesk.Viewing.Document.prototype.getItemById=function(a){function b(c){if(!c)return null;for(var f in c){var d=c[f];if("guid"===f&&d===a)return c;if(null!==d&&"object"===typeof d&&(d=b(d)))return d}return null}return b(this.myData)};
Autodesk.Viewing.Document.getSubItemsWithProperties=function(a,b,c){var f=[];if(!a)return[];for(var d=a.children?a.children.length:0,g=0;g<d;g++){var h=a.children[g],k;a:{k=b;var l=void 0;for(l in k)if(!(l in h)||k[l]!==h[l]){k=!1;break a}k=!0}k&&f.push(h);c&&f.push.apply(f,Autodesk.Viewing.Document.getSubItemsWithProperties(h,b,c))}return f};Autodesk.Viewing.Document.prototype.getViewGeometry=function(a){return this.myViewGeometry[a.guid]};
Autodesk.Viewing.Document.prototype.getNumViews=function(a){return this.myNumViews[a.guid]||0};Autodesk.Viewing.Document.prototype.getParentId=function(a){return this.parents[a]};Autodesk.Viewing.Document.prototype.getMessages=function(a,b){var c=[];if(!a)return c;var f=null;b&&(f=this.getRootItem().guid);for(var d=a,g=this.parents[d];d&&(!b||g!==f);){if((d=this.getItemById(d))&&d.messages)for(var h=0;h<d.messages.length;h++)c.push(d.messages[h]);d=g;g=this.parents[d]}return c};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.ModelUnits={METER:"m",CENTIMETER:"cm",MILLIMETER:"mm",FOOT:"ft",INCH:"in"};Autodesk.Viewing.Model=function(a){this.myData=a;this.myLoader=this.propWorker=this.sharedPath=null};Autodesk.Viewing.EventDispatcher.prototype.apply(Autodesk.Viewing.Model.prototype);Autodesk.Viewing.Model.prototype.constructor=Autodesk.Viewing.Model;Autodesk.Viewing.Model.prototype.setData=function(a){this.myData=a};Autodesk.Viewing.Model.prototype.getData=function(){return this.myData};
Autodesk.Viewing.Model.prototype.setLoader=function(a){this.myLoader=a};Autodesk.Viewing.Model.prototype.getRoot=function(){return this.is2d()?(console.warn("Autodesk.Viewing.Model.getRoot is not yet implemented for 2D"),null):this.myData&&this.myData.instanceTree?this.myData.instanceTree.root:null};
Autodesk.Viewing.Model.prototype.getRootId=function(){return this.is2d()?(console.warn("Autodesk.Viewing.Model.getRootId is not yet implemented for 2D"),null):this.myData&&this.myData.instanceTree?this.myData.instanceTree.root.dbId:null};Autodesk.Viewing.Model.prototype.getBoundingBox=function(){return this.myData?this.myData.bbox:null};
Autodesk.Viewing.Model.prototype.getUnitScale=function(){switch(this.getMetadata("distance unit","value",null)){case "meter":case "m":return 1;case "foot":case "ft":return.3048;case "inch":case "in":return.0254;case "centimeter":case "cm":return.01;case "millimeter":case "mm":return.001;default:return 1}};
Autodesk.Viewing.Model.prototype.getUnitString=function(){switch(this.getMetadata("distance unit","value",null)){case "meter":case "m":return Autodesk.Viewing.ModelUnits.METER;case "foot":case "ft":return Autodesk.Viewing.ModelUnits.FOOT;case "inch":case "in":return Autodesk.Viewing.ModelUnits.INCH;case "centimeter":case "cm":return Autodesk.Viewing.ModelUnits.CENTIMETER;case "millimeter":case "mm":return Autodesk.Viewing.ModelUnits.MILLIMETER;default:return null}};
Autodesk.Viewing.Model.prototype.getNodeById=function(a){return this.is2d()?(console.warn("Autodesk.Viewing.Model.getNodeById is not yet implemented for 2D"),null):this.myData.instanceTree?this.myData.instanceTree.getNodeById(a):{dbId:a,fragIds:a}};
Autodesk.Viewing.Model.prototype.getNodesByIds=function(a){if(this.is2d())return console.warn("Autodesk.Viewing.Model.getNodeById is not yet implemented for 2D"),null;var b=[],c,f=this.myData.instanceTree;if(f)for(c=0;c<a.length;c++){var d=f.getNodeById(a[c]);d&&b.push(d)}else for(c=0;c<a.length;c++)b.push({dbId:a[c],fragIds:a[c]});return b};Autodesk.Viewing.Model.prototype.getMetadata=function(a,b,c){if(this.myData){var f=this.myData.metadata;if(f&&(a=f[a],void 0!==a))if(b){if(b=a[b],void 0!==b)return b}else return a}return c};
Autodesk.Viewing.Model.prototype.getDefaultCamera=function(){var a=this.myData;if(!a)return null;var b=null,c=a.cameras?a.cameras.length:0;if(0<c){var f=this.getMetadata("default camera","index",null);if(null!==f&&a.cameras[f])b=a.cameras[f];else{for(f=0;f<c;f++){var d=a.cameras[f];if(d.isPerspective){b=d;break}}b||(b=a.cameras[0])}}return b};Autodesk.Viewing.Model.prototype.getUpVector=function(){return this.getMetadata("world up vector","XYZ",null)};
Autodesk.Viewing.Model.prototype.geomPolyCount=function(){return this.myData?this.myData.geomPolyCount:null};Autodesk.Viewing.Model.prototype.instancePolyCount=function(){return this.myData?this.myData.instancePolyCount:null};Autodesk.Viewing.Model.prototype.getLayersRoot=function(){return this.is2d()?this.myData?this.myData.layersRoot:null:(console.warn("Autodesk.Viewing.Model.getLayersRoot is not yet implemented for 3D"),null)};
Autodesk.Viewing.Model.prototype.is2d=function(){return!(!this.myData||!this.myData.is2d)};Autodesk.Viewing.Model.prototype.isLoadDone=function(){return!(!this.myData||!this.myData.loadDone)};Autodesk.Viewing.Model.prototype.isObjectTreeCreated=function(){return!!this.myData.instanceTree};Autodesk.Viewing.Model.prototype.getProperties=function(a,b,c){this.myData&&this.myLoader&&this.myLoader.getProperties(a,b,c)};
Autodesk.Viewing.Model.prototype.getExternalIdMapping=function(a,b){this.myData&&this.myLoader&&this.myLoader.getExternalIdMapping(a,b)};Autodesk.Viewing.Model.prototype.getObjectTree=function(a,b){this.myData&&this.myLoader&&this.myLoader.getObjectTree(a,b)};Autodesk.Viewing.Model.prototype.search=function(a,b,c,f){var d=this;this.isLoadDone()?this.myLoader.searchProperties(a,f,b,c):this.getObjectTree(function(){d.myLoader.searchProperties(a,f,b,c)})};
Autodesk.Viewing.Model.prototype.pageToModel=function(a){var b=this.myData.metadata.page_dimensions,c=a.x/b.page_width*b.logical_width+b.logical_offset_x,f=a.y/b.page_height*b.logical_height+b.logical_offset_y;if(b.source_to_logical_xform){if(!b.inverse_xform){for(var d=new THREE.Matrix4,g=0;16>g;g++)d.elements[g]=b.source_to_logical_xform[g];b.inverse_xform=d.getInverse(d)}b=b.inverse_xform.elements;a.x=b[0]*c+b[4]*f+0*b[8]+b[12];a.y=b[1]*c+b[5]*f+0*b[9]+b[13]}else a.x=c,a.y=f};AutodeskNamespace("Autodesk.Viewing");
Autodesk.Viewing.Navigation=function(a){this.__options={dollyToPivot:!1,orbitPastPoles:!0,reverseDolly:!1,reverseHorizontalLook:!1,reverseVerticalLook:!1,useLeftHandedInput:!1,usePivotAlways:!1,lockNavigation:!1};this.__transitionActive=this.__homeViewRequested=this.__fitToViewRequested=this.__pivotIsSetFlag=!1;this.__destinationView=null;this.__isTouchDevice=this.__is2D=!1;this.__kEpsilon=1E-6;var b=null,c={left:0,top:0,width:1,height:1};this.uninitialize=function(){this.setCamera(null)};this.setCamera=
function(a){a!==b&&(b=a)&&(a.hasOwnProperty("target")||(a.target=new THREE.Vector3(0,0,0)),a.hasOwnProperty("pivot")||(a.pivot=new THREE.Vector3(0,0,0)),a.worldup=a.up.clone(),a.dirty=!0)};this.getCamera=function(){return b};this.setScreenViewport=function(a){c=a};this.getScreenViewport=function(){return c};this.__setUp=function(a){return a&&b&&0!==a.clone().normalize().sub(b.worldup).lengthSq()?(b.worldup.copy(a).normalize(),b.dirty=!0):!1};this.__getUp=function(){return b?b.worldup:new THREE.Vector3(0,
1,0)};this.setView=function(a,c){b&&a&&c&&!this.__options.lockNavigation&&(b.position.copy(a),b.target.copy(c),b.dirty=!0)};this.orientCameraUp=function(){b&&!this.__options.lockNavigation&&(b.up.copy(this.getAlignedUpVector()),b.dirty=!0)};this.getPivotPoint=function(){return b?b.pivot.clone():new THREE.Vector3(0,0,0)};this.setPivotPoint=function(a){b&&a&&!this.__options.lockNavigation&&(b.pivot.copy(a),b.dirty=!0)};this.getPosition=function(){return b?b.position.clone():new THREE.Vector3(0,0,1)};
this.setPosition=function(a){b&&a&&!this.__options.lockNavigation&&(b.position.copy(a),b.dirty=!0)};this.setTarget=function(a){b&&a&&!this.__options.lockNavigation&&(b.target.copy(a),b.dirty=!0)};this.getTarget=function(){return b?b.target.clone():new THREE.Vector3(0,0,0)};this.getEyeVector=function(){return b?b.target.clone().sub(b.position):new THREE.Vector3(0,0,-1)};this.getFovMin=function(){return 6.88};this.getFovMax=function(){return 100};this.isPointVisible=function(a){return(new THREE.Frustum).setFromMatrix(b.projectionMatrix.clone().multiply(b.matrixWorldInverse)).containsPoint(a)};
this.setVerticalFov=function(a,c){if(!b||b.isPerspective)if(6.88>a?a=6.88:100<a&&(a=100),b&&!this.__options.lockNavigation&&!(1E-6>=Math.abs(b.fov-a))){if(c){var g=this.__pivotIsSetFlag&&this.isPointVisible(this.getPivotPoint()),h=this.getPosition(),k=this.getEyeVector(),l=THREE.Math.degToRad(b.fov),n=THREE.Math.degToRad(a),q=g?this.getPivotPlaneDistance():k.length(),l=q*Math.tan(.5*l)/Math.tan(.5*n),k=k.normalize().multiplyScalar(q-l);this.setPosition(h.add(k));g&&this.setTarget(this.getTarget().add(k))}b.setFov(a);
b.dirty=!0}};this.computeFit=function(a,b,c,h){if(!h||h.empty())return{position:a,target:b};var k=h.center();h=h.size();h=.5*Math.sqrt(h.x*h.x+h.y*h.y+h.z*h.z);0===h&&(h=1);if(!this.getIs2D()){var l=Math.max(1,.9+c/100*.5);h*=l}a=a.clone().sub(b).normalize();c=h/Math.tan(THREE.Math.degToRad(.5*c));a.multiplyScalar(c);return{position:k.clone().add(a),target:k}};this.computeOrthogonalUp=function(a,b){var c=this.__getUp(),h=b.clone().sub(a);if(0===h.lengthSq())return h.copy(c);var k=h.clone().cross(c);
0===k.lengthSq()&&(c.z>c.y?h.y-=1E-4:h.z-=1E-4,k.crossVectors(h,c));return k.cross(h).normalize()};this.fitBounds=function(a,c,g){var h=this.getTarget(),k=this.getPosition();if(this.__options.lockNavigation||!c||c.empty())return{position:k,target:h};var l=this.getVerticalFov();c=this.computeFit(k,h,l,c);g=g?this.computeOrthogonalUp(k,h):b.up;a?(b.up.copy(g),this.setView(c.position,c.target)):this.setRequestTransitionWithUp(!0,c.position,c.target,l,g);this.setPivotPoint(c.target);this.setPivotSetFlag(!0);
return c};this.updateCamera=function(){b&&(b.updateProjectionMatrix(),this.orient(b,b.target,b.position,b.up),b.dirty=!1)};this.setCamera(a)};Autodesk.Viewing.Navigation.prototype.constructor=Autodesk.Viewing.Navigation;Autodesk.Viewing.Navigation.prototype.setIs2D=function(a){this.__is2D=!!a};Autodesk.Viewing.Navigation.prototype.getIs2D=function(){return this.__is2D};Autodesk.Viewing.Navigation.prototype.setIsTouchDevice=function(a){this.__isTouchDevice=!!a};
Autodesk.Viewing.Navigation.prototype.getIsTouchDevice=function(){return this.__isTouchDevice};
Autodesk.Viewing.Navigation.prototype.orient=function(){var a,b,c,f;return function(d,g,h,k){a||(a=new THREE.Matrix4,b=new THREE.Vector3,c=new THREE.Vector3,f=new THREE.Vector3);var l=a.elements;f.subVectors(h,g).normalize();0===f.lengthSq()&&(f.z=1);b.crossVectors(k,f).normalize();0===b.lengthSq()&&(k.z>k.y?f.y-=1E-4:f.z+=1E-4,b.crossVectors(k,f).normalize());c.crossVectors(f,b);l[0]=b.x;l[4]=c.x;l[8]=f.x;l[1]=b.y;l[5]=c.y;l[9]=f.y;l[2]=b.z;l[6]=c.z;l[10]=f.z;d.setRotationFromMatrix(a)}}();
Autodesk.Viewing.Navigation.prototype.fov2fl=function(a){a=THREE.Math.degToRad(a);0>=a&&(a=1E-4);return Math.round(12/Math.tan(.5*a))};Autodesk.Viewing.Navigation.prototype.fl2fov=function(a){0>=a&&(a=1E-4);a=2*Math.atan(12/a);return THREE.Math.radToDeg(a)};Autodesk.Viewing.Navigation.prototype.setCameraUpVector=function(a){if(!this.__options.lockNavigation){var b=this.getCamera();b.up.copy(a);b.dirty=!0}};
Autodesk.Viewing.Navigation.prototype.getCameraUpVector=function(){var a=this.getCameraRightVector(!1),b=this.getEyeVector();return a.cross(b).normalize()};Autodesk.Viewing.Navigation.prototype.getAlignedUpVector=function(){var a=this.getCameraRightVector(!0),b=this.getEyeVector();return a.cross(b).normalize()};
Autodesk.Viewing.Navigation.prototype.getCameraRightVector=function(a){var b=new THREE.Vector3;a=a?this.getWorldUpVector():this.getCamera().up;var c=this.getEyeVector();b.crossVectors(c,a);0===b.lengthSq()&&(a.z>a.y?c.y-=1E-4:c.z+=1E-4,b.crossVectors(c,a));return b.normalize()};Autodesk.Viewing.Navigation.prototype.setWorldUpVector=function(a,b){this.__options.lockNavigation||(this.__setUp(a),b&&this.orientCameraUp())};Autodesk.Viewing.Navigation.prototype.getWorldUpVector=function(){return this.__getUp().clone()};
Autodesk.Viewing.Navigation.prototype.getWorldRightVector=function(){var a=new THREE.Vector3;a.copy(this.__getUp());Math.abs(a.z)<=Math.abs(a.y)?a.set(a.y,-a.x,0):0<=a.z?a.set(a.z,0,-a.x):a.set(-a.z,0,a.x);return a.normalize()};Autodesk.Viewing.Navigation.prototype.getVerticalFov=function(){return this.getCamera().fov};Autodesk.Viewing.Navigation.prototype.getHorizontalFov=function(){var a=this.getScreenViewport();return this.getCamera().fov*(a.width/a.height)};
Autodesk.Viewing.Navigation.prototype.getFocalLength=function(){return this.fov2fl(this.getVerticalFov())};Autodesk.Viewing.Navigation.prototype.setFocalLength=function(a,b){this.setVerticalFov(this.fl2fov(a),b)};Autodesk.Viewing.Navigation.prototype.setReverseZoomDirection=function(a){this.__options.reverseDolly=!!a};
Autodesk.Viewing.Navigation.prototype.setReverseHorizontalLookDirection=function(a){this.getIs2D()?console.warn("Autodesk.Viewing.Navigation.setReverseHorizontalLookDirection is not applicable to 2D"):this.__options.reverseHorizontalLookDirection=!!a};Autodesk.Viewing.Navigation.prototype.setReverseVerticalLookDirection=function(a){this.getIs2D()?console.warn("Autodesk.Viewing.Navigation.setReverseVerticalLookDirection is not applicable to 2D"):this.__options.reverseVerticalLookDirection=!!a};
Autodesk.Viewing.Navigation.prototype.getReverseZoomDirection=function(){return this.__options.reverseDolly};Autodesk.Viewing.Navigation.prototype.getReverseHorizontalLookDirection=function(){return this.getIs2D()?(console.warn("Autodesk.Viewing.Navigation.getReverseHorizontalLookDirection is not applicable to 2D"),!1):this.__options.reverseHorizontalLookDirection};
Autodesk.Viewing.Navigation.prototype.getReverseVerticalLookDirection=function(){return this.getIs2D()?(console.warn("Autodesk.Viewing.Navigation.getReverseVerticalLookDirection is not applicable to 2D"),!1):this.__options.reverseVerticalLookDirection};Autodesk.Viewing.Navigation.prototype.setZoomTowardsPivot=function(a){this.__options.dollyToPivot=!!a};Autodesk.Viewing.Navigation.prototype.getZoomTowardsPivot=function(){return this.__options.dollyToPivot};
Autodesk.Viewing.Navigation.prototype.setOrbitPastWorldPoles=function(a){this.getIs2D()?console.warn("Autodesk.Viewing.Navigation.setOrbitPastWorldPoles is not applicable to 2D"):this.__options.orbitPastPoles=!!a};Autodesk.Viewing.Navigation.prototype.getOrbitPastWorldPoles=function(){return this.getIs2D()?(console.warn("Autodesk.Viewing.Navigation.orbitPastWorldPoles is not applicable to 2D"),!1):this.__options.orbitPastPoles};
Autodesk.Viewing.Navigation.prototype.setUsePivotAlways=function(a){this.__options.usePivotAlways=!!a};Autodesk.Viewing.Navigation.prototype.getUsePivotAlways=function(){return this.__options.usePivotAlways};Autodesk.Viewing.Navigation.prototype.setUseLeftHandedInput=function(a){this.__options.useLeftHandedInput=!!a};Autodesk.Viewing.Navigation.prototype.getUseLeftHandedInput=function(){return this.__options.useLeftHandedInput};
Autodesk.Viewing.Navigation.prototype.setIsLocked=function(a){this.__options.lockNavigation=!!a};Autodesk.Viewing.Navigation.prototype.getIsLocked=function(){return this.__options.lockNavigation};Autodesk.Viewing.Navigation.prototype.setPivotSetFlag=function(a){this.__options.lockNavigation||(this.__pivotIsSetFlag=!!a)};Autodesk.Viewing.Navigation.prototype.getPivotSetFlag=function(){return this.__pivotIsSetFlag};
Autodesk.Viewing.Navigation.prototype.setRequestFitToView=function(a){this.__options.lockNavigation||(this.__fitToViewRequested=!!a)};Autodesk.Viewing.Navigation.prototype.getRequestFitToView=function(){return this.__fitToViewRequested};Autodesk.Viewing.Navigation.prototype.setRequestHomeView=function(a){this.__options.lockNavigation||(this.__homeViewRequested=!!a)};Autodesk.Viewing.Navigation.prototype.getRequestHomeView=function(){return this.__homeViewRequested};
Autodesk.Viewing.Navigation.prototype.setRequestTransition=function(a,b,c,f,d){this.__destinationView=a?{position:b.clone(),coi:c.clone(),fov:f,up:this.getCamera().up.clone(),worldUp:this.getWorldUpVector(),reorient:d}:null};Autodesk.Viewing.Navigation.prototype.setRequestTransitionWithUp=function(a,b,c,f,d,g){this.__destinationView=a?{position:b.clone(),coi:c.clone(),fov:f,up:d.clone(),worldUp:g?g:this.getWorldUpVector(),reorient:!1}:null};
Autodesk.Viewing.Navigation.prototype.getRequestTransition=function(){return this.__destinationView};Autodesk.Viewing.Navigation.prototype.setTransitionActive=function(a){this.__transitionActive=!!a};Autodesk.Viewing.Navigation.prototype.getTransitionActive=function(){return this.__transitionActive};
Autodesk.Viewing.Navigation.prototype.getWorldSize=function(a){var b=this.getScreenViewport(),b=b.width/b.height;a=2*a*Math.tan(THREE.Math.degToRad(.5*this.getCamera().fov));return new THREE.Vector2(a*b,a)};
Autodesk.Viewing.Navigation.prototype.getWorldPoint=function(a,b){a=2*a-1;b=2*(1-b)-1;var c=this.getCamera(),f;c.isPerspective&&(f=new THREE.Vector3(a,b,1),f=f.unproject(c));var d=this.getEyeVector(),g=this.getPosition();if(!c.isPerspective||isNaN(f.x)){var h=this.getWorldSize(d.length());f=this.getCameraRightVector(!1).multiplyScalar(.5*a*h.x);h=this.getCameraUpVector().multiplyScalar(.5*b*h.y);f=d.clone().add(f).add(h).normalize()}else f=f.sub(g).normalize();h=this.getPivotPoint();this.__pivotIsSetFlag&&
(this.getIs2D()||c.isPerspective&&this.isPointVisible(h))?(c=f.dot(d),d=0!==c?Math.abs(h.sub(g).dot(d))/c:h.sub(g).length()):d=c.isPerspective?.5*(c.near+c.far):c.orthoScale;return f.multiplyScalar(d).add(g)};Autodesk.Viewing.Navigation.prototype.getPivotPlaneDistance=function(){var a=this.getPivotPoint(),b=this.getEyeVector(),c=this.getPosition();return a.sub(c).dot(b.normalize())};
Autodesk.Viewing.Navigation.prototype.panRelative=function(a,b,c){c=this.getWorldSize(c);a*=c.x;b*=c.y;a=this.getCameraRightVector(!1).multiplyScalar(a);b=this.getCameraUpVector().multiplyScalar(b);b=a.add(b);this.setView(this.getPosition().add(b),this.getTarget().add(b))};
Autodesk.Viewing.Navigation.prototype.dollyFromPoint=function(a,b){if(!(Math.abs(a)<=this.__kEpsilon)){var c=this.getPosition(),c=b.clone().sub(c),f=c.length(),d=f+a,g=10*this.__kEpsilon;d<g&&(d=g);f=d/f;Math.abs(f-1)>this.__kEpsilon&&(c.multiplyScalar(f),c.set(-c.x,-c.y,-c.z),c=c.add(b),d=this.getEyeVector(),this.getCamera().isPerspective||d.multiplyScalar(f),this.setView(c,d.add(c)))}};
Autodesk.Viewing.Navigation.prototype.toPerspective=function(){if(this.getIs2D())console.warn("Autodesk.Viewing.Navigation.toPerspective is not applicable to 2D");else{var a=this.getCamera();this.__options.lockNavigation||a.isPerspective||(a.toPerspective(),a.dirty=!0)}};Autodesk.Viewing.Navigation.prototype.toOrthographic=function(){var a=this.getCamera();!this.__options.lockNavigation&&a.isPerspective&&(a.toOrthographic(),a.dirty=!0)};
Autodesk.Viewing.Navigation.snapToAxis=function(a){var b=new THREE.Vector3(Math.abs(a.x),Math.abs(a.y),Math.abs(a.z));b.x>b.y&&b.x>b.z?a.set(0<a.x?1:-1,0,0):b.y>b.x&&b.y>b.z?a.set(0,0<a.y?1:-1,0):a.set(0,0,0<a.z?1:-1);return a};"use strict";AutodeskNamespace("Autodesk.Viewing");Autodesk.Viewing.ViewingApplication=function(a,b){this.appContainerId=a;this.container=document.getElementById(a);this.options=b;this.myRegisteredViewers={};this.selectedItem=this.urn=this.myCurrentViewer=this.myDocument=null};
Autodesk.Viewing.ViewingApplication.prototype.k3D="3D";Autodesk.Viewing.ViewingApplication.prototype.k2D="2D";Autodesk.Viewing.ViewingApplication.prototype.registerViewer=function(a,b,c){c=c||{};this.options&&this.options.hasOwnProperty("disableBrowserContextMenu")&&!c.hasOwnProperty("disableBrowserContextMenu")&&(c.disableBrowserContextMenu=this.options.disableBrowserContextMenu);this.myRegisteredViewers[a]={};this.myRegisteredViewers[a].class=b;this.myRegisteredViewers[a].config=c};
Autodesk.Viewing.ViewingApplication.prototype.getViewerClass=function(a){return this.myRegisteredViewers.hasOwnProperty(a)?this.myRegisteredViewers[a].class:null};Autodesk.Viewing.ViewingApplication.prototype.getViewerContainer=function(){return document.getElementById(this.appContainerId)};
Autodesk.Viewing.ViewingApplication.prototype.getViewer=function(a,b,c){if(a in this.myRegisteredViewers){var f={},d=this.myRegisteredViewers[a].config,g;for(g in d)d.hasOwnProperty(g)&&(f[g]=d[g]);for(g in b)if(b.hasOwnProperty(g)){var d=b[g],h=Array.isArray(d),k=f[g],l=Array.isArray(k);h&&l?(d?h||(d=[d]):d=[],k?l||(k=[k]):k=[],f[g]=k.concat(d)):f[g]=d}a=this.myRegisteredViewers[a].class;if(this.myCurrentViewer&&this.myCurrentViewer.__proto__.constructor===a)return this.myCurrentViewer.tearDown(),
this.myCurrentViewer.setUp(f),this.myCurrentViewer;this.setCurrentViewer(null);for(b=this.getViewerContainer();b.hasChildNodes();)b.removeChild(b.lastChild);f=new a(b,f);a=f.start();if(0===a)return this.setCurrentViewer(f),f;c&&c(a,"Viewer failed to initialize.")}return null};Autodesk.Viewing.ViewingApplication.prototype.setCurrentViewer=function(a){this.myCurrentViewer&&this.myCurrentViewer.finish();this.myCurrentViewer=a};Autodesk.Viewing.ViewingApplication.prototype.getCurrentViewer=function(){return this.myCurrentViewer};
Autodesk.Viewing.ViewingApplication.prototype.loadDocument=function(a,b,c,f){var d=this;Autodesk.Viewing.Private.logger&&Autodesk.Viewing.Private.logger.log({category:"load_document",urn:0==a.indexOf("urn:")?a.substring(4):a});Autodesk.Viewing.Document.load(a,function(a,c){d.myDocument=a;d.onDocumentLoaded(a,c);b&&b(a,c)},function(a,b,f){d.onDocumentFailedToLoad(b,a,f);c&&c(a,b,f)},f)};Autodesk.Viewing.ViewingApplication.prototype.onDocumentLoaded=function(a,b){console.log(a,b)};
Autodesk.Viewing.ViewingApplication.prototype.onDocumentFailedToLoad=function(a,b,c){console.log(a,b,c)};
Autodesk.Viewing.ViewingApplication.prototype.selectItem=function(a,b,c){var f=this.myDocument.getViewablePath(a);if(f){var d,g,h,k;if("geometry"===a.type&&"3d"===a.role)d=this.k3D,h=a.name,k=a;else if("view"===a.type&&"3d"===a.role){if(g=a,d=this.k3D,k=this.myDocument.getViewGeometry(a))h=k.name}else"geometry"===a.type&&"2d"===a.role?(d=0<Autodesk.Viewing.Document.getSubItemsWithProperties(a,{mime:"application/autodesk-f2d"},!1).length?this.k3D:this.k2D,h=a.name,k=a):"view"===a.type&&"2d"===a.role&&
(g=a,d=this.k3D,k=this.myDocument.getViewGeometry(a))&&(h=k.name);var l=Autodesk.Viewing.Private.logger;if(l){var n=f.indexOf("urn:");l.log({category:"load_viewable",role:a.role,type:a.type,urn:-1!==n?f.substring(n+4):f})}var q=this.myDocument.getMessages(a.guid,!0);if(d){var m=this,p=this.myCurrentViewer&&this.urn===f,l=null,l=g&&g.camera?function(){m.myCurrentViewer.setViewFromArray(g.camera,g.name);b&&b(m.myCurrentViewer,a,q)}:g&&g.viewbox?function(){m.myCurrentViewer.setViewFromViewBox(g.viewbox,
g.name);b&&b(m.myCurrentViewer,a,q)}:p?function(){m.myCurrentViewer.setViewFromFile();b&&b(m.myCurrentViewer,a,q)}:function(){b&&b(m.myCurrentViewer,a,q)},n=function(a,b){c&&c(a,b,q)},t=!1;p?(l&&l(),t=!0):(this.urn=null,h={defaultModelStructureTitle:h,viewableName:h},a.hasOwnProperty("extensions")&&(h.extensions=Array.isArray(a.extensions)?a.extensions:[a.extensions]),(d=this.getViewer(d,h,c))&&d.load(this.myDocument.getFullPath(f),this.myDocument.getPropertyDbPath(),l,n)&&(this.urn=f,t=!0));if(t)return this.selectedItem=
a,this.onItemSelected(a,k),!0}}return!1};Autodesk.Viewing.ViewingApplication.prototype.onItemSelected=function(a,b){stderr("Selected URL: http://"+location.host+location.pathname+"?document=urn:"+this.myDocument.getRootItem().guid+"&item="+encodeURIComponent(a.guid));if(this.itemSelectedObservers)for(var c=this.getCurrentViewer(),f=0;f<this.itemSelectedObservers.length;++f){var d=this.itemSelectedObservers[f];d.onItemSelected&&d.onItemSelected(c,a,b)}};
Autodesk.Viewing.ViewingApplication.prototype.addItemSelectedObserver=function(a){this.itemSelectedObservers||(this.itemSelectedObservers=[]);this.itemSelectedObservers.push(a)};Autodesk.Viewing.ViewingApplication.prototype.selectItemById=function(a,b,c){return(a=this.myDocument.getItemById(a))?this.selectItem(a,b,c):!1};Autodesk.Viewing.ViewingApplication.prototype.getSelectedItem=function(){return this.selectedItem};AutodeskNamespace("Autodesk.Viewing.Private");
Autodesk.Viewing.Private.ViewCubeUi=function(a){this.viewer=a;this.homeViewContainer=this.infoButton=this.viewcube=this.cube=null};
Autodesk.Viewing.Private.ViewCubeUi.prototype={constructor:Autodesk.Viewing.UI.ViewCube,create:function(){var a=this.viewer.config;(a&&void 0!==a.wantInfoButton?a.wantInfoButton:1)&&this.initInfoButton();this.initHomeButton()},initInfoButton:function(){if(!(0<document.getElementsByClassName("infoButton").length)){this.infoButton=document.createElement("div");this.infoButton.className="infoButton";this.infoButton.style.cursor="pointer";this.viewer.container.appendChild(this.infoButton);var a=this;
this.infoButton.addEventListener("click",function(b){b=a.viewer.getPropertyPanel(!0);var c=!b.areDefaultPropertiesShown()||!b.isVisible();c&&b.showDefaultProperties();c!==b.isVisible()&&b.setVisible(c)})}},initHomeButton:function(){if(!(0<document.getElementsByClassName("homeViewWrapper").length)){var a=document.createElement("div");a.className="homeViewWrapper";a.style.cursor="pointer";this.viewer.container.appendChild(a);this.homeViewContainer=a;var b=this;a.addEventListener("click",function(a){b.viewer.navigation.setRequestHomeView(!0)});
this._initHomeMenu(a)}},_initHomeMenu:function(a){function b(a){h.style.display="none";document.removeEventListener("click",b)}var c=this.viewer,f=c.autocam,d=document.createElement("div");d.className="homeViewMenuHandle";var g=document.createElement("img");g.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsSAAALEgHS3X78AAAAIGNIUk0AAH7FAACLdgAA9UcAAIsOAABxUAAA6BUAADlYAAAfBMec4XAAAAEBSURBVHja7JcxCsIwFIb/V3oFx04v4iB4A3ev4Ak9iOABOhQcageHDh7iuVSwpW1eYmIFEwiFQvN9SZP/ERIRLNkyLNySQBLIhy+I6AhgE5F5FZHTpACAbV3X61h0Zs5nVwBAJiL0rd+eNuHvnQIArTEmplhrE7gAWEUUePSO/Vg1jJgFvQyYWoFoWTDMgLlNWDFzIyIUqjNzA6DSCpwBlMaYW4iZd+OU3bh2ARG5h5J4h3fj6nIghIQNbg2iTyQ0cFUS+kho4eoodpFwgTvVAo2EK9y5GM1J+MC9quGYhC98shaoPiQqAOwB7Hzhrxn1umMrABy6pxeT0t3w7wWeAwD5qe4YizvzugAAAABJRU5ErkJggg==";
g.width=g.height=18;d.appendChild(g);d.addEventListener("mouseover",function(a){g.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsSAAALEgHS3X78AAAAIGNIUk0AAH7FAACLdgAA9UcAAIsOAABxUAAA6BUAADlYAAAfBMec4XAAAAEVSURBVHja7JcxDoJAEEX/rvY2HMEb6AEsaTDxBngKIzfgDBR6AxJtiI0egN7Ght6GWBIYGzVKQHaQDYU7yYSwxb5HMvs3CCJCnyXRcxkBIzAsLwyWpx0ARyNzn29m81oBAE60mmqj237smBkwAl9PAfIssv3Y1kbMs+j9VZQvIyHEGMBI40enRHSpFdCcBR8ZUJcD2rKgnAH1Q5gmnu3HXcOBNPGUBIrQDbqUeMKL0A2UBIjo2pXEO5yIrso50IVEE7wxiH6RUIErJWEbCVW4chRzJDhw1l2gIsGFPzdmNQBLLrZr6R7pcL69WrpHkovtGoDF2o8rUCXRFt5aoCzRFl4pwCwLwOTxBGOeXi3Mv+HfC9wHAAIQ03ZDDGqmAAAAAElFTkSuQmCC"});
d.addEventListener("mouseleave",function(a){g.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsSAAALEgHS3X78AAAAIGNIUk0AAH7FAACLdgAA9UcAAIsOAABxUAAA6BUAADlYAAAfBMec4XAAAAEBSURBVHja7JcxCsIwFIb/V3oFx04v4iB4A3ev4Ak9iOABOhQcageHDh7iuVSwpW1eYmIFEwiFQvN9SZP/ERIRLNkyLNySQBLIhy+I6AhgE5F5FZHTpACAbV3X61h0Zs5nVwBAJiL0rd+eNuHvnQIArTEmplhrE7gAWEUUePSO/Vg1jJgFvQyYWoFoWTDMgLlNWDFzIyIUqjNzA6DSCpwBlMaYW4iZd+OU3bh2ARG5h5J4h3fj6nIghIQNbg2iTyQ0cFUS+kho4eoodpFwgTvVAo2EK9y5GM1J+MC9quGYhC98shaoPiQqAOwB7Hzhrxn1umMrABy6pxeT0t3w7wWeAwD5qe4YizvzugAAAABJRU5ErkJggg=="});
a.appendChild(d);var h=document.createElement("div");h.className="homeViewMenu";c.container.appendChild(h);var k=document.createElement("div");k.className="homeViewMenuItem";k.textContent=Autodesk.Viewing.i18n.translate("Set current view as Home");h.appendChild(k);k.addEventListener("click",function(a){f.setCurrentViewAsHome(!1);b(a)});k=document.createElement("div");k.className="homeViewMenuItem";k.textContent=Autodesk.Viewing.i18n.translate("Focus and set as Home");h.appendChild(k);k.addEventListener("click",
function(a){f.setCurrentViewAsHome(!0);b(a)});k=document.createElement("div");k.className="homeViewMenuItem";k.textContent=Autodesk.Viewing.i18n.translate("Reset Home");h.appendChild(k);k.addEventListener("click",function(a){f.resetHome();b(a)});a.addEventListener("mouseover",function(a){if(c.model&&c.model.is2d()||c.prefs&&!c.prefs.viewCube)d.style.display="block"});a.addEventListener("mouseleave",function(a){d.style.display="none"});d.addEventListener("click",function(a){if(c.model&&c.model.is2d()||
c.prefs&&!c.prefs.viewCube)h.style.display="block",document.addEventListener("click",b);a.stopPropagation()});a.addEventListener("contextmenu",function(a){if(c.model&&c.model.is2d()||c.prefs&&!c.prefs.viewCube)h.style.display="block",document.addEventListener("click",b)})},displayViewCube:function(a,b){!1!==b&&this.viewer.prefs.set("viewCube",a);if(a&&!this.cube)this.viewcube=document.createElement("div"),this.viewcube.className="viewcube",this.viewer.container.appendChild(this.viewcube),this.cube=
new Autocam.ViewCube("cube",this.viewer.autocam,this.viewcube,LOCALIZATION_REL_PATH);else if(!this.cube){this._positionHomeButton();return}this.viewcube.style.display=a?"block":"none";this._positionHomeButton();a&&this.viewer.autocam.refresh()},_positionHomeButton:function(){if(this.homeViewContainer){var a=this.cube&&this.viewcube&&"block"===this.viewcube.style.display,b=this.viewer.container.getBoundingClientRect(),c=this.homeViewContainer.getBoundingClientRect();a?(a=this.viewcube.getBoundingClientRect(),
b=b.left+b.width-a.left-c.width):this.infoButton?(a=this.infoButton.getBoundingClientRect(),b=b.left+b.width-a.left+a.width-c.width):b=10;this.homeViewContainer.style.right=b+"px"}},uninitialize:function(){this.viewer=null}};"use strict";AutodeskNamespace("Autodesk.Viewing.Private");AutodeskNamespace("Autodesk.Viewing.Extensions");function stringToDOM(a){var b=document.createElement("div");b.innerHTML=a;return b.firstChild}
(function(){var a=Autodesk.Viewing,b=Autodesk.Viewing.Private,c=Autodesk.Viewing.UI,f=Autodesk.Viewing.Extensions;a.TOOLBAR_CREATED_EVENT="toolbarCreated";a.TOOLBAR={NAVTOOLSID:"navTools",MODELTOOLSID:"modelTools",SETTINGSTOOLSID:"settingsTools"};b.GuiViewer3D=function(b,c){c||(c={});this.customizeConfig(c);a.Viewer3D.call(this,b,c);this.toolbar=null;this.dockingPanels=[];this.layersPanel=this.modelstructure=null};b.GuiViewer3D.prototype=Object.create(a.Viewer3D.prototype);b.GuiViewer3D.prototype.constructor=
b.GuiViewer3D;b.GuiViewer3D.prototype.customizeConfig=function(a){a.startOnInitialize=!1;a.hasOwnProperty("docStructureConfig")||(a.docStructureConfig=b.GuiViewer3D.kDefaultDocStructureConfig)};b.GuiViewer3D.prototype.resize=function(){a.Viewer3D.prototype.resize.call(this);this.resizePanels();this.centerToolBar&&this.centerToolBar()};b.GuiViewer3D.kDefaultDocStructureConfig={click:{onObject:["isolate"]},clickCtrl:{onObject:["toggleVisibility"]}};b.GuiViewer3D.prototype.initialize=function(){var c=
a.Viewer3D.prototype.initialize.call(this);if(0<c)return c;var g=this;this.toolController&&(c=new a.HotGestureTool(this),this.toolController.registerTool(c),this.toolController.activateTool(c.getName()));this.getToolbar(!0);this.addEventListener(a.FULLSCREEN_MODE_EVENT,function(a){g.resizePanels({viewer:g});g.updateFullscreenButton(a.mode)});this.contextMenu||this.setContextMenu(new f.ViewerObjectContextMenu(this));this.progressbar=new b.ProgressBar(this.container);this.addEventListener(a.PROGRESS_UPDATE_EVENT,
function(a){void 0!==a.percent&&g.progressbar.setPercent(a.percent)},!1);this.selectionActive=!1;this.addEventListener(a.SELECTION_CHANGED_EVENT,function(a){g.selectionActive=0<a.dbIdArray.length;g.prefs.openPropertiesOnSelect&&g.getPropertyPanel(!0).setVisible(g.selectionActive)});this.addEventListener(a.ISOLATE_EVENT,function(a){(g.prefs.openPropertiesOnSelect||a.nodeIdArray[0]===g.model.getRoot())&&g.propertygrid&&g.propertygrid.setVisible(0<a.nodeIdArray.length||g.selectionActive)});this.addEventListener(a.VIEWER_STATE_RESTORED_EVENT,
function(a){g.renderoptions&&g.renderoptions.syncUI();(a=g.getSettingsPanel(!0))&&a.syncUI()});this.initEscapeHandlers();this.localize();this.run();return 0};b.GuiViewer3D.prototype.uninitialize=function(){this.viewerSettingsPanel&&(this.viewerSettingsPanel.uninitialize(),this.viewerSettingsPanel=null);this.modelstructure&&(this.modelstructure.uninitialize(),this.modelstructure=null);this.layersPanel&&(this.layersPanel.uninitialize(),this.layersPanel=null);this.propertygrid&&(this.propertygrid.uninitialize(),
this.propertygrid=null);this.renderoptions&&(this.renderoptions.uninitialize(),this.renderoptions=null);a.theHotkeyManager.popHotkeys("Autodesk.ROLL");a.theHotkeyManager.popHotkeys("Autodesk.FOV");this.toolbar=this.debugMenu=this.navTools=this.modelTools=this.progressbar=null;a.Viewer3D.prototype.uninitialize.call(this)};b.GuiViewer3D.prototype.setUp=function(b){b||(b={});this.customizeConfig(b);this.getToolbar(!0);a.Viewer3D.prototype.setUp.call(this,b)};b.GuiViewer3D.prototype.tearDown=function(){a.Viewer3D.prototype.tearDown.call(this);
this.toolbar&&(this.toolbar.container.parentNode.removeChild(this.toolbar.container),this.toolbar=null);this.modelstructure&&this.setModelStructurePanel(null);this.propertygrid&&this.setPropertyPanel(null);this.viewerSettingsPanel&&this.setSettingsPanel(null);this.layersPanel&&this.setLayersPanel(null);this.renderoptions&&(this.removePanel(this.renderoptions),this.renderoptions.uninitialize(),this.renderoptions=null)};b.GuiViewer3D.prototype.loadModel=function(b,c,f,k,l){var n=this,q=function(){n.displayViewCube(n.prefs.viewCube);
n.removeEventListener(a.GEOMETRY_LOADED_EVENT,q)};-1!=b.indexOf(".f2d")?(this.createUI("2d"),n.prefs.useFirstPersonNav?this.unloadExtension("Autodesk.FirstPerson"):this.unloadExtension("Autodesk.Beeline"),this.setDefaultNavigationTool("pan"),this.setClickToSetCOI(!1,!1),this.displayViewCube(!1,!1)):(this.createUI("3d"),-1===this.getDefaultNavigationToolName().indexOf("orbit")&&this.setDefaultNavigationTool("orbit"),n.prefs.useFirstPersonNav?this.loadExtension("Autodesk.FirstPerson",null):this.loadExtension("Autodesk.Beeline",
null),this.loadExtension("Autodesk.Viewing.Oculus",null),this.prefs.fusionOrbit&&this.loadExtension("Autodesk.Viewing.FusionOrbit",null),this.loadExtension("Autodesk.Section",null),this.addEventListener(a.GEOMETRY_LOADED_EVENT,q));return a.Viewer3D.prototype.loadModel.call(this,b,c,f,k,l)};b.GuiViewer3D.prototype.createUI=function(d){var f=this;this.initHotkeys(d);this.loadExtension("Autodesk.DefaultTools.NavTools",{mode:d});this.initModelTools(d);ENABLE_DEBUG&&this.initDebugTools();this.fireEvent({type:a.TOOLBAR_CREATED_EVENT});
this.viewCubeUi||(this.viewCubeUi=new b.ViewCubeUi(this));this.viewCubeUi.create();this.centerToolBar=function(){f.toolbar.container.style.left="calc(50% - "+f.toolbar.getDimensions().width/2+"px)"};this.toolbar.addEventListener(c.ToolBar.Event.SIZE_CHANGED,this.centerToolBar);this.resize()};b.GuiViewer3D.prototype.addOptionToggle=function(b,c,f,k,l){var n=l?this.prefs[l]:null;f="boolean"===typeof n?n:f;n=document.createElement("li");n.className="toolbar-submenu-listitem";var q=document.createElement("input");
q.className="toolbar-submenu-checkbox";q.type="checkbox";q.id=c;n.appendChild(q);var m=document.createElement("label");m.setAttribute("for",c);m.setAttribute("data-i18n",c);m.textContent=a.i18n.translate(c);n.appendChild(m);b.appendChild(n);q.checked=f;q.addEventListener("touchstart",touchStartToClick);m.addEventListener("touchstart",touchStartToClick);n.addEventListener("touchstart",touchStartToClick);q.addEventListener("click",function(a){k(q.checked);a.stopPropagation()});m.addEventListener("click",
function(a){a.stopPropagation()});n.addEventListener("click",function(a){k(!q.checked);a.stopPropagation()});l&&this.prefs.addListeners(l,function(a){q.checked=a},function(a){q.checked=a;k(a)});return q};b.GuiViewer3D.prototype.addOptionList=function(b,c,f,k,l,n){var q=this.prefs[n];k="number"===typeof q?q:k;var m=document.createElement("select");m.className="optionDropDown";m.id="selectMenu_"+c;for(q=0;q<f.length;q++){var p=document.createElement("option");p.value=q;p.setAttribute("data-i18n",f[q]);
p.textContent=Autodesk.Viewing.i18n.translate(f[q]);m.add(p)}f=document.createElement("li");f.className="toolbar-submenu-select";q=document.createElement("div");q.className="toolbar-submenu-selectlabel";q.setAttribute("for",c);q.setAttribute("data-i18n",c);q.textContent=a.i18n.translate(c);f.appendChild(q);f.appendChild(m);b.appendChild(f);m.selectedIndex=k;m.onchange=function(a){l(a.target.selectedIndex);a.stopPropagation()};m.addEventListener("touchstart",function(a){a.stopPropagation()});m.addEventListener("click",
function(a){a.stopPropagation()});n&&this.prefs.addListeners(n,function(a){m.selectedIndex=a},function(a){m.selectedIndex=a;l(a)});return m};b.GuiViewer3D.prototype.showViewer3dOptions=function(a){var b=this.getSettingsPanel(!0);a&&b.isVisible()&&b.setVisible(!1);b.setVisible(a)};b.GuiViewer3D.prototype.showRenderingOptions=function(a){this.renderoptions.setVisible(a)};b.GuiViewer3D.prototype.showLayerManager=function(a){this.layersPanel.setVisible(a)};b.GuiViewer3D.prototype.initHotkeys=function(b){var c=
this,f=a.theHotkeyManager.KEYCODES;if("3d"===b){var k;a.theHotkeyManager.pushHotkeys("Autodesk.FOV",[{keycodes:[f.CONTROL,f.SHIFT],onPress:function(){if(c.toolController.getIsLocked())return!1;k=c.getActiveNavigationTool();c.setActiveNavigationTool("fov");return!0},onRelease:function(){if(c.toolController.getIsLocked())return!1;c.setActiveNavigationTool(k);return!0}}],{tryUntilSuccess:!0})}var l;a.theHotkeyManager.pushHotkeys("Autodesk.ROLL",[{keycodes:[f.ALT,f.SHIFT],onPress:function(){if(c.toolController.getIsLocked())return!1;
l=c.getActiveNavigationTool();c.setActiveNavigationTool("worldup");return!0},onRelease:function(){if(c.toolController.getIsLocked())return!1;c.setActiveNavigationTool(l);return!0}}],{tryUntilSuccess:!0})};b.GuiViewer3D.prototype.setModelStructurePanel=function(b){var f=this;if(b instanceof a.UI.ModelStructurePanel||null===b){this.modelstructure&&(this.modelstructure.setVisible(!1),this.removePanel(this.modelstructure),this.modelstructure.uninitialize());if(this.modelstructure=b)this.addPanel(this.modelstructure),
b.addVisibilityListener(function(a){if(a)f.onPanelVisible(b,f);f.settingsTools.structurebutton.setState(a?c.Button.State.ACTIVE:c.Button.State.INACTIVE)}),f.model&&f.model.getObjectTree(function(a){f.modelstructure.setModel(a)});return!0}return!1};b.GuiViewer3D.prototype.setLayersPanel=function(b){var f=this;if(this.model&&!this.model.is2d())return console.warn("av.Viewer3D.setLayersPanel is not yet implemented for 3D"),!1;if(b instanceof a.UI.LayersPanel||!b){this.layersPanel&&(this.layersPanel.setVisible(!1),
this.removePanel(this.layersPanel),this.layersPanel.uninitialize());if(this.layersPanel=b)this.addPanel(b),b.addVisibilityListener(function(a){if(a)f.onPanelVisible(b,f);f.settingsTools.layerButton.setState(a?c.Button.State.ACTIVE:c.Button.State.INACTIVE)});return!0}return!1};b.GuiViewer3D.prototype.setPropertyPanel=function(b){var f=this;if(b instanceof a.UI.PropertyPanel||!b){this.propertygrid&&(this.propertygrid.setVisible(!1),this.removePanel(this.propertygrid),this.propertygrid.uninitialize());
if(this.propertygrid=b)this.addPanel(b),b.addVisibilityListener(function(a){if(a)f.onPanelVisible(b,f);f.settingsTools.propertiesbutton.setState(a?c.Button.State.ACTIVE:c.Button.State.INACTIVE)});return!0}return!1};b.GuiViewer3D.prototype.getPropertyPanel=function(a){!this.propertygrid&&a&&this.setPropertyPanel(new f.ViewerPropertyPanel(this));return this.propertygrid};b.GuiViewer3D.prototype.setSettingsPanel=function(b){return b instanceof a.UI.SettingsPanel||!b?(this.viewerSettingsPanel&&(this.viewerSettingsPanel.setVisible(!1),
this.removePanel(this.viewerSettingsPanel),this.viewerSettingsPanel.uninitialize()),(this.viewerSettingsPanel=b)&&this.addPanel(b),!0):!1};b.GuiViewer3D.prototype.getSettingsPanel=function(a){!this.viewerSettingsPanel&&a&&this.setSettingsPanel(new f.ViewerSettingsPanel(this,this.model.is2d()?"2d":"3d"));return this.viewerSettingsPanel};b.GuiViewer3D.prototype.initModelTools=function(d){var g=this;if("3d"===d){g.modelstructure||g.setModelStructurePanel(new f.ViewerModelStructurePanel(g,"Browser",{docStructureConfig:g.config.docStructureConfig}));
var h=new c.Button("toolbar-modelStructureTool");h.setToolTip("Model browser");h.setIcon("adsk-icon-structure");h.onClick=function(a){g.showModelStructurePanel(!g.modelstructure.isVisible())};this.settingsTools.addControl(h);this.settingsTools.structurebutton=h;this.initExplodeSlider()}else h=new f.ViewerLayersPanel(this),this.setLayersPanel(h),h=new c.Button("toolbar-layersTool"),h.setToolTip("Layer Manager"),h.setIcon("adsk-icon-layers"),h.onClick=function(a){g.layersPanel||g.setLayersPanel(new f.ViewerLayersPanel(g));
g.showLayerManager(!g.layersPanel.isVisible())},this.settingsTools.addControl(h),this.settingsTools.layerButton=h;g.addEventListener(a.RESET_EVENT,function(){g.model&&!g.model.is2d()&&(g.explode(0),g.explodeSlider.value=0);g.showAll()});h=new c.Button("toolbar-propertiesTool");h.setToolTip("Properties");h.setIcon("adsk-icon-properties");h.onClick=function(a){a=g.getPropertyPanel(!0);a.setVisible(!a.isVisible())};h.setVisible(!g.prefs.openPropertiesOnSelect);this.settingsTools.addControl(h);this.settingsTools.propertiesbutton=
h;h=new f.ViewerSettingsPanel(this,d);this.setSettingsPanel(h);this.viewerOptionButton=h=new c.Button("toolbar-settingsTool");h.setIcon("adsk-icon-settings");h.setToolTip("Settings");this.settingsTools.addControl(h);this.createViewerOptionsMenu(d);ENABLE_DEBUG&&"3d"===d&&(this.renderoptions=new b.RenderOptionsPanel(this),this.addPanel(this.renderoptions),d=new c.Button("toolbar-renderOptionsTool"),d.setToolTip("Rendering options"),d.setIcon("adsk-icon-settings-render"),d.onClick=function(a){g.showRenderingOptions(!g.renderoptions.isVisible())},
this.settingsTools.addControl(d),this.renderoptionsbutton=d);this.canChangeScreenMode()&&(d=new c.Button("toolbar-fullscreenTool",{collapsible:!1}),d.setToolTip("Full screen"),d.setIcon("adsk-icon-fullscreen"),d.onClick=function(a){g.nextScreenMode()},this.settingsTools.addControl(d),this.settingsTools.fullscreenbutton=d,this.updateFullscreenButton(this.getScreenMode()))};b.GuiViewer3D.prototype.setPropertiesOnSelect=function(a){this.settingsTools.propertiesbutton.setVisible(!a)};b.GuiViewer3D.prototype.addDivider=
function(a){var b=document.createElement("li");b.className="toolbar-submenu-horizontal-divider";a.appendChild(b);return b};b.GuiViewer3D.prototype.createViewerOptionsMenu=function(c){function g(a){var b=h.getSettingsPanel(!0);b.isVisible()&&b.isTabSelected(a)?h.showViewer3dOptions(!1):(h.showViewer3dOptions(!0),b.selectTab(a))}var h=this,k=document.createElement("div");k.id="toolbar-settingsToolSubmenu";k.classList.add("toolbar-submenu");k.classList.add("toolbar-settings-sub-menu");k.classList.add("adsk-hidden");
k.mode=c;this.container.appendChild(k);if("3d"===c){c=[];for(var l=0;l<b.LightPresets.length;l++)c.push(b.LightPresets[l].name);this.viewerOptionButton.envList=this.addOptionList(k,"Background and lighting",c,4,function(a){h.blockEvent||(k.classList.toggle("adsk-hidden"),h.setLightPreset(a))},"lightPreset");this.selectLightPreset=function(a){h.blockEvent=!0;h.viewerOptionButton.envList&&(h.viewerOptionButton.envList.selectedIndex=h.impl.currentLightPreset());h.blockEvent=!1};h.addEventListener(a.RENDER_OPTION_CHANGED_EVENT,
this.selectLightPreset);this.viewerOptionButton.displayLines=this.addOptionToggle(k,"Display Lines",!0,function(a){h.hideLines(!a)},"lineRendering");this.addDivider(k)}c=document.createElement("li");c.className="toolbar-submenu-listitem";l=document.createElement("label");l.setAttribute("data-i18n","Performance and appearance settings");l.textContent=a.i18n.translate("Performance and appearance settings");c.appendChild(l);this.show3dOptionsPerformanceTab=function(){g(f.ViewerSettingTab.Performance)};
this.viewerOptionButton.performanceOption=c;this.viewerOptionButton.performanceOption.addEventListener("touchstart",touchStartToClick);this.viewerOptionButton.performanceOption.addEventListener("click",this.show3dOptionsPerformanceTab);k.appendChild(this.viewerOptionButton.performanceOption);this.addDivider(k);c=document.createElement("li");c.className="toolbar-submenu-listitem";l=document.createElement("label");l.setAttribute("data-i18n","Navigation and selection settings");l.textContent=a.i18n.translate("Navigation and selection settings");
c.appendChild(l);this.show3dOptionsNavigationTab=function(){g(f.ViewerSettingTab.Navigation)};this.viewerOptionButton.navigationOption=c;this.viewerOptionButton.navigationOption.addEventListener("touchstart",touchStartToClick);this.viewerOptionButton.navigationOption.addEventListener("click",this.show3dOptionsNavigationTab);k.appendChild(c);k.style.width=k.getBoundingClientRect().width+"px";this.container.removeChild(k);this.viewerOptionButton.onClick=function(a){k.classList.toggle("adsk-hidden")};
this.viewerOptionButton.container.appendChild(k);this.viewerOptionButton.subMenu=k};b.GuiViewer3D.prototype.removeViewerOptionsMenu=function(a){this.viewerOptionButton.container.removeChild(this.viewerOptionButton.subMenu);"3d"===a&&(this.removeEventListener(Autodesk.Viewing.RENDER_OPTION_CHANGED_EVENT,this.selectLightPreset),this.viewerOptionButton.envList=null);this.viewerOptionButton.navigationOption.removeEventListener("touchstart",touchStartToClick);this.viewerOptionButton.navigationOption.removeEventListener("click",
this.show3dOptionsNavigationTab);this.viewerOptionButton.navigationOption=null;this.viewerOptionButton.performanceOption.removeEventListener("touchstart",touchStartToClick);this.viewerOptionButton.performanceOption.removeEventListener("click",this.show3dOptionsPerformanceTab);this.viewerOptionButton.performanceOption=null};b.GuiViewer3D.prototype.initDebugTools=function(){var a=new c.ControlGroup("debugTools");this.debugMenu=a;var b=new c.Button("toolbar-debugTool");b.setIcon("adsk-icon-bug");a.addControl(b);
this.debugMenu.debugSubMenuButton=b;this.createDebugSubmenu(this.debugMenu.debugSubMenuButton);this.toolbar.addControl(a)};b.GuiViewer3D.prototype.createDebugSubmenu=function(a){function c(){f.localize()}var f=this,k=document.createElement("div");k.id="toolbar-debugToolSubmenu";k.classList.add("toolbar-submenu");k.classList.add("toolbar-settings-sub-menu");k.classList.add("adsk-hidden");this.debugMenu.subMenu=k;this.debugMenu.subMenu.style.minWidth="180px";this.container.appendChild(k);this.initModelStats();
this.addDivider(k);this.addDivider(k);var l="en ru ja ko zh-Hant sp".split(" ");this.addOptionList(k,"Language","English Russian Japanese Korean Chinese Spanish(unsupported)".split(" "),f.selectedLanguage?f.selectedLanguage:0,function(a){var d=l[a];f.selectedLanguage=a;b.setLanguage(d,c)},null).parentNode.style.paddingBottom="15px";this.addDivider(this.debugMenu.subMenu);this.addOptionList(k,"Error","UNKNOWN FAILURE; BAD DATA;NETWORK ERROR;NETWORK ACCESS DENIED;NETWORK FILE NOT FOUND; NETWORK SERVER ERROR;NETWORK UNHANDLED RESPONSE CODE;BROWSER WEBGL NOT SUPPORTED;BAD DATA NO VIEWABLE CONTENT".split(";"),
0,function(a){b.ErrorHandler.reportError(f.container,a+1,"")},null).parentNode.style.paddingBottom="15px";var n=k.getBoundingClientRect();this.debugMenu.subMenu.style.width=n.width+"px";this.container.removeChild(k);a.container.appendChild(k);var n=n.left+n.width,q=this.container.getBoundingClientRect().right;n>q&&(this.debugMenu.subMenu.style.left=-(n-q+10)+"px");a.onMouseOver=function(a){k.classList.remove("adsk-hidden")};a.onMouseOut=function(a){k.classList.add("adsk-hidden")};isTouchDevice()&&
(a.onClick=function(a){k.classList.toggle("adsk-hidden")})};b.GuiViewer3D.prototype.initModelStats=function(){function b(a){var c=f.impl,d="";f.model&&(d+="Geom&nbsp;polys:&nbsp;"+c.modelQueue().getGeometryList().geomPolyCount+"<br>",d+="Instance&nbsp;polys:&nbsp;"+c.modelQueue().getGeometryList().instancePolyCount+"<br>",d+="Fragments:&nbsp;"+c.modelQueue().getFragmentList().getCount()+"<br>",d+="Geoms:&nbsp;"+c.modelQueue().getGeometryList().geoms.length+"<br>");f.modelStats.innerHTML=d+("# "+(a||
""))}function c(){f.modelStats=document.createElement("div");f.modelStats.className="statspanel";f.container.appendChild(f.modelStats);f.addEventListener(a.PROGRESS_UPDATE_EVENT,function(a){a.message&&b(a.message)})}var f=this;this.addOptionToggle(this.debugMenu.subMenu,"Model statistics",!1,function(a){a&&!f.modelStats&&(c(),b(""));f.modelStats.style.visibility=a?"visible":"hidden"})};b.GuiViewer3D.prototype.initEscapeHandlers=function(){var c=this;this.addEventListener(a.ESCAPE_EVENT,function(a){if(!c.contextMenu||
!c.contextMenu.hide())if(c.renderoptions&&c.renderoptions.isVisible())c.renderoptions.setVisible(!1);else if(c.getActiveNavigationTool()!==c.getDefaultNavigationToolName())c.toolController&&c.toolController.setIsLocked(!1),c.setActiveNavigationTool(),b.HudMessage.dismiss();else if(c.selectionActive)c.clearSelection();else if(!c.areAllVisible())c.showAll();else if(!b.AlertBox.dismiss()){for(a=0;a<c.dockingPanels.length;++a){var f=c.dockingPanels[a];if("none"!==f.container.style.display&&""!==f.container.style.display){f.container===
c.modelstructure?c.showModelStructurePanel(!1):f.setVisible(!1);return}}c.escapeScreenMode()}})};b.GuiViewer3D.prototype.displayViewCube=function(a,b){this.viewCubeUi.displayViewCube(a,b)};b.GuiViewer3D.prototype.getToolbar=function(b){!this.toolbar&&b&&(b=a.UI,this.toolbar=new b.ToolBar("guiviewer3d-toolbar"),this.navTools=new b.RadioButtonGroup(a.TOOLBAR.NAVTOOLSID),this.modelTools=new b.ControlGroup(a.TOOLBAR.MODELTOOLSID),this.settingsTools=new b.ControlGroup(a.TOOLBAR.SETTINGSTOOLSID),this.toolbar.addControl(this.navTools),
this.toolbar.addControl(this.modelTools),this.toolbar.addControl(this.settingsTools),this.container.appendChild(this.toolbar.container));return this.toolbar};b.GuiViewer3D.prototype.showModelStructurePanel=function(a){this.modelstructure.setVisible(a)};b.GuiViewer3D.prototype.onPanelVisible=function(a){this.dockingPanels.splice(this.dockingPanels.indexOf(a),1);this.dockingPanels.splice(0,0,a)};b.GuiViewer3D.prototype.updateFullscreenButton=function(b){var c="adsk-icon-fullscreen";switch(b){case a.ScreenMode.kNormal:this.isScreenModeSupported(a.ScreenMode.kFullBrowser)||
(c="adsk-icon-fullscreen");break;case a.ScreenMode.kFullBrowser:c=this.isScreenModeSupported(a.ScreenMode.kFullScreen)?"adsk-icon-fullscreen":"adsk-icon-fullscreen-exit";break;case a.ScreenMode.kFullScreen:c="adsk-icon-fullscreen-exit"}this.settingsTools.fullscreenbutton.setIcon(c)};b.GuiViewer3D.prototype.localize=function(){a.i18n.localize();if(this.viewerOptionButton&&this.viewerOptionButton.subMenu){var c=this.viewerOptionButton.subMenu.mode;this.removeViewerOptionsMenu(c);this.createViewerOptionsMenu(c)}this.debugMenu&&
this.debugMenu.debugSubMenuButton&&(this.debugMenu.debugSubMenuButton.removeChild(this.debugMenu.subMenu),this.createDebugSubmenu(this.debugMenu.debugSubMenuButton));b.ErrorHandler.localize()};b.GuiViewer3D.prototype.addPanel=function(a){return-1===this.dockingPanels.indexOf(a)?(this.dockingPanels.push(a),!0):!1};b.GuiViewer3D.prototype.removePanel=function(a){a=this.dockingPanels.indexOf(a);return-1<a?(this.dockingPanels.splice(a,1),!0):!1};b.GuiViewer3D.prototype.resizePanels=function(a){a=a||{};
var b=this.toolbar.getDimensions().height,c=this.getDimensions(),f=c.height;a.dimensions&&a.dimensions.height?f=a.dimensions.height:a.dimensions={height:c.height,width:c.width};a.dimensions.height=f-b;(c=a?a.viewer:null)||(c=this);b=a?a.dockingPanels:null;b||(b=c.dockingPanels);var l=c.container.getBoundingClientRect(),c=l.top,f=l.bottom,n=l.left,q=l.right,m;a&&a.dimensions?(m=a.dimensions.width,f=l=a.dimensions.height):(m=l.width,l=l.height);for(a=0;a<b.length;++a){var p=b[a].container,t=p.getBoundingClientRect(),
v=t.top,v=t.bottom,D=t.left,D=t.right,w=t.width,t=t.height;if(w&&t){m<w&&(w=Math.round(m),p.style.width=w+"px");l<t&&(t=Math.round(l),p.style.height=t+"px");if(q<D||p.dockRight)D=Math.round(q-w-n),p.style.left=D+"px";if(f<v||p.dockBottom)v=Math.round(f-t-c),0>v&&(v=0),p.style.top=v+"px";p.style.maxWidth=Math.round(m)+"px";p.style.maxHeight=Math.round(l)+"px"}}};b.GuiViewer3D.prototype.initExplodeSlider=function(){var a=this,b=new c.Button("toolbar-explodeTool");b.setIcon("adsk-icon-explode");b.setToolTip("Explode");
a.modelTools.addControl(b,{index:0});var f=stringToDOM('<div class="explode-submenu" style="display:none"><input class="explode-slider" type="range" min="0" max="1" step="0.01" value="0"></input></div>'),k;k=document.querySelector("#toolbar-explodeTool").parentNode;f.classList.add("ios");k.appendChild(f);var l=f.querySelector(".explode-slider");a.explodeSlider=l;l.oninput=function(b){a.explode(l.value)};f.onclick=function(a){a.stopPropagation()};var n=b.container.querySelector(".adsk-control-tooltip");
b.onClick=function(a){a=b.getState();a===c.Button.State.INACTIVE?(b.setState(c.Button.State.ACTIVE),n.style.display="none",f.style.display=""):a===c.Button.State.ACTIVE&&(b.setState(c.Button.State.INACTIVE),n.style.display="",l.parentNode.style.display="none")}};b.GuiViewer3D.prototype.initInspectTools=function(){var a=new c.Button("toolbar-inspectTools");a.setToolTip("Inspect");a.setIcon("measure");a.setVisible(!1);this.modelTools.addControl(a);var b=new c.RadioButtonGroup("toolbar-inspectSubMenu");
b.addClass("toolbar-vertical-group");b.setVisible(!1);this.modelTools.addControl(b);a.container.insertBefore(b.container,a.container.firstChild);a.onMouseOver=function(){b.setVisible(!0)};a.onMouseOut=function(){b.setVisible(!1)};isTouchDevice()&&(a.onClick=function(a){b.setVisible(!b.isVisible())})}})();AutodeskNamespace("Autodesk.Viewing.UI");
(function(){var a=Autodesk.Viewing,b=Autodesk.Viewing.UI;b.Control=function(a,b){this._id=a;this._isCollapsible=!b||b.collapsible;this._toolTipElement=null;this._listeners={};this.container=document.createElement("div");this.container.id=a;this.addClass("adsk-control")};b.Control.Event={VISIBILITY_CHANGED:"Control.VisibilityChanged",COLLAPSED_CHANGED:"Control.CollapsedChanged"};a.EventDispatcher.prototype.apply(b.Control.prototype);b.Control.prototype.constructor=b.Control;b.Control.prototype.container=
null;b.Control.prototype.getId=function(){return this._id};b.Control.prototype.setVisible=function(a){if(!this.container.classList.contains("adsk-hidden")===a)return!1;a?this.container.classList.remove("adsk-hidden"):this.container.classList.add("adsk-hidden");this.fireEvent({type:b.Control.Event.VISIBILITY_CHANGED,target:this,controlId:this._id,isVisible:a});return!0};b.Control.prototype.isVisible=function(){return!this.container.classList.contains("adsk-hidden")};b.Control.prototype.setToolTip=
function(a){if(this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")===a)return!1;this._toolTipElement||(this._toolTipElement=document.createElement("div"),this._toolTipElement.id=this._id+"-tooltip",this._toolTipElement.classList.add("adsk-control-tooltip"),this.container.appendChild(this._toolTipElement));this._toolTipElement.setAttribute("data-i18n",a);this._toolTipElement.setAttribute("tooltipText",a);this._toolTipElement.textContent=Autodesk.Viewing.i18n.translate(a,{defaultValue:a});
return!0};b.Control.prototype.getToolTip=function(){return this._toolTipElement&&this._toolTipElement.getAttribute("tooltipText")};b.Control.prototype.setCollapsed=function(a){if(!this._isCollapsible||this.isCollapsed()===a)return!1;a?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed");this.fireEvent({type:b.Control.Event.COLLAPSED_CHANGED,isCollapsed:a});return!0};b.Control.prototype.isCollapsed=function(){return!!this.container.classList.contains("collapsed")};
b.Control.prototype.isCollapsible=function(){return this._isCollapsible};b.Control.prototype.addClass=function(a){this.container.classList.add(a)};b.Control.prototype.removeClass=function(a){this.container.classList.remove(a)};b.Control.prototype.getPosition=function(){var a=this.container.getBoundingClientRect();return{top:a.top,left:a.left}};b.Control.prototype.getDimensions=function(){var a=this.container.getBoundingClientRect();return{width:a.width,height:a.height}}})();AutodeskNamespace("Autodesk.Viewing.UI");
(function(){var a=Autodesk.Viewing.UI;a.ControlGroup=function(b,c){a.Control.call(this,b,c);var f=this;this._controls=[];this.addClass("adsk-control-group");this.handleChildSizeChanged=function(b){f.fireEvent({type:a.ControlGroup.Event.SIZE_CHANGED,childEvent:b})}};a.ControlGroup.Event={VISIBILITY_CHANGED:a.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:a.Control.Event.COLLAPSED_CHANGED,SIZE_CHANGED:"ControlGroup.SizeChanged",CONTROL_ADDED:"ControlGroup.ControlAdded",CONTROL_REMOVED:"ControlGroup.ControlRemoved"};
a.ControlGroup.prototype=Object.create(a.Control.prototype);a.ControlGroup.prototype.constructor=a.ControlGroup;a.ControlGroup.prototype.addControl=function(b,c){var f=c&&void 0!==c.index?c.index:this._controls.length;if(null!==this.getControl(b.getId()))return!1;var d={type:a.ControlGroup.Event.CONTROL_ADDED,control:b,index:f};f<this._controls.length?(this.container.insertBefore(b.container,this._controls[f].container),this._controls.splice(f,0,b)):(this.container.appendChild(b.container),this._controls.push(b));
b.addEventListener(a.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged);b.addEventListener(a.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged);b instanceof a.ControlGroup&&b.addEventListener(a.ControlGroup.Event.SIZE_CHANGED,this.handleChildSizeChanged);this.fireEvent(d);this.fireEvent(a.ControlGroup.Event.SIZE_CHANGED);return!0};a.ControlGroup.prototype.indexOf=function(a){for(var c=0;c<this._controls.length;c++){var f=this._controls[c];if(f===a||"string"===typeof a&&a===f.getId())return c}return-1};
a.ControlGroup.prototype.removeControl=function(b){b="string"===typeof b?this.getControl(b):b;if(!b)return!1;var c=this._controls.indexOf(b);this._controls.splice(c,1);this.container.removeChild(b.container);c={type:a.ControlGroup.Event.CONTROL_REMOVED,control:b,index:c};b.removeEventListener(a.Control.Event.VISIBILITY_CHANGED,this.handleChildSizeChanged);b.removeEventListener(a.Control.Event.COLLAPSED_CHANGED,this.handleChildSizeChanged);b instanceof a.ControlGroup&&b.removeEventListener(a.ControlGroup.Event.SIZE_CHANGED,
this.handleChildSizeChanged);this.fireEvent(c);this.fireEvent(a.ControlGroup.Event.SIZE_CHANGED);return!0};a.ControlGroup.prototype.getControl=function(a){for(var c=0;c<this._controls.length;c++)if(a===this._controls[c].getId())return this._controls[c];return null};a.ControlGroup.prototype.getNumberOfControls=function(){return this._controls.length};a.ControlGroup.prototype.setCollapsed=function(b){if(!this._isCollapsible)return!1;var c=!1;this._controls.forEach(function(a){a.isCollapsible()&&a.setCollapsed(b)&&
(c=!0)});c&&(b?this.container.classList.add("collapsed"):this.container.classList.remove("collapsed"),this.fireEvent({type:a.ControlGroup.Event.COLLAPSED_CHANGED,isCollapsed:b}));return c}})();AutodeskNamespace("Autodesk.Viewing.UI");
(function(){var a=Autodesk.Viewing.UI;a.ToolBar=function(b,c){a.ControlGroup.call(this,b,c);this.removeClass("adsk-control-group");this.addClass("adsk-toolbar")};a.ToolBar.Event={VISIBILITY_CHANGED:a.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:a.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:a.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:a.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:a.ControlGroup.Event.SIZE_CHANGED};a.ToolBar.prototype=Object.create(a.ControlGroup.prototype);a.ToolBar.prototype.constructor=
a.ToolBar})();AutodeskNamespace("Autodesk.Viewing.UI");
(function(){var a=Autodesk.Viewing.UI;a.Button=function(b,c){a.Control.call(this,b,c);var f=this;this._state=a.Button.State.INACTIVE;this.icon=document.createElement("div");this.icon.classList.add("adsk-button-icon");this.container.appendChild(this.icon);this.container.addEventListener("click",function(b){f.fireEvent(a.Button.Event.CLICK);if(f.onClick)f.onClick(b);b.stopPropagation()});isTouchDevice()?this.container.addEventListener("touchstart",touchStartToClick):(this.container.addEventListener("mouseover",
function(a){f.onMouseOver(a)}),this.container.addEventListener("mouseout",function(a){f.onMouseOut(a)}));this.addClass("adsk-button");this.addClass(a.Button.StateToClassMap[this._state])};a.Button.Event={VISIBILITY_CHANGED:a.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:a.Control.Event.COLLAPSED_CHANGED,STATE_CHANGED:"Button.StateChanged",CLICK:"click"};a.Button.State={ACTIVE:0,INACTIVE:1,DISABLED:2};a.Button.StateToClassMap=function(){var b=a.Button.State,c={};c[b.ACTIVE]="active";c[b.INACTIVE]=
"inactive";c[b.DISABLED]="disabled";return c}();a.Button.prototype=Object.create(a.Control.prototype);a.Button.prototype.constructor=a.Button;a.Button.prototype.setState=function(b){if(b===this._state)return!1;this.removeClass(a.Button.StateToClassMap[this._state]);this.addClass(a.Button.StateToClassMap[b]);this._state=b;this.fireEvent({type:a.Button.Event.STATE_CHANGED,state:b});return!0};a.Button.prototype.setIcon=function(a){this.iconClass&&this.icon.classList.remove(this.iconClass);this.iconClass=
a;this.icon.classList.add(a)};a.Button.prototype.getState=function(){return this._state};a.Button.prototype.onClick=function(a){};a.Button.prototype.onMouseOver=function(a){};a.Button.prototype.onMouseOut=function(a){}})();AutodeskNamespace("Auodesk.Viewing.UI");
(function(){var a=Autodesk.Viewing.UI;a.ComboButton=function(b,c){a.Button.call(this,b,c);this.arrowButton=new a.Button(b+"arrow");this.arrowButton.addClass("adsk-button-arrow");this.arrowButton.removeClass("adsk-button");this.subMenu=new a.RadioButtonGroup(b+"SubMenu");this.subMenu.addClass("toolbar-vertical-group");this.subMenu.setVisible(!1);this.container.insertBefore(this.subMenu.container,this.container.firstChild);this.container.insertBefore(this.arrowButton.container,this.container.firstChild);
var f=this;this.arrowButton.onClick=function(a){f.subMenu.setVisible(!f.subMenu.isVisible())};this.toggleFlyoutVisible=function(){f.subMenu.setVisible(!f.subMenu.isVisible())};this.subMenuActiveButtonChangedHandler=function(b){b.isActiveButton?(f.setIcon(b.target.getActiveButton().iconClass),f.setToolTip(b.target.getActiveButton().getToolTip()),f.setState(a.Button.State.ACTIVE),f.onClick=b.button.onClick):f.setState(a.Button.State.INACTIVE)};this.subMenu.addEventListener(a.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,
this.subMenuActiveButtonChangedHandler)};a.ComboButton.prototype=Object.create(a.Button.prototype);a.ComboButton.prototype.constructor=a.ComboButton;a.ComboButton.prototype.addControl=function(b){this.subMenu.addControl(b);b.addEventListener(a.Button.Event.CLICK,this.toggleFlyoutVisible)};a.ComboButton.prototype.removeControl=function(b){b.removeEventListener(a.Button.Event.CLICK,this.toggleFlyoutVisible)};a.ComboButton.prototype.setState=function(b){if(b===a.Button.State.INACTIVE){var c=this.subMenu.getActiveButton();
c&&c.setState(a.Button.State.INACTIVE)}a.Button.prototype.setState.call(this,b)}})();AutodeskNamespace("Autodesk.Viewing.UI");
(function(){var a=Autodesk.Viewing.UI;a.RadioButtonGroup=function(b,c){a.ControlGroup.call(this,b,c);var f=this;this._activeButton=null;this._handleButtonStateChange=function(b){var c=a.Button.State;b.state!==c.ACTIVE?b.target===f._activeButton&&(f._activeButton=null,f.fireEvent({type:a.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,button:b.target,isActiveButton:!1})):(f._activeButton=b.target,f.fireEvent({type:a.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,button:b.target,isActiveButton:!0}),f._controls.forEach(function(a){a!==
b.target&&a.getState()!==c.DISABLED&&a.setState(c.INACTIVE)}))}};a.RadioButtonGroup.Event={ACTIVE_BUTTON_CHANGED:"RadioButtonGroup.ActiveButtonChanged",VISIBILITY_CHANGED:a.Control.Event.VISIBILITY_CHANGED,COLLAPSED_CHANGED:a.Control.Event.COLLAPSED_CHANGED,CONTROL_ADDED:a.ControlGroup.Event.CONTROL_ADDED,CONTROL_REMOVED:a.ControlGroup.Event.CONTROL_REMOVED,SIZE_CHANGED:a.ControlGroup.Event.SIZE_CHANGED};a.RadioButtonGroup.prototype=Object.create(a.ControlGroup.prototype);a.RadioButtonGroup.prototype.constructor=
a.RadioButtonGroup;a.RadioButtonGroup.prototype.addControl=function(b,c){return b instanceof a.Button?a.ControlGroup.prototype.addControl.call(this,b,c)?(b.addEventListener(a.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0):!1:!1};a.RadioButtonGroup.prototype.removeControl=function(b){b="string"==typeof b?this.getControl(b):b;return null!==b&&a.ControlGroup.prototype.removeControl.call(this,b)?(b.removeEventListener(a.Button.Event.STATE_CHANGED,this._handleButtonStateChange),!0):!1};
a.RadioButtonGroup.prototype.getActiveButton=function(){return this._activeButton}})();AutodeskNamespace("Autodesk.Viewing.Extensions");
Autodesk.Viewing.Extensions.ViewerPanelMixin=function(){this.getContainerBoundingRect=function(){var a=this.parentContainer.getBoundingClientRect(),b={height:0,width:0,left:0,bottom:0,right:0,top:0},c=document.getElementsByClassName("toolbar-menu");c&&0<c.length&&(b=c[0].getBoundingClientRect());return{height:a.height-b.height,width:a.width,left:a.left,bottom:a.bottom-b.height,right:a.right,top:a.top}}};AutodeskNamespace("Autodesk.Viewing.Extensions");AutodeskNamespace("Autodesk.Viewing.UI");
(function(){var a=Autodesk.Viewing,b=Autodesk.Viewing.UI,c=Autodesk.Viewing.Extensions;c.ViewerModelStructurePanel=function(a,c,g){this.viewer=a;g=g||{};g.heightAdjustment=75;b.ModelStructurePanel.call(this,a.container,a.container.id+"ViewerModelStructurePanel",c,g);this.clickConfig=g&&g.docStructureConfig?g.docStructureConfig:null;this.isMac=-1!==navigator.userAgent.search("Mac OS");this.initSearchBox();this.prevSearchResults=[];this.prevSearchString=""};c.ViewerModelStructurePanel.prototype=Object.create(b.ModelStructurePanel.prototype);
c.ViewerModelStructurePanel.prototype.constructor=c.ViewerModelStructurePanel;c.ViewerPanelMixin.call(c.ViewerModelStructurePanel.prototype);c.ViewerModelStructurePanel.prototype.initialize=function(){b.ModelStructurePanel.prototype.initialize.call(this);var c=this;c.addEventListener(c.viewer,a.SELECTION_CHANGED_EVENT,function(a){c.setSelection(a.nodeArray.slice())});c.addEventListener(c.viewer,a.ISOLATE_EVENT,function(a){c.setIsolation(a.nodeIdArray.slice())});c.addEventListener(c.viewer,a.HIDE_EVENT,
function(a){c.setHidden(a.nodeIdArray.slice(),!0)});c.addEventListener(c.viewer,a.SHOW_EVENT,function(a){c.setHidden(a.nodeIdArray.slice(),!1)})};c.ViewerModelStructurePanel.prototype.uninitialize=function(){this.viewer=null;b.ModelStructurePanel.prototype.uninitialize.call(this)};c.ViewerModelStructurePanel.prototype.handleAction=function(a,b){for(var c in a)switch(a[c]){case "selectOnly":this.viewer.select([b.dbId]);break;case "deselectAll":this.viewer.select([]);break;case "selectToggle":this.viewer.toggleSelect(b.dbId);
break;case "isolate":this.viewer.isolate(b);break;case "showAll":this.viewer.isolate(null);break;case "focus":this.viewer.fitToView();break;case "hide":this.viewer.hide(b);break;case "show":this.viewer.show(b);break;case "toggleVisibility":this.viewer.toggleVisibility(b)}};c.ViewerModelStructurePanel.prototype.ctrlDown=function(a){return this.isMac&&a.metaKey||!this.isMac&&a.ctrlKey};c.ViewerModelStructurePanel.prototype.onClick=function(a,b){if(!this.isMac||!b.ctrlKey){var c="click";this.ctrlDown(b)&&
(c+="Ctrl");b.shiftKey&&(c+="Shift");b.altKey&&(c+="Alt");this.clickConfig&&this.clickConfig[c]?this.handleAction(this.clickConfig[c].onObject,a):this.viewer.select([a.dbId])}};c.ViewerModelStructurePanel.prototype.onDoubleClick=function(a,b){this.handleAction(["focus"],a)};c.ViewerModelStructurePanel.prototype.onRightClick=function(a,b){if(this.isMac&&b.ctrlKey&&0===b.button)return this.clickConfig&&this.clickConfig.clickCtrl?this.handleAction(this.clickConfig.clickCtrl.onObject,a):this.viewer.select([a.dbId]),
null;var c=[],h=!0;if(b.shiftKey||this.isMac&&b.metaKey||b.ctrlKey&&(this.isMac||2===b.button))for(var k=this.viewer.impl.selector.getSelection(),l=0;l<k.length;++l)k[l].dbId!==a.dbId?c.push(k[l].dbId):h=!1;h&&c.push(a.dbId);this.viewer.select(c);return this.viewer.contextMenu.show(b)};c.ViewerModelStructurePanel.prototype.setHidden=function(a,b){function c(a,f){f.classList.toggle("dim",b);f.classList.toggle("visible",!b)}for(var h=0;h<a.length;++h)this.tree.iterate(a[h],c)};c.ViewerModelStructurePanel.prototype.setIsolation=
function(a){if(this.modelRoot&&(this.tree&&this.tree.iterate(this.modelRoot,function(a,b){b.classList.remove("dim");b.classList.remove("visible")}),0<a.length&&(1!==a.length||a[0]!==this.modelRoot))){this.setHidden([this.modelRoot],!0);for(var b=0;b<a.length;++b)this.setHidden([a[b]],!1)}};c.ViewerModelStructurePanel.prototype.initSearchBox=function(){function b(){if(!h.isSearching){for(var a=0;a<h.prevSearchResults.length;a++)h.tree.setCollapsed(h.prevSearchResults[a],!0,!0);0===c.value.length?(h.isSearching=
!1,h.prevSearchString="",g.isolate()):h.prevSearchString!=c.value&&(h.isSearching=!0,g.search(c.value,function(a){g.isolateById(a);if(a.length){for(var b=0;b<a.length;b++)h.tree.setCollapsed(a[b],!1,!0);h.resizeToContent();h.tree.scrollTo(a[0])}h.prevSearchResults=a;h.isSearching=!1},null,["name"]))}}var c=document.createElement("input");c.className="toolbar-search-box";c.type="search";c.results=5;c.placeholder=a.i18n.translate("Filter by name");c.incremental="incremental";c.autosave=this.container.id+
"search_autosave";c.setAttribute("data-i18n","[placeholder]Filter by name");this.scrollContainer.parentNode.insertBefore(c,this.scrollContainer);var g=this.viewer,h=this,k;c.addEventListener("input",function(a){clearTimeout(k);k=setTimeout(b,500)});c.addEventListener("change",function(a){clearTimeout(k);b()})}})();AutodeskNamespace("Autodesk.Viewing.Extensions");
Autodesk.Viewing.Extensions.ViewerPropertyPanel=function(a){this.viewer=a;this.currentNodeIds=[];this.isSelection=!1;this.isDirty=!0;this.propertyNodeId=null;Autodesk.Viewing.UI.PropertyPanel.call(this,a.container,"ViewerPropertyPanel","Object Properties Loading...")};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype=Object.create(Autodesk.Viewing.UI.PropertyPanel.prototype);Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.constructor=Autodesk.Viewing.Extensions.ViewerPropertyPanel;
Autodesk.Viewing.Extensions.ViewerPanelMixin.call(Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype);
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.initialize=function(){function a(a){for(var b=[],d=0;d<a.length;d++){var g=a[d].dbId;g&&b.push(g)}return b}Autodesk.Viewing.UI.PropertyPanel.prototype.initialize.call(this);var b=this;b.addEventListener(b.viewer,Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){b.currentNodeIds=a.dbIdArray;b.isSelection=0<a.dbIdArray.length;b.isDirty=!0;b.requestProperties()});b.addEventListener(b.viewer,Autodesk.Viewing.ISOLATE_EVENT,function(c){0==c.nodeIdArray.length&&
b.isSelection||(b.currentNodeIds=a(c.nodeIdArray),b.isDirty=!0,b.requestProperties())});b.addEventListener(b.viewer,Autodesk.Viewing.HIDE_EVENT,function(a){b.isDirty=!0;b.requestProperties()});b.addEventListener(b.viewer,Autodesk.Viewing.SHOW_EVENT,function(a){b.isDirty=!0;b.requestProperties()});this.currentNodeIds=a(b.viewer.getSelection());0===this.currentNodeIds.length?this.currentNodeIds=a(b.viewer.getIsolatedNodes()):this.isSelection=!0};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.setTitle=function(a,b){a||(a="Object Properties",b=b||{},b.localizeTitle=!0);Autodesk.Viewing.UI.PropertyPanel.prototype.setTitle.call(this,a,b)};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.setVisible=function(a){Autodesk.Viewing.UI.DockingPanel.prototype.setVisible.call(this,a);this.requestProperties()};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.visibilityChanged=function(){Autodesk.Viewing.UI.DockingPanel.prototype.visibilityChanged.call(this);this.isVisible()&&this.requestProperties()};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.requestProperties=function(){this.isVisible()&&this.isDirty&&(0<this.currentNodeIds.length?this.setNodeProperties(this.currentNodeIds[this.currentNodeIds.length-1]):this.showDefaultProperties(),this.isDirty=!1)};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.setNodeProperties=function(a){var b=this;this.propertyNodeId=a;b.viewer.getProperties(a,function(a){b.setTitle(a.name);b.setProperties(a.properties);b.highlight(b.viewer.searchText);b.resizeToContent();if(b.isVisible()){var f=b.viewer.toolController;a=f.lastClickX;var f=f.lastClickY,d=b.container.getBoundingClientRect(),g=d.left,h=d.top,k=d.width,d=d.height,l=b.viewer.canvas.getBoundingClientRect(),n=l.left,q=l.top,m=l.width,l=l.height;g<=
a&&a<g+k&&h<=f&&f<h+d&&(a<g+k/2&&a+k<n+m?(b.container.style.left=Math.round(a-n)+"px",b.container.dockRight=!1):n<=a-k?(b.container.style.left=Math.round(a-n-k)+"px",b.container.dockRight=!1):a+k<n+m?(b.container.style.left=Math.round(a-n)+"px",b.container.dockRight=!1):f+d<q+l?(b.container.style.top=Math.round(f-q)+"px",b.container.dockBottom=!1):q<=f-d&&(b.container.style.top=Math.round(f-q-d)+"px",b.container.dockBottom=!1))}})};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.showDefaultProperties=function(){var a=this.viewer.model.getRoot()?this.viewer.model.getRootId():null;null!==a?this.setNodeProperties(a):(this.propertyNodeId=null,this.setTitle("Model Properties",{localizeTitle:!0}),Autodesk.Viewing.UI.PropertyPanel.prototype.showDefaultProperties.call(this))};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.areDefaultPropertiesShown=function(){var a=this.viewer.model.getRootId();return this.propertyNodeId===a};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.uninitialize=function(){Autodesk.Viewing.UI.PropertyPanel.prototype.uninitialize.call(this);this.viewer=null};
Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.onCategoryClick=function(a,b){Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryClick.call(this,a,b);this.viewer.getDimensions();this.resizeToContent()};Autodesk.Viewing.Extensions.ViewerPropertyPanel.prototype.onCategoryIconClick=function(a,b){Autodesk.Viewing.UI.PropertyPanel.prototype.onCategoryIconClick.call(this,a,b);this.viewer.getDimensions();this.resizeToContent()};AutodeskNamespace("Autodesk.Viewing.Extensions");
Autodesk.Viewing.Extensions.ViewerLayersPanel=function(a){var b=a.container;Autodesk.Viewing.UI.LayersPanel.call(this,a,b,b.id+"ViewerLayersPanel")};Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype=Object.create(Autodesk.Viewing.UI.LayersPanel.prototype);Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.constructor=Autodesk.Viewing.Extensions.ViewerLayersPanel;Autodesk.Viewing.Extensions.ViewerPanelMixin.call(Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype);
Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onClick=function(a,b){this.isMac&&b.ctrlKey||this.setLayerVisible(a,!(b.shiftKey||b.metaKey||b.ctrlKey))};Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onRightClick=function(a,b){this.setLayerVisible(a,!(b.shiftKey||b.metaKey||b.ctrlKey))};Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onImageClick=function(a,b){this.isMac&&b.ctrlKey||this.setLayerVisible(a)};
Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onTitleClick=function(a){this.viewer.setLayerVisible(null,!0)};Autodesk.Viewing.Extensions.ViewerLayersPanel.prototype.onTitleDoubleClick=function(a){this.viewer.fitToView()};AutodeskNamespace("Autodesk.Viewing.Extensions");Autodesk.Viewing.Extensions.ViewerSettingTab={Navigation:"navigationtab",Performance:"performancetab"};
Autodesk.Viewing.Extensions.ViewerSettingsPanel=function(a,b){this.viewer=a;this.is3dMode="3d"===b;Autodesk.Viewing.UI.SettingsPanel.call(this,a.container,"ViewerSettingsPanel","Settings",{width:340,heightAdjustment:155});this.addTab("navigationtab","Navigation and selection",{className:"navigation"});this.addTab("performancetab","Performance and appearance",{className:"performance"});this.restoreDiv=document.createElement("div");this.restoreDiv.className="viewer-restore-defaults";this.restoreDiv.setAttribute("data-i18n",
"Restore settings defaults");this.restoreDiv.textContent=Autodesk.Viewing.i18n.translate("Restore settings defaults");this.addEventListener(this.restoreDiv,"touchstart",touchStartToClick);this.addEventListener(this.restoreDiv,"click",function(){var b=a.model.is2d()?"2d":"3d";a.prefs.reset(b)},!1);this.container.appendChild(this.restoreDiv);this.createNavigationPanel();this.createPerformancePanel()};Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype=Object.create(Autodesk.Viewing.UI.SettingsPanel.prototype);
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.constructor=Autodesk.Viewing.Extensions.ViewerSettingsPanel;Autodesk.Viewing.Extensions.ViewerPanelMixin.call(Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype);Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.uninitialize=function(){this.viewer=null;Autodesk.Viewing.UI.SettingsPanel.prototype.uninitialize.call(this)};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.addCheckbox=function(a,b,c,f,d){var g=this.viewer,h=g.prefs[d];a=Autodesk.Viewing.UI.SettingsPanel.prototype.addCheckbox.call(this,a,b,"boolean"===typeof h?h:c,function(a){g.prefs.set(d,a);f(a)});var k=this.getControl(a);k.saveKey=d;g.prefs.addListeners(d,function(a){k.setValue(a)},function(a){k.setValue(a);f(a)});return k};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.removeCheckbox=function(a){this.viewer.prefs.removeListeners(a.saveKey);this.removeEventListener(a,"change",a.changeListener);return Autodesk.Viewing.UI.SettingsPanel.prototype.removeCheckbox.call(this,a)};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.createNavigationPanel=function(){var a=this.viewer,b=Autodesk.Viewing.Extensions.ViewerSettingTab.Navigation;this.is3dMode&&(this.addCheckbox(b,"Show ViewCube",!0,function(b){a.displayViewCube(b)},"viewCube"),this.addCheckbox(b,"ViewCube acts on pivot",!1,function(b){a.setUsePivotAlways(b)},"alwaysUsePivot"),this.addCheckbox(b,"Zoom towards pivot",!1,function(b){a.setZoomTowardsPivot(b)},"zoomTowardsPivot"),this.addCheckbox(b,"Set pivot with left mouse button",
!1,function(b){a.setClickToSetCOI(b)},"clickToSetCOI"),this.addCheckbox(b,"Fusion style orbit",!1,function(b){b?a.loadExtension("Autodesk.Viewing.FusionOrbit",null):a.unloadExtension("Autodesk.Viewing.FusionOrbit",null)},"fusionOrbit"));this.addCheckbox(b,"Reverse mouse zoom direction",!1,function(b){a.setReverseZoomDirection(b)},"reverseMouseZoomDir");this.is3dMode&&this.addCheckbox(b,"Orbit past world poles",!0,function(b){a.setOrbitPastWorldPoles(b)},"orbitPastWorldPoles");this.addCheckbox(b,"Open properties on select",
!0,function(b){a.setPropertiesOnSelect(b)},"openPropertiesOnSelect");this.addCheckbox(b,"Left handed mouse setup",!1,function(b){a.setUseLeftHandedInput(b)},"leftHandedMouseSetup")};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.createPerformancePanel=function(){var a=this.viewer,b=Autodesk.Viewing.Extensions.ViewerSettingTab.Performance;this.is3dMode&&(this.ghosthiddenChkBoxId=this.addCheckbox(b,"Ghost hidden objects",!0,function(b){a.setGhosting(b)},"ghosting"),this.optimizeNavigationhkBoxId=this.addCheckbox(b,"Smooth navigation",isMobileDevice(),function(b){a.setOptimizeNavigation(b)},"optimizeNavigation"),this.antialiasingChkBoxId=this.addCheckbox(b,"Anti-aliasing",
!0,function(b){a.setQualityLevel(a.prefs.ambientShadows,b)},"antialiasing"),this.ambientshadowsChkBoxId=this.addCheckbox(b,"Ambient shadows",!0,function(b){a.setQualityLevel(b,a.prefs.antialiasing)},"ambientShadows"),this.groundShadowChkBoxId=this.addCheckbox(b,"Ground shadow",!0,function(b){a.setGroundShadow(b)},"groundShadow"),this.groundReflectionChkBoxId=this.addCheckbox(b,"Ground reflection",!0,function(b){a.setGroundReflection(b)},"groundReflection"));this.progressiveRenderChkBoxId=this.addCheckbox(b,
"Progressive model display",!0,function(b){a.setProgressiveRendering(b)},"progressiveRendering")};
Autodesk.Viewing.Extensions.ViewerSettingsPanel.prototype.syncUI=function(){var a=this.viewer,b=this.getControl(this.antialiasingChkBoxId);b&&b.setValue(a.prefs.antialiasing);(b=this.getControl(this.ambientshadowsChkBoxId))&&b.setValue(a.prefs.ambientShadows);(b=this.getControl(this.groundShadowChkBoxId))&&b.setValue(a.prefs.groundShadow);(b=this.getControl(this.groundReflectionChkBoxId))&&b.setValue(a.prefs.groundReflection);(b=this.getControl(this.progressiveRenderChkBoxId))&&b.setValue(a.prefs.progressiveRendering);
(b=this.getControl(this.ghosthiddenChkBoxId))&&b.setValue(a.prefs.ghosting)};AutodeskNamespace("Autodesk.Viewing.Extensions");Autodesk.Viewing.Extensions.ViewerObjectContextMenu=function(a){Autodesk.Viewing.UI.ObjectContextMenu.call(this,a)};Autodesk.Viewing.Extensions.ViewerObjectContextMenu.prototype=Object.create(Autodesk.Viewing.UI.ObjectContextMenu.prototype);Autodesk.Viewing.Extensions.ViewerObjectContextMenu.prototype.constructor=Autodesk.Viewing.Extensions.ViewerObjectContextMenu;
Autodesk.Viewing.Extensions.ViewerObjectContextMenu.prototype.buildMenu=function(a,b){var c=this,f=[],d=this.viewer.model.is2d();!d&&b.hasSelected&&(f.push({title:"Isolate",target:function(){var a=c.viewer.getSelection();c.viewer.clearSelection();c.viewer.isolate(a)}}),b.hasVisible&&f.push({title:"Hide Selected",target:function(){var a=c.viewer.getSelection();c.viewer.clearSelection();c.viewer.hide(a)}}),b.hasHidden&&f.push({title:"Show Selected",target:function(){var a=c.viewer.getSelection();c.viewer.clearSelection();
c.viewer.show(a)}}));d?f.push({title:"Show All Layers",target:function(){c.viewer.setLayerVisible(null,!0)}}):f.push({title:"Show All Objects",target:function(){c.viewer.showAll()}});!d&&b.hasSelected&&f.push({title:"Focus",target:function(){var a=c.viewer.getSelection().map(function(a){return a.dbId});c.viewer.fitToView(a)}});b.hasSelected&&f.push({title:"Clear Selection",target:function(){c.viewer.clearSelection()}});return f};"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.CAM360");
Autodesk.Viewing.Extensions.CAM360.CAM360Extension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b)};Autodesk.Viewing.Extensions.CAM360.CAM360Extension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.CAM360.CAM360Extension.prototype.constructor=Autodesk.Viewing.Extensions.CAM360.CAM360Extension;
Autodesk.Viewing.Extensions.CAM360.CAM360Extension.prototype.load=function(){function a(){b.impl.setLightPreset(0,!0);b.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a)}var b=this.viewer,c=new Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel(this.viewer,"CAM Model Structure Loading",this.options);b.setModelStructurePanel(c);b.hideLines(!1);b.setGhosting(!1);b.setQualityLevel(!1,!0);b.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a);return!0};
Autodesk.Viewing.Extensions.CAM360.CAM360Extension.prototype.unload=function(){this.viewer.setModelStructurePanel(null)};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.CAM360",Autodesk.Viewing.Extensions.CAM360.CAM360Extension);"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.CAM360");Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel=function(a,b,c){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.call(this,a,b,c);this.viewer=a};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype=Object.create(Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype);Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.constructor=Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel;
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.sortCamNodes=function(a,b){function c(a){if(a.children)for(var b=0;b<a.children.length;b++){var d=a.children[b];h.push(d);c(d)}}function f(a,b){g.viewer.getProperties(a.dbId,function(c){a:{c=c.properties;for(var d=0;d<c.length;++d){var f=c[d];if("9429B915-D020-4CEB-971B-6ADD0A5D4BFA"===f.displayName){c=f.displayValue;break a}}c=null}c?("CAM_Setup"==c?g.camSetupNodes.push(a):"CAM_Operation"==c?g.camOperationNodes.push(a):"CAM_Tool"===
c?g.camToolNodes.push(a):"CAM_Stock"===c?g.camStockNodes.push(a):"CAM_Folder"==c&&g.camFolderNodes.push(a),g.camNodes.push(a)):g.camModelNodes.push(a);b()},function(a,c,d){b()})}function d(){0<h.length?f(h.shift(),d):b()}this.camNodes=[];this.camModelNodes=[];this.camSetupNodes=[];this.camStockNodes=[];this.camOperationNodes=[];this.camToolNodes=[];this.camFolderNodes=[];var g=this,h=[];c(a);d()};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.setModel=function(a,b){var c=this;c.sortCamNodes(a,function(){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.setModel.call(c,a,b);c.SetCAMNodeVisible(!1);c.setVisible(!0);c.ExpandSetupNodes();c.resizeToContent()})};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.initialize=function(){function a(c){b.SetCAMNodeVisible(!1);b.removeEventListener(b.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a)}Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.initialize.call(this);var b=this;this.viewer.model&&this.viewer.model.isLoadDone()||b.addEventListener(b.viewer,Autodesk.Viewing.GEOMETRY_LOADED_EVENT,a);b.addEventListener(b.viewer,Autodesk.Viewing.SHOW_EVENT,function(a){if(a=a.nodeIdArray)for(var f=
0;f<a.length;f++)b.setCamNodeVisibility(a[f])});b.addEventListener(b.viewer,Autodesk.Viewing.SELECTION_CHANGED_EVENT,function(a){if(a=a.nodeArray)for(var f=0;f<a.length;f++)b.HideHightlightCAMNode(a[f])});b.addEventListener(b.viewer,Autodesk.Viewing.ISOLATE_EVENT,function(a){if(a=a.nodeIdArray)if(0==a.length)b.SetModelVisible(),b.SetCAMNodeVisible(!0);else for(var f=0;f<a.length;f++)b.setCamNodeVisibility(a[f])})};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMNode=function(a){return-1!==this.camNodes.indexOf(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMSetupNode=function(a){return-1!==this.camSetupNodes.indexOf(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMStockNode=function(a){return-1!==this.camStockNodes.indexOf(a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMToolNode=function(a){return-1!==this.camToolNodes.indexOf(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMOperationNode=function(a){return-1!==this.camOperationNodes.indexOf(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.IsCAMFolderNode=function(a){return-1!==this.camFolderNodes.indexOf(a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.shouldInclude=function(a){return!this.IsCAMStockNode(a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.isGroupNode=function(a){return this.IsCAMOperationNode(a)?!1:Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.isGroupNode.call(this,a)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.setNodeVisibility=function(a,b){b?this.viewer.show(a):this.viewer.hide(a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.SetModelVisible=function(){if(this.camModelNodes)for(var a=0;a<this.camModelNodes.length;a++)this.setNodeVisibility(this.camModelNodes[a],!0)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.SetCAMNodeVisible=function(a){if(this.camNodes){for(var b=0;b<this.camNodes.length;b++)this.setNodeVisibility(this.camNodes[b],a);this.SetToolNodeVisible(!1)}};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.SetToolNodeVisible=function(a){if(this.camToolNodes)for(var b=0;b<this.camToolNodes.length;b++)this.setNodeVisibility(this.camToolNodes[b],a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.HideHightlightNode=function(a){var b=this.viewer.impl,c=this;(function d(a){var h=a.fragIds;if("undefined"!=typeof h){Array.isArray(h)||(h=[h]);for(var k=0;k<h.length;++k)b.highlightFragment(c.modelRoot,h[k],!1,!0)}if(a.children)for(h=0;h<a.children.length;h++)d(a.children[h])})(a)};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.HideHightlightCAMNode=function(a){var b=this.IsCAMSetupNode(a),c=this.IsCAMOperationNode(a),f=this.IsCAMFolderNode(a);if(b)for(b=0;b<a.children.length;b++)c=a.children[b],this.IsCAMStockNode(c)||this.HideHightlightNode(c);else if(c)for(b=0;b<a.children.length;b++)c=a.children[b],this.IsCAMToolNode(c)&&this.HideHightlightNode(c);else if(f)for(b=0;b<a.children.length;b++)this.HideHightlightNode(a.children[b])};
Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.setCamNodeVisibility=function(a){var b=this.IsCAMSetupNode(a),c=this.IsCAMOperationNode(a),f=this.IsCAMFolderNode(a);if(b)for(b=0;b<a.children.length;b++)c=a.children[b],this.IsCAMStockNode(c)?this.setNodeVisibility(c,!0):this.setNodeVisibility(c,!1);else if(c)for(b=0;b<a.children.length;b++)c=a.children[b],this.IsCAMToolNode(c)&&this.setNodeVisibility(c,!1);else if(f)for(b=0;b<a.children.length;b++)this.setNodeVisibility(a.children[b],
!1)};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.onClick=function(a,b){Autodesk.Viewing.Extensions.ViewerModelStructurePanel.prototype.onClick.call(this,a,b);this.SetModelVisible();this.setCamNodeVisibility(a);this.viewer.fitToView()};Autodesk.Viewing.Extensions.CAM360.CAMModelStructurePanel.prototype.ExpandSetupNodes=function(){if(this.camSetupNodes)for(var a=0;a<this.camSetupNodes.length;a++)this.tree.setCollapsed(this.camSetupNodes[a].dbId,!1)};"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Fusion360");
Autodesk.Viewing.Extensions.Fusion360.AnimationExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b);this.viewer=a;this.animTools=null;this.animToolsId="animationTools";this.playButton=null;this.prevExplodeValue=0;this.prevAnimationTime=-1};Autodesk.Viewing.Extensions.Fusion360.AnimationExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.Fusion360.AnimationExtension.prototype.constructor=Autodesk.Viewing.Extensions.Fusion360.AnimationExtension;
Autodesk.Viewing.Extensions.Fusion360.AnimationExtension.prototype.load=function(){function a(a,b){b?(a.setIcon("toolbar-animationPlayIcon"),a.setToolTip("Play")):(a.setIcon("toolbar-animationPauseIcon"),a.setToolTip("Pause"))}function b(){l.toolbar.removeClass("toolbar-animationMenuplacer");k.animTools.setVisible(!1)}function c(a,b){l.model.is2d()||0===l.getExplodeScale()||(k.prevExplodeValue=l.explodeslider.value,b&&(l.explodeslider.value=a),l.explode(a))}function f(a){var b=a.value;a.style.background=
"-webkit-linear-gradient(left,#ffffff "+b+"%, #393939 "+b+"%)";a.style.background="-moz-linear-gradient(left,#ffffff "+b+"%, #393939 "+b+"%)";a.style.background="-ms-linear-gradient(left,#ffffff "+b+"%, #393939 "+b+"%)";a.style.background="-o-linear-gradient(left,#ffffff "+b+"%, #393939 "+b+"%)";a.style.background="linear-gradient(to right,#ffffff "+b+"%, #393939 "+b+"%)"}function d(a){var b="";0>a&&(b="-",a=-a);var c=~~(a/3600),d=~~(a%3600/60);a%=60;0<c&&(b+=c+":"+(10>d?"0":""));return b=b+(d+":"+
(10>a?"0":""))+a.toFixed(2)}function g(m){l.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,g);k.toolbar=new q.ToolBar("animation-toolbar");k.toolbar.addClass("toolbar-animationSubtoolbar");l.container.appendChild(k.toolbar.container);k.animTools=new q.ControlGroup(k.animToolsId);k.animTools.setVisible(!1);k.toolbar.addControl(k.animTools);k.playButton=new q.Button("toolbar-animationPlay");k.playButton.setToolTip("Play");k.playButton.onClick=function(b){c(0);var g=l.impl.keyFrameAnimator;
void 0!==g&&g&&(0<k.prevAnimationTime&&(g.goto(k.prevAnimationTime),k.prevAnimationTime=-1),g.play(0,function(b){t.value=b;n.value=d(g.currentTime);D.value=d(g.currentTime-g.duration);100<=b&&a(k.playButton,!0);f(t)}),a(k.playButton,g.isPaused),l.toolbar.addClass("toolbar-animationMenuplacer"),k.animTools.setVisible(!0),k.animTools.isPositionAdjusted||(h(),k.animTools.isPositionAdjusted=!0))};k.playButton.setIcon("toolbar-animationPlayIcon");l.modelTools.addControl(k.playButton);k.onExplodeChange=
function(){var c=l.impl.keyFrameAnimator;void 0!==c&&c&&(0!==c.currentTime&&(k.prevAnimationTime=c.currentTime,c.goto(0)),a(k.playButton,!0));b()};l.addEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT,k.onExplodeChange);l.modelTools.resetModelButton&&(l.modelTools.resetModelButton.onClick=function(b){l.showAll();b=l.impl.keyFrameAnimator;void 0!==b&&b&&(b.goto(0),t.value=0,n.value=d(0),D.value=d(-b.duration),a(k.playButton,!0));c(0,!0);f(t)});k.animTools.backwardButton=new q.Button("toolbar-animationBackward");
k.animTools.backwardButton.setToolTip("Previous keyframe");k.animTools.backwardButton.onClick=function(b){b=l.impl.keyFrameAnimator;void 0!==b&&b&&(b.prev(),t.value=0<b.duration?b.currentTime/b.duration*100:0,n.value=d(b.currentTime),D.value=d(b.currentTime-b.duration),a(k.playButton,b.isPaused),f(t))};k.animTools.backwardButton.addClass("toolbar-animationButton");k.animTools.backwardButton.setIcon("toolbar-animationBackwardIcon");k.animTools.addControl(k.animTools.backwardButton);k.animTools.forwardButton=
new q.Button("toolbar-animationForward");k.animTools.forwardButton.setToolTip("Next keyframe");k.animTools.forwardButton.onClick=function(b){b=l.impl.keyFrameAnimator;void 0!==b&&b&&(b.next(),t.value=0<b.duration?b.currentTime/b.duration*100:0,n.value=d(b.currentTime),D.value=d(b.currentTime-b.duration),a(k.playButton,b.isPaused),f(t))};k.animTools.forwardButton.addClass("toolbar-animationButton");k.animTools.forwardButton.setIcon("toolbar-animationForwardIcon");k.animTools.addControl(k.animTools.forwardButton);
k.animTools.timeText=new q.Control("toolbar-animationTimeLapse");var n=document.createElement("input");n.type="text";n.value="0";n.className="animationTimeLapse";n.disabled=!0;k.animTools.timeText.container.appendChild(n);k.animTools.timeText.addClass("toolbar-animationButton");k.animTools.addControl(k.animTools.timeText);k.animTools.timeline=new q.Control("toolbar-animationTimeline");var t=k.animTools.input=document.createElement("input");t.type="range";t.value="0";t.className="animationTimeline";
k.animTools.timeline.container.appendChild(t);t.addEventListener("input",function(b){b=l.impl.keyFrameAnimator;if(void 0!==b&&b){var c=t.value*b.duration/100;n.value=d(c);D.value=d(c-b.duration);b.goto(c);a(k.playButton,b.isPaused);f(t)}});var v=document.createElement("div");v.className="adsk-control-tooltip";v.textContent=Autodesk.Viewing.i18n.translate("Click-drag to scrub");k.animTools.timeline.container.appendChild(v);t.addEventListener("mouseover",function(a){a.target===t&&(v.style.visibility=
"visible")});t.addEventListener("mouseout",function(a){a.target===t&&(v.style.visibility="hidden")});k.animTools.timeline.addClass("toolbar-animationButton");k.animTools.timeline.addClass("toolbar-animationTimeline");k.animTools.addControl(k.animTools.timeline);k.animTools.timeLeftText=new q.Control("toolbar-animationRemainingTime");var D=document.createElement("input");D.type="text";D.value="0";D.className="animationTimeLapse";D.disabled=!0;k.animTools.timeLeftText.container.appendChild(D);k.animTools.timeLeftText.addClass("toolbar-animationButton");
k.animTools.addControl(k.animTools.timeLeftText);k.animTools.closeButton=new q.Button("toolbar-animationClose");k.animTools.closeButton.setToolTip("Close animation timeline");k.animTools.closeButton.onClick=function(a){b()};k.animTools.closeButton.setIcon("toolbar-animationCloseIcon");k.animTools.closeButton.addClass("toolbar-animationButton");k.animTools.addControl(k.animTools.closeButton);k.onEscape=function(c){c=l.impl.keyFrameAnimator;void 0!==c&&c&&(c.isPaused?b():c.pause(),a(k.playButton,c.isPaused))};
l.addEventListener(Autodesk.Viewing.ESCAPE_EVENT,k.onEscape);k.onCameraChange=function(){if(l.toolController.cameraUpdated){var a=l.impl.keyFrameAnimator;void 0!==a&&a&&(!a.isPlaying||a.isPaused||a.areCameraAnimationsPaused||a.pauseCameraAnimations())}};l.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,k.onCameraChange);k.onResize=function(){l.container.clientWidth<(isTouchDevice()?560:600)?k.toolbar.setCollapsed(!0):(k.toolbar.setCollapsed(!1),h())};l.addEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,
k.onResize)}function h(){var a=l.toolbar.getDimensions().width,b=l.container.getBoundingClientRect().width;a>b&&(a=l.modelTools.getDimensions().width);b=a-(2*k.animTools.backwardButton.getDimensions().width+3*k.animTools.timeText.getDimensions().width+k.animTools.closeButton.getDimensions().width)+12;k.animTools.input.style.width=b+"px";k.toolbar.container.style.left="calc(50% - "+a/2+"px)"}var k=this,l=this.viewer,n=l.impl,q=Autodesk.Viewing.UI;this.viewer.toolbar&&this.viewer.toolbar.modelTools&&
0<this.viewer.toolbar.modelTools.getNumberOfControls()?g():this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,g);n.toggleGhosting(!1);return!0};
Autodesk.Viewing.Extensions.Fusion360.AnimationExtension.prototype.unload=function(){var a=this.viewer,b=a.impl.keyFrameAnimator;b&&b.stop();a.impl.keyFrameAnimator=null;this.animTools&&(this.animTools.removeControl(this.animTools.timeText.getId()),this.animTools.removeControl(this.animTools.timeline.getId()),this.animTools.removeControl(this.animTools.timeLeftText.getId()),this.animTools.removeControl(this.animTools.forwardButton.getId()),this.animTools.removeControl(this.animTools.backwardButton.getId()),
this.animTools.removeControl(this.animTools.closeButton.getId()));this.toolbar&&(this.toolbar.removeControl(this.animTools),this.toolbar.container.parentNode.removeChild(this.toolbar.container),this.toolbar=null);(b=a.getToolbar(!1))&&b.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID).removeControl(this.playButton.getId());a.removeEventListener(Autodesk.Viewing.EXPLODE_CHANGE_EVENT,this.onExplodeChange);a.removeEventListener(Autodesk.Viewing.ESCAPE_EVENT,this.onEscape);a.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,
this.onCameraChange);a.removeEventListener(Autodesk.Viewing.VIEWER_RESIZE_EVENT,this.onResize);return!0};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Fusion360.Animation",Autodesk.Viewing.Extensions.Fusion360.AnimationExtension);
function init_WarpShader(){WarpShader||(WarpShader={uniforms:{tDiffuse:{type:"t",value:null},scale:{type:"v2",value:new THREE.Vector2(1,1)},scaleIn:{type:"v2",value:new THREE.Vector2(1,1)},lensCenter:{type:"v2",value:new THREE.Vector2(0,0)},hmdWarpParam:{type:"v4",value:new THREE.Vector4(1,.22,.24,0)},chromAbParam:{type:"v4",value:new THREE.Vector4(.996,-.004,1.014,0)}},defines:{},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",
fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 scale;\nuniform vec2 scaleIn;\nuniform vec2 lensCenter;\nuniform vec4 hmdWarpParam;\nuniform vec4 chromAbParam;\nvarying vec2 vUv;\nvec4 sampleColor() {\nvec2 uv = (vUv*2.0)-1.0;\nvec2 theta = (uv-lensCenter)*scaleIn;\nfloat rSq = theta.x*theta.x + theta.y*theta.y;\nvec2 rvector = theta*(hmdWarpParam.x + hmdWarpParam.y*rSq + hmdWarpParam.z*rSq*rSq + hmdWarpParam.w*rSq*rSq*rSq);\n  vec2 rBlue = rvector * (chromAbParam.z + chromAbParam.w * rSq);\n  vec2 tcBlue = (lensCenter + scale * rBlue);\n  tcBlue = (tcBlue+1.0)/2.0;\n  if (any(bvec2(clamp(tcBlue, vec2(0.0,0.0), vec2(1.0,1.0))-tcBlue)))\n    return vec4(0.0, 0.0, 0.0, 1.0);\n  vec2 tcGreen = lensCenter + scale * rvector;\n  tcGreen = (tcGreen+1.0)/2.0;\n  vec2 rRed = rvector * (chromAbParam.x + chromAbParam.y * rSq);\n  vec2 tcRed = lensCenter + scale * rRed;\n  tcRed = (tcRed+1.0)/2.0;\n  return vec4(texture2D(tDiffuse, tcRed).r, texture2D(tDiffuse, tcGreen).g, texture2D(tDiffuse, tcBlue).b, 1);\n}\nvoid main() {\nvec4 texel = sampleColor();\ngl_FragColor = texel;\n}"})}
AutodeskNamespace("Autodesk.Viewing.Extensions.Oculus");
Autodesk.Viewing.Extensions.Oculus.StereoRenderContext=function(a){var b,c,f,d,g,h,k,l,n,q,m=a?a.useWarp:!0,p=a&&a.HMD?a.HMD:{hResolution:1920,vResolution:1080,hScreenSize:.12576,vScreenSize:.07074,interpupillaryDistance:.0635,lensSeparationDistance:.0635,eyeToScreenDistance:.041,distortionK:[1,.22,.24,0],chromaAbParameter:[.996,-.004,1.014,0]},t,v,D=1,w=0,F=100,B=1;this.init=function(a,b,c){init_WarpShader();g=a;h=b;k=c;l=g.devicePixelRatio;B=p.hResolution/(2*p.vResolution);a=-1-4*(p.hScreenSize/
4-p.lensSeparationDistance/2)/p.hScreenSize;D=p.distortionK[0]+p.distortionK[1]*Math.pow(a,2)+p.distortionK[2]*Math.pow(a,4)+p.distortionK[3]*Math.pow(a,6);F=THREE.Math.radToDeg(2*Math.atan2(p.vScreenSize*D,2*p.eyeToScreenDistance));w=4*(p.hScreenSize/4-p.interpupillaryDistance/2)/p.hScreenSize;a=4*(p.hScreenSize/4-p.lensSeparationDistance/2)/p.hScreenSize;t=new THREE.Vector2(a,0);v=new THREE.Vector2(-a,0);f=new RenderContext;d=new RenderContext;f.settings.sao=d.settings.sao=!1;f.settings.antialias=
d.settings.antialias=!1;f.settings.customPresentPass=d.settings.customPresentPass=m;f.init(g,h/2*D/l,k*D/l);d.init(g,k/2*D/l,k*D/l);this.settings=f.settings;if(m){n=new LmvShaderPass(WarpShader);q=new LmvShaderPass(WarpShader);a=[n,q];for(b=0;2>b;b++)a[b].material.blending=THREE.NoBlending,a[b].material.depthWrite=!1,a[b].material.depthTest=!1,a[b].uniforms.hmdWarpParam.value.set(p.distortionK[0],p.distortionK[1],p.distortionK[2],p.distortionK[3]),a[b].uniforms.chromAbParam.value.set(p.chromaAbParameter[0],
p.chromaAbParameter[1],p.chromaAbParameter[2],p.chromaAbParameter[3]),a[b].uniforms.scaleIn.value.set(1,1/B),a[b].uniforms.scale.value.set(1/D,1*B/D);a[0].uniforms.lensCenter.value.copy(t);a[1].uniforms.lensCenter.value.copy(v)}};this.update=function(a){var b=f.update(a);a=d.update(a);return b||a};this.beginScene=function(a,g,h,k){b=g.clone();c=g.clone();b.aspect=c.aspect=B;b.fov=c.fov=F;var l=1/f.getUnitScale();g=g.target.clone().sub(g.position).cross(g.up).normalize();g.multiplyScalar(.5*p.interpupillaryDistance*
l);b.position.sub(g);c.position.add(g);b.target.sub(g);c.target.add(g);b.toPerspective();c.toPerspective();b.projectionMatrix.elements[12]+=w;c.projectionMatrix.elements[12]-=w;f.beginScene(a,b,h,k);d.beginScene(a,c,h,k)};this.renderScenePart=function(a,b,c,g){f.renderScenePart(a,b,c,g);d.renderScenePart(a,b,c,g)};this.sceneDirty=function(a,b){f.sceneDirty(a,b);d.sceneDirty(a,b)};this.endScene=function(){f.endScene();d.endScene()};this.clearAllOverlays=function(){f.clearAllOverlays();d.clearAllOverlays()};
this.renderOverlays=function(a){f.renderOverlays(a);d.renderOverlays(a)};this.composeFinalFrame=function(a,b){f.composeFinalFrame(a,b,!0);d.composeFinalFrame(a,b,!0);g.setViewport(0,0,h/2,k);f.presentBuffer(n);g.setViewport(h/2,0,h/2,k);d.presentBuffer(q);g.setViewport(0,0,h,k)};this.cleanup=function(){f.cleanup();d.cleanup()};this.setSize=function(a,b,c){h=a;k=b;f.setSize(h/2*D/l,k*D/l,c);d.setSize(h/2*D/l,k*D/l,c);g.setSize(a,b)};this.getMaxAnisotropy=function(){return f.getMaxAnisotropy()};this.hasMRT=
function(){return f.hasMRT()};this.initPostPipeline=function(a,b,c){c=b=a=!1;f.initPostPipeline(a,b,c);d.initPostPipeline(a,b,c)};this.setClearColors=function(a,b){f.setClearColors(a,b);d.setClearColors(a,b)};this.setAOOptions=function(a,b){f.setAOOptions(a,b);d.setAOOptions(a,b)};this.getAORadius=function(){return f.getAORadius()};this.getAOIntensity=function(){return f.getAOIntensity()};this.setTonemapExposureBias=function(a){f.setTonemapExposureBias(a);d.setTonemapExposureBias(a)};this.getExposureBias=
function(){return f.getExposureBias()};this.setTonemapMethod=function(a){f.setTonemapMethod(a);d.setTonemapMethod(a)};this.getToneMapMethod=function(){return f.getToneMapMethod()};this.toggleTwoSided=function(a){f.toggleTwoSided(a);d.toggleTwoSided(a)};this.enter2DMode=function(a){f.enter2DMode(a);d.enter2DMode(a)};this.idAtPixel=function(a,b){console.warn("idAtPixel not implemented in stereo context.");return 0};this.rolloverObjectViewport=function(a,b){console.warn("rolloverObjectViewport not implemented in stereo context")};
this.screenCapture=function(){console.warn("Screen capture not implemented by stereo render context");return null};this.setUnitScale=function(a){f.setUnitScale(a);d.setUnitScale(a)};this.getUnitScale=function(){return f.getUnitScale()}};AutodeskNamespace("Autodesk.Viewing.Extensions.Oculus");
(function(){function a(a){function b(){w.copy(d.matrixWorld);w.elements[12]=0;w.elements[13]=0;w.elements[14]=0;B&&D.set(B[1],B[2],B[3])}function c(){var a=new WebSocket("ws://localhost:8888/ws");a.onopen=function(){console.log("### Oculus Connected ####")};a.onmessage=function(a){a=a.data;try{B=JSON.parse(a)}catch(b){console.log(a)}};a.onclose=function(){console.log("### Oculus Connection Closed ####")};R=a}var d,f=new THREE.Vector3(0,0,0),g=new THREE.Quaternion,t=new THREE.Quaternion,v=new THREE.Matrix4,
D=new THREE.Vector3(0,0,0),w=new THREE.Matrix4,F=new THREE.Matrix4,B,z=0,G=1,A=10,E=-1,H=0,I=0,J=0,L=0,C=0,N=0,K=0,R;h?B=[0,0,0,0,0,0,0,0]:c();this.getNames=function(){return["headtracker"]};this.getName=function(){return"headtracker"};this.activate=function(c){d=a.navigation.getCamera();b();a.model&&(G=1/a.model.getUnitScale(),A=1E-4*a.model.getBoundingBox().size().length())};this.deactivate=function(a){d=null};this.update=function(b){0>E&&(E=b);var c=b-E;d.isPerspective||a.navigation.toPerspective();
if(h){var l=h.getState();B[0]=z+1;l.orientation&&(B[4]=l.orientation.x,B[5]=l.orientation.y,B[6]=l.orientation.z,B[7]=l.orientation.w);l.position&&(B[1]=l.position.x,B[2]=l.position.y,B[3]=l.position.z)}if(B){l=B[0];if(l>z){d.position.sub(f);f.set(B[1],B[2],B[3]);f.sub(D);f.multiplyScalar(G);f.applyMatrix4(w);d.position.add(f);H+=(N-K)*c*.001;t.setFromAxisAngle(d.worldup,H);g.set(B[4],B[5],B[6],B[7]);t.multiply(g);F.makeRotationFromQuaternion(t);v.multiplyMatrices(w,F);var n=v.elements,W=new THREE.Vector3(-n[8],
-n[9],-n[10]),U=d.target.clone().sub(d.position).length();d.up.set(n[4],n[5],n[6]);var n=new THREE.Vector3(n[0],n[1],n[2]),O=W.clone().multiplyScalar((I-L)*c*A);d.position.add(O);c=n.multiplyScalar((C-J)*c*A);d.position.add(c);d.target.set(d.position.x,d.position.y,d.position.z);d.target.add(W.multiplyScalar(U))}z=l}R&&1===R.readyState&&R.send("get\n");E=b;return!0};this.handleSingleClick=function(a,b){return!1};this.handleDoubleClick=function(a,b){return!1};this.handleSingleTap=function(a){return!1};
this.handleDoubleTap=function(a,b){return!1};this.handleKeyDown=function(a,b){switch(b){case 38:case 87:I=1;break;case 40:case 83:L=1;break;case 37:case 65:J=1;break;case 39:case 68:C=1;break;case 81:N=1;break;case 69:K=1}return!1};this.handleKeyUp=function(a,c){switch(c){case 38:case 87:I=0;break;case 40:case 83:L=0;break;case 37:case 65:J=0;break;case 39:case 68:C=0;break;case 81:N=0;break;case 69:K=0;break;case 32:b()}return!1};this.handleWheelInput=function(a){return!1};this.handleButtonDown=
function(a,b){return!1};this.handleButtonUp=function(a,b){return!1};this.handleMouseMove=function(a){return!1};this.handleGesture=function(a,b){return!1};this.handleTouchChange=function(a,b){return!1};this.handleBlur=function(a){return!1};this.handleResize=function(){}}var b=Autodesk.Viewing,c=b.Extensions,f=b.UI,d=c.Oculus,g=null,h=null;d.Oculus=function(a,c){b.Extension.call(this,a,c);this.viewer=a;this.context=null;this.initialized=!1};d.Oculus.prototype=Object.create(b.Extension.prototype);d.Oculus.prototype.constructor=
c.Oculus;d.Oculus.prototype.toggleOculus=function(b){var c=this.viewer;b?this.context||(this.context=new d.StereoRenderContext({useWarp:!g}),c.impl.setUserRenderContext(this.context),c.resize(c.canvas.clientWidth,c.canvas.clientHeight),c.displayViewCube(!1,!1),c.navigation.isPerspective||c.navigation.toPerspective(),g?launchFullscreen(c.impl.canvas,{vrDisplay:g}):launchFullscreen(c.impl.canvas),this.headTracker||(this.headTracker=new a(c),c.toolController.registerTool(this.headTracker)),c.toolController.activateTool("headtracker")):
this.context&&(this.context=null,c.impl.setUserRenderContext(null),c.displayViewCube(c.prefs.get("viewCube"),!1),c.toolController.deactivateTool("headtracker"),exitFullscreen())};d.Oculus.prototype.createUI=function(){var a=this,b=this.viewer;this.oculusButton=new f.Button("toolbar-oculusTool");this.oculusButton.setToolTip("Oculus VR Mode");this.oculusButton.setIcon("oculusIcon");this.oculusButton.onClick=function(b){a.toggleOculus(!a.context)};b.modelTools.addControl(this.oculusButton)};d.Oculus.prototype.load=
function(){function a(c){d.removeEventListener(b.TOOLBAR_CREATED_EVENT,a);f.createUI()}function c(l){for(var p=0;p<l.length;++p)if(l[p]instanceof HMDVRDevice){g=l[p];break}if(g){for(p=0;p<l.length;++p)if(l[p]instanceof PositionSensorVRDevice&&l[p].hardwareUnitId==g.hardwareUnitId){h=l[p];break}g&&h?d.modelTools&&0<d.modelTools.getNumberOfControls()?f.createUI():d.addEventListener(b.TOOLBAR_CREATED_EVENT,a):stderr("Didn't find a HMD and sensor!");f.initialized=!0}}var d=this.viewer,f=this;navigator.getVRDevices?
navigator.getVRDevices().then(c):navigator.mozGetVRDevices?navigator.mozGetVRDevices(c):this.initialized=!0;return!0};d.Oculus.prototype.unload=function(){this.toggleOculus(!1);return!0};b.theExtensionManager.registerExtension("Autodesk.Viewing.Oculus",d.Oculus)})();AutodeskNamespace("Autodesk.Viewing.Extensions.Collaboration");
(function(){var a=Autodesk.Viewing,b=a.Private,c=a.Extensions.Collaboration;c.InteractionInterceptor=function(a){this.getNames=function(){return["intercept"]};this.getName=function(){return"intercept"};this.activate=function(a){};this.deactivate=function(a){};this.update=function(a){return!1};this.handleSingleClick=function(a,b){return!1};this.handleDoubleClick=function(a,b){return!1};this.handleSingleTap=function(a){return!1};this.handleDoubleTap=function(a,b){return!1};this.handleKeyDown=function(a,
b){return!1};this.handleKeyUp=function(a,b){return!1};this.handleWheelInput=function(b){a.takeControl();return!1};this.handleButtonDown=function(b,c){a.takeControl();return!1};this.handleButtonUp=function(a,b){return!1};this.handleMouseMove=function(b){a.updatePointer(b);return!1};this.handleGesture=function(b){a.takeControl();return!1};this.handleBlur=function(a){return!1};this.handleResize=function(){}};c.ViewTransceiver=function(c){function d(a){t=!0;a=JSON.parse(a.data.msg);A.restoreState(a);
p.impl.invalidate(!0,!1,!0);t=!1}function g(a){for(var b=0;b<a.length;b++)a[b]=Math.round(1E3*a[b])/1E3}function h(a){var b=a.data.msg;!0===b[1]||D||(b[0]!=w&&(w=b[0],a.data.lastInControl=b[0],m.dispatchEvent({type:"controlChange",channelId:m.channelId,data:a.data})),v=!1,p.navigation.setView((new THREE.Vector3).set(b[2],b[3],b[4]),(new THREE.Vector3).set(b[5],b[6],b[7])),p.navigation.setCameraUpVector((new THREE.Vector3).set(b[8],b[9],b[10])))}function k(a){if(v||D)a=a.camera,a=[a.position.x,a.position.y,
a.position.z,a.target.x,a.target.y,a.target.z,a.up.x,a.up.y,a.up.z],g(a),a.unshift(D),a.unshift(c.getLocalId()),F.sendMessage("camera",a,m.channelId),w!=a[0]&&(w=a[0],m.dispatchEvent({type:"controlChange",channelId:m.channelId,data:{lastInControl:w}}))}function l(a,b,c){a&&!z&&(z=document.createElement("div"),z.classList.add("collabPointer"));a&&!G?(p.container.appendChild(z),G=!0):!a&&G&&(p.container.removeChild(z),G=!1);a&&(z.style.left=b-6+"px",z.style.top=c-6+"px")}function n(a){v||D||(a=a.data.msg,
B.origin.set(a[1],a[2],a[3]),B.direction.set(a[4],a[5],a[6]),a=B.at(p.getCamera().near),a.project(p.getCamera()),a=p.impl.viewportToClient(a.x,a.y),l(!0,a.x,a.y))}function q(a){t||(a=A.getState(E),c.sendMessage("state",JSON.stringify(a),m.channelId))}var m=this,p=this.viewer=null,t=!1,v=!1,D=!1,w,F=this.client=c,B=new THREE.Ray,z=null,G=!1;this.channelId=null;var A,E={seedURN:!1,objectSet:!0,viewport:!1,cutplanes:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}};
this.takeControl=function(){v=!0;l(!1)};this.updatePointer=function(a){v&&(a=p.impl.clientToViewport(a.canvasX,a.canvasY),p.impl.viewportToRay(a,B),a=[B.origin.x,B.origin.y,B.origin.z,B.direction.x,B.direction.y,B.direction.z],g(a),a.unshift(c.getLocalId()),F.sendMessage("pointer",a,m.channelId))};this.connectCamera=function(a){D=!a};this.attach=function(c){p&&this.detach();this.viewer=p=c;A=new b.ViewerState(p);F.addEventListener("cameraChange",h);F.addEventListener("pointerMove",n);F.addEventListener("viewerState",
d);p.hasEventListener(a.CAMERA_CHANGE_EVENT,k)||p.addEventListener(a.CAMERA_CHANGE_EVENT,k);p.hasEventListener(a.SELECTION_CHANGED_EVENT,q)||(p.addEventListener(a.SELECTION_CHANGED_EVENT,q),p.addEventListener(a.ISOLATE_EVENT,q),p.addEventListener(a.HIDE_EVENT,q),p.addEventListener(a.SHOW_EVENT,q),p.addEventListener(a.HIGHLIGHT_EVENT,q),p.addEventListener(a.EXPLODE_CHANGE_EVENT,q),p.addEventListener(a.LAYER_VISIBILITY_CHANGED_EVENT,q),p.addEventListener(a.CUTPLANES_CHANGE_EVENT,q))};this.detach=function(){F&&
(F.removeEventListener("cameraChange",h),F.removeEventListener("viewerState",d));p&&(p.removeEventListener(a.CAMERA_CHANGE_EVENT,k),p.removeEventListener(a.SELECTION_CHANGED_EVENT,q),p.removeEventListener(a.ISOLATE_EVENT,q),p.removeEventListener(a.HIDE_EVENT,q),p.removeEventListener(a.SHOW_EVENT,q),p.removeEventListener(a.HIGHLIGHT_EVENT,q),p.removeEventListener(a.EXPLODE_CHANGE_EVENT,q),p.removeEventListener(a.LAYER_VISIBILITY_CHANGED_EVENT,q),p.removeEventListener(a.CUTPLANES_CHANGE_EVENT,q),A=
this.viewer=p=null)}};c.ViewTransceiver.prototype.constructor=c.ViewTransceiver;Autodesk.Viewing.EventDispatcher.prototype.apply(c.ViewTransceiver.prototype)})();AutodeskNamespace("Autodesk.Viewing.Extensions.Collaboration");var avec=Autodesk.Viewing.Extensions.Collaboration;avec.Panel=null;Autodesk.Viewing.startLiveReviewSession=function(){avec.Panel&&avec.Panel.startSession()};Autodesk.Viewing.endLiveReviewSession=function(){avec.Panel&&avec.Panel.endSession()};
(function(){function a(a,d,f,g){this.viewer=a;this.client=d;this.p2p=f;this.viewtx=g;c.UI.DockingPanel.call(this,a.container,"CollabPanel","Live Review");this.container.classList.add("collabPanel");this.container.style.height="auto";this.container.dockRight=!0;this.content=document.createElement("div");this.container.appendChild(this.content);this.content.classList.add("collabPanelContent");this.tableContainer=document.createElement("div");this.tableContainer.classList.add("userListTable","dockingPanelScroll");
this.table=document.createElement("table");this.table.classList.add("tftable");this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.tableContainer.appendChild(this.table);this.content.appendChild(this.tableContainer);this.inviteDiv=document.createElement("div");this.inviteDiv.className="collabBoxOK";this.inviteDiv.style.float="left";this.inviteDiv.style.width="232px";this.inviteDiv.setAttribute("data-i18n","Invite");this.inviteDiv.textContent=Autodesk.Viewing.i18n.translate("Invite");
this.content.appendChild(this.inviteDiv);this.inviteDiv.addEventListener("click",function(c){(new b).start(a.container,function(){document.location.href="mailto:?subject=Please Join My Live Review"},"Invite Others","Email Invite",!0)});this.chatHistory=document.createElement("div");this.chatHistory.classList.add("chatHistory");this.chatHistory.classList.add("textEntry");this.chatHistory.classList.add("dockingPanelScroll");this.content.appendChild(this.chatHistory);this.chatPanel=document.createElement("div");
this.chatPanel.classList.add("chatPanel");this.textInput=document.createElement("input");this.textInput.type="text";this.textInput.classList.add("textEntry");this.textInput.placeholder="Type a message...";this.chatPanel.appendChild(this.textInput);this.content.appendChild(this.chatPanel);this.isCameraConnected=!0;var h=this;this.addEventListener(d,"userListChange",function(a){a.channelId&&a.channelId!==h.viewtx.channelId||(a=h.client.getChannelInfo(h.viewtx.channelId))&&h.updateUsers(a.users)});this.addEventListener(this.viewtx,
"controlChange",function(a){a.channelId===h.viewtx.channelId&&h.updateUserInControl(a.data.lastInControl)});this.addEventListener(d,"chatReceived",function(a){a.channelId===h.viewtx.channelId&&h.updateChatHistory(a)});this.textInput.onkeyup=function(a){h.handleChatInput(a)};this.addEventListener(this.p2p,"remoteStreamAdded",function(a){h.videoPanel||h.createVideoPanel();h.remoteVideo.src=window.URL.createObjectURL(a.data)});this.addEventListener(this.p2p,"localStreamAdded",function(a){h.videoPanel||
h.createVideoPanel();h.localVideo.src=window.URL.createObjectURL(a.data)});this.addEventListener(this.p2p,"remoteHangup",function(a){h.removeVideoPanel()})}function b(){}var c=Autodesk.Viewing,f=c.Extensions,d=c.Private,g=c.UI,h=f.Collaboration;a.prototype=Object.create(c.UI.DockingPanel.prototype);a.prototype.constructor=a;a.prototype.startSession=function(){var a=this;this.isVisible()||(new b).start(this.viewer.container,function(){a.setVisible(!0,!0)},"Start a Live Review","Start Review")};a.prototype.endSession=
function(){this.isVisible()&&(this.setVisible(!1,!0),this.reset())};a.prototype.updateUsers=function(a){for(var b=document.createElement("tbody"),c=0;c<a.length;c++){var d=b.insertRow(-1);d.id=a[c].id;var f=d.insertCell(0);f.style.width="14px";f.style.cursor="default";var g=document.createElement("div");g.classList.add("statusBase");g.classList.add("statusNormal");g.innerHTML="&#9679";f.appendChild(g);d.insertCell(1).textContent=a[c].name}this.table.replaceChild(b,this.tbody);this.tbody=b;this.fixComponentPlacement()};
a.prototype.updateUserInControl=function(a){for(var b=0;b<this.tbody.rows.length;b++){var c=this.tbody.rows[b],d=c.cells[0].childNodes[0];c.id==a?(d.classList.remove("statusNormal"),d.classList.add("statusInControl"),d.innerHTML="&#9784",c.cells[1].style.color="#4CBA36"):(d.classList.remove("statusInControl"),d.classList.add("statusNormal"),d.innerHTML="&#9679",c.cells[1].style.color="#ffffff")}};a.prototype.updateChatHistory=function(a){var b=this.client.getUserById(a.data.from,a.channelId);if("/"!=
a.data.msg.charAt(0)){if(this.chatHistory.lastUser!=b.name){var c=document.createElement("p"),d=document.createElement("div");d.classList.add("heading");d.style.float="left";d.style.fontStyle="normal";d.style.color="#857E7E";d.textContent=b.name;c.appendChild(d);d=document.createElement("div");d.classList.add("heading");d.style.textAlign="right";d.style.fontStyle="normal";d.style.color="#857E7E";d.textContent=(new Date).toLocaleTimeString();c.appendChild(d);this.chatHistory.appendChild(c);this.chatHistory.lastUser=
b.name}else b=document.createElement("br"),this.chatHistory.appendChild(b);b=document.createElement("span");b.classList.add("messageText");b.textContent=a.data.msg;this.chatHistory.appendChild(b);this.chatHistory.scrollTop=this.chatHistory.scrollHeight}};a.prototype.handleChatInput=function(a){13==a.which&&0!=this.textInput.value.length&&(this.client.sendChatMessage(this.textInput.value,this.viewtx.channelId),this.textInput.value="",this.textInput.placeholder="")};a.prototype.fixComponentPlacement=
function(a){a=this.tableContainer.offsetHeight+this.chatPanel.offsetHeight;this.videoPanel&&(a+=this.videoPanel.offsetHeight);this.chatHistory.style.height="calc(100% - "+a+"px)"};a.prototype.createVideoPanel=function(a){this.videoPanel=document.createElement("div");this.videoPanel.classList.add("videoPanel");this.localVideo=document.createElement("video");this.localVideo.autoplay=!0;this.localVideo.muted=!0;this.localVideo.classList.add("videoInset");this.videoPanel.appendChild(this.localVideo);
this.remoteVideo=document.createElement("video");this.remoteVideo.autoplay=!0;this.remoteVideo.classList.add("videoMain");this.videoPanel.appendChild(this.remoteVideo);var b=this;a=document.createElement("div");a.classList.add("dockingPanelClose");a.innerHTML="&times";a.title="End video call";a.onclick=function(a){b.p2p.hangup();b.removeVideoPanel()};this.videoPanel.appendChild(a);this.content.insertBefore(this.videoPanel,this.chatHistory);this.fixComponentPlacement()};a.prototype.removeCollabPrompt=
function(){var a=document.getElementById("collabBox");a&&(a.style.visibility="hidden",this.viewer.container.removeChild(a))};a.prototype.removeVideoPanel=function(){this.videoPanel&&this.content.removeChild(this.videoPanel);this.videoPanel=null};a.prototype.reset=function(a){this.tbody&&(a=document.createElement("tbody"),this.table.replaceChild(a,this.tbody),this.tbody=a);this.chatHistory.textContent="";this.textInput.value="";this.removeVideoPanel();this.removeCollabPrompt()};b.prototype.start=function(a,
b,c,f,g){if(a){var h=document.createElement("div");h.id="collabBox";h.className="collabBox";a.appendChild(h);var t=document.createElement("div");t.className="collabBoxTitle";t.textContent=Autodesk.Viewing.i18n.translate(c,{defaultValue:c});h.appendChild(t);c=document.createElement("span");c.className="collabBoxText";t="Enter your name:";g&&(t="Review URL");c.textContent=Autodesk.Viewing.i18n.translate(t,{defaultValue:t});h.appendChild(c);c=document.createElement("span");c.className="collabBoxInputContainer";
h.appendChild(c);var v=document.createElement("input");v.type="text";v.className="collabBoxInputText";g&&(t=window.location.toString(),t=-1==t.indexOf("?")?t+"?invited=true":t+"&invited=true",Autodesk.Viewing.Private.docItemId&&(t+="&itemid="+Autodesk.Viewing.Private.docItemId),v.value=t+"&doNotRedirect=true");c.appendChild(v);v.onkeyup=function(c){13==c.keyCode&&(h.style.visibility="hidden",a.removeChild(h),d.setUserName(v.value),b())};c=document.createElement("div");c.className="collabBoxClose";
c.innerHTML="&times;";c.addEventListener("click",function(b){h.style.visibility="hidden";a.removeChild(h)});h.appendChild(c);g?(c=document.createElement("span"),c.className="collabBoxText",c.style.marginTop="0px",t="Copy and send this URL to invite others",c.textContent=Autodesk.Viewing.i18n.translate(t,{defaultValue:t})):(c=document.createElement("div"),c.className="collabBoxOK",c.textContent=Autodesk.Viewing.i18n.translate(f,{defaultValue:f}),c.addEventListener("click",function(c){h.style.visibility=
"hidden";a.removeChild(h);""!==v.value.trim()&&d.setUserName(v.value);b()}));h.appendChild(c);h.style.visibility="visible";v.focus();g&&v.select()}};f.Collaboration.Collaboration=function(a,b){c.Extension.call(this,a,b);b&&b.rtc&&b.rtc.disableRTCToolbarButton&&(this.disableRTCToolbarButton=!0);this.viewer=a};f.Collaboration.Collaboration.prototype=Object.create(c.Extension.prototype);f.Collaboration.Collaboration.prototype.constructor=f.Collaboration.Collaboration;f.Collaboration.Collaboration.prototype.initNetwork=
function(a){if(!this.p2p||a)this.viewtx=new h.ViewTransceiver(this.client),this.interceptor=new h.InteractionInterceptor(this.viewtx),this.viewer.toolController.registerTool(this.interceptor),this.p2p=new d.P2PClient(this.client)};f.Collaboration.Collaboration.prototype.createUI=function(){var c=this,h=this.viewer;this.initNetwork(!1);this.panel=new a(this.viewer,this.client,this.p2p,this.viewtx);f.Collaboration.Collaboration.Panel=this.panel;this.collabButton=new g.Button("toolbar-collaborateTool");
this.collabButton.setToolTip("Live review");this.collabButton.setIcon("adsk-icon-live-review");this.collabButton.onClick=function(a){c.panel.isVisible()?(c.panel.setVisible(!1,!0),c.panel.reset()):(new b).start(h.container,function(){c.panel.setVisible(!0,!0)},"Start a Live Review","Start Review")};this.disableRTCToolbarButton&&this.collabButton.setVisible(!1,!0);this.panel.addVisibilityListener(function(a){a?(h.model&&(a=h.model.getData(),c.viewtx.channelId=a.basePath,c.viewtx.attach(h),c.client.connect(c.viewtx.channelId),
c.client.join(c.viewtx.channelId)),h.toolController.activateTool(c.interceptor.getName()),c.collabButton.setState(g.Button.State.ACTIVE),d.logger&&d.logger.log({category:"viewer_rtc_start"})):(d.logger&&c.client.isConnected()&&d.logger.log({category:"viewer_rtc_stop"}),c.p2p.hangup(),c.viewtx.detach(h),c.viewtx.channelId=null,c.client.disconnect(),c.panel.reset(),h.toolController.deactivateTool(c.interceptor.getName()),c.collabButton.setState(g.Button.State.INACTIVE))});h.modelTools.addControl(this.collabButton);
Autodesk.Viewing.Private.getParameterByName("invited")&&(new b).start(h.container,function(){c.panel.setVisible(!0,!0)},"Join a Live Review","Join Review")};f.Collaboration.Collaboration.prototype.close=function(){this.panel.setVisible(!1,!0);this.panel.reset()};f.Collaboration.Collaboration.prototype.load=function(){var a=this.viewer,b=this;d.loadDependency("io","socket.io-1.3.5.js",function(){function c(d){a.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,c);b.createUI()}b.client=d.MessageClient.GetInstance(b.options?
b.options.messageServerURL:void 0);b.client.addEventListener("socketError",function(c){d.ErrorHandler.reportError(a.container,Autodesk.Viewing.ErrorCodes.RTC_ERROR,c.data);b.close()});b.presenceChannelId=window.location.host;b.client.isConnected();a.modelTools&&0<a.modelTools.getNumberOfControls()?b.createUI():a.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,c)});return!0};f.Collaboration.Collaboration.prototype.unload=function(){var a=this.viewer;this.p2p.hangup();this.viewtx.detach(a);
this.client.disconnect();a.toolController.deactivateTool(this.interceptor.getName());this.panel&&(this.panel.reset(),this.panel.setVisible(!1),this.panel.uninitialize(),this.panel=null);a.modelTools.removeControl(this.collabButton.getId());this.collabButton=null;return!0};c.theExtensionManager.registerExtension("Autodesk.Viewing.Collaboration",f.Collaboration.Collaboration)})();"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Beeline");
Autodesk.Viewing.Extensions.Beeline.BeelineExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b)};Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.constructor=Autodesk.Viewing.Extensions.Beeline.BeelineExtension;
Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.load=function(){var a=this,b=this.viewer,c=b.getToolbar(!0),f=Autodesk.Viewing.UI;this.tool=new Autodesk.Viewing.Extensions.Beeline.BeelineTool(b.impl,b);b.toolController.registerTool(this.tool);this.createUI(c);var d;this.HOTKEYS_ID="Autodesk.Beeline.Hotkeys";c=[];c.push({keycodes:[Autodesk.Viewing.theHotkeyManager.KEYCODES.CONTROL,Autodesk.Viewing.theHotkeyManager.KEYCODES.ALT],onPress:function(){d=b.getActiveNavigationTool();b.setActiveNavigationTool(a.tool.getName());
return!0},onRelease:function(){b.setActiveNavigationTool(d?d:b.defaultNavigationToolName);return!0}});Autodesk.Viewing.theHotkeyManager.pushHotkeys(this.HOTKEYS_ID,c);this.onToolChanged=function(b){-1!==b.toolName.indexOf("beeline")&&a.beelineButton.setState(b.active?f.Button.State.ACTIVE:f.Button.State.INACTIVE)};b.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged);return!0};
Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.createUI=function(a){var b=Autodesk.Viewing.UI;a=a.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);var c=this.viewer,f=new b.Button("toolbar-beelineTool");f.setToolTip("Walk to");f.setIcon("adsk-icon-walk");f.onClick=function(a){a=f.getState();a===b.Button.State.INACTIVE?c.setActiveNavigationTool("beeline"):a===b.Button.State.ACTIVE&&c.setActiveNavigationTool()};this.beelineButton=f;var d=a.getControl("toolbar-cameraSubmenuTool");d?a.addControl(this.beelineButton,
{index:a.indexOf(d.getId())}):a.addControl(this.beelineButton);var g=this,h=function(){c.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,h);var a=Autodesk.Viewing.Extensions.ViewerSettingTab.Navigation,b=c.getSettingsPanel(!0);g.viewerOption_LookHorId=b.addCheckbox(a,"Reverse horizontal look direction",!1,function(a){c.setReverseHorizontalLookDirection(a)},"reverseHorizontalLookDirection");g.viewerOption_LookVertId=b.addCheckbox(a,"Reverse vertical look direction",!1,function(a){c.setReverseVerticalLookDirection(a)},
"reverseVerticalLookDirection")};this.viewer.getSettingsPanel(!1)?h():this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,h)};
Autodesk.Viewing.Extensions.Beeline.BeelineExtension.prototype.unload=function(){var a=this.viewer;a.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged);this.onToolChanged=void 0;Autodesk.Viewing.theHotkeyManager.popHotkeys(this.HOTKEYS_ID);var b=a.getToolbar(!1);b&&b.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID).removeControl(this.beelineButton.getId());this.beelineButton=null;this.viewer.getSettingsPanel(!1).removeCheckbox(this.viewerOption_LookHorId);this.viewer.getSettingsPanel(!1).removeCheckbox(this.viewerOption_LookVertId);
a.getActiveNavigationTool()==this.tool.getName()&&a.setActiveNavigationTool();a.toolController.deregisterTool(this.tool);this.tool=null;return!0};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Beeline",Autodesk.Viewing.Extensions.Beeline.BeelineExtension);AutodeskNamespace("Autodesk.Viewing.Extensions.Beeline");
Autodesk.Viewing.Extensions.Beeline.BeelineTool=function(a,b){function c(){h.revertToStartState()}function f(a){var b={};b.target=a.target.clone();b.worldup=a.worldup.clone();b.position=a.position.clone();b.up=a.up.clone();for(var c="isPerspective fov zoom aspect left right top bottom".split(" "),d=0;d<c.length;d++)b[c[d]]=a[c[d]];return b}function d(b){var c=new THREE.Vector3(b.x,b.y,1);b=a.hitTestViewport(c.clone(),!1);if(!b.intersectPoint)return[];var d=b.node.fragIds instanceof Array?b.node.fragIds:
[b.node.fragIds];b=[];for(var f=0;f<d.length;f++){var g=a.getRenderProxy(this.model,d[f]);g&&b.push(g)}d=new THREE.Raycaster;c=c.clone();f=a.camera;g=new THREE.Vector3(c.x,c.y,1);c.z=-1;c=c.unproject(f);g=g.unproject(f);g.sub(c).normalize();d.set(n.isPerspective?f.position:c,g);return d.intersectObjects(b,!1)}function g(){n.isPerspective||(n.toPerspective(),q.activatePivot(!1));28<n.getFocalLength()&&n.setFocalLength(28,!0)}var h=this,k=b.container,l=b.autocam,n=b.navigation,q=b.utilities,m=["beeline"],
p=0,t=!1,v=0,D=null,w=null,F=new THREE.Vector3,B=new THREE.Vector3,z=new THREE.Vector3,G=new THREE.Vector3,A=!1,E=new THREE.Vector3,H=new THREE.Vector3,I=null,J=null;this.getNames=function(){return m};this.getName=function(){return m[0]};this.activate=function(a){v=0;b.addEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,c);l.userLookSpeed=.8;this.showHUDMessage(!0)};this.deactivate=function(){b.removeEventListener(Autodesk.Viewing.FULLSCREEN_MODE_EVENT,c);this.revertToStartState();this.showHUDMessage(!1)};
this.getCursor=function(){return t?"url(data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAQAAADYBBcfAAAACXBIWXMAABYlAAAWJQFJUiTwAAADGGlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjaY2BgnuDo4uTKJMDAUFBUUuQe5BgZERmlwH6egY2BmYGBgYGBITG5uMAxIMCHgYGBIS8/L5UBFTAyMHy7xsDIwMDAcFnX0cXJlYE0wJpcUFTCwMBwgIGBwSgltTiZgYHhCwMDQ3p5SUEJAwNjDAMDg0hSdkEJAwNjAQMDg0h2SJAzAwNjCwMDE09JakUJAwMDg3N+QWVRZnpGiYKhpaWlgmNKflKqQnBlcUlqbrGCZ15yflFBflFiSWoKAwMD1A4GBgYGXpf8EgX3xMw8BSMDVQYqg4jIKAUICxE+CDEESC4tKoMHJQODAIMCgwGDA0MAQyJDPcMChqMMbxjFGV0YSxlXMN5jEmMKYprAdIFZmDmSeSHzGxZLlg6WW6x6rK2s99gs2aaxfWMPZ9/NocTRxfGFM5HzApcj1xZuTe4FPFI8U3mFeCfxCfNN45fhXyygI7BD0FXwilCq0A/hXhEVkb2i4aJfxCaJG4lfkaiQlJM8JpUvLS19QqZMVl32llyfvIv8H4WtioVKekpvldeqFKiaqP5UO6jepRGqqaT5QeuA9iSdVF0rPUG9V/pHDBYY1hrFGNuayJsym740u2C+02KJ5QSrOutcmzjbQDtXe2sHY0cdJzVnJRcFV3k3BXdlD3VPXS8Tbxsfd99gvwT//ID6wIlBS4N3hVwMfRnOFCEXaRUVEV0RMzN2T9yDBLZE3aSw5IaUNak30zkyLDIzs+ZmX8xlz7PPryjYVPiuWLskq3RV2ZsK/cqSql01jLVedVPrHzbqNdU0n22VaytsP9op3VXUfbpXta+x/+5Em0mzJ/+dGj/t8AyNmf2zvs9JmHt6vvmCpYtEFrcu+bYsc/m9lSGrTq9xWbtvveWGbZtMNm/ZarJt+w6rnft3u+45uy9s/4ODOYd+Hmk/Jn58xUnrU+fOJJ/9dX7SRe1LR68kXv13fc5Nm1t379TfU75/4mHeY7En+59lvhB5efB1/lv5dxc+NH0y/fzq64Lv4T8Ffp360/rP8f9/AA0ADzT6lvFdAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAEtSURBVHja7JQxTkJBFEXPQ/xQEDG0ljRYSU1iLN2AtSWlC7Gw04QtGF2ApQVLIDY2hlgIDagJwWCOhf74JXxRYumbaib3ZO7c9zIhq1WBfzAfjJViDWPdYBq/w0pKITjhd7eGJwQkDu2I8rOFHYcmkqgDz4wfoeGZA01BHXtsbSla89ixZsH3an2LtpRUOQde28xFm17PgyPvVK1bl5yYEOtuq3rnyMQCXNJgiiTchuHCnhrGbYBMaXAJULGqlJz54O43bcFdH5xZUqpWJJWW7duza/tDmTWJbbv27Fs2PS2m1iZRNeGcI/aAEevOgCKnbAI7DNjjhUmk1ouf7xgHbLgF3MSzT7wCaxxSiW3hnsf4OngLotj3ILO74CoWTWzOIGcTXab4/6z+CnwbAGjXSZC++vLvAAAAAElFTkSuQmCC), auto":
1>=v?"url(data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAQdJREFUeNq0k0GOgzAMRZ+jHI4VO4410qzam0aCjbsoaS1PUgfoWIqAEPnZ3z8AN0DNWoFfVeUbC0BtrOtaISNhC3tvGkC2P7ZtY1kWgHul90JEtCYTkVqo7O844LPyeZ51RJ5atQ3biZeolFJ0miYd1d4nd5A/gB+g7E++AFB7VqzWIkKkfdW/d27P8RpE4p8jRy7Z9ZBOpSEgRRb0MAv0lmxZNEXJj0IACTvwrfeksJBW9a0Z6NEh+vl4UI6qHzHBJ4nyFQv6YoaG3Ls80X7vTIqS1W+vdWvArfuSG/pplPzTBRy6ybaLkSSHAFcThoCe/c6C81n7jUY6a78rHQigftBnQY8BAEubfpuApyq2AAAAAElFTkSuQmCC), auto":
null};this.update=function(){var a=n.getCamera(),c=t=!1;if(1===v){var d=E.clone().sub(H);if(0!==d.x||0!==d.y){t=!0;H.x+=.7*d.x;H.y+=.7*d.y;var c=n.getWorldUpVector().dot(n.getCameraUpVector()),g=b.prefs.reverseHorizontalLookDirection?-1:1,h=b.prefs.reverseVerticalLookDirection?-1:1;d.x*=0>c?-g:g;d.y*=h;l.sync(n.getCamera());l.look(d);c=!0;I=f(a)}}return c};this.revertToStartState=function(){q.pivotActive(!1);p=0;A=!0};this.attemptFlight=function(a,b){var c=d(a);0<c.length&&(F=c[0].point,B=c[c.length-
1].point,h.fly(1E3,b))};this.fly=function(a,b){q.setPivotPoint(0===b?F:B,!0,!0);g();z=n.getPosition();w=a;switch(b){case 0:G=z.clone().lerp(F,.8);break;case 1:var c=2*l.camera.near,d=B.clone().sub(z).length(),c=c/d;q.setPivotPoint(z.clone().lerp(B,1+10*c),!0,!0);G=z.clone().lerp(B,1+c);break;default:return}p=1;A=!1;D=null;requestAnimationFrame(h.step)};this.step=function(a){var b=n.getCamera();if(!A){if(null===D)I=f(b),D=a;else{var c;a:if(c=I,b.target.equals(c.target)&&b.position.equals(c.position)&&
b.worldup.equals(c.worldup)&&b.up.equals(c.up)){for(var d="isPerspective fov zoom aspect left right top bottom".split(" "),g=0;g<d.length;g++)if(b[d[g]]!==c[d[g]]){c=!1;break a}c=!0}else c=!1;if(!c){h.revertToStartState();return}}a-=D;c=a<w?a/w:1;c=z.clone().lerp(G,c);d=n.getEyeVector();d.multiplyScalar(n.getPivotPoint().sub(n.getPosition()).length()/d.length());n.setView(c,d.add(c));I=f(b);q.activatePivot(!1);a<w?requestAnimationFrame(h.step):h.revertToStartState()}};this.handleGesture=function(a){switch(a.type){case "dragstart":return J=
"drag",this.handleButtonDown(a,0);case "dragmove":return"drag"===J?this.handleMouseMove(a):!1;case "dragend":if("drag"===J)return this.handleButtonUp(a,0),J=null,!0}return!1};this.handleButtonDown=function(a,b){v+=1<<b;return 0===b?(H.x=E.x=a.canvasX,H.y=E.y=a.canvasY,!0):!1};this.handleButtonUp=function(a,b){v-=1<<b;return 0===b?!0:!1};this.handleSingleClick=function(a,b){if(0===b){var c={x:a.normalizedX,y:a.normalizedY};switch(p){case 0:h.attemptFlight(c,0);break;case 1:h.revertToStartState()}}else return this.revertToStartState(),
!1;return!0};this.handleSingleTap=function(a){return this.handleSingleClick(a,0)};this.handleDoubleTap=function(a){return a.pointers&&1===a.pointers.length?(h.attemptFlight({x:a.normalizedX,y:a.normalizedY},1),!0):!1};this.handleDoubleClick=function(a,b){return 0===b?(h.attemptFlight({x:a.normalizedX,y:a.normalizedY},1),!0):!1};this.handleMouseMove=function(a){E.x=a.canvasX;E.y=a.canvasY;return 1===v?(g(),!0):!1};this.handleBlur=function(a){this.revertToStartState();return!1};this.showOrthoWarningMessage=
function(){Autodesk.Viewing.Private.HudMessage.displayMessage(k,{msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic Beeline",messageDefaultValue:"The view is set to Orthographic. Using this tool will switch to Perspective."})};this.showFocalWarningMessage=function(){Autodesk.Viewing.Private.HudMessage.displayMessage(k,{msgTitleKey:"Long Focal Length View Set",messageKey:"The view is set to a long focal length",messageDefaultValue:"This view has a long focal length. Using this tool will set a short focal length."})};
this.watchCamera=function(a){if(b.toolController.getActiveToolName()===m[0]||b.toolController.getActiveToolName()===m[1]){a=(a=n.getCamera())&&!a.isPerspective;var c=28<n.getFocalLength();a?h.showOrthoWarningMessage():c?h.showFocalWarningMessage():Autodesk.Viewing.Private.HudMessage.dismiss()}};this.showHUDMessage=function(a){var c=n.getCamera(),c=c&&!c.isPerspective,d=28<n.getFocalLength();a&&c?h.showOrthoWarningMessage():a&&d?h.showFocalWarningMessage():Autodesk.Viewing.Private.HudMessage.dismiss();
a?b.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,h.watchCamera):b.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,h.watchCamera)}};"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.DefaultTools");
(function(){function a(a,b,c){return function(){var k=b.getState();k===f.Button.State.INACTIVE?(a.setActiveNavigationTool(c),b.setState(f.Button.State.ACTIVE)):k===f.Button.State.ACTIVE&&(a.setActiveNavigationTool(),b.setState(f.Button.State.INACTIVE))}}var b=Autodesk.Viewing,c=Autodesk.Viewing.Extensions.DefaultTools,f=Autodesk.Viewing.UI;c.NavToolsExtension=function(a,c){b.Extension.call(this,a,c)};c.NavToolsExtension.prototype=Object.create(b.Extension.prototype);c.NavToolsExtension.prototype.constructor=
c.NavToolsExtension;c.NavToolsExtension.prototype.load=function(){var a=this.viewer,c=new b.FovTool(a),f=new b.WorldUpTool(a.impl,a);a.toolController.registerTool(c);a.toolController.registerTool(f);this.createUI();this.initCameraStateMachine();this.initFocalLengthOverlay();return!0};c.NavToolsExtension.prototype.createUI=function(){var c=this.viewer,g=c.getToolbar(!0).getControl(b.TOOLBAR.NAVTOOLSID);g.returnToDefault=function(){};if("3d"===this.options.mode){var h=new f.ComboButton("toolbar-orbitTools");
h.setToolTip("Orbit");h.setIcon("adsk-icon-orbit-constrained");this.createOrbitSubmenu(h);g.addControl(h);g.orbittoolsbutton=h;h.setState(f.Button.State.ACTIVE);g.returnToDefault=function(){h.setState(f.Button.State.ACTIVE)}}var k=new f.Button("toolbar-panTool");k.setToolTip("Pan");k.setIcon("adsk-icon-pan");k.onClick=a(c,k,"pan");g.addControl(k);g.panbutton=k;k=new f.Button("toolbar-zoomTool");k.setToolTip("Zoom");k.setIcon("adsk-icon-zoom");k.onClick=a(c,k,"dolly");g.addControl(k);g.dollybutton=
k;c=new f.ComboButton("toolbar-cameraSubmenuTool");c.setToolTip("Camera interactions");c.setIcon("adsk-icon-camera");this.createCameraSubmenu(c);g.addControl(c);g.camerabutton=c};c.NavToolsExtension.prototype.createOrbitSubmenu=function(c){var g=this.viewer,h=g.getToolbar(!0).getControl(b.TOOLBAR.NAVTOOLSID),k=new f.Button("toolbar-freeOrbitTool");k.setToolTip("Free orbit");k.setIcon("adsk-icon-orbit-free");k.onClick=a(g,k,"freeorbit");c.addControl(k);h.freeorbitbutton=k;k=new f.Button("toolbar-orbitTool");
k.setToolTip("Orbit");k.setIcon("adsk-icon-orbit-constrained");k.onClick=a(g,k,"orbit");c.addControl(k);h.orbitbutton=k;c.onClick=k.onClick};c.NavToolsExtension.prototype.createCameraSubmenu=function(c){var g=this,h=this.viewer,k=h.getToolbar(!0).getControl(b.TOOLBAR.NAVTOOLSID);if(isTouchDevice()){var l=new f.Button("toolbar-homeTool");l.setToolTip("Home");l.setIcon("adsk-icon-home");l.onClick=function(){h.navigation.setRequestHomeView(!0)};c.addControl(l);k.homebutton=l}l=new f.Button("toolbar-fitToViewTool");
l.setToolTip("Fit to view");l.setIcon("adsk-icon-fit-to-view");l.onClick=function(a){h.fitToView("3d"===g.options.mode?h.getSelection().map(function(a){return a.dbId}):void 0)};c.addControl(l);k.fovbutton=l;"3d"===this.options.mode&&(l=new f.Button("toolbar-focalLengthTool"),l.setToolTip("Focal length"),l.setIcon("adsk-icon-focal-length"),l.onClick=a(h,l,"fov"),c.addControl(l),k.fovbutton=l);l=new f.Button("toolbar-rollTool");l.setToolTip("Roll");l.setIcon("adsk-icon-roll");l.onClick=a(h,l,"worldup");
c.addControl(l);k.rollbutton=l};c.NavToolsExtension.prototype.initCameraStateMachine=function(a){var c=this,f=this.viewer,k=f.getToolbar(!0).getControl(b.TOOLBAR.NAVTOOLSID);this.toolChangedHandler=function(a){"fov"===a.toolName&&c.showFocalLengthOverlay(a.active)};f.addEventListener(b.TOOL_CHANGE_EVENT,this.toolChangedHandler);this.navChangedHandler=function(a){f.getDefaultNavigationToolName()===a.id&&k.returnToDefault()};f.addEventListener(b.NAVIGATION_MODE_CHANGED_EVENT,this.navChangedHandler)};
c.NavToolsExtension.prototype.initFocalLengthOverlay=function(){var a=this.focallength=document.createElement("div");a.className="focallength";var b=document.createElement("table"),c=document.createElement("tbody");b.appendChild(c);a.appendChild(b);this.viewer.container.appendChild(a);b=c.insertRow(-1);c=b.insertCell(0);c.setAttribute("data-i18n","Focal Length");c.textContent=Autodesk.Viewing.i18n.translate("Focal Length");c=b.insertCell(1);c.textContent="";c.style.width="4em";c.style.textAlign="right";
this.fovCell=c;a.style.visibility="hidden"};c.NavToolsExtension.prototype.showFocalLengthOverlay=function(a){function c(a){a?b.Private.HudMessage.displayMessage(q.container,{msgTitleKey:"Orthographic View Set",messageKey:"The view is set to Orthographic",messageDefaultValue:"The view is set to Orthographic. Changing the focal length will switch to Perspective."}):b.Private.HudMessage.dismiss()}function f(a){a&&k();n.focallength&&(n.focallength.style.visibility=a?"visible":"hidden")}function k(){var a=
q.getFocalLength();m!==a&&(m=a,n.fovCell.textContent=a.toString()+" mm")}function l(a){k();"fov"===q.toolController.getActiveToolName()&&(a=(a=q.navigation.getCamera())&&!a.isPerspective,f(!a),c(a))}var n=this,q=this.viewer,m=0,p=q.navigation.getCamera(),p=p&&!p.isPerspective;f(a&&!p);c(a&&p);a?q.addEventListener(b.CAMERA_CHANGE_EVENT,l):q.removeEventListener(b.CAMERA_CHANGE_EVENT,l)};c.NavToolsExtension.prototype.unload=function(){this.destroyUI();return!0};c.NavToolsExtension.prototype.destroyUI=
function(){var a=this.viewer,c=a.getToolbar(!1);if(!c)return!0;c=c.getControl(b.TOOLBAR.NAVTOOLSID);if(!c)return!0;"3d"===this.options.mode&&(c.orbittoolsbutton.subMenu.removeEventListener(f.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,c.orbittoolsbutton.subMenuActiveButtonChangedHandler(c)),c.removeControl(c.orbittoolsbutton.getId()),c.orbittoolsbutton=null);c.removeControl(c.panbutton.getId());c.panbutton=null;c.removeControl(c.dollybutton.getId());c.dollybutton=null;c.camerabutton.subMenu.removeEventListener(f.RadioButtonGroup.Event.ACTIVE_BUTTON_CHANGED,
c.camerabutton.subMenuActiveButtonChangedHandler(c));c.removeControl(c.camerabutton.getId());c.camerabutton=null;a.removeEventListener(b.TOOL_CHANGE_EVENT,this.toolChangedHandler);this.toolChangedHandler=null;a.removeEventListener(b.NAVIGATION_MODE_CHANGED_EVENT,this.navChangedHandler);this.navChangedHandler=null;return!0};b.theExtensionManager.registerExtension("Autodesk.DefaultTools.NavTools",c.NavToolsExtension)})();"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Measure");
Autodesk.Viewing.Extensions.Measure.MeasureExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b)};Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.constructor=Autodesk.Viewing.Extensions.Measure.MeasureExtension;
Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.load=function(){function a(){b.createUI()}var b=this,c=this.viewer;this.escapeHotkeyId="Autodesk.Measure.Hotkeys.Escape";if(!c.toolController)return!1;this.tool=new Autodesk.Viewing.Extensions.Measure.MeasureTool(c,{onCloseCallback:function(a){b.enableMeasureTool(!1)}});c.toolController.registerTool(this.tool);this.viewer.toolbar?0<this.viewer.toolbar.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID).getNumberOfControls()?this.createUI():
this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a):this.viewer.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);return!0};Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.unload=function(){var a=this.viewer;this.destroyUI();a.toolController.deregisterTool(this.tool);this.tool=null;return!0};
Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.enableMeasureTool=function(a){if(this.tool){var b=this.viewer.toolController,c=this.tool.isActive();if(a&&!c)return b.activateTool("measure"),this.measureToolButton.setState(Autodesk.Viewing.UI.Button.State.ACTIVE),!0;if(!a&&c)return b.deactivateTool("measure"),this.measureToolButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE),!0}return!1};
Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.createUI=function(){var a=Autodesk.Viewing.UI,b=this,c=this.viewer;this.measureToolButton=null;c=c.getToolbar(!0).getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID);this.measureToolButton=new a.Button("toolbar-measureTool");this.measureToolButton.setToolTip("Measure");this.measureToolButton.setIcon("adsk-icon-measure");this.measureToolButton.onClick=function(a){b.enableMeasureTool(!b.tool.isActive())};this.onMeasureButtonStateChange=function(c){c.state===
a.Button.State.ACTIVE?b.enableMeasureTool(!0):c.state===a.Button.State.INACTIVE&&b.enableMeasureTool(!1)};this.measureToolButton.addEventListener(a.Button.Event.STATE_CHANGED,this.onMeasureButtonStateChange);c.addControl(this.measureToolButton,{index:0});Autodesk.Viewing.theHotkeyManager.pushHotkeys(this.escapeHotkeyId,[{keycodes:[Autodesk.Viewing.theHotkeyManager.KEYCODES.ESCAPE],onRelease:function(){return b.enableMeasureTool(!1)}}])};
Autodesk.Viewing.Extensions.Measure.MeasureExtension.prototype.destroyUI=function(){var a=this.viewer;if(!a.model.is2d()){this.measureToolButton&&this.measureToolButton.removeEventListener(Autodesk.Viewing.UI.Button.Event.STATE_CHANGED,this.onMeasureButtonStateChange);if(a=a.getToolbar(!1))if(a=a.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID)){if(this.measureToolButton){var b=a.getControl("toolbar-inspectSubMenu");b?b.removeControl(this.measureToolButton.getId()):a.removeControl(this.measureToolButton.getId())}this.measureToolButton=
null}Autodesk.Viewing.theHotkeyManager.popHotkeys(this.escapeHotkeyId)}};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Measure",Autodesk.Viewing.Extensions.Measure.MeasureExtension);AutodeskNamespace("Autodesk.Viewing.Extensions.Measure");
Autodesk.Viewing.Extensions.Measure.MeasureTool=function(a,b){function c(){A.updateLabelPositions()}function f(){g.clearMeasurement()}function d(a){var b=this,c=!1,d=null,f=null,k=null,l=null,m=null,p=null,B={first:{},second:{}},z={first:{},second:{}},A={first:{},second:{}},C={xyz:{axis:!1,color:"00CC00"},x:{axis:!0,color:"FF0000"},y:{axis:!0,color:"00FF00"},z:{axis:!0,color:"0000FF"}},E={},K=[];this.showFirstVertex=function(a){var b=this.setScale(a);this.showEndPoint("first",a,b)};this.showSecondVertex=
function(a){var b=this.setScale(a);this.showEndPoint("second",a,b)};this.showEndPoint=function(a,b,c){d||(d=new THREE.MeshPhongMaterial({color:3355647,ambient:3355647,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1}),h.impl.createOverlayScene("MeasureTool-endPoint"));a=B[a];var f=a.mesh;f||(a.geometry=new THREE.SphereGeometry(1),f=a.mesh=new THREE.Mesh(a.geometry,d),h.impl.addOverlay("MeasureTool-endPoint",f));f.scale.x=c;f.scale.y=c;f.scale.z=c;f.position.set(b.x,b.y,b.z);f.visible=!0;h.impl.invalidate(!1,
!1,!0)};this.setScale=function(a){var b=h.navigation,c=b.getCamera(),d=b.getEyeVector(),f=b.getPosition();a=a.clone();c=c.isPerspective?a.sub(f).dot(d.normalize()):b.getEyeVector().length();d=b.getVerticalFov();c=2*c*Math.tan(THREE.Math.degToRad(.5*d));b=b.getScreenViewport();return 5*c/(b.height*(window.devicePixelRatio||1))};this.updateScale=function(){var a=h.impl.overlayScenes["MeasureTool-endPoint"];if(a)for(var a=a.scene,b=0;b<a.children.length;b++){var c=a.children[b];if(c){var d=this.setScale(c.position);
c.scale.x=d;c.scale.y=d;c.scale.z=d}}if(a=h.impl.overlayScenes["MeasureTool-extensionLine"])for(a=a.scene,b=0;b<a.children.length;b++)if(c=a.children[b])d=this.setScale(c.geometry.vertices[0]),c.material.dashSize=4*d,c.material.gapSize=2*d};this.showFirstEdge=function(a,b){this.showEdge("first",a,b)};this.showSecondEdge=function(a,b){this.showEdge("second",a,b)};this.showEdge=function(a,b,c){f||(f=new THREE.LineBasicMaterial({color:3355647,opacity:.5,linewidth:5,depthTest:!1,depthWrite:!1}),h.impl.createOverlayScene("MeasureTool-edge"));
a=z[a];a.line&&h.impl.removeOverlay("MeasureTool-edge",a.line);a.line=new THREE.Line(b,f,THREE.LinePieces);h.impl.addOverlay("MeasureTool-edge",a.line);if(t||G){var d=a.label;d||(d=a.label=document.createElement("div"),d.className="measure-label",h.container.appendChild(d));d.textContent="Length = "+this.getEdgeLength(b);d.classList.toggle("visible",!0);a.intersectPoint=c.clone();this.updateLabelPositions()}};this.showFirstFace=function(a,b){this.showFace("first",a,b)};this.showSecondFace=function(a,
b){this.showFace("second",a,b)};this.showFace=function(a,b,c){k||(k=new THREE.MeshPhongMaterial({color:3355647,ambient:3355647,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),h.impl.createOverlayScene("MeasureTool-face"));a=A[a];a.mesh&&h.impl.removeOverlay("MeasureTool-face",a.mesh);a.mesh=new THREE.Mesh(b,k);h.impl.addOverlay("MeasureTool-face",a.mesh);if(t||G){var d=a.label;d||(d=a.label=document.createElement("div"),d.className="measure-label",h.container.appendChild(d));
d.textContent="Area = "+this.getFaceArea(b);d.classList.toggle("visible",!0);a.intersectPoint=c.clone();this.updateLabelPositions()}};this.drawExtensionFace=function(a){p||(p=new THREE.MeshPhongMaterial({color:10066329,ambient:10066329,opacity:.25,transparent:!0,depthTest:!1,depthWrite:!1,side:THREE.DoubleSide}),h.impl.createOverlayScene("MeasureTool-extensionFace"));a=new THREE.Mesh(a,p);h.impl.addOverlay("MeasureTool-extensionFace",a)};this.getEdgeLength=function(a){var b=0;a=a.vertices;for(var c=
0;c<a.length;c+=2)b+=a[c].distanceTo(a[c+1]);b=Autodesk.Viewing.Private.convertUnits(h.model.getUnitString(),w,b);return Autodesk.Viewing.Private.formatValueWithUnits(b,w,3,F)};this.getFaceArea=function(a){var b=0;a=a.vertices;for(var c=new THREE.Vector3,d=new THREE.Vector3,f=0;f<a.length;f+=3)c.subVectors(a[f+1],a[f]),d.subVectors(a[f+2],a[f]),b+=c.length()*d.length()*Math.sin(c.angleTo(d))/2;b=Autodesk.Viewing.Private.convertUnits(h.model.getUnitString(),w,b,"square");return w?Autodesk.Viewing.Private.formatValueWithUnits(b,
w+"^2",3,F):Autodesk.Viewing.Private.formatValueWithUnits(b,null,3,F)};this.updateLabels=function(){v===SNAP_EDGE?z.first.label.textContent="Length = "+this.getEdgeLength(n):v===SNAP_FACE&&(A.first.label.textContent="Area = "+this.getFaceArea(n));D===SNAP_EDGE?z.second.label.textContent="Length = "+this.getEdgeLength(q):D===SNAP_FACE&&(A.second.label.textContent="Area = "+this.getFaceArea(q))};this.updateLabelPositions=function(){function a(b,c,d){var f=h.navigation.getCamera(),g=h.navigation.getScreenViewport();
b=new THREE.Vector3(b,c,d);b=b.project(f);return{x:Math.round((b.x+1)/2*g.width),y:Math.round((-b.y+1)/2*g.height)}}function b(c){var d=c.p1,f=c.p2,g=a(d.x,d.y,d.z),h=a(f.x,f.y,f.z),d=h.x-g.x,g=h.y-g.y,h=a(f.x,f.y,f.z),f=h.x,h=h.y;c=c.label.getBoundingClientRect();h=0<g?h+4:h-(c.height+4);f=0>d||0<g?f-(c.width+4):f+4;return{x:f,y:h}}function c(b,d){var f=b.p1,g=b.p2,g=a(f.x+(g.x-f.x)/2,f.y+(g.y-f.y)/2,f.z+(g.z-f.z)/2),f=g.x,g=g.y,h=d.p1,k=d.p2,h=a(h.x,h.y,h.z),l=a(k.x,k.y,k.z),k=f-(f+h.x+l.x)/3,h=
g-(g+h.y+l.y)/3,m=b.label.getBoundingClientRect(),l=m.width/2,m=m.height/2,f=f-l,g=g-m;return{x:0<k?f+l:f-l,y:0<h?g+m:g-m}}for(var d in C)if(C.hasOwnProperty(d)){var f=C[d],g=f.label;g&&(f=f.axis?c(f,C.xyz):b(f),g.style.top=f.y+"px",g.style.left=f.x+"px",K.push(g))}E&&(g=E.label)&&(f=b(E),g.style.top=f.y+"px",g.style.left=f.x+"px",K.push(g));for(d in A)A.hasOwnProperty(d)&&(f=A[d],g=f.label,f=f.intersectPoint,g&&f&&(f=a(f.x,f.y,f.z),g.style.top=f.y+"px",g.style.left=f.x+"px",K.push(g)));for(d in z)z.hasOwnProperty(d)&&
(f=z[d],g=f.label,f=f.intersectPoint,g&&f&&(f=a(f.x,f.y,f.z),g.style.top=f.y+"px",g.style.left=f.x+"px",K.push(g)));for(d=0;d<K.length;d++)for(g=0;g<d;g++)this.labelsOverlapDetection(K[g],K[d]);K=[]};this.labelsOverlapDetection=function(a,b){var c=a.getBoundingClientRect(),d=b.getBoundingClientRect();d.top<=c.bottom&&d.bottom>=c.top&&(d.right>=c.left&&d.right<=c.right?b.style.left=parseInt(b.style.left,10)-(d.right-c.left)+"px":d.left>=c.left&&d.left<=c.right?b.style.left=parseInt(b.style.left,10)+
(c.right-d.left)+"px":d.left<=c.left&&d.right>=c.right&&(b.style.left=parseInt(b.style.left,10)+(c.right-d.left)+"px"))};this.drawLine=function(a,d){function f(a,d,g,k,l,m,n){var p=C[a],q=p.line,w=p.label;d=new THREE.Vector3(d,g,k);m=new THREE.Vector3(l,m,n);q&&(h.impl.removeOverlay("MeasureTool-"+a,q),p.line=null);w&&w.classList.remove("visible");0<d.distanceTo(m)&&(l="xyz"===a||!c&&t,q||(p.material=new THREE.LineBasicMaterial({color:parseInt(p.color,16),linewidth:2,depthTest:!1,depthWrite:!1}),
p.overlayName="MeasureTool-"+a,h.impl.createOverlayScene(p.overlayName)),p.material.opacity=t?1:.5,h.impl.clearOverlay(p.overlayName),q=p.geometry=new THREE.Geometry,q.vertices.push(d),q.vertices.push(m),q=p.line=new THREE.Line(q,p.material),h.impl.addOverlay(p.overlayName,q),q.visible=l,p.p1=d,p.p2=m,"xyz"!=a||t)&&(w||(w=p.label=document.createElement("div"),w.className="measure-length","xyz"===a?(q=document.createElement("div"),q.className="measure-length-text",w.appendChild(q)):w.style.pointerEvents=
"none",p.axis&&(w.style.color="#"+p.color,w.style.backgroundColor="transparent",w.textContent=a),h.container.appendChild(w)),p.axis||b.updateDistance(),w.classList.toggle("visible",l))}f("xyz",a.x,a.y,a.z,d.x,d.y,d.z);var g=h.navigation.getAlignedUpVector(),k=Math.abs(g.x),l=Math.abs(g.y),g=Math.abs(g.z);g>k&&g>l?(f("x",a.x,a.y,a.z,d.x,a.y,a.z),f("y",d.x,a.y,a.z,d.x,d.y,a.z),f("z",d.x,d.y,a.z,d.x,d.y,d.z)):l>k&&l>g?(f("x",a.x,a.y,a.z,d.x,a.y,a.z),f("z",d.x,a.y,a.z,d.x,a.y,d.z),f("y",d.x,a.y,d.z,d.x,
d.y,d.z)):(f("y",a.x,a.y,a.z,a.x,d.y,a.z),f("z",a.x,d.y,a.z,a.x,d.y,d.z),f("x",a.x,d.y,d.z,d.x,d.y,d.z));this.updateLabelPositions()};this.updateDistance=function(){var a=C.xyz.label;a&&(a.children[0].textContent=g.getDistance("xyz"))};this.updateAngle=function(){var a=E.label;a&&(a.textContent=g.getAngle())};this.drawExtensionLine=function(a,b,c){var d=new THREE.Vector3,f=new THREE.Vector3;d.subVectors(b,a);f.subVectors(c,b);a=d.dot(f);d.subVectors(c,b);a=-a/d.dot(d);d.subVectors(c,b);d.multiplyScalar(a);
d=d.add(b);if(0>a)c=d;else if(1<a)b=c,c=d;else return;m||(m=new THREE.LineDashedMaterial({color:parseInt(C.xyz.color,16),linewidth:2,dashSize:1,gapSize:.5,depthTest:!1}),h.impl.createOverlayScene("MeasureTool-extensionLine"));m.opacity=t?1:.5;d=this.setScale(b);m.dashSize=4*d;m.gapSize=2*d;d=new THREE.Geometry;d.vertices.push(b);d.vertices.push(c);d.computeLineDistances();b=new THREE.Line(d,m);h.impl.addOverlay("MeasureTool-extensionLine",b)};this.drawExtensionLinePointToPoint=function(a,b){m||(m=
new THREE.LineDashedMaterial({color:parseInt(C.xyz.color,16),linewidth:2,dashSize:1,gapSize:.5,depthTest:!1}),h.impl.createOverlayScene("MeasureTool-extensionLine"));m.opacity=t?1:.5;var c=this.setScale(a);m.dashSize=4*c;m.gapSize=2*c;c=new THREE.Geometry;c.vertices.push(a);c.vertices.push(b);c.computeLineDistances();c=new THREE.Line(c,m);h.impl.addOverlay("MeasureTool-extensionLine",c)};this.nearestPointsInSegmentToSegment=function(a,b,c,d){var f=new THREE.Vector3,g=new THREE.Vector3,h=new THREE.Vector3;
f.subVectors(b,a);g.subVectors(d,c);h.subVectors(a,c);d=f.dot(f);var k=f.dot(g),l=g.dot(g),m=f.dot(h),n=g.dot(h),p=d*l-k*k,q,w=p;b=p;.001>p?(q=0,w=1,p=n,b=l):(q=k*n-l*m,p=d*n-k*m,0>q?(q=0,p=n,b=l):q>w&&(q=w,p=n+k,b=l));0>p?(p=0,0>-m?q=0:-m>d?q=w:(q=-m,w=d)):p>b&&(p=b,0>-m+k?q=0:-m+k>d?q=w:(q=-m+k,w=d));d=.001>Math.abs(q)?0:q/w;b=.001>Math.abs(p)?0:p/b;f.multiplyScalar(d);g.multiplyScalar(b);h.add(f);h.sub(g);f.add(a);g.add(c);return[f,g]};this.edgeToEdgeMeasure=function(a,b,c){var d=H.getEndPointsInEdge(a);
a=d[0].clone();var f=d[1].clone(),d=H.getEndPointsInEdge(b);b=d[0].clone();var d=d[1].clone(),g=this.nearestPointInPointToLine(a,b,d),h=this.nearestPointInPointToLine(f,b,d),k=new THREE.Vector3,l=new THREE.Vector3;c=this.nearestPointInPointToLine(c,a,f);if(a.distanceTo(b)<a.distanceTo(d)&&a.distanceTo(b)<f.distanceTo(b)&&a.distanceTo(b)<f.distanceTo(d)){k.subVectors(a,f);l.subVectors(b,d);k.normalize();l.normalize();if(this.isEqualVectors(k,l,.01)||this.isInverseVectors(k,l,.01))return this.drawLine(a,
g),this.drawExtensionLine(a,b,d),[a,g];g=this.angleVectorToVector(k,l);this.drawAngleLineToLine(a,c,b,d,g);return g}if(a.distanceTo(d)<a.distanceTo(b)&&a.distanceTo(d)<f.distanceTo(b)&&a.distanceTo(d)<f.distanceTo(d)){k.subVectors(a,f);l.subVectors(d,b);k.normalize();l.normalize();if(this.isEqualVectors(k,l,.01)||this.isInverseVectors(k,l,.01))return this.drawLine(a,g),this.drawExtensionLine(a,b,d),[a,g];g=this.angleVectorToVector(k,l);this.drawAngleLineToLine(a,c,d,b,g);return g}if(f.distanceTo(b)<
a.distanceTo(b)&&f.distanceTo(b)<a.distanceTo(d)&&f.distanceTo(b)<f.distanceTo(d)){k.subVectors(f,a);l.subVectors(b,d);k.normalize();l.normalize();if(this.isEqualVectors(k,l,.01)||this.isInverseVectors(k,l,.01))return this.drawLine(f,h),this.drawExtensionLine(f,b,d),[f,h];g=this.angleVectorToVector(k,l);this.drawAngleLineToLine(f,c,b,d,g);return g}k.subVectors(f,a);l.subVectors(d,b);k.normalize();l.normalize();if(this.isEqualVectors(k,l,.01)||this.isInverseVectors(k,l,.01))return this.drawLine(f,
h),this.drawExtensionLine(f,b,d),[f,h];g=this.angleVectorToVector(k,l);this.drawAngleLineToLine(f,c,d,b,g);return g};this.nearestPointInPointToSegment=function(a,b,c){var d=new THREE.Vector3,f=new THREE.Vector3;d.subVectors(b,a);f.subVectors(c,b);a=d.dot(f);d.subVectors(c,b);a=-a/d.dot(d);0>a||(1<a?b=c:(d.subVectors(c,b),d.multiplyScalar(a),b=d.add(b)));return b};this.nearestPointInPointToLine=function(a,b,c){var d=new THREE.Vector3,f=new THREE.Vector3;d.subVectors(b,a);f.subVectors(c,b);a=d.dot(f);
d.subVectors(c,b);a=-a/d.dot(d);d.subVectors(c,b);d.multiplyScalar(a);return d.add(b)};this.pointToEdgeMeasure=function(a,b,c){b=H.getEndPointsInEdge(b);var d=b[0],f=b[1];b=this.nearestPointInPointToLine(a,d,f);c=this.nearestPointInPointToLine(c,d,f);d=new THREE.Vector3;d.subVectors(c,b);d.add(a);this.drawLine(d,c);this.drawExtensionLinePointToPoint(a,d);return[a,b]};this.edgeToPointMeasure=function(a,b){var c=H.getEndPointsInEdge(a),d=c[0],c=c[1],f=this.nearestPointInPointToLine(b,d,c);this.drawLine(b,
f);this.drawExtensionLine(b,d,c);return[b,f]};this.faceToFaceMeasure=function(a,b,c,d){var f=b.clone(),g=d.clone(),h=this.angleVectorToVector(b,d);return f.x<=g.x+.01&&f.x>=g.x-.01&&f.y<=g.y+.01&&f.y>=g.y-.01&&f.z<=g.z+.01&&f.z>=g.z-.01||f.x<=-g.x+.01&&f.x>=-g.x-.01&&f.y<=-g.y+.01&&f.y>=-g.y-.01&&f.z<=-g.z+.01&&f.z>=-g.z-.01?(b=new THREE.Vector3,b.subVectors(a,c),f=f.dot(b)/f.dot(g),b.addVectors(c,g.multiplyScalar(f)),g=new THREE.Vector3,g.subVectors(b,a),a=A.first.mesh.geometry.clone(),a.applyMatrix((new THREE.Matrix4).makeTranslation(g.x,
g.y,g.z)),this.drawExtensionFace(a),this.drawLine(c,b),[c,b,h]):h=this.drawAngleFaceToFace(a,b,c,d)};this.angleVectorToVector=function(a,b){return 180*a.angleTo(b)/Math.PI};this.intersectPlaneToPlane=function(a,b,c,d){var f=new THREE.Vector3;f.crossVectors(b,d);var g=0<=f.x?f.x:-f.x,h=0<=f.y?f.y:-f.y,k=0<=f.z?f.z:-f.z,h=g>h?g>k?1:3:h>k?2:3,g=new THREE.Vector3,l,k=-b.dot(a);l=-d.dot(c);switch(h){case 1:g.x=0;0!==f.x?(g.y=(l*b.z-k*d.z)/f.x,g.z=(k*d.y-l*b.y)/f.x):(g.y=-(l*b.z)/(b.z*d.y),g.z=-(k*d.y)/
(b.z*d.y));break;case 2:g.y=0;0!==f.y?(g.x=(k*d.z-l*b.z)/f.y,g.z=(l*b.x-k*d.x)/f.y):(g.x=-(k*d.z)/(b.x*d.z),g.z=-(l*b.x)/(b.x*d.z));break;case 3:g.z=0,0!==f.z?(g.x=(l*b.y-k*d.y)/f.z,g.y=(k*d.x-l*b.x)/f.z):(g.x=-(l*b.y)/(b.y*d.x),g.y=-(k*d.x)/(b.y*d.x))}b=new THREE.Vector3;b.addVectors(g,f.multiplyScalar(100));a=this.nearestPointInPointToLine(a,g,b);c=this.nearestPointInPointToLine(c,g,b);return[a,c]};this.drawAngle=function(a,b,c,d,f){l||(l=new THREE.LineBasicMaterial({color:52224,opacity:.5,linewidth:2,
depthTest:!1}),h.impl.createOverlayScene("MeasureTool-angle",l));h.impl.clearOverlay("MeasureTool-angle");var g=new THREE.Geometry,k=new THREE.Geometry;g.vertices.push(a,b);k.vertices.push(a,c);g=new THREE.Line(g,l);k=new THREE.Line(k,l);h.impl.addOverlay("MeasureTool-angle",g);h.impl.addOverlay("MeasureTool-angle",k);k=a.distanceTo(b);f=new THREE.CircleGeometry(k,100,0,f*Math.PI/180);f=new THREE.Line(f,l);k=f.geometry.vertices[0].clone();f.geometry.vertices.push(k);f.position.set(a.x,a.y,a.z);k=
f.position.clone();k.add(d);f.lookAt(k);f.updateMatrixWorld();var m=f.geometry.vertices[1].clone(),n=f.geometry.vertices[f.geometry.vertices.length-2].clone();m.applyMatrix4(f.matrixWorld);n.applyMatrix4(f.matrixWorld);var k=new THREE.Vector3,g=new THREE.Vector3,p=new THREE.Vector3,q=new THREE.Vector3;k.subVectors(m,a);g.subVectors(n,a);p.subVectors(b,a);q.subVectors(c,a);c=k.angleTo(p);m=k.angleTo(q);b=g.angleTo(p);n=g.angleTo(q);b=(.001>=c&&-.001<=c||.001>=m&&-.001<=m)&&(.001>=b&&-.001<=b||.001>=
n&&-.001<=n)?0:(c<=Math.PI+.001&&c>=Math.PI-.001||m<=Math.PI+.001&&m>=Math.PI-.001)&&(b<=Math.PI+.001&&b>=Math.PI-.001||n<=Math.PI+.001&&n>=Math.PI-.001)?Math.PI:c<=b+.001&&c>=b-.001||c<=n+.001&&c>=n-.001?c:m;c=new THREE.Matrix4;c.makeRotationAxis(d,b);c.multiply(f.matrix);f.matrix=c;f.rotation.setFromRotationMatrix(f.matrix);f.updateMatrixWorld();m=f.geometry.vertices[1].clone();n=f.geometry.vertices[f.geometry.vertices.length-2].clone();m.applyMatrix4(f.matrixWorld);n.applyMatrix4(f.matrixWorld);
k.subVectors(m,a);g.subVectors(n,a);c=k.angleTo(p);m=k.angleTo(q);g.angleTo(p);g.angleTo(q);.001<=c&&.001<=m&&(c=new THREE.Matrix4,c.makeRotationAxis(d,2*-b),c.multiply(f.matrix),f.matrix=c,f.rotation.setFromRotationMatrix(f.matrix));h.impl.addOverlay("MeasureTool-angle",f)};this.drawAngleFaceToFace=function(a,b,c,d){var f=this.intersectPlaneToPlane(a,b,c,d),k=new THREE.Vector3,l=new THREE.Vector3;k.subVectors(a,f[0]);l.subVectors(c,f[1]);var k=this.angleVectorToVector(k,l),l=f[0].clone(),m=new THREE.Vector3;
m.crossVectors(b,d);m.normalize();f=this.intersectPlaneToPlane(a,b,l,m);a=f[0].clone();f=this.intersectPlaneToPlane(c,d,l,m);c=f[0].clone();this.drawAngle(l,a,c,m,k);t&&(c=E.label,c||(c=E.label=document.createElement("div"),c.className="measure-length",h.container.appendChild(c)),c.textContent=g.getAngle(),c.classList.toggle("visible",!0),E.p1=l.clone(),E.p2=l.clone(),this.updateLabelPositions());return k};this.drawAngleLineToLine=function(a,b,c,d,f){var k=new THREE.Vector3,l=new THREE.Vector3,m=
new THREE.Vector3;l.subVectors(a,b);m.subVectors(c,d);k.crossVectors(l,m);k.normalize();l=new THREE.Vector3;l.subVectors(a,c);l.add(d);this.drawAngle(a,b,l,k,f);t&&(b=E.label,b||(b=E.label=document.createElement("div"),b.className="measure-length",h.container.appendChild(b)),b.textContent=g.getAngle(),b.classList.toggle("visible",!0),E.p1=a.clone(),E.p2=a.clone(),this.updateLabelPositions())};this.intersectLineToLine=function(a,b,c,d){var f=new THREE.Vector3,g=new THREE.Vector3;f.subVectors(c,a);
f.cross(d);g.crossVectors(b,d);c=f.divide(g);g=b.clone();g.multiplyScalar(c);f.addVectors(a,g);return f};this.nearestPointInPointToPlane=function(a,b,c){var d=new THREE.Vector3;c=c.clone();var f=new THREE.Vector3;f.subVectors(a,b);b=-c.dot(f);f=c.dot(c);d.addVectors(a,c.multiplyScalar(b/f));return d};this.faceToPointMeasure=function(a,b,c,d){b=this.nearestPointInPointToPlane(d,a.vertices[0],b);c=c.clone();var f=new THREE.Vector3;f.subVectors(c,b);f.add(d);f=new THREE.Vector3;f.subVectors(b,c);a=a.clone();
a.applyMatrix((new THREE.Matrix4).makeTranslation(f.x,f.y,f.z));this.drawExtensionFace(a);this.drawLine(d,b);return[d,b]};this.nearestPointInPointToFace=function(a,b,c){for(var d,f=Number.MAX_VALUE,g=new THREE.Vector3,h=new THREE.Vector3,k=new THREE.Vector3,l=new THREE.Vector3,m=0;m<b.vertices.length;m+=3){g.subVectors(b.vertices[m+1],b.vertices[m]);h.subVectors(b.vertices[m+2],b.vertices[m]);l.crossVectors(g,h);k.subVectors(a,b.vertices[m]);g.cross(k);var n=g.dot(l)/l.dot(l);k.cross(h);var p=k.dot(l)/
l.dot(l),q=1-n-p;if(0<=q&&1>=q&&0<=p&&1>=p&&0<=n&&1>=n)return d=this.nearestPointInPointToPlane(a,b.vertices[0],c)}for(m=0;m<b.vertices.length;m+=3)c=this.nearestPointInPointToSegment(a,b.vertices[m],b.vertices[m+1]),a.distanceTo(c)<f&&(f=a.distanceTo(c),d=c.clone()),c=this.nearestPointInPointToSegment(a,b.vertices[m],b.vertices[m+2]),a.distanceTo(c)<f&&(f=a.distanceTo(c),d=c.clone()),c=this.nearestPointInPointToSegment(a,b.vertices[m+1],b.vertices[m+2]),a.distanceTo(c)<f&&(f=a.distanceTo(c),d=c.clone());
return d};this.pointToFaceMeasure=function(a,b,c,d){b=this.nearestPointInPointToPlane(a,b.vertices[0],c);d=d.clone();c=new THREE.Vector3;c.subVectors(d,b);c.add(a);this.drawLine(d,c);this.drawExtensionLinePointToPoint(a,c);return[a,b]};this.nearestPointsInEdgeToFace=function(a,b){for(var c=[],d=Number.MAX_VALUE,f=H.getEndPointsInEdge(a),g=f[0],f=f[1],h,k,l=0;l<b.vertices.length;l+=3)h=b.vertices[l],k=b.vertices[l+1],h=this.nearestPointsInSegmentToSegment(g,f,h,k),h[0].distanceTo(h[1])<d&&(d=h[0].distanceTo(h[1]),
c[0]=h[0].clone(),c[1]=h[1].clone()),h=b.vertices[l],k=b.vertices[l+2],h=this.nearestPointsInSegmentToSegment(g,f,h,k),h[0].distanceTo(h[1])<d&&(d=h[0].distanceTo(h[1]),c[0]=h[0].clone(),c[1]=h[1].clone()),h=b.vertices[l+1],k=b.vertices[l+2],h=this.nearestPointsInSegmentToSegment(g,f,h,k),h[0].distanceTo(h[1])<d&&(d=h[0].distanceTo(h[1]),c[0]=h[0].clone(),c[1]=h[1].clone());return c};this.faceToEdgeMeasure=function(a,b,c,d,f){var g=H.getEndPointsInEdge(d),h;g[0].distanceTo(c)<g[1].distanceTo(c)?(d=
g[0],h=g[1]):(d=g[1],h=g[0]);var k=new THREE.Vector3;k.subVectors(h,d);g=this.angleLineToPlane(k,b);if(.01>=k.dot(b)&&-.01<=k.dot(b))return k=this.nearestPointInPointToPlane(d,a.vertices[0],b),f=this.nearestPointInPointToLine(f,d,h),this.faceToPointMeasure(a,b,c,f),[d,k,g];f=this.nearestPointInPointToLine(f,d,h);this.drawAngleEdgeToFace(a.vertices[0],b,c,d,f,g);return g};this.edgeToFaceMeasure=function(a,b,c,d,f){var g=H.getEndPointsInEdge(a),h;g[0].distanceTo(f)<g[1].distanceTo(f)?(a=g[0],h=g[1]):
(a=g[1],h=g[0]);var k=new THREE.Vector3;k.subVectors(h,a);g=this.angleLineToPlane(k,d);if(.01>=k.dot(d)&&-.01<=k.dot(d))return c=this.nearestPointInPointToPlane(a,c.vertices[0],d),d=new THREE.Vector3,d.subVectors(f,c),d.add(a),b=new THREE.Vector3,b.subVectors(f,c),b.add(h),this.drawLine(d,f),this.drawExtensionLinePointToPoint(d,b),[a,c,g];h=this.nearestPointInPointToLine(b,a,h);this.drawAngleEdgeToFace(c.vertices[0],d,f,a,h,g);return g};this.angleLineToPlane=function(a,b){var c=this.angleVectorToVector(a,
b);return 90<c?c-90:90-c};this.drawAngleEdgeToFace=function(a,b,c,d,f,k){var l=this.intersectPointLineToPlane(a,b,d,f);if(l){a=90===k?c.clone():this.nearestPointInPointToPlane(f,a,b);b=new THREE.Vector3;c=new THREE.Vector3;var m=new THREE.Vector3;c.subVectors(f,d);m.subVectors(a,l);b.crossVectors(c,m);b.normalize();this.drawAngle(l,f,a,b,k);t&&(d=E.label,d||(d=E.label=document.createElement("div"),d.className="measure-length",h.container.appendChild(d)),d.textContent=g.getAngle(),d.classList.toggle("visible",
!0),E.p1=l.clone(),E.p2=l.clone(),this.updateLabelPositions())}};this.intersectPointLineToPlane=function(a,b,c,d){var f=new THREE.Vector3,g=new THREE.Vector3;f.subVectors(d,c);g.subVectors(c,a);a=b.dot(f);b=-b.dot(g);if(.001>Math.abs(a))return null;f.multiplyScalar(b/a);f.add(c);return f};this.isEqualVectors=function(a,b,c){return a.x<=b.x+c&&a.x>=b.x-c&&a.y<=b.y+c&&a.y>=b.y-c&&a.z<=b.z+c&&a.z>=b.z-c?!0:!1};this.isInverseVectors=function(a,b,c){return a.x<=-b.x+c&&a.x>=-b.x-c&&a.y<=-b.y+c&&a.y>=-b.y-
c&&a.z<=-b.z+c&&a.z>=-b.z-c?!0:!1};this.setSimple=function(a){if(c!=a){c=a;for(var b in C)if("xyz"!==b&&C.hasOwnProperty(b)){var d=C[b];d.line&&(d.line.visible=!a,d.label&&d.label.classList.toggle("visible",!a))}h.impl.invalidate(!1,!1,!0)}};this.hide=function(){for(var a in B)if(B.hasOwnProperty(a)){var b=B[a];b.mesh&&(b.mesh.visible=!1)}for(a in z)z.hasOwnProperty(a)&&(b=z[a],b.line&&(b.line.visible=!1),b.label&&b.label.classList.remove("visible"));for(a in A)A.hasOwnProperty(a)&&(b=A[a],b.mesh&&
(b.mesh.visible=!1),b.label&&b.label.classList.remove("visible"));for(a in C)C.hasOwnProperty(a)&&(b=C[a],b.line&&(b.line.visible=!1),b.label&&b.label.classList.remove("visible"));E.label&&E.label.classList.remove("visible");l&&h.impl.clearOverlay("MeasureTool-angle");m&&h.impl.clearOverlay("MeasureTool-extensionLine");p&&h.impl.clearOverlay("MeasureTool-extensionFace");h.impl.invalidate(!1,!1,!0)};this.hideClick=function(a){if(B.hasOwnProperty(a)){var b=B[a];b.mesh&&(b.mesh.visible=!1)}z.hasOwnProperty(a)&&
(b=z[a],b.line&&(b.line.visible=!1),b.label&&b.label.classList.remove("visible"));A.hasOwnProperty(a)&&(a=A[a],a.mesh&&(a.mesh.visible=!1),a.label&&a.label.classList.remove("visible"));for(var c in C)C.hasOwnProperty(c)&&(a=C[c],a.line&&(a.line.visible=!1),a.label&&a.label.classList.remove("visible"));E.label&&E.label.classList.remove("visible");l&&h.impl.clearOverlay("MeasureTool-angle");m&&h.impl.clearOverlay("MeasureTool-extensionLine");p&&h.impl.clearOverlay("MeasureTool-extensionFace");h.impl.invalidate(!1,
!1,!0)};this.destroy=function(){for(var a in B)if(B.hasOwnProperty(a)){var b=B[a];b.mesh&&(h.impl.removeOverlay("MeasureTool-endPoint",b.mesh),b.mesh=b.geometry=null)}for(a in z)z.hasOwnProperty(a)&&(b=z[a],b.line&&(h.impl.removeOverlay("MeasureTool-edge",b.line),b.line=b.intersectPoint=null),b.label&&(b.label.parentNode.removeChild(b.label),b.label=null));for(a in A)A.hasOwnProperty(a)&&(b=A[a],b.mesh&&(h.impl.removeOverlay("MeasureTool-face",b.mesh),b.mesh=b.intersectPoint=null),b.label&&(b.label.parentNode.removeChild(b.label),
b.label=null));d&&(d=null,h.impl.removeOverlayScene("MeasureTool-endPoint"));k&&(k=null,h.impl.removeOverlayScene("MeasureTool-face"));f&&(f=null,h.impl.removeOverlayScene("MeasureTool-edge"));m&&(m=null,h.impl.removeOverlayScene("MeasureTool-extensionLine"));p&&(p=null,h.impl.removeOverlayScene("MeasureTool-extensionFace"));for(a in C)C.hasOwnProperty(a)&&(b=C[a],b.line&&(h.impl.removeOverlay(b.overlayName,b.line),h.impl.removeOverlayScene(b.overlayName),b.material=b.line=b.geometry=null),b.label&&
(b.label.parentNode.removeChild(b.label),b.label=null),b.material=b.line=b.geometry=b.label=b.p1=b.p2=null);E.label&&(E.label.parentNode.removeChild(E.label),E.label=null);E.label=E.p1=E.p2=null}}var g=this,h=a,k=["measure"],l=!1,n=null,q=null,m=!1,p=0,t=!1,v=null,D=null,w="",F=3,B={},z=0,G=!1,A=null,E=null,H=null,I=null,J=null,L=null,C=null,N=null,K=null;this.register=function(){E||(E=new Autodesk.Viewing.Extensions.Measure.MeasurePanel(g,h,"measure-panel","Measure",b),h.addPanel(E));H||(H=new Autodesk.Viewing.Extensions.Measure.Snapper(a),
h.toolController.registerTool(H))};this.deregister=function(){this.deactivate();h.removePanel(E);E.uninitialize();h.toolController.deregisterTool(H);H=null};this.isActive=function(){return l};this.getNames=function(){return k};this.getName=function(){return k[0]};this.getCursor=function(){return m?null:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAKZJREFUeNrclLEKwzAQQ9+FgH/Nk7d8ViFT+6cG36IsNXgIdMg5kAoOIw8WSDoDvAEN04BdEhFjgCTR4e6klFxSIgDLSNydbdsAPgRCktRaUylFkfZ0Z2qtVTlnAfugGibwAur3JFrAxoBnYGEy1pGYmQCLLNB6Uqmw182M9eRS0yzqGo+y6D9rytSQR8vM7DKfbtHy4x+/xG8J+d4W9WAi8fxFOwYA8W0ypu2ZfcsAAAAASUVORK5CYII=), wait"};
this.activate=function(){l=!0;p=0;m=!1;w||(w=h.model.getUnitString());A||(A=new d(h));A.hide();E.setVisible(!0);E.updatePanel();h.model&&h.model.is2d()&&E.isolate.setDisabled(!0);h.toolController.activateTool("snapper");h.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,c);h.addEventListener(Autodesk.Viewing.RESET_EVENT,f)};this.deactivate=function(){l=!1;n=q=null;B={};this.clearMeasurement();A&&(A.hide(),A.destroy());B={};E&&(E.setVisible(!1),E.updatePanel());H&&H.isActive()&&h.toolController.deactivateTool("snapper");
h.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,c);h.removeEventListener(Autodesk.Viewing.RESET_EVENT,f)};this.update=function(){return!1};this.getUnits=function(){return w};this.setUnits=function(a){w!==a&&(w=a,A&&(A.updateDistance(),A.updateLabels()))};this.getPrecision=function(){return F};this.setPrecision=function(a){F!==a&&(F=a,A&&(A.updateDistance(),A.updateLabels()))};this.getDistance=function(a){if(h.model&&h.model.isLoadDone())return a=Autodesk.Viewing.Private.convertUnits(h.model.getUnitString(),
w,B[a]||0),Autodesk.Viewing.Private.formatValueWithUnits(a,w,3,F)};this.getAngle=function(){return Autodesk.Viewing.Private.formatValueWithUnits(z,String.fromCharCode(176),3,F)};this.clearMeasurement=function(){N=K=v=D=n=q=null;p=1;B={};z=0;A&&A.hide();E&&(E.updatePanel(),E.hideMeasureResult(),E.isolateMeasure&&this.clearIsolate())};this.clearRubberBand=function(){D=q=null;A.hideClick("second")};this.clearFirstPick=function(){q?(A.hide(),n=q.clone(),v=D,I=J,L=C,N=K,G=!0,v===SNAP_VERTEX?A.showFirstVertex(n):
v===SNAP_EDGE?A.showFirstEdge(n,I):A.showFirstFace(n,I),G=!1,K=D=q=null,p=2,B={},z=0,E&&E.isolateMeasure&&this.clearIsolate()):this.clearMeasurement();E.showSelection1()};this.clearSecondPick=function(){K=D=q=null;p=2;B={};z=0;A.hideClick("second");E&&E.isolateMeasure&&this.clearIsolate()};this.getIndicator=function(){return A};this.getFirstGeometry=function(){return{type:v,geometry:n}};this.getSecondGeometry=function(){return{type:D,geometry:q}};this.getEdgeLength=function(a){return A.getEdgeLength(a)};
this.getFaceArea=function(a){return A.getFaceArea(a)};this.isolateMeasurement=function(){N&&K&&h.isolate([N,K])};this.clearIsolate=function(){h.showAll()};this._handleMouseEvent=function(a){if(H.isSnapped()){0===p&&(this.clearMeasurement(),p=1);if(1===p)H.getHighlightGeometry()===SNAP_VERTEX?(n=H.getVertex(),v=SNAP_VERTEX,A.showFirstVertex(n)):H.getHighlightGeometry()===SNAP_EDGE?(n=H.getEdge(),v=SNAP_EDGE,I=H.getIntersectPoint(),A.showFirstEdge(n,I)):(n=H.getFace(),v=SNAP_FACE,I=H.getIntersectPoint(),
L=H.getFaceNormal(),A.showFirstFace(n,I)),N=H.getSnapNode(),E.showSelection1();else if(2===p){var b;v===SNAP_VERTEX&&H.getHighlightGeometry()===SNAP_VERTEX?(q=H.getVertex(),D=SNAP_VERTEX,A.showSecondVertex(q),A.drawLine(n,q),b=[n,q]):v===SNAP_EDGE&&H.getHighlightGeometry()===SNAP_EDGE?(q=H.getEdge(),D=SNAP_EDGE,J=H.getIntersectPoint(),A.showSecondEdge(q,J),b=A.edgeToEdgeMeasure(q,n,J)):v===SNAP_FACE&&H.getHighlightGeometry()===SNAP_FACE?(q=H.getFace(),D=SNAP_FACE,J=H.getIntersectPoint(),C=H.getFaceNormal(),
A.showSecondFace(q,J),b=A.faceToFaceMeasure(I,L,J,C)):v===SNAP_VERTEX&&H.getHighlightGeometry()===SNAP_EDGE?(q=H.getEdge(),D=SNAP_EDGE,J=H.getIntersectPoint(),A.showSecondEdge(q,J),b=A.pointToEdgeMeasure(n,q,J)):v===SNAP_EDGE&&H.getHighlightGeometry()===SNAP_VERTEX?(q=H.getVertex(),D=SNAP_VERTEX,A.showSecondVertex(q),b=A.edgeToPointMeasure(n,q)):v===SNAP_VERTEX&&H.getHighlightGeometry()===SNAP_FACE?(q=H.getFace(),D=SNAP_FACE,C=H.getFaceNormal(),J=H.getIntersectPoint(),A.showSecondFace(q,J),b=A.pointToFaceMeasure(n,
q,C,J)):v===SNAP_FACE&&H.getHighlightGeometry()===SNAP_VERTEX?(q=H.getVertex(),D=SNAP_VERTEX,A.showSecondVertex(q),b=A.faceToPointMeasure(n,L,I,q)):v===SNAP_EDGE&&H.getHighlightGeometry()===SNAP_FACE?(q=H.getFace(),D=SNAP_FACE,C=H.getFaceNormal(),J=H.getIntersectPoint(),A.showSecondFace(q,J),b=A.edgeToFaceMeasure(n,I,q,C,J)):v===SNAP_FACE&&H.getHighlightGeometry()===SNAP_EDGE&&(q=H.getEdge(),D=SNAP_EDGE,J=H.getIntersectPoint(),A.showSecondEdge(q,J),b=A.faceToEdgeMeasure(n,L,I,q,J));t&&(void 0===b.length?
(z=b,E.showAngleResult()):(B.xyz=b[0].distanceTo(b[1]),B.x=Math.abs(b[0].x-b[1].x),B.y=Math.abs(b[0].y-b[1].y),B.z=Math.abs(b[0].z-b[1].z),E.showDistanceResult()),E.showSelection2(),E.updatePanel(),A.updateDistance(),A.updateAngle(),K=H.getSnapNode(),E.isolateMeasure&&this.isolateMeasurement());A.updateLabelPositions()}return!0}2===p&&(v===SNAP_VERTEX?(q=this.inverseProject(a.canvasX,a.canvasY),D=SNAP_VERTEX,A.drawLine(n,q)):v===SNAP_EDGE?(q=this.inverseProject(a.canvasX,a.canvasY),D=SNAP_VERTEX,
A.edgeToPointMeasure(n,q)):v===SNAP_FACE&&(q=this.inverseProject(a.canvasX,a.canvasY),D=SNAP_VERTEX,A.faceToPointMeasure(n,L,I,q)));return!1};this.inverseProject=function(a,b){var c=h.navigation.getCamera(),d=h.navigation.getScreenViewport(),f=new THREE.Vector3;f.x=a/d.width*2-1;f.y=-(b/d.height*2-1);f.z=0;return f=f.unproject(c)};this.handleButtonDown=function(a,b){m=!0;0!==b||a.ctrlKey||a.metaKey||a.shiftKey||a.altKey||(t=!0);return!1};this.handleMouseMove=function(a){t=!1;2===p&&(this.clearRubberBand(),
this._handleMouseEvent(a));return!1};this.handleButtonUp=function(a,b){return m=!1};this.handleSingleClick=function(a,b){if(t){this._handleMouseEvent(a)||(this.clearMeasurement(),p=0);if(1===p||2===p)p=1===p?2:0;t=!1}return!0};this.handleDoubleClick=function(a,b){return!0};this.handleWheelInput=function(a){A.updateScale();return!1}};AutodeskNamespace("Autodesk.Viewing.Extensions.Measure");
Autodesk.Viewing.Extensions.Measure.MeasurePanel=function(a,b,c,f,d){Autodesk.Viewing.UI.DockingPanel.call(this,b.container,c,f,d);this.kPanelExpandedHeight=310;this.kPanelCollapsedHeight=35;this.isDeltaExpanded=!0;this.isolateMeasure=!1;this.measureTool=a;this.viewer=b;this.parentContainer=b.container;this.container.classList.add("measurePanel");this.container.dockRight=!0;this.container.style.minWidth="325px";this.container.style.width="325px";this.container.style.minHeight=this.kPanelCollapsedHeight+
"px";this.container.style.height=this.kPanelExpandedHeight+"px";this.container.style.maxHeight=this.kPanelExpandedHeight+"px";this.container.style.top="200px";this.container.style.left="220px";this.container.style.position="absolute";this.addEventListener(this.closer,"click",function(a){if(d&&d.onCloseCallback)d.onCloseCallback()});this.container.children[0].classList.add("expanded");d=d||{};d.heightAdjustment||(d.heightAdjustment=40);d.marginTop||(d.marginTop=0);d.left=!1;this.createScrollContainer(d);
this.measureResults=document.createElement("div");this.scrollContainer.appendChild(this.measureResults);this.units=[{name:"Decimal feet",units:"decimal-ft",matches:["decimal-ft"]},{name:"Feet and fractional inches",units:"ft",matches:["ft","in"]},{name:"Decimal inches",units:"decimal-in",matches:["decimal-in"]},{name:"Fractional inches",units:"fractional-in",matches:["fractional-in"]},{name:"Meters",units:"m",matches:["m"]},{name:"Centimeters",units:"cm",matches:["cm"]},{name:"Millimeters",units:"mm",
matches:["mm"]},{name:"Meters and centimeters",units:"m-and-cm",matches:["m-and-cm"]}];a=this.findUnits();b=[];for(c=0;c<this.units.length;++c)b.push(this.units[c].name);var g=this;this.unitList=this.addDropDownMenu(this.measureResults,"Unit type",b,a,function(a){g.measureTool.setUnits(g.units[a].units);g.updatePanel();g.setupPrecision()});this.precisionList=this.addDropDownMenu(this.measureResults,"Precision",[],-1,function(a){g.measureTool.setPrecision(a);g.updatePanel()});this.precisionList.parentNode.style.paddingBottom=
"15px";this.setupPrecision();this.addDivider(this.measureResults);this.results=document.createElement("div");this.measureResults.appendChild(this.results);a=document.createElement("div");a.className="measure-result";a.setAttribute("data-i18n","Results");a.textContent=Autodesk.Viewing.i18n.translate("Results");this.results.appendChild(a);this.distanceDiv=document.createElement("div");this.distanceDiv.className="measure-results";this.results.appendChild(this.distanceDiv);a=document.createElement("div");
a.className="measure-result-label";a.setAttribute("data-i18n","Distance = ");a.textContent=Autodesk.Viewing.i18n.translate("Distance = ");this.distanceDiv.appendChild(a);a=document.createElement("div");a.className="measure-result-number";this.distanceDiv.appendChild(a);a=document.createElement("div");a.className="measure-delta-collapse";a.setAttribute("data-i18n","+");a.textContent=Autodesk.Viewing.i18n.translate("+");a.addEventListener("click",function(a){g.toggle()},!0);this.distanceDiv.appendChild(a);
this.deltaXDiv=document.createElement("div");this.deltaXDiv.className="measure-results";this.results.appendChild(this.deltaXDiv);a=document.createElement("div");a.className="measure-result-label";a.setAttribute("data-i18n","Delta x = ");a.textContent=Autodesk.Viewing.i18n.translate("Delta x = ");this.deltaXDiv.appendChild(a);a=document.createElement("div");a.className="measure-result-number";this.deltaXDiv.appendChild(a);this.deltaYDiv=document.createElement("div");this.deltaYDiv.className="measure-results";
this.results.appendChild(this.deltaYDiv);a=document.createElement("div");a.className="measure-result-label";a.setAttribute("data-i18n","Delta y = ");a.textContent=Autodesk.Viewing.i18n.translate("Delta y = ");this.deltaYDiv.appendChild(a);a=document.createElement("div");a.className="measure-result-number";this.deltaYDiv.appendChild(a);this.deltaZDiv=document.createElement("div");this.deltaZDiv.className="measure-results";this.results.appendChild(this.deltaZDiv);a=document.createElement("div");a.className=
"measure-result-label";a.setAttribute("data-i18n","Delta z = ");a.textContent=Autodesk.Viewing.i18n.translate("Delta z = ");this.deltaZDiv.appendChild(a);a=document.createElement("div");a.className="measure-result-number";this.deltaZDiv.appendChild(a);this.angleDiv=document.createElement("div");this.angleDiv.className="measure-results";this.results.appendChild(this.angleDiv);a=document.createElement("div");a.className="measure-result-label";a.setAttribute("data-i18n","Angle = ");a.textContent=Autodesk.Viewing.i18n.translate("Angle = ");
this.angleDiv.appendChild(a);a=document.createElement("div");a.className="measure-result-number";this.angleDiv.appendChild(a);this.addDivider(this.results);this.selection1=document.createElement("div");this.measureResults.appendChild(this.selection1);a=document.createElement("div");a.className="measure-result";a.setAttribute("data-i18n","Selection 1");a.textContent=Autodesk.Viewing.i18n.translate("Selection 1");this.selection1.appendChild(a);a=document.createElement("div");a.className="measure-selection-repick";
a.setAttribute("data-i18n","Repick");a.textContent=Autodesk.Viewing.i18n.translate("Repick");a.addEventListener("click",function(a){g.firstSelectionRepick()},!0);this.selection1.appendChild(a);this.selection1Element=document.createElement("div");this.selection1Element.className="measure-results";this.selection1.appendChild(this.selection1Element);a=document.createElement("div");a.className="measure-result-label";this.selection1Element.appendChild(a);this.selection1Div=document.createElement("div");
this.selection1Div.className="measure-results";this.selection1.appendChild(this.selection1Div);a=document.createElement("div");a.className="measure-result-label";this.selection1Div.appendChild(a);a=document.createElement("div");a.className="measure-result-number";this.selection1Div.appendChild(a);this.addDivider(this.selection1);this.selection2=document.createElement("div");this.measureResults.appendChild(this.selection2);a=document.createElement("div");a.className="measure-result";a.setAttribute("data-i18n",
"Selection 2");a.textContent=Autodesk.Viewing.i18n.translate("Selection 2");this.selection2.appendChild(a);a=document.createElement("div");a.className="measure-selection-repick";a.setAttribute("data-i18n","Repick");a.textContent=Autodesk.Viewing.i18n.translate("Repick");a.addEventListener("click",function(a){g.secondSelectionRepick()},!0);this.selection2.appendChild(a);this.selection2Element=document.createElement("div");this.selection2Element.className="measure-results";this.selection2.appendChild(this.selection2Element);
a=document.createElement("div");a.className="measure-result-label";a.setAttribute("data-i18n","Vertex selected");a.textContent=Autodesk.Viewing.i18n.translate("Vertex selected");this.selection2Element.appendChild(a);this.selection2Div=document.createElement("div");this.selection2Div.className="measure-results";this.selection2.appendChild(this.selection2Div);a=document.createElement("div");a.className="measure-result-label";a.setAttribute("data-i18n","Length = ");a.textContent=Autodesk.Viewing.i18n.translate("Length = ");
this.selection2Div.appendChild(a);a=document.createElement("div");a.className="measure-result-number";this.selection2Div.appendChild(a);this.addDivider(this.selection2);this.table=document.createElement("table");this.table.className="tftable measure-table";this.tbody=document.createElement("tbody");this.table.appendChild(this.tbody);this.measureResults.appendChild(this.table);this.isolate=new Autodesk.Viewing.Private.OptionCheckbox("Isolate Measurement",this.tbody,!1);this.addEventListener(this.isolate,
"change",function(a){g.isolateMeasure=g.isolate.checked;g.isolateMeasure?g.measureTool.isolateMeasurement():g.measureTool.clearIsolate()});this.addDivider(this.measureResults);a=document.createElement("div");a.className="measure-restart";a.setAttribute("data-i18n","Restart measurement");a.textContent=Autodesk.Viewing.i18n.translate("Restart measurement");a.addEventListener("click",function(){g.measureTool.clearMeasurement()},!1);this.measureResults.appendChild(a);this.updatePanel();this.addVisibilityListener(function(){g.resizeToContent({maxHeight:g.parentContainer.offsetHeight-
75})});this.hideMeasureResult()};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype=Object.create(Autodesk.Viewing.UI.DockingPanel.prototype);Autodesk.Viewing.Extensions.ViewerPanelMixin.call(Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype);
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.addDropDownMenu=function(a,b,c,f,d){var g=document.createElement("select");g.className="optionDropDown";for(var h=0;h<c.length;h++){var k=document.createElement("option");k.value=h;k.setAttribute("data-i18n",c[h]);k.textContent=Autodesk.Viewing.i18n.translate(c[h]);g.add(k)}c=document.createElement("div");c.className="measure-submenu-select";h=document.createElement("div");h.className="measure-submenu-selectlabel";h.setAttribute("for",b);
h.setAttribute("data-i18n",b);h.textContent=Autodesk.Viewing.i18n.translate(b);c.appendChild(h);c.appendChild(g);a.appendChild(c);g.selectedIndex=f;g.onchange=function(a){d(a.target.selectedIndex)};return g};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.addDivider=function(a){var b=document.createElement("div");b.className="measure-horizontal-divider";a.appendChild(b);return b};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.findUnits=function(){var a,b,c=this.measureTool.getUnits();for(a=0;a<this.units.length;++a){var f=this.units[a].matches;if(f)for(b=0;b<f.length;++b)if(f[b]===c)return a}return 0};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.setupPrecision=function(){for(;this.precisionList.lastChild;)this.precisionList.removeChild(this.precisionList.lastChild);for(var a=this.measureTool.getUnits(),a="ft"===a||"in"===a||"fractional-in"===a?"1 1/2 1/4 1/8 1/16 1/32 1/64".split(" "):"0 0.1 0.01 0.001 0.0001 0.00001".split(" "),b=0;b<a.length;++b){var c=document.createElement("option");c.value=b;c.textContent=a[b];this.precisionList.appendChild(c)}b=this.measureTool.getPrecision();
a.length<=b&&(b=a.length-1,self.measureTool.setPrecision(b));this.precisionList.selectedIndex=b};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.uninitialize=function(){this.viewer=null;Autodesk.Viewing.UI.DockingPanel.prototype.uninitialize.call(this)};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.onTitleClick=function(a){};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.collapse=function(a){var b=this.container.children[0];a?(b.classList.remove("expanded"),b.classList.add("collapsed"),this.measureResults.style.display="none"):(b.classList.remove("collapsed"),b.classList.add("expanded"),this.measureResults.style.display="block");this.measureTool.getIndicator().setSimple(a);this.resizeToContent({maxHeight:this.parentContainer.offsetHeight-75})};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.deltaCollapse=function(){this.measureTool.getIndicator().setSimple(this.isDeltaExpanded);this.isDeltaExpanded?(this.deltaXDiv.style.display="none",this.deltaYDiv.style.display="none",this.deltaZDiv.style.display="none",this.isDeltaExpanded=!1):(this.deltaXDiv.style.display="block",this.deltaYDiv.style.display="block",this.deltaZDiv.style.display="block",this.isDeltaExpanded=!0);this.resizeToContent()};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.toggle=function(){this.deltaCollapse()};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.isExpanded=function(){return this.container.children[0].classList.contains("expanded")};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.getContentSize=function(){return{height:this.isExpanded()?this.measureResults.clientHeight+46:0,width:this.measureResults.clientWidth}};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.updatePanel=function(){function a(a,f){a.children[1].textContent="angle"===f?b.measureTool.getAngle():b.measureTool.getDistance(f)}var b=this;a(this.distanceDiv,"xyz");a(this.deltaXDiv,"x");a(this.deltaYDiv,"y");a(this.deltaZDiv,"z");a(this.angleDiv,"angle");this.unitList.selectedIndex=this.findUnits();this.showSelection1();this.showSelection2()};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.showDistanceResult=function(){this.results.style.display="block";this.angleDiv.style.display="none";this.distanceDiv.style.display="block";this.isDeltaExpanded&&(this.deltaXDiv.style.display="block",this.deltaYDiv.style.display="block",this.deltaZDiv.style.display="block");this.resizeToContent()};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.showAngleResult=function(){this.results.style.display="block";this.angleDiv.style.display="block";this.distanceDiv.style.display="none";this.isDeltaExpanded&&(this.deltaXDiv.style.display="none",this.deltaYDiv.style.display="none",this.deltaZDiv.style.display="none");this.resizeToContent()};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.showSelection1=function(){var a=this.measureTool.getFirstGeometry();null!==a.type&&(a.type===SNAP_VERTEX?(this.selection1Element.children[0].setAttribute("data-i18n","Vertex selected"),this.selection1Element.children[0].textContent=Autodesk.Viewing.i18n.translate("Vertex selected"),this.selection1Div.style.display="none"):(a.type===SNAP_EDGE?(this.selection1Element.children[0].setAttribute("data-i18n","Edge selected"),this.selection1Element.children[0].textContent=
Autodesk.Viewing.i18n.translate("Edge selected"),this.selection1Div.children[0].setAttribute("data-i18n","Length = "),this.selection1Div.children[0].textContent=Autodesk.Viewing.i18n.translate("Length = "),this.selection1Div.children[1].textContent=this.measureTool.getEdgeLength(a.geometry)):(this.selection1Element.children[0].setAttribute("data-i18n","Face selected"),this.selection1Element.children[0].textContent=Autodesk.Viewing.i18n.translate("Face selected"),this.selection1Div.children[0].setAttribute("data-i18n",
"Area = "),this.selection1Div.children[0].textContent=Autodesk.Viewing.i18n.translate("Area = "),this.selection1Div.children[1].textContent=this.measureTool.getFaceArea(a.geometry)),this.selection1Div.style.display="block"),this.selection1.style.display="block",this.resizeToContent())};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.showSelection2=function(){var a=this.measureTool.getSecondGeometry();null!==a.type&&(a.type===SNAP_VERTEX?(this.selection2Element.children[0].setAttribute("data-i18n","Vertex selected"),this.selection2Element.children[0].textContent=Autodesk.Viewing.i18n.translate("Vertex selected"),this.selection2Div.style.display="none"):(a.type===SNAP_EDGE?(this.selection2Element.children[0].setAttribute("data-i18n","Edge selected"),this.selection2Element.children[0].textContent=
Autodesk.Viewing.i18n.translate("Edge selected"),this.selection2Div.children[0].setAttribute("data-i18n","Length = "),this.selection2Div.children[0].textContent=Autodesk.Viewing.i18n.translate("Length = "),this.selection2Div.children[1].textContent=this.measureTool.getEdgeLength(a.geometry)):(this.selection2Element.children[0].setAttribute("data-i18n","Face selected"),this.selection2Element.children[0].textContent=Autodesk.Viewing.i18n.translate("Face selected"),this.selection2Div.children[0].setAttribute("data-i18n",
"Area = "),this.selection2Div.children[0].textContent=Autodesk.Viewing.i18n.translate("Area = "),this.selection2Div.children[1].textContent=this.measureTool.getFaceArea(a.geometry)),this.selection2Div.style.display="block"),this.selection2.style.display="block",this.resizeToContent())};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.firstSelectionRepick=function(){this.measureTool.clearFirstPick();this.results.style.display="none";this.selection2.style.display="none";this.resizeToContent()};
Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.secondSelectionRepick=function(){this.measureTool.clearSecondPick();this.results.style.display="none";this.selection2.style.display="none";this.resizeToContent()};Autodesk.Viewing.Extensions.Measure.MeasurePanel.prototype.hideMeasureResult=function(){this.results.style.display="none";this.selection1.style.display="none";this.selection2.style.display="none";this.resizeToContent()};AutodeskNamespace("Autodesk.Viewing.Extensions.Measure");
var SNAP_VERTEX=0,SNAP_EDGE=1,SNAP_FACE=2,SNAP_PRECISION=.001;
Autodesk.Viewing.Extensions.Measure.Snapper=function(a){function b(a,b){this.viewer=a;this.snapper=b;this.lineGeom=new THREE.Geometry;this.circularArc=null;this.circularArcCenter;this.ellipticalArc=null;this.minDist=Number.MAX_VALUE}var c=["snapper"],f=!1,d=.05,g=null,h=null,k=null,l=null,n=null,q=null,m=null,p=null,t=null,v=!1,D=!1;this.isActive=function(){return f};this.getNames=function(){return c};this.getName=function(){return c[0]};this.activate=function(){f=!0};this.deactivate=function(){f=
!1;this.destroy()};this.getFace=function(){return k};this.getEdge=function(){return l};this.getVertex=function(){return n};this.getSnapNode=function(){return q};this.getHighlightGeometry=function(){return m};this.getIntersectPoint=function(){return p};this.getFaceNormal=function(){return t};this.getEndPointsInEdge=function(a){a=a.vertices;for(var b=[],c=0;c<a.length;++c){for(var d=!1,f=0;f<a.length;++f)if(f!==c&&a[f].equals(a[c])){d=!0;break}d||b.push(a[c])}return b};this.isSnapped=function(){return D};
this.isEqualWithPrecision=function(a,b){return a<=b+SNAP_PRECISION&&a>=b-SNAP_PRECISION?!0:!1};this.isEqualVectorsWithPrecision=function(a,b){return a.x<=b.x+SNAP_PRECISION&&a.x>=b.x-SNAP_PRECISION&&a.y<=b.y+SNAP_PRECISION&&a.y>=b.y-SNAP_PRECISION&&a.z<=b.z+SNAP_PRECISION&&a.z>=b.z-SNAP_PRECISION?!0:!1};this.isInverseVectorsWithPrecision=function(a,b){return a.x<=-b.x+SNAP_PRECISION&&a.x>=-b.x-SNAP_PRECISION&&a.y<=-b.y+SNAP_PRECISION&&a.y>=-b.y-SNAP_PRECISION&&a.z<=-b.z+SNAP_PRECISION&&a.z>=-b.z-
SNAP_PRECISION?!0:!1};this.snapping3D=function(b){q=b.node;var c=b.face,f=b.intersectPoint;b=void 0===b.node.fragIds.length?[b.node.fragIds]:b.node.fragIds;for(var z=0;z<b.length;++z){var v=a.impl.getRenderProxy(a.model,b[z]);if(k=this.faceSnapping(c,v.geometry)){l=this.edgeSnapping(k,f,v);n=this.vertexSnapping(l,f);k.applyMatrix(v.matrixWorld);l.applyMatrix(v.matrixWorld);n.applyMatrix4(v.matrixWorld);p=f.applyMatrix4(v.matrixWorld);f=(new THREE.Matrix3).getNormalMatrix(v.matrixWorld);t=c.normal.applyMatrix3(f).normalize();
d=this.setDetectRadius(p);h<d?(this.drawPoint(n),m=SNAP_VERTEX):g<d?(this.drawLine(l),m=SNAP_EDGE):(this.drawFace(k),m=SNAP_FACE);D=!0;break}}};this.faceSnapping=function(a,b){var c=new THREE.Vector3,d=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Geometry,h=b.attributes;if(void 0!==h.index){var k=h.index.array||b.ib,l=b.vb?b.vb:h.position.array,m=b.vb?b.vbstride:3;(h=b.offsets)&&0!==h.length||(h=[{start:0,count:k.length,index:0}]);for(var n=0;n<h.length;++n)for(var p=h[n].start,q=h[n].count,
t=h[n].index,v=p;v<p+q;v+=3){var D=t+k[v],ba=t+k[v+1],X=t+k[v+2];c.set(l[D*m],l[D*m+1],l[D*m+2]);d.set(l[ba*m],l[ba*m+1],l[ba*m+2]);f.set(l[X*m],l[X*m+1],l[X*m+2]);D=THREE.Triangle.normal(c,d,f);ba=new THREE.Vector3;ba.set(l[a.a*m],l[a.a*m+1],l[a.a*m+2]);this.isEqualVectorsWithPrecision(D,a.normal)&&this.isEqualWithPrecision(D.dot(c),a.normal.dot(ba))&&(D=g.vertices.length,g.vertices.push(c.clone()),g.vertices.push(d.clone()),g.vertices.push(f.clone()),g.faces.push(new THREE.Face3(D,D+1,D+2)))}}return 0<
g.vertices.length?this.getTrianglesOnSameFace(g,a,l,m):null};this.getTrianglesOnSameFace=function(a,b,c,d){var f=!1;a=a.vertices.slice();var g=new THREE.Vector3;g.set(c[b.a*d],c[b.a*d+1],c[b.a*d+2]);var h=new THREE.Vector3;h.set(c[b.b*d],c[b.b*d+1],c[b.b*d+2]);var k=new THREE.Vector3;k.set(c[b.c*d],c[b.c*d+1],c[b.c*d+2]);b=new THREE.Geometry;b.vertices.push(g);b.vertices.push(h);b.vertices.push(k);b.faces.push(new THREE.Face3(0,1,2));c=[];do{c=[];for(d=0;d<a.length;d+=3)if(a[d].equals(g)&&a[d+1].equals(h)&&
a[d+2].equals(k))f=!0,c.push(d);else for(var l=0;l<b.vertices.length;l+=3)if(this.trianglesSharedEdge(a[d],a[d+1],a[d+2],b.vertices[l],b.vertices[l+1],b.vertices[l+2])){l=b.vertices.length;b.vertices.push(a[d].clone());b.vertices.push(a[d+1].clone());b.vertices.push(a[d+2].clone());b.faces.push(new THREE.Face3(l,l+1,l+2));c.push(d);break}for(d=c.length-1;0<=d;--d)a.splice(c[d],3)}while(0<c.length);return f?b:null};this.trianglesSharedEdge=function(a,b,c,d,f,g){var h=!1,k=!1,l=!1;if(a.equals(d)||a.equals(f)||
a.equals(g))h=!0;if(b.equals(d)||b.equals(f)||b.equals(g))k=!0;if(c.equals(d)||c.equals(f)||c.equals(g))l=!0;return h&k||h&l||k&l?!0:!1};this.edgeSnapping=function(a,b,c){for(var d=new THREE.Geometry,f=!0,h=!0,k=!0,l=0;l<a.vertices.length;l+=3){for(var m=0;m<a.vertices.length;m+=3)l!==m&&((a.vertices[l].equals(a.vertices[m])||a.vertices[l].equals(a.vertices[m+1])||a.vertices[l].equals(a.vertices[m+2]))&&(a.vertices[l+1].equals(a.vertices[m])||a.vertices[l+1].equals(a.vertices[m+1])||a.vertices[l+
1].equals(a.vertices[m+2]))&&(f=!1),(a.vertices[l].equals(a.vertices[m])||a.vertices[l].equals(a.vertices[m+1])||a.vertices[l].equals(a.vertices[m+2]))&&(a.vertices[l+2].equals(a.vertices[m])||a.vertices[l+2].equals(a.vertices[m+1])||a.vertices[l+2].equals(a.vertices[m+2]))&&(h=!1),(a.vertices[l+1].equals(a.vertices[m])||a.vertices[l+1].equals(a.vertices[m+1])||a.vertices[l+1].equals(a.vertices[m+2]))&&(a.vertices[l+2].equals(a.vertices[m])||a.vertices[l+2].equals(a.vertices[m+1])||a.vertices[l+2].equals(a.vertices[m+
2]))&&(k=!1));f&&(d.vertices.push(a.vertices[l].clone()),d.vertices.push(a.vertices[l+1].clone()));h&&(d.vertices.push(a.vertices[l].clone()),d.vertices.push(a.vertices[l+2].clone()));k&&(d.vertices.push(a.vertices[l+1].clone()),d.vertices.push(a.vertices[l+2].clone()));k=h=f=!0}a=new THREE.Geometry;var n,f=Number.MAX_VALUE,h=new THREE.Matrix4;h.getInverse(c.matrixWorld);b.applyMatrix4(h);for(c=0;c<d.vertices.length;c+=2)h=this.distancePointToLine(b,d.vertices[c],d.vertices[c+1]),h<f&&(f=h,n=c);a.vertices.push(d.vertices[n].clone());
a.vertices.push(d.vertices[n+1].clone());a.vertices=this.getConnectedLineSegmentsOnSameLine(d,a.vertices);g=f;return a};this.distancePointToLine=function(a,b,c){var d=new THREE.Vector3,f=new THREE.Vector3,g;d.subVectors(b,a);f.subVectors(c,b);g=d.dot(f);d.subVectors(c,b);g=-g/d.dot(d);0>g?a=a.distanceTo(b):1<g?a=a.distanceTo(c):(d.subVectors(a,b),f.subVectors(a,c),d.cross(f),f.subVectors(c,b),a=Math.sqrt(d.dot(d))/Math.sqrt(f.dot(f)));return a};this.getConnectedLineSegmentsOnSameLine=function(a,b){var c=
a.vertices.slice(),d=b[0],f=b[1],g=[];do{for(var g=[],h=0;h<c.length;h+=2)if(!c[h].equals(d)||!c[h+1].equals(f))for(var k=0;k<b.length;k+=2)if(c[h].equals(b[k])||c[h+1].equals(b[k])||c[h].equals(b[k+1])||c[h+1].equals(b[k+1])){var l=new THREE.Vector3,m=new THREE.Vector3;l.subVectors(b[k],b[k+1]);l.normalize();m.subVectors(c[h],c[h+1]);m.normalize();if(this.isEqualVectorsWithPrecision(l,m)||this.isInverseVectorsWithPrecision(l,m)){g.push(h);break}}for(h=g.length-1;0<=h;--h)b.push(c[g[h]]),b.push(c[g[h]+
1]),c.splice(g[h],2)}while(0<g.length);return b};this.vertexSnapping=function(a,b){for(var c=Number.MAX_VALUE,d,f=0;f<a.vertices.length;++f){var g=b.distanceTo(a.vertices[f]);g<c-SNAP_PRECISION&&(c=g,d=a.vertices[f].clone())}h=c;return d};this.angleVector2=function(a){return 0<a.x&&0<=a.y?Math.atan(a.y/a.x):0<=a.x&&0>a.y?Math.atan(a.y/a.x)+2*Math.PI:0>a.x&&0>=a.y?Math.atan(a.y/a.x)+Math.PI:0>=a.x&&0<a.y?Math.atan(a.y/a.x)+Math.PI:null};b.prototype.onLineSegment=function(a,b,c,d){var f=this.lineGeom.vertices;
a=new THREE.Vector3(a,b,0);c=new THREE.Vector3(c,d,0);d=this.snapper.getIntersectPoint();d=this.snapper.distancePointToLine(d,a,c);d<this.minDist&&(f.splice(0,2,a,c),this.minDist=d)};b.prototype.onCircularArc=function(a,b,c,d,f){var g=this.snapper.getIntersectPoint(),h=new THREE.Vector2(g.x,g.y),k=new THREE.Vector2(a,b),g=h.distanceTo(k);h.sub(k);h=this.snapper.angleVector2(h);if(g<=f+.1&&g>=f-.1){if(d>c&&h>=c&&h<=d)c=new THREE.CircleGeometry(f,100,c,d-c);else if(d<c&&(h>=c||h<=d))c=new THREE.CircleGeometry(f,
100,c,2*Math.PI-c+d);else return;c.vertices.splice(0,1);this.circularArc=c;this.circularArcCenter=new THREE.Vector3(a,b,0)}};b.prototype.onEllipticalArc=function(a,b,c,d,f,g,h){h=this.snapper.getIntersectPoint();var k=new THREE.Vector2(h.x,h.y);h=(k.x-a)*(k.x-a)/(f*f)+(k.y-b)*(k.y-b)/(g*g);var l=new THREE.Vector2(a,b);k.sub(l);k.x*=g;k.y*=f;k=this.snapper.angleVector2(k);d>2*Math.PI&&(d=2*Math.PI);1.1>=h&&.9<=h&&(d>c&&k>=c&&k<=d||d<c&&(k>=c||k<=d))&&(a=new THREE.EllipseCurve(a,b,f,g,c,d,!1),a=(new THREE.Path(a.getPoints(50))).createPointsGeometry(50),
this.isEqualWithPrecision(d-c,2*Math.PI)||a.vertices.pop(),this.ellipticalArc=a)};this.snapping2D=function(c){if(c.node){var f=c.intersectPoint,g=c.node.fragIds;if("undefined"!==typeof g){Array.isArray(g)||(g=[g]);p=f;for(var h=new b(a,this),k=0;k<g.length;++k){var q=a.impl.getRenderProxy(a.model,g[k]);(new Autodesk.Viewing.Private.VertexBufferReader(q.geometry)).enumGeomsForObject(c.node.dbId,h)}h.circularArc?(this.drawArc(h.circularArc,h.circularArcCenter),h.circularArc=null,n=h.circularArcCenter,
m=SNAP_VERTEX,D=!0):h.ellipticalArc?(this.drawArc(h.ellipticalArc),h.ellipticalArc=null):h.lineGeom.vertices.length&&(d=this.setDetectRadius(f),f.distanceTo(h.lineGeom.vertices[0])<d?(n=h.lineGeom.vertices[0],this.drawPoint(n),m=SNAP_VERTEX):f.distanceTo(h.lineGeom.vertices[1])<d?(n=h.lineGeom.vertices[1],this.drawPoint(n),m=SNAP_VERTEX):(l=h.lineGeom,this.drawLine(l),m=SNAP_EDGE),D=!0)}}};this.createOverlay=function(b){a.impl.createOverlayScene(b)};this.addOverlay=function(b,c){a.impl.addOverlay(b,
c)};this.clearOverlay=function(){a.impl.overlayScenes["MeasureTool-snapper-face"]&&a.impl.clearOverlay("MeasureTool-snapper-face");a.impl.overlayScenes["MeasureTool-snapper-vertex"]&&a.impl.clearOverlay("MeasureTool-snapper-vertex");a.impl.overlayScenes["MeasureTool-snapper-edge"]&&a.impl.clearOverlay("MeasureTool-snapper-edge")};this.drawFace=function(a){this.createOverlay("MeasureTool-snapper-face");var b=new THREE.MeshPhongMaterial({color:52224,ambient:52224,opacity:.5,transparent:!0,depthTest:!1,
depthWrite:!1,side:THREE.DoubleSide});a=new THREE.Mesh(a,b,!0);this.addOverlay("MeasureTool-snapper-face",a)};this.drawLine=function(a){this.createOverlay("MeasureTool-snapper-edge");var b=new THREE.LineBasicMaterial({color:52224,opacity:.5,linewidth:5,depthTest:!1,depthWrite:!1});a=new THREE.Line(a,b,THREE.LinePieces);this.addOverlay("MeasureTool-snapper-edge",a)};this.drawArc=function(a,b){this.createOverlay("MeasureTool-snapper-edge");var c=new THREE.LineBasicMaterial({color:52224,opacity:.5,linewidth:5,
depthTest:!1,depthWrite:!1}),c=new THREE.Line(a,c);b&&c.position.set(b.x,b.y,b.z);this.addOverlay("MeasureTool-snapper-edge",c)};this.drawPoint=function(a){this.createOverlay("MeasureTool-snapper-vertex");var b=new THREE.MeshPhongMaterial({color:52224,ambient:52224,opacity:.5,transparent:!0,depthTest:!1,depthWrite:!1}),b=new THREE.Mesh(new THREE.SphereGeometry(1),b);b.position.set(a.x,a.y,a.z);this.setPointScale(b);this.addOverlay("MeasureTool-snapper-vertex",b)};this.setPointScale=function(b){var c=
a.navigation,d=c.getCamera(),f=c.getEyeVector(),g=c.getPosition(),h=b.position.clone(),d=d.isPerspective?h.sub(g).dot(f.normalize()):c.getEyeVector().length(),f=c.getVerticalFov(),d=2*d*Math.tan(THREE.Math.degToRad(.5*f)),c=c.getScreenViewport(),c=5*d/(c.height*(window.devicePixelRatio||1));b.scale.x=c;b.scale.y=c;b.scale.z=c};this.updatePointScale=function(){var b=a.impl.overlayScenes["MeasureTool-snapper-vertex"];if(b)for(var b=b.scene,c=0;c<b.children.length;c++){var d=b.children[c];d&&this.setPointScale(d)}};
this.setDetectRadius=function(b){var c=a.navigation,d=c.getCamera(),f=c.getEyeVector(),g=c.getPosition();b=b.clone();d=d.isPerspective?b.sub(g).dot(f.normalize()):c.getEyeVector().length();f=c.getVerticalFov();d=2*d*Math.tan(THREE.Math.degToRad(.5*f));c=c.getScreenViewport();c=1.5*d/(c.height*(window.devicePixelRatio||1));a.impl.is2d&&(c*=10);return c};this.drawIntersectFace=function(a,b,c,d){this.createOverlay();var f=new THREE.Vector3;f.set(b[a.a*c],b[a.a*c+1],b[a.a*c+2]);var g=new THREE.Vector3;
g.set(b[a.b*c],b[a.b*c+1],b[a.b*c+2]);var h=new THREE.Vector3;h.set(b[a.c*c],b[a.c*c+1],b[a.c*c+2]);a=new THREE.Geometry;a.vertices.push(f);a.vertices.push(g);a.vertices.push(h);a.faces.push(new THREE.Face3(0,1,2));f=new THREE.Mesh(a,d.material,!0);f.matrixWorld=d.matrixWorld;this.addOverlay(f)};this.handleWheelInput=function(a){this.updatePointScale();return!1};this.handleButtonDown=function(a,b){v=!0;return!1};this.handleButtonUp=function(a,b){return v=!1};this.handleMouseMove=function(b){v||(this.clearOverlay(),
n=l=k=null,D=!1,(b=a.impl.renderer().hasMRT()?a.impl.snappingHitTest(b.canvasX,b.canvasY,!1):a.impl.hitTest(b.canvasX,b.canvasY,!1))&&b.intersectPoint&&(b.face?this.snapping3D(b):this.snapping2D(b)));return!1};this.destroy=function(){this.clearOverlay();a.impl.removeOverlayScene("MeasureTool-snapper-face");a.impl.removeOverlayScene("MeasureTool-snapper-vertex");a.impl.removeOverlayScene("MeasureTool-snapper-edge")}};AutodeskNamespace("Autodesk.Viewing.Extensions.FirstPerson");
Autodesk.Viewing.Extensions.FirstPerson.FirstPersonTool=function(a){var b=-1!=navigator.userAgent.search("Mac OS"),c=a.navigation,f=a.container,d=c.getCamera(),g=["firstperson"],h=0,k=Autodesk.Viewing.theHotkeyManager.KEYCODES,l=!1,n=!0,q=!1,m=null,p=new THREE.Clock(!0),t=-1,v=5E3,D=1,w=2,F=0,B=-1E20,z=-1E20,G=0,A=0,E=!1,H=!1,I=!1,J=!1,L=!1,C=!1;this.isActive=function(){return l};this.getNames=function(){return g};this.getName=function(){return g[0]};this.activate=function(b){p.start();c.toPerspective();
c.setVerticalFov(75,!0);a.model.getUnitScale();b=a.model.getBoundingBox().size();D=Math.max(Math.min(Math.min(b.x,b.y),b.z)/10,1E-4);a.canvas.focus();l=!0};this.deactivate=function(a){l=!1;p.stop();Autodesk.Viewing.Private.HudMessage.dismiss();t=-1};this.getCursor=function(){return"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3goOFQoQszohGAAAA9hJREFUSMedll1oHGUUhp8zuzP5291pEvNTomgVjFCCCa0NpAqJEJTUFVv8uWxQLwKCF6IUr7wJ6J30QvBCAlZssA0EkYJaAm1FwU3iakrbVNNuutlukk3dzWyT/ZnJ7ufFTtokbmvX72Y45+N73/Oe8858I+xYSikBJJFI7AmFQh9alvVWoVC47vP5ho4cOXJeRGwqWN4yOQ2oHh0dPROJRNo7OjqIRCKPRxeiP66srBxSSn0vIsX/RaCU0gDV399vNjQ0tB8/fpxAIEAsFuP06dPEYrFvgHqguEMxIqLKdUPbmnArU52dnb2maWJUGeRyOWzbpqGxgXg87gOMncDlwLe2Y5uCwcHBFp/P90k4PE349xkWolGi0SjhPy5hF+UmIEopz/1AtxRcqmJzDQ8P7750+Wq8e9+TPGLe4sSp39jz9LMsxm/izE6gOVnquoIcOHDgnddfe/VEU3PLWkUzSCQSesCzxNtvHKZu11O0137OuTMneYY1+l+px99sci5zgU+/Pv/Z5OTkWeCvigja2tqqri3/RPbiMfSWLvY+/wJ7XwxCOoyz+gPF5C0OzsFZv8NEOOxU7KL5+fkcooFUo9avYt+4htTU43noJVTmIPYvp8hnChSKCr/fr1VMkEqlCgEATUDTAIVykhSWRtj4M4/KKzZ9Z9u2ehCCbVUYhlEaurg7m09NB/GWYhe2r69vV8UEvb29DeIWL+6uIG6w6b1SGAqF0hUTZDKZ7GLKy1w0h+Z1keQuMEDOKbK+oZFIJOyKZqCUEsuy/k4mk6kr0ZH6/Z2CkrttEl1QjuJkKI3z6KGp6vTFpYoVmKaZ9Xg8lleDoq3IzOdBILuygbVgs2YVSNrgOM7o1NTURkUE7qufX15evo5A0VHcnrNRgFgFJF6gsVmntlaIxWKNIlK/s8D/VCAianZ29spmv0vfVoVuaNT6PYhWMpGIGIZhNAGtQC3bbXDfj51YlrWObHeOKu3didfX1x3btgGqgADgu5eafyXT6XT2zmDLnVDg9Xq9uq573fMeQAeqy+HtTAgguq7h0aUsgyZCJpPZcBxnE1xz3fhACqp7enoe+3ZimVg8j6ELiIACEUETWErnsCwrD2h1dXW6C+4A2a033T0VfPD+e8dePvoFb36sM/LzKomkQ1FgMW3z7neL3Gh6jtbW1rmamhrDNM0NYAVIAYWyl06ZPwoNeHh6evqJmZmZiV8vnCBw+yLRRCv7gkdpamr6aGho6KuBgQFnfHx88V7AZQlcEt01jgD+sbGx3V+OjPR07d8fDQaDl1OpVLK7u9swTXP1Qa7NfwCi46BIaoRmhAAAAABJRU5ErkJggg==), auto"};
this.adjustSpeed=function(a){0===a?w=2:(w*=0<a?1.1:.9,.01>w&&(w=.01))};this.handleGesture=function(a){switch(a.type){case "dragstart":return m="drag",this.handleButtonDown(a,0);case "dragmove":return"drag"===m?this.handleMouseMove(a):!1;case "dragend":if("drag"===m)return this.handleButtonUp(a,0),m=null,!0}return!1};this.handleSingleClick=function(a,b){return!1};this.handleButtonDown=function(a,c){var d;m?d=!0:(d=a.metaKey&&!b,d=a.ctrlKey||b&&a.metaKey||d||a.shiftKey||a.altKey);0!==c||d||(G=A=0,q=
!0);return!0};this.handleMouseMove=function(a){var b=-1E10>B?0:a.pageX-B,c=-1E10>z?0:a.pageY-z;B=a.pageX;z=a.pageY;q===n&&(G+=.007*b,A+=.007*c);return!0};this.handleButtonUp=function(a,b){0===b&&q&&(G=A=0,q=!1);return!0};this.handleKeyDown=function(a,b){var c=!1;switch(b){case k.TAB:c=!1;break;case k.SHIFT:h=1;c=!0;break;case k.CONTROL:c=!0;break;case k.ALT:c=!0;break;case k.SPACE:c=!0;break;case k.EQUALS:this.adjustSpeed(1);c=!0;break;case k.DASH:this.adjustSpeed(-1);c=!0;break;case k.ZERO:this.adjustSpeed(0);
c=!0;break;case k.UP:case k.w:c=E=!0;break;case k.LEFT:case k.a:c=I=!0;break;case k.DOWN:case k.s:c=H=!0;break;case k.RIGHT:case k.d:c=J=!0;break;case k.q:c=L=!0;break;case k.e:c=C=!0;break;case k.g:c=!0;break;case k.F1:c=!0}return c};this.handleKeyUp=function(a,b){var c=!1;switch(b){case k.TAB:c=!1;break;case k.SHIFT:h=0;c=!0;break;case k.CONTROL:c=!0;break;case k.ALT:c=!0;break;case k.SPACE:c=!0;break;case k.UP:case k.w:E=!1;c=!0;break;case k.LEFT:case k.a:I=!1;c=!0;break;case k.DOWN:case k.s:H=
!1;c=!0;break;case k.RIGHT:case k.d:J=!1;c=!0;break;case k.q:L=!1;c=!0;break;case k.e:C=!1;c=!0;break;case k.g:n=!n;N({msgTitleKey:"Dragging Look Mode Toggled",messageKey:"Dragging Look Mode Toggled",messageDefaultValue:n?"Press the primary mouse button and drag to change the view orientation.":"Move the cursor to change the view orientation."},5E3);c=!0;break;case k.F1:N({msgTitleKey:"First Person Tool",messageKey:"First Person Tool",messageDefaultValue:"Use the WASD and QE keys to move.  Shift+Key to move faster.  G key to toggle drag mode for changing view orientation."},
5E3),c=!0}return c};this.handleWheelInput=function(a){c.getReverseZoomDirection()&&(a*=-1);F+=a;return!0};this.handleSingleClick=function(a,b){return!1};this.handleDoubleClick=function(a,b){return!1};this.handleSingleTap=function(a){return this.handleSingleClick(a,0)};this.handleDoubleTap=function(a){return!1};this.handleBlur=function(a){return L=C=I=J=E=H=!1};this.update=function(){if(!l)return!1;var a=p.getDelta();-1<t&&(new Date).getTime()-t>v&&(Autodesk.Viewing.Private.HudMessage.dismiss(),t=
-1);d.isPerspective||(console.log("Lost perspective mode: resetting view."),c.toPerspective());var b=d.clone(),f=a*w*D*(1===h?4:1),a=.5*a*D*(1===h?4:1);0!=F&&(b.translateZ(-(1*F*D*(1===h?4:1))),F=0);E&&b.translateZ(-f);H&&b.translateZ(f);I&&b.translateX(-f);J&&b.translateX(f);L&&b.translateY(a);C&&b.translateY(-a);var f=b.position,a=0!==f.distanceToSquared(d.position),g=b.target,g=d.target.clone().sub(d.position),k=g.clone().cross(d.up).normalize();if(0!=A){var m=new THREE.Quaternion;m.setFromAxisAngle(k,
-A);k=g.clone();k.applyQuaternion(m);var n=d.worldup.clone(),k=k.angleTo(n),n=THREE.Math.degToRad(5);k>=n&&k<=Math.PI-n&&(g.applyQuaternion(m),b.up.applyQuaternion(m));A=0}0!=G&&(m=new THREE.Quaternion,m.setFromAxisAngle(d.worldup,-G),g.applyQuaternion(m),b.up.applyQuaternion(m),G=0);g=f.clone().add(g);b=0!==g.distanceToSquared(d.target);if(a||b)c.setView(f,g),c.orientCameraUp();return d.dirty};var N=function(a,b,c,d){Autodesk.Viewing.Private.HudMessage.displayMessage(f,a,c,d);0<b?(t=(new Date).getTime(),
v=b):(t=-1,v=0)}};"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.FirstPerson");Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b)};Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype.constructor=Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension;
Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype.load=function(){var a=this,b=this.viewer,c=b.getToolbar(!0),f=Autodesk.Viewing.UI;this.tool=new Autodesk.Viewing.Extensions.FirstPerson.FirstPersonTool(b);b.toolController.registerTool(this.tool);this.createUI(c);this.onToolChanged=function(b){-1!==b.toolName.indexOf("firstperson")&&a.firstPersonToolButton.setState(b.active?f.Button.State.ACTIVE:f.Button.State.INACTIVE)};b.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged);
return!0};
Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype.createUI=function(a){var b=this,c=this.viewer,f=Autodesk.Viewing.UI;a=a.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);this.firstPersonToolButton=new f.Button("toolbar-firstPersonTool");this.firstPersonToolButton.setToolTip("First person");this.firstPersonToolButton.onClick=function(a){a=b.firstPersonToolButton.getState();a===f.Button.State.INACTIVE?c.setActiveNavigationTool("firstperson"):a===f.Button.State.ACTIVE&&c.setActiveNavigationTool()};
this.firstPersonToolButton.setIcon("adsk-icon-first-person");var d=a.getControl("toolbar-cameraSubmenuTool");d?a.addControl(this.firstPersonToolButton,{index:a.indexOf(d.getId())}):a.addControl(this.firstPersonToolButton)};
Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension.prototype.unload=function(){var a=this.viewer;a.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged);this.onToolChanged=void 0;Autodesk.Viewing.theHotkeyManager.popHotkeys(this.HOTKEYS_ID);var b=a.getToolbar(!1);b&&b.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID).removeControl(this.firstPersonToolButton.getId());this.firstPersonToolButton=null;a.getActiveNavigationTool()==this.tool.getName()&&a.setActiveNavigationTool();
a.toolController.deregisterTool(this.tool);this.tool=null;return!0};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.FirstPerson",Autodesk.Viewing.Extensions.FirstPerson.FirstPersonExtension);AutodeskNamespace("Autodesk.Viewing.Extensions.VR");
Autodesk.Viewing.Extensions.VR.VRTool=function(a,b){var c=a.navigation,f=a.container,d=c.getCamera(),g=["vr"],h=!1,k=null,l=!1,n=0,q=0,m=Autodesk.Viewing.theHotkeyManager.KEYCODES,p=0,t=!1,v=!1,D=!1,w=!1,F=!1,B=!1,z=new THREE.Clock(!0),G=-1,A=5E3,E=1,H=16,I=!1,J=16,L=d.isPerspective,C=null,N=null,K=null,R=!1,T=-1,ba=!0,X=null,Y=null,W=!1,U=new THREE.Vector3(0,0,0),O=new THREE.Vector3(0,0,0),da=!1;this.isActive=function(){return h};this.getNames=function(){return g};this.getName=function(){return g[0]};
this.activate=function(b){h||(l=d.worldup&&1===d.worldup.z,console.log("VRTool : camera world up = "+d.worldup.x+","+d.worldup.y+","+d.worldup.z),z.start(),ga()?(Z({msgTitleKey:"VR Head Mounted Display",messageKey:"VR Head Mounted Display",messageDefaultValue:"VR Mode Enabled (Head Mounted Display) - Use SPACE key to toggle move control."},2E3),V(!1),console.log("VR Supported (Web API): Oculus, etc.")):(Z({msgTitleKey:"VR Device Orientation",messageKey:"VR Device Orientation",messageDefaultValue:"VR Mode Enabled (Device Orientation)"},
2E3),window.addEventListener("deviceorientation",ja,!0)),da="wearality"===(a.config&&a.config.useVR?a.config.useVR:"").toLowerCase(),M(!0),b=a.utilities.getBoundingBox(!0).size(),E=Math.max(Math.min(Math.min(b.x,b.y),b.z)/100,1),this.resetPointerTracking(),a.canvas.focus(),ea(),h=!0)};this.deactivate=function(a){h&&(h=!1,Autodesk.Viewing.Private.HudMessage.dismiss(),G=-1,C&&(K&&(K.stop(),K=null),C.disconnect(),C=null,N&&N.disable()),M(!1),exitFullscreen(),z.stop(),V(!0))};this.getCursor=function(){return"url(data:image/gif;base64,R0lGODlhGAAYAMIDAAQEBH19feDg4P///////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAAQALAAAAAAYABgAAAMqSLrc/jDKSau9OOvN8fjDNghBIITZEABAgHpr+15jeYpgp+987//AICEBADs=), auto"};
var V=function(a){var b=document.getElementsByClassName("toolbar-menu");0<b.length&&""!==b[0]&&(b[0].style.display=a?"block":"none")},M=function(b){if(b!==!!k)if(console.log("Enable Render Context: "+b),b){a.displayViewCube(!1,!1);(L=a.navigation.isPerspective)||a.navigation.toPerspective();b=!!X;var c=null,c=da?{useWarp:b,HMD:{hResolution:1920,vResolution:1080,hScreenSize:.12576,vScreenSize:.07074,interpupillaryDistance:.075,lensSeparationDistance:.075,eyeToScreenDistance:.041,distortionK:[1,.22,
.24,0],chromaAbParameter:[.996,-.004,1.014,0]}}:{useWarp:b};k=new Autodesk.Viewing.Extensions.Oculus.StereoRenderContext(c);a.impl.setUserRenderContext(k);a.resize(a.canvas.clientWidth,a.canvas.clientHeight);X?launchFullscreen(a.impl.canvas,{vrDisplay:X}):launchFullscreen(a.impl.canvas)}else k=null,a.impl.setUserRenderContext(null),a.setScreenMode(Autodesk.Viewing.ScreenMode.kNormal),a.displayViewCube(a.prefs.get("viewCube"),!1)};this.handleSingleTap=function(b){if(C&&b.pointers){if(1===b.pointers.length)return setTimeout(function(){a.setActiveNavigationTool(a.defaultNavigationToolName)},
10),!0;if(2===b.pointers.length)return la(),!0}return!1};this.handleDoubleTap=function(a){return!1};this.handlePressHold=function(a){return!1};this.handleGesture=function(a){return!1};this.handleKeyDown=function(a,b){var c=!1;switch(b){case m.TAB:c=!0;break;case m.SHIFT:n=1;c=!0;break;case m.CONTROL:q=1;c=!0;break;case m.ALT:c=!0;break;case m.SPACE:c=!0;break;case m.EQUALS:this.adjustSpeed(1);c=!0;break;case m.DASH:this.adjustSpeed(-1);c=!0;break;case m.ZERO:this.adjustSpeed(0);c=!0;break;case m.w:if(1===
q&&1===n){c=!0;break}case m.UP:c=t=!0;break;case m.LEFT:case m.a:c=D=!0;break;case m.DOWN:case m.s:c=v=!0;break;case m.RIGHT:case m.d:c=w=!0;break;case m.q:c=B=!0;break;case m.e:c=F=!0;break;case m.h:c=!0}return c};this.handleKeyUp=function(a,b){var c=!1;switch(b){case m.SHIFT:n=0;break;case m.CONTROL:q=0;break;case m.SPACE:X&&X&&((W=!W)&&U.copy(O),ca(W));c=!0;break;case m.w:if(!t&&1===q&&1===n){setTimeout(function(){M(!1);da=!da;M(!0)},10);c=!0;break}case m.UP:t=!1;c=!0;break;case m.LEFT:case m.a:D=
!1;c=!0;break;case m.DOWN:case m.s:v=!1;c=!0;break;case m.RIGHT:case m.d:w=!1;c=!0;break;case m.q:B=!1;c=!0;break;case m.e:F=!1;c=!0;break;case m.h:ea(),c=!0}return c};this.handleBlur=function(a){return w=D=v=t=!1};this.update=function(a){if(h){a=z.getDelta();-1<G&&(new Date).getTime()-G>A&&(Autodesk.Viewing.Private.HudMessage.dismiss(),G=-1);var b;if(b=!!X)if(Y){b=Y.getState();if(d){l?(O.x=b.position.x,O.y=-b.position.z,O.z=b.position.y):(O.x=b.position.x,O.y=b.position.y,O.z=b.position.z);if(W){var f=
U.distanceTo(O);.15<=f&&(f=(f-.15)/.0762*H*E*a,f=O.clone().sub(U).normalize().multiplyScalar(f),d.position.add(f))}l?(d.quaternion.x=b.orientation.x,d.quaternion.y=-b.orientation.z,d.quaternion.z=b.orientation.y):(d.quaternion.x=b.orientation.x,d.quaternion.y=b.orientation.y,d.quaternion.z=b.orientation.z);d.quaternion.w=b.orientation.w;b=new THREE.Vector3(0,0,-1);l&&(b=new THREE.Vector3(b.x,-b.z,b.y));b.applyQuaternion(d.quaternion);d.target=d.position.clone().add(b.clone().multiplyScalar(10));d.dirty=
!0}b=!0}else b=!1;!b&&C&&C&&(b=C.update())&&(l&&(f=b.z,b.z=b.y,b.y=-f),b=(l?new THREE.Vector3(0,1,0):new THREE.Vector3(0,0,-1)).clone().applyQuaternion(b),f=d.target.clone().sub(d.position).length(),c.setTarget(d.position.clone().add(b.multiplyScalar(f))),K?K.isStarted()&&(0>=T?K.checkVideoThreshold(15)&&la():K.checkVideoThreshold(15)?I&&(b=(new Date).getTime(),f=b-T,250<f&&(T=b,H+=J,ca(!0))):T=-1):(f=l?new THREE.Vector3(0,0,-1):new THREE.Vector3(0,-1,0),b=THREE.Math.radToDeg(b.angleTo(f)),30>b)?
R?I&&(b=(new Date).getTime(),f=b-T,f>=(ba?1500:1E3)&&(ba=!1,T=b,H+=J,ca(!0))):(la(),R=!0,I&&(ba=!0)):30<=b&&(R=!1,T=-1),d.dirty=!0);b=d.clone();f=a*H*E*(1===n?4:1);a=15*a*E*(1===n?4:1);0!=p&&(b.translateZ(-(3*p*E*(1===n?4:1))),p=0);var g=!1;I&&(g=!0);(t||g)&&b.translateZ(-f);v&&b.translateZ(f);D&&b.translateX(-f);w&&b.translateX(f);F&&b.translateY(a);B&&b.translateY(-a);a=b.position;0!==a.distanceToSquared(d.position)&&(b=b.target,f=a.clone().sub(d.position),b.add(f),c.setView(a,b));return d.dirty}};
this.resetPointerTracking=function(){_mouseDraggingLookMode=F=B=D=w=t=v=!1};var la=function(){(I=!I)?(J=H,H=1.75,T=(new Date).getTime()):H=J;ca(I);return I},ga=function(){function a(c){for(var d=0;d<c.length;++d)c[d]instanceof HMDVRDevice&&(X=c[d]);for(d=0;d<c.length;++d)c[d]instanceof PositionSensorVRDevice&&(!X||c[d].hardwareUnitId==X.hardwareUnitId)&&(Y=c[d],b=!0)}var b=!1;navigator.getVRDevices?navigator.getVRDevices().then(a):navigator.mozGetVRDevices?navigator.mozGetVRDevices(a):b=!1;return b},
ja=function(a){if(!a.alpha)return!1;window.removeEventListener("deviceorientation",ja,!0);C=new THREE.DeviceOrientationControls;C.connect();N||(N=new window.NoSleep,N.enable());K=new VideoHelper("videoVR","videoVR-canvas",1);K.start()||(K=null,console.log("VideoHelper : Failed to start."));V(!1);console.log("VR Supported (DeviceOrientation): Google Goggles, etc.");return!0},Z=function(a,b){Autodesk.Viewing.Private.HudMessage.dismiss();Autodesk.Viewing.Private.HudMessage.displayMessage(f,a);G=(new Date).getTime();
if(!b||0>=b)b=5E3;A=b},ea=function(){Z({msgTitleKey:"Virtual Reality Tool",messageKey:"Virtual Reality Tool",messageDefaultValue:"This is the Virtual Reality tool."},3E3)},ca=function(a,b){if(!b||0>=b)b=250;Z({msgTitleKey:"VR Toggle Move",messageKey:"VR Toggle Move",messageDefaultValue:a?"START Auto Move ("+Math.floor(H)+")":"STOP Auto Move"},b)}};"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.VR");
Autodesk.Viewing.Extensions.VR.VRExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b)};Autodesk.Viewing.Extensions.VR.VRExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.VR.VRExtension.prototype.constructor=Autodesk.Viewing.Extensions.VR.VRExtension;
Autodesk.Viewing.Extensions.VR.VRExtension.prototype.load=function(){var a=this,b=this.viewer,c=b.getToolbar(!0),f=Autodesk.Viewing.UI;this.tool=new Autodesk.Viewing.Extensions.VR.VRTool(b,this);b.toolController.registerTool(this.tool);this.createUI(c);this.onToolChanged=function(b){-1!==b.toolName.indexOf("vr")&&a.vrToolButton.setState(b.active?f.Button.State.ACTIVE:f.Button.State.INACTIVE)};b.addEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged);return!0};
Autodesk.Viewing.Extensions.VR.VRExtension.prototype.createUI=function(a){var b=this,c=this.viewer,f=Autodesk.Viewing.UI;a=a.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);this.vrToolButton=new f.Button("toolbar-vrTool");this.vrToolButton.setToolTip("Virtual Reality Tool");this.vrToolButton.setIcon("toolbar-vrToolButton");this.vrToolButton.onClick=function(a){a=b.vrToolButton.getState();a===f.Button.State.INACTIVE?c.setActiveNavigationTool("vr"):a===f.Button.State.ACTIVE&&c.setActiveNavigationTool()};
var d=a.getControl("toolbar-cameraSubmenuTool");d?a.addControl(this.vrToolButton,{index:a.indexOf(d.getId())}):a.addControl(this.vrToolButton)};
Autodesk.Viewing.Extensions.VR.VRExtension.prototype.unload=function(){var a=this.viewer;a.removeEventListener(Autodesk.Viewing.TOOL_CHANGE_EVENT,this.onToolChanged);this.onToolChanged=void 0;Autodesk.Viewing.theHotkeyManager.popHotkeys(this.HOTKEYS_ID);var b=a.getToolbar(!1);b&&b.getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID).removeControl(this.vrToolButton.getId());this.vrToolButton=null;a.toolController.deregisterTool(this.tool);this.tool=null;return!0};
Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.VR",Autodesk.Viewing.Extensions.VR.VRExtension);AutodeskNamespace("Autodesk.Viewing.Extensions.FusionOrbit");
(function(){var a=Autodesk.Viewing.Extensions.FusionOrbit;a.FusionOrbitExtension=function(a,c){Autodesk.Viewing.Extension.call(this,a,c)};a.FusionOrbitExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);a.FusionOrbitExtension.prototype.constructor=a.FusionOrbitExtension;a.FusionOrbitExtension.prototype.load=function(){function a(){f.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);c.createUI()}var c=this,f=this.viewer,d=f.getToolbar?f.getToolbar(!0):void 0;this.tool=
new Autodesk.Viewing.Extensions.FusionOrbit.FusionOrbitTool(f);f.toolController.registerTool(this.tool);d?(d=d.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID))&&0<d.getNumberOfControls()?a():f.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a):f.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);return!0};a.FusionOrbitExtension.prototype.createUI=function(){var a=this.viewer,c=Autodesk.Viewing.UI,f=a.getToolbar(!1).getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);this.classicBehavior=
{};this.classicBehavior.orbitOnClick=f.orbitbutton.onClick;this.classicBehavior.freeorbitOnClick=f.freeorbitbutton.onClick;this.classicBehavior.returnToDefault=f.returnToDefault;f.freeorbitbutton.onClick=function(d){d=f.freeorbitbutton.getState();d===c.Button.State.INACTIVE?(a.setActiveNavigationTool("fusion orbit"),f.freeorbitbutton.setState(c.Button.State.ACTIVE)):d===c.Button.State.ACTIVE&&(a.setActiveNavigationTool(),f.freeorbitbutton.setState(c.Button.State.INACTIVE))};f.orbitbutton.onClick=
function(d){d=f.orbitbutton.getState();d===c.Button.State.INACTIVE?(a.setActiveNavigationTool("fusion orbit constrained"),f.orbitbutton.setState(c.Button.State.ACTIVE)):d===c.Button.State.ACTIVE&&(a.setActiveNavigationTool(),f.orbitbutton.setState(c.Button.State.INACTIVE))};f.returnToDefault=function(){f.orbittoolsbutton.setState(c.Button.State.ACTIVE);f.orbittoolsbutton.setState(c.Button.State.INACTIVE)};f.orbittoolsbutton.setState(c.Button.State.INACTIVE);a.prefs.fusionOrbitConstrained?(f.orbittoolsbutton.onClick=
f.orbitbutton.onClick,f.orbittoolsbutton.setIcon(f.orbitbutton.iconClass),a.setDefaultNavigationTool("orbit")):(f.orbittoolsbutton.onClick=f.freeorbitbutton.onClick,f.orbittoolsbutton.setIcon(f.freeorbitbutton.iconClass),a.setDefaultNavigationTool("freeorbit"));a.setActiveNavigationTool();f.returnToDefault()};a.FusionOrbitExtension.prototype.unload=function(){var a=this.viewer,c=a.getToolbar(!1).getControl(Autodesk.Viewing.TOOLBAR.NAVTOOLSID);c.orbitbutton.onClick=this.classicBehavior.orbitOnClick;
c.freeorbitbutton.onClick=this.classicBehavior.freeorbitOnClick;c.returnToDefault=this.classicBehavior.returnToDefault;c.orbittoolsbutton&&(c.orbittoolsbutton.onClick=c.orbitbutton.onClick,c.orbittoolsbutton.setIcon("adsk-icon-orbit-constrained"),c.orbittoolsbutton.setState(Autodesk.Viewing.UI.Button.State.ACTIVE));a.setActiveNavigationTool("orbit");a.setDefaultNavigationTool("orbit");a.toolController.deregisterTool(this.tool);this.tool=null;return!0};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Viewing.FusionOrbit",
a.FusionOrbitExtension)})();Autodesk.Viewing.Extensions.FusionOrbit.html='<div class="orbit-gizmo noselect">\n<div class="outside"></div>\n<div class="ring"></div>\n<div class="layout-hor">\n<div class="edgemark-area"><div class="edgemark"></div></div>\n</div>\n<div class="layout-mid">\n<div class="layout-ver">\n<div class="edgemark-area"><div class="edgemark"></div></div>\n</div>\n<div class="circle">\n<div class="crosshair-area">\n<div class="crosshair-v"></div>\n<div class="crosshair-h"></div>\n</div>\n</div>\n<div class="layout-ver">\n<div class="edgemark-area"><div class="edgemark"></div></div>\n</div>\n</div>\n<div class="layout-hor">\n<div class="edgemark-area"><div class="edgemark"></div></div>\n</div>\n</div>';
Autodesk.Viewing.Extensions.FusionOrbit.FusionOrbitTool=function(a,b){var c=["fusion orbit","fusion orbit constrained"],f,d,g,h,k,l=a.navigation,n,q=isTouchDevice(),m=!1,p=[],t=void 0,v=0,D=0,w=0,F=0,B=!0,z=void 0,G=function(a){p[a.touches?0:a.button]=!0;t=a.target.className;F=w=D=v=0;B=!0;z=void 0;"ring"===t?z=2:"edgemark-area"===t&&("layout-ver"===a.target.parentNode.className?z=0:"layout-hor"===a.target.parentNode.className&&(z=1));J();a.stopPropagation()},A=function(a){p[a.touches?0:a.button]=
!1;t=void 0},E=function(a){if(p[0]){var b=a.touches?a.touches[0].pageX:a.pageX;a=a.touches?a.touches[0].pageY:a.pageY;B||(w=b-v,F=a-D);v=b;D=a;b=n.target.clone().sub(n.position).normalize();a=b.clone().cross(n.up).normalize();var c=a.clone().cross(b).normalize();n.up.copy(c);if(2===z){var f=new THREE.Vector3(v-d.center.x,D-d.center.y,0),g=(new THREE.Vector3(w,F,0)).add(f);f.normalize();g.normalize();f=f.clone().cross(g);f=Math.asin(f.z);n.up.applyAxisAngle(b,1*-f)}else 0===z?(g=.005*-w,k&&(n.up=Autodesk.Viewing.Navigation.snapToAxis(n.up.clone())),
f=n.up):1===z&&(g=.005*-F,k?(B&&(n.up=Autodesk.Viewing.Navigation.snapToAxis(n.up.clone())),f=b.clone().cross(n.up).normalize()):f=a,n.up.applyAxisAngle(f,g)),b=l.getPivotPoint(),a=n.position.clone().sub(b),a.applyAxisAngle(f,g),n.position.addVectors(b,a),a=n.target.clone().sub(b),a.applyAxisAngle(f,g),n.target.addVectors(b,a);n.dirty=!0;B=!1}},H=function(){var b=n.target.clone().sub(n.position).normalize();return(b=a.impl.rayIntersect(new THREE.Ray(n.position,b)))&&b.intersectPoint?b.intersectPoint:
n.target},I=function(a,b){var c=b||a.clone().sub(n.position).normalize();return new THREE.Plane(c,-c.x*a.x-c.y*a.y-c.z*a.z)},J=function(){var a=n.target.clone().sub(n.position).normalize(),b=I(n.position,a).distanceToPoint(n.pivot);n.pivot.copy(a).multiplyScalar(b).add(n.position)},L=function(a){a.touches||0!==a.button||J()},C=function(b){m&&a.setActiveNavigationTool()},N=function(b,c){var d=a.impl.hitTest(b,c),d=d&&d.intersectPoint?d.intersectPoint:a.impl.viewportToRay(a.impl.clientToViewport(b,
c)).intersectPlane(I(n.target)),f=n.position.clone().sub(H()).add(d);l.setRequestTransition(!0,f,d,n.fov)};this.register=function(){f=stringToDOM(Autodesk.Viewing.Extensions.FusionOrbit.html);f.style.display="none";a.canvasWrap.insertBefore(f,a.canvasWrap.firstChild);g=f.querySelector(".ring");g.addEventListener("mousedown",G);Array.prototype.forEach.call(f.querySelectorAll(".edgemark-area"),function(a,b){a.addEventListener("mousedown",G);q&&a.addEventListener("touchstart",G)});window.addEventListener("mouseup",
A);window.addEventListener("mousemove",E);h=f.querySelector(".outside");h.addEventListener("mousedown",C);var b=f.querySelector(".circle");b.addEventListener("mousedown",L);q&&(g.addEventListener("touchstart",G),window.addEventListener("touchend",A),window.addEventListener("touchmove",E),h.addEventListener("touchstart",C),b.addEventListener("touchstart",L));n=a.impl.camera};this.deregister=function(){window.removeEventListener("mouseup",A);window.removeEventListener("mousemove",E);q&&(window.removeEventListener("touchend",
A),window.removeEventListener("touchmove",E));g=f=void 0};this.activate=function(b){f.style.display="";this.handleResize();(k="fusion orbit constrained"===b)?(a.setDefaultNavigationTool("orbit"),a.prefs.set("fusionOrbitConstrained",!0)):(a.setDefaultNavigationTool("freeorbit"),a.prefs.set("fusionOrbitConstrained",!1));a.navigation.setZoomTowardsPivot(!0)};this.deactivate=function(b){f.style.display="none";a.navigation.setZoomTowardsPivot(a.prefs.zoomTowardsPivot)};this.getNames=function(){return c};
this.getName=function(){return c[0]};this.update=function(){return!1};this.handleSingleClick=function(a,b){N(a.canvasX,a.canvasY);return!0};this.handleDoubleClick=function(a,b){return!0};this.handleSingleTap=function(a){N(a.canvasX,a.canvasY);return!0};this.handleDoubleTap=function(a){return!1};this.handleKeyDown=function(a,b){return!1};this.handleKeyUp=function(a,b){return!1};this.handleWheelInput=function(a){return!1};this.handleButtonDown=function(a,b){return!1};this.handleButtonUp=function(a,
b){return!1};this.handleMouseMove=function(b){var c=a.impl.canvas.getBoundingClientRect();b=1.2<(c.width>c.height?new THREE.Vector2(((b.canvasX+.5)/c.width*2-1)*c.width/c.height,2*-((b.canvasY+.5)/c.height)+1):new THREE.Vector2((b.canvasX+.5)/c.width*2-1,(2*-((b.canvasY+.5)/c.height)+1)*c.height/c.width)).length();m!==b&&(h.style.cursor=b?"":"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAt1BMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8AAAAzMzP6+vri4uISEhKKioqtra2dnZ2EhIR9fX10dHRkZGQdHR3t7e3Hx8e5ubm1tbWoqKhWVlZKSko4ODgICAjv7+/o6OjMzMyxsbFOTk4pKSkXFxcEBAT29vbW1tZ6enpISEgLCwvhzeX+AAAAGXRSTlMANRO0nHRJHfnskIxQRKh89syDVwTWZjEJxPFEswAAAOFJREFUKM+1j+lygkAQhIflEAJe0Rw9u4CCeKKoSTTX+z9XoMJWWeX+ssrvZ3f19DQ5zOw/0DUMQPlmQ72bE2adBp8/Rp3CQUi3ILx+bxj4fjDs9T1Bmo6bbPPN8aDU4bjJt4nb+de789kSFyxn826jW3ICLNZZKU8nWWbrBTCRVm04U8TpjquRFf1Go0d7l8aYOrUR7FGEFr1S9LGymwthgX2gE/Kl0cHPOtF2xOWZ5QpIC93RflW4InkDoPRXesd5LJIMQPzV7tCMa7f6BvhJL79AVDmYTNQ1NhnxbI/uwB8H5Bjd4zQPBAAAAABJRU5ErkJggg==), auto",
m=b);return!1};this.handleGesture=function(a){J();return!1};this.handleBlur=function(a){return!1};this.handleResize=function(){d=f.getBoundingClientRect();d.center={};d.center.x=d.left+d.width/2;d.center.y=d.top+d.height/2;var a=.8*(window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth);f.style.width=f.style.height=""+a+"px";f.style.top=f.style.left="calc(50% - "+a/2+"px)";g.style.borderWidth=""+.1*a+"px"}};AutodeskNamespace("Autodesk.Viewing.Private.Collaboration");
(function(){function a(a,b,c){function d(b){b=b.data.msg;n.x=b.x1;n.y=b.y1;q.x=b.x2;q.y=b.y2;m=b.explode;b.command&&("gohome"==b.command?(n.x=n.y=0,q.x=q.y=0,a.navigation.setRequestHomeView(!0),a.showAll(),a.impl.selector.clearSelection(),a.explode(0),p=null):"select"==b.command?(b=a.impl.hitTestViewport(new THREE.Vector3(0,0,0)))&&b.node?a.impl.selector.toggleSelection(b.node):a.impl.selector.clearSelection():"hide"==b.command?(b=a.impl.hitTestViewport(new THREE.Vector3(0,0,0)))&&b.node&&a.hide(b.node):
"fly"==b.command?p=p?null:t.target.clone().sub(t.position).normalize():"savepoint"==b.command?(b=w.getState(z),F.push(b),alertify.success("Savepoint created.")):"nextsavepoint"==b.command&&F.length&&(B>=F.length&&(B=0),w.restoreState(F[B++])))}var n=new THREE.Vector2,q=new THREE.Vector2,m=0,p=null,t,v=.02,D=.002,w,F=[],B=0,z={seedURN:!1,objectSet:!0,viewport:!0,renderOptions:{environment:!1,ambientOcclusion:!1,toneMap:{exposure:!1},appearance:!1}},G=function(){if(!a.impl.svfloader.isf2d){var b=a.impl.svfloader.svf.bbox.size().length();
v*=b;D*=b;a.removeEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,G)}};a.addEventListener(Autodesk.Viewing.PROGRESS_UPDATE_EVENT,G);this.getNames=function(){return["joystick"]};this.getName=function(){return"joystick"};this.activate=function(m){b.addEventListener("joystick",d);c.addEventListener("joystick",d);t=a.navigation.getCamera();a.model&&(a.model.getBoundingBox().size().length(),w=new f.ViewerState(a))};this.deactivate=function(a){b.removeEventListener("joystick",d);c.removeEventListener("joystick",
d);w=t=null;F.length=0};this.update=function(b){t.isPerspective||a.navigation.toPerspective();p&&(b=p.clone().multiplyScalar(D),t.position.add(b),t.target.add(b));0!=m&&(b=a.getExplodeScale()+.01*m,1<b&&(b=1),0>b&&(b=0),a.explode(b));if(0==n.x&&0==n.y&&0==q.x&&0==q.y)return!(!p&&!m);var c=t.target.clone().sub(t.position);b=c.length();c.multiplyScalar(1/b);var d=c.clone().cross(t.up).normalize(),f=c.clone().multiplyScalar(n.y*v);t.position.add(f);t.target.add(f);f=d.clone().multiplyScalar(n.x*v);t.position.add(f);
t.target.add(f);f=new THREE.Quaternion;f.setFromAxisAngle(d,.05*q.y);c=c.clone().applyQuaternion(f);t.up.applyQuaternion(f);d=new THREE.Quaternion;d.setFromAxisAngle(t.worldup,.05*-q.x);c.applyQuaternion(d);t.up.applyQuaternion(d);c.multiplyScalar(b);t.target.copy(t.position).add(c);p&&p.copy(t.target).sub(t.position).normalize();return!0};this.handleSingleClick=function(a,b){return!1};this.handleDoubleClick=function(a,b){return!1};this.handleSingleTap=function(a){return!1};this.handleDoubleTap=function(a,
b){return!1};this.handleKeyDown=function(a,b){return!1};this.handleKeyUp=function(a,b){return!1};this.handleWheelInput=function(a){return!1};this.handleButtonDown=function(a,b){return!1};this.handleButtonUp=function(a,b){return!1};this.handleMouseMove=function(a){return!1};this.handleGesture=function(a,b){return!1};this.handleTouchChange=function(a,b){return!1};this.handleBlur=function(a){return!1};this.handleResize=function(){}}var b=Autodesk.Viewing,c=b.Extensions,f=b.Private,d=b.UI;c.RemoteControl=
function(c,d){b.Extension.call(this,c,d);this.viewer=c;this.client=f.MessageClient.GetInstance();this.p2p=new f.P2PClient(this.client);this.controllerTool=new a(c,this.client,this.p2p);c.toolController.registerTool(this.controllerTool)};c.RemoteControl.prototype=Object.create(b.Extension.prototype);c.RemoteControl.prototype.constructor=c.RemoteControl;c.RemoteControl.prototype.createUI=function(){var a=this,b=this.viewer;this.controlButton=new d.Button("toolbar-remoteControlTool");this.controlButton.setToolTip("Pair with controller device");
this.controlButton.onClick=function(){this.getState()===d.Button.State.INACTIVE?(a.connect(),this.setState(d.Button.State.ACTIVE)):(a.disconnect(),this.setState(d.Button.State.INACTIVE))};this.controlButton.setIcon("adsk-icon-game-controller");b.modelTools.addControl(this.controlButton);this.panel=new Autodesk.Viewing.UI.DockingPanel(b.container,"remote-panel","Remote Control");this.panel.width=300;this.panel.height=375;this.panel.container.style.width=this.panel.width+"px";this.panel.container.style.height=
this.panel.height+"px";this.panel.container.style.top=(window.innerHeight-this.panel.height)/2+"px";this.panel.container.style.left=(window.innerWidth-this.panel.width)/2+"px";this.panel.body=document.createElement("div");this.panel.body.classList.add("body");this.panel.container.appendChild(this.panel.body);this.panel.body.innerHTML='<p>Go to this link:</p>\n<p><a class="url" target="_blank" href="#">Link</a></p>\n<p>or</p>\n<p>Scan the QR code with your device:</p>\n<img class="qr-img" src="">';
this.panel.link=this.panel.container.querySelector(".url");this.panel.code=this.panel.container.querySelector(".code");this.panel.qrImg=this.panel.container.querySelector(".qr-img")};c.RemoteControl.prototype.load=function(){function a(d){b.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);c.createUI()}var b=this.viewer,c=this;b.modelTools&&0<b.modelTools.getNumberOfControls()?c.createUI():b.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);return!0};c.RemoteControl.prototype.unload=
function(){var a=this.viewer;this.p2p.hangup();this.client.disconnect();a.toolController.deactivateTool(this.controllerTool.getName());this.panel&&(this.panel.setVisible(!1),this.panel=null);if(this.controlButton)try{a.modelTools.removeControl(this.controlButton),this.controlButton=null}catch(b){stderr("RemoteControlReceiver - Failed to remove controlButton"),this.controlButton=null}return!0};c.RemoteControl.prototype.addCrosshair=function(){this.crosshair=stringToDOM('<div id="remote-crosshair"><div class="crosshair-v"></div><div class="crosshair-h"></div></div>');
this.viewer.canvasWrap.appendChild(this.crosshair)};c.RemoteControl.prototype.removeCrosshair=function(){this.crosshair&&this.crosshair.remove()};c.RemoteControl.prototype.connect=function(a){if(this.client.isConnected())console.log("RemoteControl already connected");else{var b=this,c=this.viewer;b.client.addEventListener("connectSucceeded",function(c){function d(){m&&m.setVisible(!1);b.p2p.removeEventListener(d);b.addCrosshair()}stderr("connect succeeded");c=c.data.id+"rc";b.client.join(c);c=(LMV_RESOURCE_ROOT.length?
LMV_RESOURCE_ROOT:window.location.origin+"/")+"rc.html?sessionId="+c+"&env="+f.env;var k="http://chart.googleapis.com/chart?cht=qr&chs=200x200&choe=UTF-8&chld=H|0&chl="+escape(c),m=b.panel;m&&(m.link.href=c,m.link.innerHTML=(LMV_RESOURCE_ROOT.length?LMV_RESOURCE_ROOT:window.location.origin+"/")+"rc.html",m.qrImg.src=k,m.setVisible(!0));b.p2p.addEventListener("dataChannelAdded",d);a&&a instanceof Function&&a(c)});c.navigation.toPerspective();b.client.connect();c.toolController.activateTool(b.controllerTool.getName())}};
c.RemoteControl.prototype.disconnect=function(){this.p2p.hangup();this.client.disconnect();this.viewer.toolController.deactivateTool(this.controllerTool.getName());this.removeCrosshair()};b.theExtensionManager.registerExtension("Autodesk.Viewing.RemoteControl",c.RemoteControl)})();"use strict";AutodeskNamespace("Autodesk.Viewing.Extensions.Section");Autodesk.Viewing.Extensions.Section.SectionExtension=function(a,b){Autodesk.Viewing.Extension.call(this,a,b);this.viewer=a};
Autodesk.Viewing.Extensions.Section.SectionExtension.prototype=Object.create(Autodesk.Viewing.Extension.prototype);Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.constructor=Autodesk.Viewing.Extensions.Section.SectionExtension;
Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.load=function(){function a(){c.removeEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);b.createUI()}var b=this,c=this.viewer;this.tool=new Autodesk.Viewing.Extensions.Section.SectionTool(c);c.toolController.registerTool(this.tool);this.tool.setOutlineColor({r:1,g:0,b:0});var f=c.getToolbar?c.getToolbar(!0):void 0;f?(f=f.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID))&&0<f.getNumberOfControls()?a():c.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,
a):c.addEventListener(Autodesk.Viewing.TOOLBAR_CREATED_EVENT,a);c.addEventListener(Autodesk.Viewing.RESET_EVENT,function(){b.tool&&b.tool.resetSection()});this.HOTKEYS_ID="Autodesk.Section.Hotkeys";Autodesk.Viewing.theHotkeyManager.pushHotkeys(this.HOTKEYS_ID,[{keycodes:[Autodesk.Viewing.theHotkeyManager.KEYCODES.ESCAPE],onRelease:function(){return b.enableSectionTool(!1)}}]);return!0};
Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.enableSectionTool=function(a){if(this.tool){var b=this.viewer.toolController,c=this.tool.isActive();if(a&&!c)return b.activateTool("section"),this.sectionToolButton.setState(Autodesk.Viewing.UI.Button.State.ACTIVE),!0;if(!a&&c)return b.deactivateTool("section"),this.sectionToolButton.setState(Autodesk.Viewing.UI.Button.State.INACTIVE),!0}return!1};
Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.createUI=function(){var a=this.viewer;this.sectionToolButton=new Autodesk.Viewing.UI.ComboButton("toolbar-sectionTool");this.sectionToolButton.setToolTip("Section analysis");this.sectionToolButton.setIcon("adsk-icon-section-analysis");this.createSubmenu(this.sectionToolButton);var a=a.getToolbar(!1).getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID),b=a.getControl("toolbar-resetTool");b?a.addControl(this.sectionToolButton,{index:a.indexOf(b.getId())}):
a.addControl(this.sectionToolButton,{index:0})};
Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.createSubmenu=function(a){function b(a,b){return function(){var c=a.getState();c===g.Button.State.INACTIVE?(a.setState(g.Button.State.ACTIVE),f.enableSectionTool(!0),!1===this instanceof g.ComboButton?f.tool.setSection(b):f.tool.attachControl(!0)):c===g.Button.State.ACTIVE&&(a.setState(g.Button.State.INACTIVE),f.enableSectionTool(!1))}}function c(){var a=function(){var a=new THREE.Vector3;return function(b,c,d){a.subVectors(b,c);return a.lengthSq()<
d}}(),b=new THREE.Vector3(1,0,0),g=new THREE.Vector3(0,1,0),h=new THREE.Vector3(0,0,1),m=d.autocam.getWorldRightVector(),p=d.autocam.getWorldUpVector(),t=d.autocam.getWorldFrontVector();a(p,b,1E-4)?f.sectionYButton.setIcon("adsk-icon-plane-x"):a(p,h,1E-4)?f.sectionYButton.setIcon("adsk-icon-plane-z"):f.sectionYButton.setIcon("adsk-icon-plane-y");a(m,g,1E-4)?f.sectionXButton.setIcon("adsk-icon-plane-y"):a(m,h,1E-4)?f.sectionXButton.setIcon("adsk-icon-plane-z"):f.sectionXButton.setIcon("adsk-icon-plane-x");
a(t,b,1E-4)?f.sectionZButton.setIcon("adsk-icon-plane-x"):a(t,g,1E-4)?f.sectionZButton.setIcon("adsk-icon-plane-y"):f.sectionZButton.setIcon("adsk-icon-plane-z");d.removeEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)}var f=this,d=this.viewer,g=Autodesk.Viewing.UI,h=this.sectionXButton=new g.Button("toolbar-sectionTool-x");h.setToolTip("Add x plane");h.setIcon("adsk-icon-plane-x");h.onClick=b(h,"X");a.addControl(h);h=this.sectionYButton=new g.Button("toolbar-sectionTool-y");h.setToolTip("Add y plane");
h.setIcon("adsk-icon-plane-y");h.onClick=b(h,"Y");a.addControl(h);h=this.sectionZButton=new g.Button("toolbar-sectionTool-z");h.setToolTip("Add z plane");h.setIcon("adsk-icon-plane-z");h.onClick=b(h,"Z");a.addControl(h);h=this.sectionBoxButton=new g.Button("toolbar-sectionTool-box");h.setToolTip("Add box");h.setIcon("adsk-icon-box");h.onClick=b(h,"BOX");a.addControl(h);d.addEventListener(Autodesk.Viewing.GEOMETRY_LOADED_EVENT,c)};
Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.destroyUI=function(){var a=this.viewer.getToolbar(!1);if(a&&(a=a.getControl(Autodesk.Viewing.TOOLBAR.MODELTOOLSID))&&this.sectionToolButton){var b=a.getControl("toolbar-inspectSubMenu");b?b.removeControl(this.sectionToolButton.getId()):a.removeControl(this.sectionToolButton.getId());this.sectionToolButton=null}};
Autodesk.Viewing.Extensions.Section.SectionExtension.prototype.unload=function(){var a=this.viewer;Autodesk.Viewing.theHotkeyManager.popHotkeys(this.HOTKEYS_ID);a.setQualityLevel(this.ambientShadows,a.prefs.antialiasing);this.destroyUI();a.toolController.deregisterTool(this.tool);this.tool=null;return!0};Autodesk.Viewing.theExtensionManager.registerExtension("Autodesk.Section",Autodesk.Viewing.Extensions.Section.SectionExtension);AutodeskNamespace("Autodesk.Viewing.Extensions.Section");
Autodesk.Viewing.Extensions.Section.SectionTool=function(a,b){function c(){m.invalidate(!1,!1,!0)}function f(){w&&w.update();F&&F.update()}function d(a,b){b=b||m.getVisibleBounds();var c=new THREE.Vector3(0,0,1),c=(new THREE.Quaternion).setFromUnitVectors(c,a.normal),d=a.projectPoint(b.max),f=a.projectPoint(b.min),g=c.clone().inverse();d.applyQuaternion(g);f.applyQuaternion(g);d=(new THREE.Vector3).subVectors(d,f);d=new THREE.PlaneBufferGeometry(d.x,d.y);f=new THREE.MeshBasicMaterial({opacity:.1,
color:16777215,side:THREE.DoubleSide,depthTest:!1,depthWrite:!1,transparent:!0});d=new I.SectionMesh(d,f,a);f=a.projectPoint(b.center());d.position.copy(f);d.quaternion.multiply(c);return d}function g(){h(function(a){if(a instanceof I.SectionMesh&&0<a.connectivity.length){for(var b=(new THREE.Matrix4).getInverse(a.matrixWorld),c=new THREE.Vector3,d=a.geometry.getAttribute("position"),f=0;f<d.length/d.itemSize;f++){var g=a.connectivity[f];null!==J(a.plane,g[0],g[1],c)&&(c.applyMatrix4(b),d.setXYZ(f,
c.x,c.y,c.z))}d.needsUpdate=!0}})}function h(a){for(var b=0;b<B.length;b++)B[b].traverse(a)}function k(){h(function(a){a instanceof I.SectionMesh&&a.update()});m.setCutPlanes(z)}function l(a){for(var b=0;b<B.length;b++)B[b].visible=a;D=a;c()}function n(a,b){a.attach(b);a.setPosition(b.position)}function q(a){var b=new THREE.Group;a=new THREE.Plane(a,0);a=d(a);b.add(a);z.push(a.planeVec);B.push(b);m.addOverlay("gizmo",b);n(w,a);w.showRotationGizmos(!0);G=w.getPicker();k()}var m=a.impl,p=["section"],
t=!1,v=!1,D=!0,w,F,B=[],z=[],G=[],A="",E=null,H=!1,I=Autodesk.Viewing.Extensions.Section;init_TransformGizmos();init_SectionMesh();var J=function(){var a=new THREE.Matrix3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(f,g,h,k){a.set(f.normal.x,f.normal.y,f.normal.z,g.normal.x,g.normal.y,g.normal.z,h.normal.x,h.normal.y,h.normal.z);var l=a.determinant();if(0===l)return null;b.crossVectors(g.normal,h.normal).multiplyScalar(-f.constant);c.crossVectors(h.normal,f.normal).multiplyScalar(-g.constant);
d.crossVectors(f.normal,g.normal).multiplyScalar(-h.constant);return(k||new THREE.Vector3).copy(b).add(c).add(d).divideScalar(l)}}(),L=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Raycaster,d=m.camera;return function(f,g){var h=m.canvas.getBoundingClientRect(),k=(f.clientX-h.left)/h.width*2-1,h=2*-((f.clientY-h.top)/h.height)+1;d.isPerspective?(a.set(k,h,.5),a.unproject(d),c.set(d.position,a.sub(d.position).normalize())):(a.set(k,h,-1),a.unproject(d),b.set(0,0,-1),c.set(a,b.transformDirection(d.matrixWorld)));
k=c.intersectObjects(g,!0);return k[0]?k[0]:!1}}();this.isActive=function(){return t};this.setSection=function(a){this.clearSection();switch(a){case "X":var b=new THREE.Vector3(1,0,0);q(b);break;case "Y":b=new THREE.Vector3(0,1,0);q(b);break;case "Z":b=new THREE.Vector3(0,0,1);q(b);break;case "BOX":for(var c=[new THREE.Vector3(1,0,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1),new THREE.Vector3(-1,0,0),new THREE.Vector3(0,-1,0),new THREE.Vector3(0,0,-1)],b=[[[1,2],[1,5],[2,4],[4,5]],[[3,5],
[0,5],[2,3],[0,2]],[[1,3],[0,1],[3,4],[0,4]],[[1,5],[1,2],[4,5],[2,4]],[[2,3],[0,2],[3,5],[0,5]],[[0,1],[3,1],[0,4],[3,4]]],f=new THREE.Group,g=m.getVisibleBounds(),h=g.center(),g=new THREE.Box3(g.min,h),l=[],p=[],t=0;t<c.length;t++){var v=new THREE.Plane(c[t],-1*h.dot(c[t]));l.push(v);if(2<t){var E=v.orthoPoint(g.max),D=v.orthoPoint(g.min),E=(new THREE.Vector3).subVectors(E,D);v.constant-=E.length()}v=d(v,g);f.add(v);p.push(v);z.push(v.planeVec)}for(t=0;t<p.length;t++)for(v=p[t],c=b[t],h=0;h<c.length;h++){for(var E=
[],D=c[h],H=0;H<D.length;H++)E.push(l[D[H]]);v.connectivity.push(E)}B.push(f);m.addOverlay("gizmo",f);F.setSize(g.getBoundingSphere().radius/6);n(w,B[0].children[0]);n(F,B[0]);w.showRotationGizmos(!1);G=w.getPicker().concat(F.getPicker());k()}A=a};this.clearSection=function(){w&&w.detach();for(F&&F.detach();0<z.length;)z.pop();for(;0<B.length;){var a=B.pop();m.removeOverlay("gizmo",a)}m.setCutPlanes()};this.isPlaneOn=function(){return D};this.showPlane=function(a){l(a)};this.attachControl=function(a){a?
(n(w,B[0].children[0]),"BOX"===A&&n(F,B[0])):(w.detach(),F.detach())};this.setOutlineColor=function(a){m.setCutPlanesOutlineColor(a)};this.resetSection=function(){this.setSection(A)};this.getNames=function(){return p};this.getName=function(){return p[0]};this.register=function(){};this.deregister=function(){this.clearSection();H&&(m.removeOverlay("gizmo",w),w.removeEventListener("change",c),w=null,m.removeOverlay("gizmo",F),F.removeEventListener("change",c),F=null,m.removeOverlayScene("gizmo"),a.removeEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,
f),H=!1)};this.activate=function(b){H||(w=new THREE.TransformControls(m.camera,m.canvas,"transrotate"),w.addEventListener("change",c),w.setSnap(Math.PI/2,Math.PI/36),F=new THREE.TransformControls(m.camera,m.canvas,"translate"),F.addEventListener("change",c),void 0===m.overlayScenes.gizmo&&m.createOverlayScene("gizmo"),m.addOverlay("gizmo",w),m.addOverlay("gizmo",F),a.addEventListener(Autodesk.Viewing.CAMERA_CHANGE_EVENT,f),H=!0);t=!0;v=!1;z=z||[];0<z.length&&a.setCutPlanes(z);l(!0)};this.deactivate=
function(a){v=t=!1;l(!1);m.setCutPlanes();w.detach();F.detach()};this.update=function(){return!1};this.handleSingleClick=function(a,b){var d=L(a.pointers?a.pointers[0]:a,B);return d?(n(w,d.object),c(),!0):!1};this.handleDoubleClick=function(a,b){return!1};this.handleSingleTap=function(a){return this.handleSingleClick(a,0)};this.handleDoubleTap=function(a){return!1};this.handleKeyDown=function(a,b){return!1};this.handleKeyUp=function(a,b){return!1};this.handleWheelInput=function(a){return!1};this.handleButtonDown=
function(a,b){v=!0;return F.onPointerDown(a)?!0:w.onPointerDown(a)};this.handleButtonUp=function(a,b){v=!1;return F.onPointerUp(a)?!0:w.onPointerUp(a)};this.handleMouseMove=function(a){if(v){if(F.onPointerMove(a))return k(),w.update(),!0;if(w.onPointerMove(a))return k(),g(),!0}if("touch"!==a.pointerType){h(function(a){a instanceof I.SectionMesh&&(a.material.opacity=a.materialOpacity)});var b=a.pointers?a.pointers[0]:a,c=L(b,B);c&&(c.object.material.opacity=.2);b=c||L(b,G)?!0:!1;w.visible=b;F.visible=
void 0!==F.object&&b;l(b)}return F.onPointerHover(a)?!0:w.onPointerHover(a)};this.handleGesture=function(a){switch(a.type){case "dragstart":return E="drag",this.handleButtonDown(a,0);case "dragmove":return"drag"===E?this.handleMouseMove(a):!1;case "dragend":if("drag"===E)return E=null,this.handleButtonUp(a,0)}return!1};this.handleBlur=function(a){return!1};this.handleResize=function(){};this.handlePressHold=function(a){return!0}};
function init_SectionMesh(){Autodesk.Viewing.Extensions.Section.SectionMesh||(Autodesk.Viewing.Extensions.Section.SectionMesh=function(a,b,c){THREE.Mesh.call(this,a,b,!1);this.plane=c;this.planeVec=new THREE.Vector4(c.normal.x,c.normal.y,c.normal.z,c.constant);this.materialColor=this.material.color.clone();this.materialOpacity=this.material.opacity;this.connectivity=[]},Autodesk.Viewing.Extensions.Section.SectionMesh.prototype=Object.create(THREE.Mesh.prototype),Autodesk.Viewing.Extensions.Section.SectionMesh.prototype.constructor=
Autodesk.Viewing.Extensions.Section.SectionMesh,Autodesk.Viewing.Extensions.Section.SectionMesh.prototype.update=function(){this.plane.normal.set(0,0,1);this.plane.normal.applyQuaternion(this.quaternion);var a=this.plane.normal,b=-1*this.getWorldPosition().dot(a);this.planeVec.set(a.x,a.y,a.z,b);this.plane.constant=b})}
function init_TransformGizmos(){var a=function(a){THREE.MeshBasicMaterial.call(this);this.depthWrite=this.depthTest=!1;this.side=THREE.FrontSide;this.transparent=!0;this.setValues(a);this.oldColor=this.color.clone();this.oldOpacity=this.opacity;this.highlight=function(a){a?(this.color.setRGB(1,230/255,3/255),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};a.prototype=Object.create(THREE.MeshBasicMaterial.prototype);var b=function(a){THREE.LineBasicMaterial.call(this);
this.depthWrite=this.depthTest=!1;this.transparent=!0;this.linewidth=1;this.setValues(a);this.oldColor=this.color.clone();this.oldOpacity=this.opacity;this.highlight=function(a){a?(this.color.setRGB(1,230/255,3/255),this.opacity=1):(this.color.copy(this.oldColor),this.opacity=this.oldOpacity)}};b.prototype=Object.create(THREE.LineBasicMaterial.prototype);void 0===THREE.PolyhedronGeometry&&(THREE.PolyhedronGeometry=function(a,b,c,d){function f(a){var b=a.normalize().clone();b.index=t.vertices.push(b)-
1;var c=Math.atan2(a.z,-a.x)/2/Math.PI+.5;a=Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5;b.uv=new THREE.Vector2(c,1-a);return b}function q(a,b,c){var d=new THREE.Face3(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]);t.faces.push(d);A.copy(a).add(b).add(c).divideScalar(3);d=Math.atan2(A.z,-A.x);t.faceVertexUvs[0].push([p(a.uv,a,d),p(b.uv,b,d),p(c.uv,c,d)])}function m(a,b){var c=Math.pow(2,b);Math.pow(4,b);for(var d=f(t.vertices[a.a]),g=f(t.vertices[a.b]),h=f(t.vertices[a.c]),k=[],
l=0;l<=c;l++){k[l]=[];for(var m=f(d.clone().lerp(h,l/c)),p=f(g.clone().lerp(h,l/c)),v=c-l,B=0;B<=v;B++)k[l][B]=0==B&&l==c?m:f(m.clone().lerp(p,B/v))}for(l=0;l<c;l++)for(B=0;B<2*(c-l)-1;B++)d=Math.floor(B/2),0==B%2?q(k[l][d+1],k[l+1][d],k[l][d]):q(k[l][d+1],k[l+1][d+1],k[l+1][d])}function p(a,b,c){0>c&&1===a.x&&(a=new THREE.Vector2(a.x-1,a.y));0===b.x&&0===b.z&&(a=new THREE.Vector2(c/2/Math.PI+.5,a.y));return a.clone()}THREE.Geometry.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:a,
indices:b,radius:c,detail:d};c=c||1;d=d||0;for(var t=this,v=0,D=a.length;v<D;v+=3)f(new THREE.Vector3(a[v],a[v+1],a[v+2]));a=this.vertices;for(var w=[],F=v=0,D=b.length;v<D;v+=3,F++){var B=a[b[v]],z=a[b[v+1]],G=a[b[v+2]];w[F]=new THREE.Face3(B.index,z.index,G.index,[B.clone(),z.clone(),G.clone()])}for(var A=new THREE.Vector3,v=0,D=w.length;v<D;v++)m(w[v],d);v=0;for(D=this.faceVertexUvs[0].length;v<D;v++)b=this.faceVertexUvs[0][v],d=b[0].x,a=b[1].x,w=b[2].x,F=Math.max(d,Math.max(a,w)),B=Math.min(d,
Math.min(a,w)),.9<F&&.1>B&&(.2>d&&(b[0].x+=1),.2>a&&(b[1].x+=1),.2>w&&(b[2].x+=1));v=0;for(D=this.vertices.length;v<D;v++)this.vertices[v].multiplyScalar(c);this.mergeVertices();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)},THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype));void 0===THREE.OctahedronGeometry&&(THREE.OctahedronGeometry=function(a,b){this.parameters={radius:a,detail:b};THREE.PolyhedronGeometry.call(this,[1,0,0,-1,0,0,0,
1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b);this.type="OctahedronGeometry";this.parameters={radius:a,detail:b}},THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype));void 0===THREE.TorusGeometry&&(THREE.TorusGeometry=function(a,b,c,d,f){THREE.Geometry.call(this);this.type="TorusGeometry";this.parameters={radius:a,tube:b,radialSegments:c,tubularSegments:d,arc:f};a=a||100;b=b||40;c=c||8;d=d||6;f=f||2*Math.PI;for(var q=new THREE.Vector3,m=[],
p=[],t=0;t<=c;t++)for(var v=0;v<=d;v++){var D=v/d*f,w=t/c*Math.PI*2;q.x=a*Math.cos(D);q.y=a*Math.sin(D);var F=new THREE.Vector3;F.x=(a+b*Math.cos(w))*Math.cos(D);F.y=(a+b*Math.cos(w))*Math.sin(D);F.z=b*Math.sin(w);this.vertices.push(F);m.push(new THREE.Vector2(v/d,t/c));p.push(F.clone().sub(q).normalize())}for(t=1;t<=c;t++)for(v=1;v<=d;v++)a=(d+1)*t+v-1,b=(d+1)*(t-1)+v-1,f=(d+1)*(t-1)+v,q=(d+1)*t+v,D=new THREE.Face3(a,b,q,[p[a].clone(),p[b].clone(),p[q].clone()]),this.faces.push(D),this.faceVertexUvs[0].push([m[a].clone(),
m[b].clone(),m[q].clone()]),D=new THREE.Face3(b,f,q,[p[b].clone(),p[f].clone(),p[q].clone()]),this.faces.push(D),this.faceVertexUvs[0].push([m[b].clone(),m[f].clone(),m[q].clone()]);this.computeFaceNormals()},THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype));var c=function(a,b,c){var d=new THREE.Geometry;c=c?c:1;for(var f=0;f<=64*c;++f)"x"==b&&d.vertices.push((new THREE.Vector3(0,Math.cos(f/32*Math.PI),Math.sin(f/32*Math.PI))).multiplyScalar(a)),"y"==b&&d.vertices.push((new THREE.Vector3(Math.cos(f/
32*Math.PI),0,Math.sin(f/32*Math.PI))).multiplyScalar(a)),"z"==b&&d.vertices.push((new THREE.Vector3(Math.sin(f/32*Math.PI),Math.cos(f/32*Math.PI),0)).multiplyScalar(a));return d},f=function(a,b,c,d,f,q){var m=new THREE.Geometry;a=new THREE.Mesh(new THREE.CylinderGeometry(a,b,c,d,f,q));a.position.y=.5;a.updateMatrix();m.merge(a.geometry,a.matrix);return m},d=function(a){var b=new THREE.Geometry;"X"===a?b.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(1,0,0)):"Y"===a?b.vertices.push(new THREE.Vector3(0,
0,0),new THREE.Vector3(0,1,0)):"Z"===a&&b.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1));return b};THREE.TransformGizmo=function(){var a=this;this.init=function(){THREE.Object3D.call(this);this.handles=new THREE.Object3D;this.pickers=new THREE.Object3D;this.planes=new THREE.Object3D;this.highlights=new THREE.Object3D;this.hemiPicker=new THREE.Object3D;this.subPickers=new THREE.Object3D;this.add(this.handles);this.add(this.pickers);this.add(this.planes);this.add(this.highlights);
this.add(this.hemiPicker);this.add(this.subPickers);var a=new THREE.PlaneBufferGeometry(50,50,2,2),b=new THREE.MeshBasicMaterial({wireframe:!0});b.side=THREE.DoubleSide;a={XY:new THREE.Mesh(a,b),YZ:new THREE.Mesh(a,b),XZ:new THREE.Mesh(a,b),XYZE:new THREE.Mesh(a,b)};this.activePlane=a.XYZE;a.YZ.rotation.set(0,Math.PI/2,0);a.XZ.rotation.set(-Math.PI/2,0,0);for(var c in a)a[c].name=c,this.planes.add(a[c]),this.planes[c]=a[c],a[c].visible=!1;this.setupGizmos();this.activeMode="";this.traverse(function(a){if(a instanceof
THREE.Mesh){a.updateMatrix();var b=new THREE.Geometry;a.geometry instanceof THREE.BufferGeometry&&(a.geometry=(new THREE.Geometry).fromBufferGeometry(a.geometry));b.merge(a.geometry,a.matrix);a.geometry=b;a.position.set(0,0,0);a.rotation.set(0,0,0);a.scale.set(1,1,1)}})};this.hide=function(){this.traverse(function(a){a.visible=!1})};this.show=function(){this.traverse(function(b){b.visible=!0;if(b.parent==a.pickers||b.parent==a.hemiPicker)b.visible=!1;b.parent==a.planes&&(b.visible=!1)});this.activePlane.visible=
!1};this.highlight=function(a){this.traverse(function(b){b.material&&b.material.highlight&&(b.name==a?b.material.highlight(!0):b.material.highlight(!1))})};this.setupGizmos=function(){var a=function(a,b){for(var c in a)for(var d=a[c].length;d--;){var f=a[c][d][0],g=a[c][d][1],h=a[c][d][2],v=a[c][d][3];f.name=c;g&&f.position.set(g[0],g[1],g[2]);h&&f.rotation.set(h[0],h[1],h[2]);v&&(f.visble=v);b.add(f)}};this.setHandlePickerGizmos();a(this.handleGizmos,this.handles);a(this.pickerGizmos,this.pickers);
a(this.highlightGizmos,this.highlights);a(this.hemiPickerGizmos,this.hemiPicker);a(this.subPickerGizmos,this.subPickers);this.hide();this.show()}};THREE.TransformGizmo.prototype=Object.create(THREE.Object3D.prototype);THREE.TransformGizmo.prototype.update=function(a,b){var c=new THREE.Vector3(0,0,0),d=new THREE.Vector3(0,1,0),f=new THREE.Matrix4;this.traverse(function(q){q.name&&(-1!=q.name.search("E")?q.quaternion.setFromRotationMatrix(f.lookAt(b,c,d)):-1==q.name.search("X")&&-1==q.name.search("Y")&&
-1==q.name.search("Z")||q.quaternion.setFromEuler(a))})};THREE.TransformGizmoTranslate=function(){THREE.TransformGizmo.call(this);this.setHandlePickerGizmos=function(){var c=f(0,.05,.2,12,1,!1),h=d("X"),k=d("Y"),l=d("Z");this.handleGizmos={X:[[new THREE.Mesh(c,new a({color:15805484})),[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(h,new b({color:15805484}))]],Y:[[new THREE.Mesh(c,new a({color:768011})),[0,.5,0]],[new THREE.Line(k,new b({color:768011}))]],Z:[[new THREE.Mesh(c,new a({color:2895089})),[0,
0,.5],[Math.PI/2,0,0]],[new THREE.Line(l,new b({color:2895089}))]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.1,0),new a({color:16777215,opacity:.25})),[0,0,0],[0,0,0]]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new a({color:16776960,opacity:.25})),[.15,.15,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new a({color:65535,opacity:.25})),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.29,.29),new a({color:16711935,opacity:.25})),
[.15,0,.15],[-Math.PI/2,0,0]]]};this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:16711680,opacity:.25})),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:65280,opacity:.25})),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:255,opacity:.25})),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.OctahedronGeometry(.2,0),new a({color:16777215,opacity:.25}))]],XY:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,
.4),new a({color:16776960,opacity:.25})),[.2,.2,0]]],YZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new a({color:65535,opacity:.25})),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new THREE.Mesh(new THREE.PlaneBufferGeometry(.4,.4),new a({color:16711935,opacity:.25})),[.2,0,.2],[-Math.PI/2,0,0]]]};this.hemiPickerGizmos={XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(1.2,1.2,1.2),new a({color:255})),[.5,.5,.5],null,!1]]}};this.setActivePlane=function(a,b){var c=new THREE.Matrix4;b.applyMatrix4(c.getInverse(c.extractRotation(this.planes.XY.matrixWorld)));
"X"==a&&(this.activePlane=this.planes.XY,Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ));"Y"==a&&(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ));"Z"==a&&(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=this.planes.YZ));"XYZ"==a&&(this.activePlane=this.planes.XYZE);"XY"==a&&(this.activePlane=this.planes.XY);"YZ"==a&&(this.activePlane=this.planes.YZ);"XZ"==a&&(this.activePlane=this.planes.XZ);this.hide();
this.show()};this.init()};THREE.TransformGizmoTranslate.prototype=Object.create(THREE.TransformGizmo.prototype);THREE.TransformGizmoRotate=function(){THREE.TransformGizmo.call(this);this.setHandlePickerGizmos=function(){this.handleGizmos={RX:[[new THREE.Line(c(1,"x",.5),new b({color:16711680}))]],RY:[[new THREE.Line(c(1,"y",.5),new b({color:65280}))]],RZ:[[new THREE.Line(c(1,"z",.5),new b({color:255}))]],RE:[[new THREE.Line(c(1.25,"z",1),new b({color:65535}))]],RXYZE:[[new THREE.Line(c(1,"z",1),new b({color:16711935}))]]};
this.pickerGizmos={RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new a({color:16711680,opacity:.25})),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new a({color:65280,opacity:.25})),[0,0,0],[Math.PI/2,0,0]]],RZ:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,Math.PI),new a({color:255,opacity:.25})),[0,0,0],[0,0,-Math.PI/2]]],RE:[[new THREE.Mesh(new THREE.TorusGeometry(1.25,.12,2,24),new a({color:65535,opacity:.25}))]],RXYZE:[[new THREE.Mesh(new THREE.TorusGeometry(1,
.12,2,24),new a({color:16711935,opacity:.25}))]]}};this.setActivePlane=function(a){"RE"==a&&(this.activePlane=this.planes.XYZE);"RX"==a&&(this.activePlane=this.planes.YZ);"RY"==a&&(this.activePlane=this.planes.XZ);"RZ"==a&&(this.activePlane=this.planes.XY);this.hide();this.show()};this.update=function(a,b){THREE.TransformGizmo.prototype.update.apply(this,arguments);var c=new THREE.Matrix4,d=new THREE.Euler(0,0,1),f=new THREE.Quaternion,q=new THREE.Vector3(1,0,0),m=new THREE.Vector3(0,1,0),p=new THREE.Vector3(0,
0,1),t=new THREE.Quaternion,v=new THREE.Quaternion,D=new THREE.Quaternion,w=b.clone();d.copy(this.planes.XY.rotation);f.setFromEuler(d);c.makeRotationFromQuaternion(f).getInverse(c);w.applyMatrix4(c);this.traverse(function(a){f.setFromEuler(d);"RX"==a.name&&(t.setFromAxisAngle(q,Math.atan2(-w.y,w.z)),f.multiplyQuaternions(f,t),a.quaternion.copy(f));"RY"==a.name&&(v.setFromAxisAngle(m,Math.atan2(w.x,w.z)),f.multiplyQuaternions(f,v),a.quaternion.copy(f));"RZ"==a.name&&(D.setFromAxisAngle(p,Math.atan2(w.y,
w.x)),f.multiplyQuaternions(f,D),a.quaternion.copy(f))})};this.init()};THREE.TransformGizmoRotate.prototype=Object.create(THREE.TransformGizmo.prototype);THREE.TransformGizmoTranslateRotate=function(){THREE.TransformGizmo.call(this);var b=this;this.setHandlePickerGizmos=function(){var b=f(0,.05,.2,12,1,!1);(new THREE.Geometry).vertices.push(new THREE.Vector3(0,0,-.1),new THREE.Vector3(0,0,.1),new THREE.Vector3(-.1,0,0),new THREE.Vector3(.1,0,0));this.handleGizmos={Z:[[new THREE.Mesh(b,new a({color:16777215})),
[0,0,.25],[Math.PI/2,0,0]],[new THREE.Mesh(new THREE.CylinderGeometry(.015,.015,.6,4,1,!1),new a({color:16777215})),[0,0,.5],[Math.PI/2,0,0]]],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.015,12,60,.3*Math.PI),new a({color:16711680})),[0,0,0],[.15*Math.PI,-Math.PI/2,0]],[new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,.015,60,1,!1),new a({color:16711680})),[0,0,1],[Math.PI/2,0,0]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.015,12,60,.3*Math.PI),new a({color:255})),[0,0,0],[Math.PI/2,0,.35*
Math.PI]],[new THREE.Mesh(new THREE.CylinderGeometry(.05,.05,.01,60,1,!1),new a({color:255})),[0,0,1]]]};this.pickerGizmos={Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.12,.12,.65,4,1,!1),new a({color:255,opacity:.25})),[0,0,.5],[Math.PI/2,0,0]]],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,.3*Math.PI),new a({color:16711680,opacity:.25})),[0,0,0],[.15*Math.PI,-Math.PI/2,0]]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.12,4,12,.3*Math.PI),new a({color:255,opacity:.25})),[0,0,0],[Math.PI/
2,0,.35*Math.PI]]]};this.subPickerGizmos={Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.12,.12,.65,4,1,!1),new a({color:255,opacity:.25})),[0,0,.5],[Math.PI/2,0,0]]]};this.highlightGizmos={Z:[],RX:[[new THREE.Mesh(new THREE.TorusGeometry(1,.02,12,60,2*Math.PI),new a({color:16711680,opacity:1})),[0,0,0],[0,-Math.PI/2,-Math.PI/2],!1]],RY:[[new THREE.Mesh(new THREE.TorusGeometry(1,.02,12,60,2*Math.PI),new a({color:255,opacity:1})),[0,0,0],[Math.PI/2,0,0],!1]]};this.hemiPickerGizmos={XYZ:[[new THREE.Mesh(new THREE.SphereGeometry(1.2,
8,8,0,Math.PI),new a({color:255})),null,null,!1]]}};this.setActivePlane=function(a,b){if("translate"==this.activeMode){var c=new THREE.Matrix4;b.applyMatrix4(c.getInverse(c.extractRotation(this.planes.XY.matrixWorld)));"X"==a&&(this.activePlane=this.planes.XY,Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ));"Y"==a&&(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ));"Z"==a&&(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=
this.planes.YZ))}else"rotate"==this.activeMode&&("RX"==a&&(this.activePlane=this.planes.YZ),"RY"==a&&(this.activePlane=this.planes.XZ),"RZ"==a&&(this.activePlane=this.planes.XY));this.hide();this.show()};this.update=function(a,b){if("translate"==this.activeMode)THREE.TransformGizmo.prototype.update.apply(this,arguments);else if("rotate"==this.activeMode){THREE.TransformGizmo.prototype.update.apply(this,arguments);var c=new THREE.Matrix4,d=new THREE.Euler(0,0,1),f=new THREE.Quaternion,g=new THREE.Vector3(1,
0,0),p=new THREE.Vector3(0,1,0),t=new THREE.Vector3(0,0,1),v=new THREE.Quaternion,D=new THREE.Quaternion,w=new THREE.Quaternion,F=b.clone();d.copy(this.planes.XY.rotation);f.setFromEuler(d);c.makeRotationFromQuaternion(f).getInverse(c);F.applyMatrix4(c);this.traverse(function(a){f.setFromEuler(d);"RX"==a.name&&(v.setFromAxisAngle(g,Math.atan2(-F.y,F.z)),f.multiplyQuaternions(f,v),a.quaternion.copy(f));"RY"==a.name&&(D.setFromAxisAngle(p,Math.atan2(F.x,F.z)),f.multiplyQuaternions(f,D),a.quaternion.copy(f));
"RZ"==a.name&&(w.setFromAxisAngle(t,Math.atan2(F.y,F.x)),f.multiplyQuaternions(f,w),a.quaternion.copy(f))})}};this.show=function(){this.traverse(function(a){if(null==b.parent||b.parent.useAllPickers||a.parent!=b.handles)a.visible=!0;a.material&&(a.material.opacity=a.material.oldOpacity);if(a.parent==b.pickers||a.parent==b.hemiPicker||a.parent==b.subPickers)a.visible=!1;if(a.parent==b.planes||a.parent==b.highlights)a.visible=!1});this.activePlane.visible=!1};this.highlight=function(a){this.traverse(function(c){if(c.material&&
c.material.highlight)if(c.name==a){if(c.parent==b.highlights||c.parent==b.handles)c.visible=!0;c.material.highlight(!0)}else c.material.highlight(!1),c.material.opacity=.1})};this.init()};THREE.TransformGizmoTranslateRotate.prototype=Object.create(THREE.TransformGizmo.prototype);THREE.TransformGizmoScale=function(){THREE.TransformGizmo.call(this);this.setHandlePickerGizmos=function(){var c=f(.125,.125,.125),h=d("X"),k=d("Y"),l=d("Z");this.handleGizmos={X:[[new THREE.Mesh(c,new a({color:16711680})),
[.5,0,0],[0,0,-Math.PI/2]],[new THREE.Line(h,new b({color:16711680}))]],Y:[[new THREE.Mesh(c,new a({color:65280})),[0,.5,0]],[new THREE.Line(k,new b({color:65280}))]],Z:[[new THREE.Mesh(c,new a({color:255})),[0,0,.5],[Math.PI/2,0,0]],[new THREE.Line(l,new b({color:255}))]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.125,.125,.125),new a({color:16777215,opacity:.25}))]]};this.pickerGizmos={X:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:16711680,opacity:.25})),[.6,0,0],[0,
0,-Math.PI/2]]],Y:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:65280,opacity:.25})),[0,.6,0]]],Z:[[new THREE.Mesh(new THREE.CylinderGeometry(.2,0,1,4,1,!1),new a({color:255,opacity:.25})),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new THREE.Mesh(new THREE.BoxGeometry(.4,.4,.4),new a({color:16777215,opacity:.25}))]]}};this.setActivePlane=function(a,b){var c=new THREE.Matrix4;b.applyMatrix4(c.getInverse(c.extractRotation(this.planes.XY.matrixWorld)));"X"==a&&(this.activePlane=this.planes.XY,
Math.abs(b.y)>Math.abs(b.z)&&(this.activePlane=this.planes.XZ));"Y"==a&&(this.activePlane=this.planes.XY,Math.abs(b.x)>Math.abs(b.z)&&(this.activePlane=this.planes.YZ));"Z"==a&&(this.activePlane=this.planes.XZ,Math.abs(b.x)>Math.abs(b.y)&&(this.activePlane=this.planes.YZ));"XYZ"==a&&(this.activePlane=this.planes.XYZE);this.hide();this.show()};this.init()};THREE.TransformGizmoScale.prototype=Object.create(THREE.TransformGizmo.prototype);THREE.TransformControls=function(a,b,c){function d(c,f){var k=
b.getBoundingClientRect(),l=(c.clientX-k.left)/k.width*2-1,k=2*-((c.clientY-k.top)/k.height)+1;a.isPerspective?(z.set(l,k,.5),z.unproject(a),B.set(a.position,z.sub(a.position).normalize())):(z.set(l,k,-1),z.unproject(a),G.set(0,0,-1),B.set(z,G.transformDirection(a.matrixWorld)));l=B.intersectObjects(f,!0);return l[0]?l[0]:!1}THREE.Object3D.call(this);b=void 0!==b?b:document;this.gizmo={};switch(c){case "translate":this.gizmo[c]=new THREE.TransformGizmoTranslate;break;case "rotate":this.gizmo[c]=new THREE.TransformGizmoRotate;
break;case "transrotate":this.gizmo[c]=new THREE.TransformGizmoTranslateRotate;break;case "scale":this.gizmo[c]=new THREE.TransformGizmoScale}this.add(this.gizmo[c]);this.gizmo[c].hide();this.object=void 0;this.snap=null;this.snapDelta=0;this.space="world";this.size=1;this.axis=null;this.useAllPickers=!0;this.unitX=new THREE.Vector3(1,0,0);this.unitY=new THREE.Vector3(0,1,0);this.unitZ=new THREE.Vector3(0,0,1);this.normal=new THREE.Vector3(0,0,1);if("transrotate"===c){var f=new THREE.Geometry;f.vertices.push(new THREE.Vector3(0,
0,0),new THREE.Vector3(0,0,1));var q=new THREE.LineBasicMaterial({color:0,linewidth:2,depthTest:!1});this.startLine=new THREE.Line(f,q);f=new THREE.Geometry;q=new THREE.LineBasicMaterial({color:16770563,linewidth:2,depthTest:!1});f.vertices.push(new THREE.Vector3(0,0,0),new THREE.Vector3(0,0,1));this.endLine=new THREE.Line(f,q);f=new THREE.Geometry;q=new THREE.LineDashedMaterial({color:0,linewidth:1,depthTest:!1});f.vertices.push(new THREE.Vector3(0,-1,0),new THREE.Vector3(0,1,0));this.centerLine=
new THREE.Line(f,q);q=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/textures/centerMarker_X.png"));q.magFilter=q.minFilter=THREE.NearestFilter;f=new THREE.CircleGeometry(.1,32);q=new THREE.MeshBasicMaterial({opacity:1,side:THREE.DoubleSide,transparent:!0,map:q});this.centerMark=new THREE.Mesh(f,q);this.centerMark.rotation.set(Math.PI/2,0,0);this.ticks={};q=THREE.ImageUtils.loadTexture(Autodesk.Viewing.Private.getResourceUrl("res/textures/cardinalPoint.png"));q.magFilter=
q.minFilter=THREE.NearestFilter;q=new THREE.MeshBasicMaterial({depthTest:!1,opacity:1,transparent:!0,side:THREE.DoubleSide,map:q});this.ticks.RX=new THREE.Object3D;f=new THREE.PlaneBufferGeometry(.12,.25);f=new THREE.Mesh(f,q);f.position.set(0,0,-1.275);f.rotation.set(Math.PI/2,Math.PI/2,0);this.ticks.RX.add(f);f=f.clone();f.position.set(0,1.275,0);f.rotation.set(0,Math.PI/2,0);this.ticks.RX.add(f);f=f.clone();f.position.set(0,0,1.275);f.rotation.set(0,Math.PI/2,Math.PI/2);this.ticks.RX.add(f);f=
f.clone();f.position.set(0,-1.275,0);f.rotation.set(0,Math.PI/2,0);this.ticks.RX.add(f);this.ticks.RY=new THREE.Object3D;f=f.clone();f.position.set(0,0,-1.275);f.rotation.set(Math.PI/2,0,0);this.ticks.RY.add(f);f=f.clone();f.position.set(-1.275,0,0);f.rotation.set(Math.PI/2,0,Math.PI/2);this.ticks.RY.add(f);f=f.clone();f.position.set(0,0,1.275);f.rotation.set(Math.PI/2,0,0);this.ticks.RY.add(f);f=f.clone();f.position.set(1.275,0,0);f.rotation.set(Math.PI/2,0,Math.PI/2);this.ticks.RY.add(f)}var m=
this,p=!1,t=c,v={type:"change"},D={type:"mouseDown"},w={type:"mouseUp",mode:t},F={type:"objectChange"},B=new THREE.Raycaster,z=new THREE.Vector3,G=new THREE.Vector3,A=new THREE.Vector3,E=new THREE.Vector3,H=new THREE.Vector3,I=new THREE.Vector3,J=1,L=new THREE.Matrix4,C=new THREE.Vector3,N=new THREE.Matrix4,K=new THREE.Vector3,R=new THREE.Quaternion,T=new THREE.Vector3,ba=new THREE.Vector3,X=new THREE.Vector3,Y=new THREE.Quaternion,W=new THREE.Quaternion,U=new THREE.Quaternion,O=new THREE.Quaternion,
da=new THREE.Quaternion,V=new THREE.Vector3,M=new THREE.Vector3,la=new THREE.Matrix4,ga=new THREE.Matrix4,ja=new THREE.Vector3,Z=new THREE.Vector3,ea=new THREE.Euler,ca=new THREE.Matrix4,Q=new THREE.Vector3;new THREE.Euler;this.attach=function(a){m.object=a;this.gizmo[t].show();m.update();m.updateUnitVectors()};this.detach=function(a){m.object=void 0;this.axis=null;this.gizmo[t].hide()};this.setMode=function(a){t=a?a:t;"scale"==t&&(m.space="local");this.gizmo[t].show();this.update();m.dispatchEvent(v)};
this.getPicker=function(){return m.gizmo[t].hemiPicker.children};this.setPosition=function(a){this.object.position.copy(a);this.update()};this.setNormal=function(a){R.setFromUnitVectors(this.normal,a);this.unitX.applyQuaternion(R);this.unitY.applyQuaternion(R);this.unitZ.applyQuaternion(R);this.normal.copy(a);this.object&&this.object.quaternion.multiply(R);this.update()};this.setSnap=function(a,b){m.snap=a;m.snapDelta=b};this.setSize=function(a){m.size=a;this.update();m.dispatchEvent(v)};this.setSpace=
function(a){m.space=a;this.update();m.dispatchEvent(v)};this.update=function(c){if(void 0!==m.object){m.object.updateMatrixWorld();Z.setFromMatrixPosition(m.object.matrixWorld);ea.setFromRotationMatrix(N.extractRotation(m.object.matrixWorld));a.updateMatrixWorld();Q.setFromMatrixPosition(a.matrixWorld);this.position.copy(Z);this.quaternion.setFromEuler(ea);this.normal.set(0,0,1);this.normal.applyEuler(ea);var d=Z.distanceTo(Q),d=2*Math.tan(a.fov*Math.PI/180/2)*d,f=b.getBoundingClientRect();J=100*
d/f.height;this.scale.set(J,J,J);c&&this.gizmo[t].highlight(m.axis)}};this.updateUnitVectors=function(){this.unitX.set(1,0,0);this.unitY.set(0,1,0);this.unitZ.set(0,0,1);this.unitX.applyEuler(ea);this.unitY.applyEuler(ea);this.unitZ.applyEuler(ea)};this.showRotationGizmos=function(a){for(var b=this.gizmo[t].handles.children,c=0;c<b.length;c++){var d=b[c];d.visible=!0;-1!==d.name.search("R")&&(d.visible=a)}this.useAllPickers=a};this.onPointerHover=function(a){if(void 0===m.object||!0===p)return!1;
a=d(a.pointers?a.pointers[0]:a,m.useAllPickers?m.gizmo[t].pickers.children:m.gizmo[t].subPickers.children);var b=null,c="";a&&(b=a.object.name,c=-1!=b.search("R")?"rotate":"translate");m.axis!==b&&(m.axis=b,m.gizmo[t].activeMode=c,m.update(!0),m.dispatchEvent(v));null===m.axis&&m.gizmo[t].show();return a?!0:!1};this.onPointerDown=function(b){if(void 0===m.object||!0===p)return!1;var c=b.pointers?b.pointers[0]:b;if("touch"===b.pointerType){b=d(c,m.useAllPickers?m.gizmo[t].pickers.children:m.gizmo[t].subPickers.children);
var f=null,h="";b&&(f=b.object.name,h=-1!=f.search("R")?"rotate":"translate");m.axis!==f&&(m.axis=f,m.gizmo[t].activeMode=h)}b=null;if(0===c.button||void 0===c.button)if(b=d(c,m.useAllPickers?m.gizmo[t].pickers.children:m.gizmo[t].subPickers.children))if(m.dispatchEvent(D),m.axis=b.object.name,m.update(),C.copy(a.position).sub(Z).normalize(),m.gizmo[t].setActivePlane(m.axis,C),(c=d(c,[m.gizmo[t].activePlane]))&&E.copy(c.point),V.copy(m.object.position),M.copy(m.object.scale),la.extractRotation(m.object.matrix),
ca.extractRotation(m.object.matrixWorld),m.object.parent?(ga.extractRotation(m.object.parent.matrixWorld),ja.setFromMatrixScale(N.getInverse(m.object.parent.matrixWorld))):(ga.extractRotation(m.object.matrixWorld),ja.setFromMatrixScale(N.getInverse(m.object.matrixWorld))),"transrotate"===t&&"rotate"===m.gizmo[t].activeMode){m.startLine.geometry.vertices[0].set(0,0,0).applyMatrix4(m.matrixWorld);m.startLine.geometry.vertices[1].set(0,0,1).applyMatrix4(m.matrixWorld);m.startLine.geometry.verticesNeedUpdate=
!0;m.parent.add(m.startLine);var k=m.object.geometry.getAttribute("position"),c=(new THREE.Vector3).fromAttribute(k,0).applyMatrix4(m.object.matrixWorld),f=(new THREE.Vector3).fromAttribute(k,1).applyMatrix4(m.object.matrixWorld),h=(new THREE.Vector3).fromAttribute(k,2).applyMatrix4(m.object.matrixWorld),k=(new THREE.Vector3).fromAttribute(k,3).applyMatrix4(m.object.matrixWorld);"RX"===m.axis?(c.lerp(h,.5),f.lerp(k,.5),k=c.distanceTo(f),m.centerLine.material.dashSize=k/15,m.centerLine.material.gapSize=
k/30,m.centerLine.geometry.vertices[0].copy(c),m.centerLine.geometry.vertices[1].copy(f)):(c.lerp(f,.5),h.lerp(k,.5),k=c.distanceTo(h),m.centerLine.material.dashSize=k/15,m.centerLine.material.gapSize=k/30,m.centerLine.geometry.vertices[0].copy(c),m.centerLine.geometry.vertices[1].copy(h));m.centerLine.geometry.computeLineDistances();m.centerLine.geometry.verticesNeedUpdate=!0;m.parent.add(m.centerLine);m.ticks[m.axis].position.copy(m.position);m.ticks[m.axis].quaternion.copy(m.quaternion);m.ticks[m.axis].scale.copy(m.scale);
m.parent.add(m.ticks[m.axis])}p=!0;return b?!0:!1};this.onPointerMove=function(a){if(void 0===m.object||null===m.axis||!1===p)return!1;(a=d(a.pointers?a.pointers[0]:a,[m.gizmo[t].activePlane]))&&A.copy(a.point);var b=m.gizmo[t].activeMode;if("translate"==b){if(A.sub(E),A.multiply(ja),"local"==m.space&&(A.applyMatrix4(N.getInverse(ca)),T.copy(this.unitX),ba.copy(this.unitY),X.copy(this.unitZ),K.set(0,0,0),-1!=m.axis.search("X")&&(T.multiplyScalar(A.dot(this.unitX)),K.add(T)),-1!=m.axis.search("Y")&&
(ba.multiplyScalar(A.dot(this.unitY)),K.add(ba)),-1!=m.axis.search("Z")&&(X.multiplyScalar(A.dot(this.unitZ)),K.add(X)),A.copy(K),A.applyMatrix4(la),m.object.position.copy(V),m.object.position.add(A)),"world"==m.space||-1!=m.axis.search("XYZ"))T.copy(this.unitX),ba.copy(this.unitY),X.copy(this.unitZ),K.set(0,0,0),-1!=m.axis.search("X")&&(T.multiplyScalar(A.dot(this.unitX)),K.add(T)),-1!=m.axis.search("Y")&&(ba.multiplyScalar(A.dot(this.unitY)),K.add(ba)),-1!=m.axis.search("Z")&&(X.multiplyScalar(A.dot(this.unitZ)),
K.add(X)),A.copy(K),A.applyMatrix4(N.getInverse(ga)),m.object.position.copy(V),m.object.position.add(A)}else if("scale"==b)A.sub(E),A.multiply(ja),"local"==m.space&&("XYZ"==m.axis?(J=1+A.y/50,m.object.scale.x=M.x*J,m.object.scale.y=M.y*J,m.object.scale.z=M.z*J):(A.applyMatrix4(N.getInverse(ca)),"X"==m.axis&&(m.object.scale.x=M.x*(1+A.x/50)),"Y"==m.axis&&(m.object.scale.y=M.y*(1+A.y/50)),"Z"==m.axis&&(m.object.scale.z=M.z*(1+A.z/50))));else if("rotate"==b){A.sub(Z);A.multiply(ja);K.copy(E).sub(Z);
K.multiply(ja);if("RE"==m.axis){A.applyMatrix4(N.getInverse(L));K.applyMatrix4(N.getInverse(L));H.set(Math.atan2(A.z,A.y),Math.atan2(A.x,A.z),Math.atan2(A.y,A.x));I.set(Math.atan2(K.z,K.y),Math.atan2(K.x,K.z),Math.atan2(K.y,K.x));R.setFromRotationMatrix(N.getInverse(ga));var c=H.z-I.z;null!==m.snap&&(b=Math.round(c/m.snap)*m.snap,Math.abs(b-c)<m.snapDelta&&(c=b));da.setFromAxisAngle(C,c);Y.setFromRotationMatrix(ca);R.multiplyQuaternions(R,da);R.multiplyQuaternions(R,Y);m.object.quaternion.copy(R)}else if("RXYZE"==
m.axis){c=A.clone().cross(K).normalize();R.setFromRotationMatrix(N.getInverse(ga));var f=-A.clone().angleTo(K);null!==m.snap&&(b=Math.round(f/m.snap)*m.snap,Math.abs(b-f)<m.snapDelta&&(f=b));W.setFromAxisAngle(c,f);Y.setFromRotationMatrix(ca);R.multiplyQuaternions(R,W);R.multiplyQuaternions(R,Y);m.object.quaternion.copy(R)}else if("local"==m.space){A.applyMatrix4(N.getInverse(ca));K.applyMatrix4(N.getInverse(ca));var b=A.dot(this.unitX),c=A.dot(this.unitY),f=A.dot(this.unitZ),g=K.dot(this.unitX),
h=K.dot(this.unitY),k=K.dot(this.unitZ);H.set(Math.atan2(f,c),Math.atan2(b,f),Math.atan2(c,b));I.set(Math.atan2(k,h),Math.atan2(g,k),Math.atan2(h,g));f=H.x-I.x;g=H.y-I.y;c=H.z-I.z;null!==m.snap&&(-1!=m.axis.search("X")&&(b=Math.round(f/m.snap)*m.snap,Math.abs(b-f)<m.snapDelta&&(f=b)),-1!=m.axis.search("Y")&&(b=Math.round(g/m.snap)*m.snap,Math.abs(b-g)<m.snapDelta&&(g=b)),-1!=m.axis.search("Z")&&(b=Math.round(c/m.snap)*m.snap,Math.abs(b-c)<m.snapDelta&&(c=b)));W.setFromAxisAngle(this.unitX,f);U.setFromAxisAngle(this.unitY,
g);O.setFromAxisAngle(this.unitZ,c);Y.setFromRotationMatrix(la);"RX"==m.axis&&Y.multiplyQuaternions(Y,W);"RY"==m.axis&&Y.multiplyQuaternions(Y,U);"RZ"==m.axis&&Y.multiplyQuaternions(Y,O);m.object.quaternion.copy(Y)}else"world"==m.space&&(b=A.dot(this.unitX),c=A.dot(this.unitY),f=A.dot(this.unitZ),g=K.dot(this.unitX),h=K.dot(this.unitY),k=K.dot(this.unitZ),H.set(Math.atan2(f,c),Math.atan2(b,f),Math.atan2(c,b)),I.set(Math.atan2(k,h),Math.atan2(g,k),Math.atan2(h,g)),R.setFromRotationMatrix(N.getInverse(ga)),
f=H.x-I.x,g=H.y-I.y,c=H.z-I.z,null!==m.snap&&(-1!=m.axis.search("X")&&(b=Math.round(f/m.snap)*m.snap,Math.abs(b-f)<m.snapDelta&&(f=b)),-1!=m.axis.search("Y")&&(b=Math.round(g/m.snap)*m.snap,Math.abs(b-g)<m.snapDelta&&(g=b)),-1!=m.axis.search("Z")&&(b=Math.round(c/m.snap)*m.snap,Math.abs(b-c)<m.snapDelta&&(c=b))),W.setFromAxisAngle(this.unitX,f),U.setFromAxisAngle(this.unitY,g),O.setFromAxisAngle(this.unitZ,c),Y.setFromRotationMatrix(ca),"RX"==m.axis&&R.multiplyQuaternions(R,W),"RY"==m.axis&&R.multiplyQuaternions(R,
U),"RZ"==m.axis&&R.multiplyQuaternions(R,O),R.multiplyQuaternions(R,Y),m.object.quaternion.copy(R));"transrotate"===t&&(m.add(m.endLine),m.add(m.centerMark))}m.object.matrixAutoUpdate=!0;m.update(!0);m.dispatchEvent(v);m.dispatchEvent(F);return a?!0:!1};this.onPointerUp=function(a){p&&null!==m.axis&&(w.mode=t,m.dispatchEvent(w));p=!1;this.gizmo[t].show();this.updateUnitVectors();"transrotate"===t&&"rotate"===this.gizmo[t].activeMode&&(this.remove(this.endLine),this.remove(this.centerMark),this.parent.remove(this.centerLine),
this.parent.remove(this.startLine),this.parent.remove(this.ticks[this.axis]));return!1}};THREE.TransformControls.prototype=Object.create(THREE.Object3D.prototype)}
(function(a,b){var c=a.document;"undefined"===typeof a.alertify&&(a.alertify=new function(){var f={},d=!1,g=[],h,k,l,n,q,m,p,t,v,D,w,F;F=function(){var a,d,f=!1,g=c.createElement("fakeelement"),h={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend",transition:"transitionend"};for(a in h)if(g.style[a]!==b){d=h[a];f=!0;break}return{type:d,supported:f}};h=function(a){return c.getElementById(a)};f={labels:{ok:"OK",cancel:"Cancel"},delay:5E3,buttonReverse:!1,
buttonFocus:"ok",transition:b,addListeners:function(a){var b="undefined"!==typeof l,d="undefined"!==typeof k,f="undefined"!==typeof w,g="",h=this,m,p,t,v,D;m=function(b){"undefined"!==typeof b.preventDefault&&b.preventDefault();t(b);"undefined"!==typeof w&&(g=w.value);"function"===typeof a&&("undefined"!==typeof w?a(!0,g):a(!0));return!1};p=function(b){"undefined"!==typeof b.preventDefault&&b.preventDefault();t(b);"function"===typeof a&&a(!1);return!1};t=function(a){h.hide();h.unbind(c.body,"keyup",
v);h.unbind(n,"focus",D);b&&h.unbind(l,"click",m);d&&h.unbind(k,"click",p)};v=function(a){var b=a.keyCode;(32===b&&!f||f&&13===b)&&m(a);27===b&&d&&p(a)};D=function(a){f?w.focus():!d||h.buttonReverse?l.focus():k.focus()};this.bind(n,"focus",D);this.bind(q,"focus",D);b&&this.bind(l,"click",m);d&&this.bind(k,"click",p);this.bind(c.body,"keyup",v);this.transition.supported||this.setFocus()},bind:function(a,b,c){"function"===typeof a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+
b,c)},handleErrors:function(){if("undefined"!==typeof a.onerror){var b=this;a.onerror=function(a,c,d){b.error("["+a+" on line "+d+" of "+c+"]",0)};return!0}return!1},appendButtons:function(a,b){return this.buttonReverse?b+a:a+b},build:function(a){var b=a.type,c=a.message,d=a.cssClass||"";a='<div class="alertify-dialog"><a id="alertify-resetFocusBack" class="alertify-resetFocus" href="#">Reset Focus</a>';"none"===f.buttonFocus&&(a+='<a href="#" id="alertify-noneFocus" class="alertify-hidden"></a>');
"prompt"===b&&(a+='<div id="alertify-form">');a+='<article class="alertify-inner">';a+='<p class="alertify-message">{{message}}</p>'.replace("{{message}}",c);"prompt"===b&&(a+='<div class="alertify-text-wrapper"><input type="text" class="alertify-text" id="alertify-text"></div>');a+='<nav class="alertify-buttons">{{buttons}}</nav>';a+="</article>";"prompt"===b&&(a+="</div>");a+='<a id="alertify-resetFocus" class="alertify-resetFocus" href="#">Reset Focus</a>';a+="</div>";switch(b){case "confirm":a=
a.replace("{{buttons}}",this.appendButtons('<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</button>','<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>'));a=a.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case "prompt":a=a.replace("{{buttons}}",this.appendButtons('<button class="alertify-button alertify-button-cancel" id="alertify-cancel">{{cancel}}</button>','<button type="submit" class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>'));
a=a.replace("{{ok}}",this.labels.ok).replace("{{cancel}}",this.labels.cancel);break;case "alert":a=a.replace("{{buttons}}",'<button class="alertify-button alertify-button-ok" id="alertify-ok">{{ok}}</button>'),a=a.replace("{{ok}}",this.labels.ok)}v.className="alertify alertify-"+b+" "+d;t.className="alertify-cover";return a},close:function(a,b){var c=b&&!isNaN(b)?+b:this.delay,d=this,f,g;this.bind(a,"click",function(){f(a)});g=function(a){a.stopPropagation();d.unbind(this,d.transition.type,g);D.removeChild(this);
D.hasChildNodes()||(D.className+=" alertify-logs-hidden")};f=function(a){"undefined"!==typeof a&&a.parentNode===D&&(d.transition.supported?(d.bind(a,d.transition.type,g),a.className+=" alertify-log-hide"):(D.removeChild(a),D.hasChildNodes()||(D.className+=" alertify-logs-hidden")))};0!==b&&setTimeout(function(){f(a)},c)},dialog:function(a,b,f,h,k){p=c.activeElement;var l=function(){D&&null!==D.scrollTop&&t&&null!==t.scrollTop||l()};if("string"!==typeof a)throw Error("message must be a string");if("string"!==
typeof b)throw Error("type must be a string");if("undefined"!==typeof f&&"function"!==typeof f)throw Error("fn must be a function");this.init();l();g.push({type:b,message:a,callback:f,placeholder:h,cssClass:k});d||this.setup();return this},extend:function(a){if("string"!==typeof a)throw Error("extend method must have exactly one paramter");return function(b,c){this.log(b,a,c);return this}},hide:function(){var a,b=this;g.splice(0,1);0<g.length?this.setup(!0):(d=!1,a=function(c){c.stopPropagation();
b.unbind(v,b.transition.type,a)},this.transition.supported?(this.bind(v,this.transition.type,a),v.className="alertify alertify-hide alertify-hidden"):v.className="alertify alertify-hide alertify-hidden alertify-isHidden",t.className="alertify-cover alertify-cover-hidden",p.focus())},init:function(){c.createElement("nav");c.createElement("article");c.createElement("section");null==h("alertify-cover")&&(t=c.createElement("div"),t.setAttribute("id","alertify-cover"),t.className="alertify-cover alertify-cover-hidden",
c.body.appendChild(t));null==h("alertify")&&(d=!1,g=[],v=c.createElement("section"),v.setAttribute("id","alertify"),v.setAttribute("style","z-index : 999999999"),v.className="alertify alertify-hidden",c.body.appendChild(v));null==h("alertify-logs")&&(D=c.createElement("section"),D.setAttribute("id","alertify-logs"),D.className="alertify-logs alertify-logs-hidden",c.body.appendChild(D));c.body.setAttribute("tabindex","0");this.transition=F()},log:function(a,b,c){var d=function(){D&&null!==D.scrollTop||
d()};this.init();d();D.className="alertify-logs";this.notify(a,b,c);return this},notify:function(a,b,d){var f=c.createElement("article");f.className="alertify-log"+("string"===typeof b&&""!==b?" alertify-log-"+b:"");f.innerHTML=a;D.appendChild(f);setTimeout(function(){f.className+=" alertify-log-show"},50);this.close(f,d)},set:function(a){var b;if("object"!==typeof a&&a instanceof Array)throw Error("args must be an object");for(b in a)a.hasOwnProperty(b)&&(this[b]=a[b])},setFocus:function(){w?(w.focus(),
w.select()):m.focus()},setup:function(a){var c=g[0],p=this,t;d=!0;t=function(a){a.stopPropagation();p.setFocus();p.unbind(v,p.transition.type,t)};this.transition.supported&&!a&&this.bind(v,this.transition.type,t);v.innerHTML=this.build(c);n=h("alertify-resetFocus");q=h("alertify-resetFocusBack");l=h("alertify-ok")||b;k=h("alertify-cancel")||b;m="cancel"===f.buttonFocus?k:"none"===f.buttonFocus?h("alertify-noneFocus"):l;w=h("alertify-text")||b;h("alertify-form");"string"===typeof c.placeholder&&""!==
c.placeholder&&(w.value=c.placeholder);a&&this.setFocus();this.addListeners(c.callback)},unbind:function(a,b,c){"function"===typeof a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)}};return{alert:function(a,b,c){f.dialog(a,"alert",b,"",c);return this},confirm:function(a,b,c){f.dialog(a,"confirm",b,"",c);return this},extend:f.extend,init:f.init,log:function(a,b,c){f.log(a,b,c);return this},prompt:function(a,b,c,d){f.dialog(a,"prompt",b,c,d);return this},success:function(a,
b){f.log(a,"success",b);return this},error:function(a,b){f.log(a,"error",b);return this},set:function(a){f.set(a)},hide:function(a){f.hide(a)},labels:f.labels,debug:f.handleErrors}})})(this);AutodeskNamespace("Autodesk.Viewing");AutodeskNamespace("Autodesk.Viewing.Private");var auth=null,VIEWING_URL,ACM_SESSION_URL,PROTEIN_ROOT=null,PRISM_ROOT=null,LOCALIZATION_REL_PATH="",LMV_VIEWER_VERSION="1.2.14",LMV_RESOURCE_VERSION=null,LMV_RESOURCE_ROOT="";function stderr(a){ENABLE_TRACE&&console.log(a)}
(function(){var a=Autodesk.Viewing.Private;a.env=null;a.logger=null;a.refreshToken=null;a.docItemId=null;a.accessToken=null;a.memoryOptimizedLoading=null;a.assets=[];a.offline=!1;a.offlineResourcePrefix=null;a.EnvironmentConfigurations={Local:{VIEWING:"https://viewing-dev.api.autodesk.com/viewingservice/v1",ACM:"https://developer-dev.api.autodesk.com/oss-ext/v1/acmsessions",LOGGING:"rtc-dev.api.autodesk.com",RTC:"https://rtc-dev.api.autodesk.com:443"},Development:{VIEWING:"https://viewing-dev.api.autodesk.com/viewingservice/v1",
ACM:"https://developer-dev.api.autodesk.com/oss-ext/v1/acmsessions",LOGGING:"rtc-dev.api.autodesk.com",RTC:"https://rtc-dev.api.autodesk.com:443"},Staging:{VIEWING:"https://viewing-staging.api.autodesk.com/viewingservice/v1",ACM:"https://developer-stg.api.autodesk.com/oss-ext/v1/acmsessions",LOGGING:"rtc-stg.api.autodesk.com",RTC:"https://rtc-stg.api.autodesk.com:443"},Production:{VIEWING:"https://viewing.api.autodesk.com/viewingservice/v1",ACM:"https://developer.api.autodesk.com/oss-ext/v1/acmsessions",
LOGGING:"rtc.api.autodesk.com",RTC:"https://rtc.api.autodesk.com:443"},AutodeskDevelopment:{VIEWING:"https://developer-dev.api.autodesk.com/viewingservice/v1",ACM:"https://developer-dev.api.autodesk.com/oss-ext/v1/acmsessions",LOGGING:"rtc-dev.api.autodesk.com",RTC:"https://rtc-dev.api.autodesk.com:443"},AutodeskStaging:{VIEWING:"https://developer-stg.api.autodesk.com/viewingservice/v1",ACM:"https://developer-stg.api.autodesk.com/oss-ext/v1/acmsessions",LOGGING:"rtc-stg.api.autodesk.com",RTC:"https://rtc-stg.api.autodesk.com:443"},
AutodeskProduction:{VIEWING:"https://developer.api.autodesk.com/viewingservice/v1",ACM:"https://developer.api.autodesk.com/oss-ext/v1/acmsessions",LOGGING:"rtc.api.autodesk.com",RTC:"https://rtc.api.autodesk.com:443"}};a.initializeEnvironmentVariable=function(b){var c;b&&b.env&&(c=b.env);b&&b.memoryOptimizedLoading&&(a.memoryOptimizedLoading="true"===b.memoryOptimizedLoading?!0:!1,a.memoryOptimizedLoading&&console.log("Viewer is set in optimized memory mode."));c||(c=a.getParameterByName("env"));
b&&b.offlineResourcePrefix&&(a.offlineResourcePrefix=b.offlineResourcePrefix);b&&b.offline&&"true"===b.offline&&(a.offline=!0);if(!c)switch(window.location.hostname){case "viewing-dev.api.autodesk.com":c="Development";break;case "viewing-staging.api.autodesk.com":c="Staging";break;case "viewing.api.autodesk.com":c="Production";break;case "developer-dev.api.autodesk.com":c="AutodeskDevelopment";break;case "developer-stg.api.autodesk.com":c="AutodeskStaging";break;case "developer.api.autodesk.com":c=
"AutodeskProduction";break;case "ec2-23-20-101-198.compute-1.amazonaws.com":c="Development";break;case "localhost.autodesk.com":c="Local";break;case "":c="Local";break;case "127.0.0.1":c="Local";break;default:c="AutodeskProduction"}console.log("Host name : "+window.location.hostname);console.log("Environment initialized as : "+c);a.env=c};a.initializeServiceEndPoints=function(b){var c=a.EnvironmentConfigurations[a.env];VIEWING_URL=c.VIEWING;ACM_SESSION_URL=c.ACM;c=[];b&&b.hasOwnProperty("libraryName")&&
c.push(b.libraryName);c.push("viewer3D.min.js");c.push("viewer3D.js");var f,d;for(b=0;b<c.length;b++){d=(d=a.getScript(c[b]))?d.src:"";var g=d.indexOf(c[b]);if(0<=g){f=d.substr(0,g);break}}LMV_RESOURCE_VERSION="v"+LMV_VIEWER_VERSION;(c=a.getParameterByNameFromPath("v",d))&&c.length&&c!=LMV_RESOURCE_VERSION?(console.warn("Version string mismatch between requested and actual version: "+c+" vs. "+LMV_RESOURCE_VERSION+". Using "+c),LMV_RESOURCE_VERSION=c):c&&c.length||(LMV_RESOURCE_VERSION=null,console.info("No viewer version specified, will implicitly use "+
LMV_VIEWER_VERSION));LMV_RESOURCE_ROOT=f||LMV_RESOURCE_ROOT};a.refreshCookie=function(b,c,f){var d=new XMLHttpRequest;d.onload=c;d.onerror=f;d.ontimeout=f;0===a.env.indexOf("Autodesk")?(c=VIEWING_URL.substring(0,VIEWING_URL.indexOf("/viewingservice")),d.open("POST",c+"/utility/v1/settoken",!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.withCredentials=!0,d.send("access-token="+b),_isIE11&&(a.accessToken=b)):(b={oauth:{token:b}},d.open("POST",VIEWING_URL+"/token",!0),
d.setRequestHeader("Content-Type","application/json"),d.withCredentials=!0,d.send(JSON.stringify(b)))};a.initializeAuth=function(b,c){var f=c?c.shouldInitializeAuth:null;f||(f=a.getParameterByName("auth"));if("Local"==a.env&&!f)return setTimeout(b,0),auth=!1;auth=!0;c?(f=c.getAccessToken?c.getAccessToken():c.accessToken?c.accessToken:a.getParameterByName("accessToken"),a.refreshToken=c.refreshToken):f=a.getParameterByName("accessToken");f||(f="zglJ9kHw1cT65I1ORsp/0YZNiks=",console.log("Warning : no access token is provided. Use built in token : "+
f));a.refreshCookie(f,b);return auth};a.refreshTokenAndCookie=function(b,c){var f=null;a.refreshToken&&(f=a.refreshToken());f?a.refreshCookie(f,b,c):c&&c(null)};a.initializeLogger=function(b){a.logger=new a.Logger({endpoint:a.EnvironmentConfigurations[a.env].LOGGING,eventCallback:b?b.eventCallback:void 0})};a.initializeProtein=function(){if(!ENABLE_DEBUG||"Local"!=a.env||auth){var b=new XMLHttpRequest;b.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=protein",!0);b.responseType=
"json";b.onload=function(a){(a=b.response.url)&&a.length&&(a=a.replace("http://","https://"),PROTEIN_ROOT=a+"/",stderr("Protein root is: "+PROTEIN_ROOT))};b.send();var c=new XMLHttpRequest;c.open("GET","https://raas-assets.autodesk.com/StaticContent/BaseAddress?family=prism",!0);c.responseType="json";c.onload=function(a){(a=c.response.url)&&a.length&&(a=a.replace("http://","https://"),PRISM_ROOT=a+"/",stderr("Prism root is: "+PRISM_ROOT))};c.send()}};a.getAuthObject=function(){return auth};a.getParameterByName=
function(b){return a.getParameterByNameFromPath(b,window.location.href)};a.getParameterByNameFromPath=function(a,c){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var f=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(c);return null==f?"":decodeURIComponent(f[1].replace(/\+/g," "))};a.getDemoDocumentURN=function(){var b;switch(a.env){case "Development":b="urn:dXJuOmFkc2suYTM2MGJldGFkZXY6ZnMuZmlsZTplbnRlcnByaXNlLmxtdnRlc3QuRFM1YTczMFFUYmYwMDIyZDA3NTFhYmE5MjZlZDZkMjJlZDY0P3ZlcnNpb249MQ==";break;case "Staging":b=
"urn:dXJuOmFkc2suczM6ZGVyaXZlZC5maWxlOlZpZXdpbmdTZXJ2aWNlVGVzdEFwcC91c2Vycy9NaWNoYWVsX0hhbicvTU0zNTAwQXNzZW1ibHkuZHdm";break;case "Production":b="FIXME";break;default:b="https://lmv.rocks/viewer/data/gears/output/bubble.json"}return b};a.setLanguage=function(a,c){var f={lng:a,resGetPath:"res/locales/__lng__/__ns__.json",ns:{namespaces:["allstrings"],defaultNs:"allstrings"},fallbackLng:"en",debug:!1};LOCALIZATION_REL_PATH="res/locales/"+a+"/";Autodesk.Viewing.i18n.init(f,function(a){Autodesk.Viewing.i18n.localize();
c&&c()})};a.initializeLocalization=function(){navigator.language.split("-");a.setLanguage("en")};a.initializeUserInfo=function(b){b&&b.userInfo&&(a.setUserName(b.userInfo.name),b.comment2Token&&(a.comment2Token=b.comment2Token))};a.getScript=function(a){a=a.toLowerCase();var c=document.getElementsByTagName("SCRIPT");if(c&&0<c.length)for(var f=0;f<c.length;++f)if(c[f].src&&-1!==c[f].src.toLowerCase().indexOf(a))return c[f];return null};a.getResourceUrl=function(a){var c=LMV_RESOURCE_VERSION;return LMV_RESOURCE_ROOT+
a+(c?"?v="+c:"")};a.loadDependency=function(b,c,f){"undefined"==typeof window[b]?(b=document.createElement("SCRIPT"),b.src=a.getResourceUrl(c),document.head.appendChild(b),f&&(b.onload=f)):f&&f()};Autodesk.Viewing.Initializer=function(b,c){a.WEBGL_HELP_LINK=b?b.webGLHelpLink:null;a.initializeEnvironmentVariable(b);a.initializeServiceEndPoints(b);a.initializeProtein();a.initWorkerScript();a.loadDependency("THREE","adsk_three.min.js",function(){a.initializeLogger(b);a.initializeAuth(c,b);a.initializeLocalization();
a.initializeUserInfo(b)})}})();
