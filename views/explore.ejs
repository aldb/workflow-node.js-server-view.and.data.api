<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>ADN Node.js Server Sample</title>

    <!-- External libraries -->
    <script src="https://code.jquery.com/jquery-2.1.2.js"></script><!-- jquery-2.1.2.min.js -->

    <!-- Autodesk View & Data API -->
    <link type="text/css" rel="stylesheet" href="https://developer.api.autodesk.com/viewingservice/v1/viewers/style.css" />
    <script src="https://developer.api.autodesk.com/viewingservice/v1/viewers/viewer3D.min.js"></script>

    <!-- Our scripts -->
    <link rel="stylesheet" type="text/css" href="/style.css" />

    <script>
        function initialize () {
            var options ={ "document": '<%= urn %>', env: '"AutodeskProduction' } ;
            var viewerElement =$("#viewer") ;
            var viewer =new Autodesk.Viewing.Viewer3D (viewerElement, {}) ; //Autodesk.Viewing.Viewer3D
            Autodesk.Viewing.Initializer (options, function () {
                viewer.initialize () ;
                loadDocument (viewer, '<%= accessToken %>', options.document) ;
            }) ;
        }

        function loadDocument (viewer, auth, documentId) {
            // Find the first 3d geometry and load that.
            Autodesk.Viewing.Document.load (documentId, auth,
                function (doc) { // onLoadCallback
                    var geometryItems =[] ;
                    geometryItems =Autodesk.Viewing.Document.getSubItemsWithProperties (doc.getRootItem (), { "type" : "geometry", "role" : "3d" }, true) ;
                    if ( geometryItems.length > 0 )
                        viewer.load (doc.getViewablePath (geometryItems [0])) ;
                },
                function (errorMsg) { // onErrorCallback
                    alert("Load Error: " + errorMsg) ;
                }
            ) ;
        }
    </script>
</head>

<body style="margin:0" onload="initialize ();">

    <div id="project">

        <hr />
        <h3>LMV Node.js Sample</h3>
        <div id="viewer" width="800" height="450"></div>

    </div>



</body>
</html>